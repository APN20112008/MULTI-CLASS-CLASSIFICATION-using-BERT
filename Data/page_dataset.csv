text,label
"7.3 Computation of EigenvaluesExample 2. (to change a13 = a31 to zero)Embedding H into Q, the result Q−1AQ is tridiagonal:Q−1AQ is a matrix that is ready to reveal its eigenvalues—the QR algorithm is ready tobegin—but we digress for a moment to mention two other applications of these same1. The Gram-Schmidt factorization A = QR. Remember that R is to be upper trian-gular. We no longer have to accept an extra nonzero diagonal below the main one,since no matrices are multiplying on the right to spoil the zeros. The ﬁrst step inconstructing Q is to work with the whole ﬁrst column of A:H1 = I −2 vvTThe ﬁrst column of H1A equals −∥x∥z. It is zero below the main diagonal, and itis the ﬁrst column of R. The second step works with the second column of H1A,from the pivot on down, and produces an H2H1A which is zero below that pivot.(The whole algorithm is like elimination, but slightly slower.) The result of n − 1steps is an upper triangular R, but the matrix that records the steps is not a lowertriangular L. Instead it is the product Q = H1H2···Hn−1, which can be stored in thisfactored form (keep only the v’s) and never computed explicitly. That completes2. The singular value decomposition UTAV = Σ. The diagonal matrix Σ has the sameshape as A, and its entries (the singular values) are the square roots of the eigenval-ues of ATA. Since Householder transformations can only prepare for the eigenvalueproblem, we cannot expect them to produce Σ. Instead, they stably produce a bidi-agonal matrix, with zeros everywhere except along the main diagonal and the oneThe ﬁrst step toward the SVD is exactly as in QR above: x is the ﬁrst column of A,and H1x is zero below the pivot. The next step is to multiply on the right by an H(1)",computations
"5.3 Difference Equations and Powers AkDifference Equations and Powers AkDifference equations uk+1 = Auk move forward in a ﬁnite number of ﬁnite steps. Adifferential equation takes an inﬁnite number of inﬁnitesimal steps, but the two theoriesstay absolutely in parallel. It is the same analogy between the discrete and the continuousthat appears over and over in mathematics. A good illustration is compound interest,when the time step gets shorter.Suppose you invest $1000 at 6% interest. Compounded once a year, the principal Pis multiplied by 1.06. This is a difference equation Pk+1 = APk = 1.06Pk with a time stepof one year. After 5 years, the original P0 = 1000 has been multiplied 5 times:Now suppose the time step is reduced to a month. The new difference equation is pk+1 =(1+.06/12)pk. After 5 years, or 60 months, you have $11 more:The next step is to compound every day, on 5(365) days. This only helps a little:Finally, to keep their employees really moving, banks offer continuous compounding.The interest is added on at every instant, and the difference equation breaks down. Youcan hope that the treasurer does not know calculus (which is all about limits as ∆t → 0).The bank could compound the interest N times a year, so ∆t = 1/N:1000 → e.301000 = $1349.87.Or the bank can switch to a differential equation—the limit of the difference equationpk+1 = (1+.06∆t)pk. Moving pk to the left side and dividing by ∆t,The solution is p(t) = e.06t p0. After t = 5 years, this again amounts to $1349.87. Theprincipal stays ﬁnite, even when it is compounded every instant—and the improvementover compounding every day is only four cents.The main object of this section is to solve uk+1 = Auk. That leads us to Ak and powersof matrices. Our second example is the famous Fibonacci sequence:",eigenvec_val
"2.3 Linear Independence, Basis, and DimensionExample 6. The vectors w1 = (1,0,0), w2 = (0,1,0), and w3 = (−2,0,0) span a plane(the x-y plane) in R3. The ﬁrst two vectors also span this plane, whereas w1 and w3 spanExample 7. The column space of A is exactly the space that is spanned by its columns.The row space is spanned by the rows. The deﬁnition is made to order. Multiplying Aby any x gives a combination of the columns; it is a vector Ax in the column space.The coordinate vectors e1,...,en coming from the identity matrix span Rn. Everyvector b = (b1,...,bn) is a combination of those columns. In this example the weightsare the components bi themselves: b = b1e1 + ··· + bnen. But the columns of othermatrices also span Rn!Basis for a Vector SpaceTo decide if b is a combination of the columns, we try to solve Ax = b. To decide ifthe columns are independent, we solve Ax = 0. Spanning involves the column space,and independence involves the nullspace. The coordinate vectors e1,...,en span Rnand they are linearly independent. Roughly speaking, no vectors in that set are wasted.This leads to the crucial idea of a basis.A basis for V is a sequence of vectors having two properties at once:1. The vectors are linearly independent (not too many vectors).2. They span the space V (not too few vectors).This combination of properties is absolutely fundamental to linear algebra. It meansthat every vector in the space is a combination of the basis vectors, because they span.It also means that the combination is unique: If v = a1v1 + ··· + akvk and also v =b1v1 + ··· + bkvk, then subtraction gives 0 = ∑(ai − bi)vi. Now independence plays itspart; every coefﬁcient ai − bi must be zero. Therefore ai = bi. There is one and onlyone way to write v as a combination of the basis vectors.We had better say at once that the coordinate vectors e1,...,en are not the only basisfor Rn. Some things in linear algebra are unique, but not this. A vector space hasinﬁnitely many different bases. Whenever a square matrix is invertible, its columns areindependent—and they are a basis for Rn. The two columns of this nonsingular matrixare a basis for R2:Every two-dimensional vector is a combination of those (independent!) columns.Example 8. The x-y plane in Figure 2.4 is just R2. The vector v1 by itself is linearlyindependent, but it fails to span R2. The three vectors v1, v2, v3 certainly span R2, butare not independent. Any two of these vectors, say v1 and v2, have both properties—they",vector spaces
"1.6 Inverses and Transposes(a) Find a nonzero solution x to Ax = 0. The matrix is 3 by 3.(b) Elimination keeps column 1 + column 2 = column 3. Explain why there is no27. Suppose A is invertible and you exchange its ﬁrst two rows to reach B. Is the newmatrix B invertible? How would you ﬁnd B−1 from A−1?28. If the product M = ABC of three square matrices is invertible, then A, B, C areinvertible. Find a formula for B−1 that involves M−1 and A and C.29. Prove that a matrix with a column of zeros cannot have an inverse.30. Multiply [a bc d] times [ d −b−c a ]. What is the inverse of each matrix if ad ̸= bc?31. (a) What matrix E has the same effect as these three steps? Subtract row 1 from row2, subtract row 1 from row 3, then subtract row 2 from row 3.(b) What single matrix L has the same effect as these three reverse steps? Add row2 to row 3, add row 1 to row 3, then add row 1 to row 2.32. Find the numbers a and b that give the inverse of 5 ∗ eye(4) − ones(4,4):a b b bb a b bb b a bb b b aWhat are a and b in the inverse of 6 ∗ eye(5) − ones(5,5)?33. Show that A = 4 ∗ eye(4) − ones(4,4) is not invertible: Multiply A ∗ ones(4,1).34. There are sixteen 2 by 2 matrices whose entries are 1s and 0s. How many of themProblems 35–39 are about the Gauss-Jordan method for calculating A−1.35. Change I into A−1 as you reduce A to I (by row operations):1 3 1 02 7 0 11 4 1 03 9 0 136. Follow the 3 by 3 text example but with plus signs in A. Eliminate above and belowthe pivots to reduce [A I] to [I A−1]:2 1 0 1 0 01 2 1 0 1 00 1 2 0 0 1",gauss elim
"1.7 Special Matrices and Applications(a) Factor A into LU, assuming v2 ̸= 0.(b) Find A−1, which has the same form as A.1.19 Solve by elimination, or show that there is no solution:u + 2v + 3w = 03u + 5v + 7w = 1u + 3w =3u + 5v + 7w = 1.1.20 The n by n permutation matrices are an important example of a “group.” If youmultiply them you stay inside the group; they have inverses in the group; the identityis in the group; and the law P1(P2P3) = (P1P2)P3 is true—because it is true for all(a) How many members belong to the groups of 4 by 4 and n by n permutation(b) Find a power k so that all 3 by 3 permutation matrices satisfy Pk = I.1.21 Describe the rows of DA and the columns of AD if D = [2 01.22 (a) If A is invertible what is the inverse of AT?(b) If A is also symmetric what is the transpose of A−1?(c) Illustrate both formulas when A = [2 11.23 By experiment with n = 2 and n = 3, ﬁnd1.24 Starting with a ﬁrst plane u+2v−w = 6, ﬁnd the equation for(a) the parallel plane through the origin.(b) a second plane that also contains the points (6,0,0) and (2,2,0).(c) a third plane that meets the ﬁrst and second in the point (4,1,0).1.25 What multiple of row 2 is subtracted from row 3 in forward elimination of A?How do you know (without multiplying those factors) that A is invertible, symmet-ric, and tridiagonal? What are its pivots?1.26 (a) What vector x will make Ax = column 1 of A + 2(column 3), for a 3 by 3 matrix",gauss elim
"4.2 Properties of the Determinantthe best deﬁnition. Obviously, detA will not be some extremely simple function of n2variables; otherwise A−1 would be much easier to ﬁnd than it actually is.The simple things about the determinant are not the explicit formulas, but the prop-erties it possesses. This suggests the natural place to begin. The determinant can be (andwill be) deﬁned by its three most basic properties: detI = 1, the sign is reversed by arow exchange, the determinant is linear in each row separately. The problem is thento show, by systematically using these properties, how the determinant can be computed.This will bring us back to the product of the pivots.Section 4.2 explains these three deﬁning properties of the determinant, and their mostimportant consequences. Section 4.3 gives two more formulas for the determinant—the“big formula” with n! terms, and a formula “by induction”. In Section 4.4 the determi-nant is applied to ﬁnd A−1. Then we compute x = A−1b by Cramer’s rule. And ﬁnally, inan optional remark on permutations, we show that whatever the order in which the prop-erties are used, the result is always the same—the deﬁning properties are self-consistent.Here is a light-hearted question about permutations. How many exchanges does ittake to change VISA into AVIS? Is this permutation odd or even?Properties of the DeterminantThis will be a pretty long list. Fortunately each rule is easy to understand, and eveneasier to illustrate, for a 2 by 2 example. Therefore we shall verify that the familiardeﬁnition in the 2 by 2 case,����� = ad −bc,possesses every property in the list. (Notice the two accepted notations for the deter-minant, detA and |A|.) Properties 4–10 will be deduced from the previous ones. Everyproperty is a consequence of the ﬁrst three. We emphasize that the rules apply tosquare matrices of any size.1. The determinant of the identity matrix is 1.",determinants
"Chapter 2 Vector SpacesFind H−1 and write v = (7,5,3,1) as a combination of the columns of H.48. Suppose we have two bases v1,...,vn and w1,...,wn for Rn. If a vector has coefﬁ-cients bi in one basis and ci in the other basis, what is the change-of-basis matrix inb = Mc? Start fromb1v1 +···+bnvn = Vb = c1w1 +···+cnwn = Wc.Your answer represents T(v) = v with input basis of v’s and output basis of w’s.Because of different bases, the matrix is not I.49. True or false: If we know T(v) for n different nonzero vectors in R2, then we knowT(v) for every vector in Rn.50. (Recommended) Suppose all vectors x in the unit square 0 ≤ x1 ≤ 1, 0 ≤ x2 ≤ 1 aretransformed to Ax (A is 2 by 2).(a) What is the shape of the transformed region (all Ax)?(b) For which matrices A is that region a square?(c) For which A is it a line?(d) For which A is the new area still 1?1.1 Find a basis for the following subspaces of R4:(a) The vectors for which x1 = 2x4.(b) The vectors for which x1 +x2 +x3 = 0 and x3 +x4 = 0.(c) The subspace spanned by (1,1,1,1), (1,2,3,4), and (2,3,4,5).1.2 By giving a basis, describe a two-dimensional subspace of R3 that contains none ofthe coordinate vectors (1,0,0), (0,1,0), (0,0,1).1.3 True or false, with counterexample if false:(a) If the vectors x1,...,xm span a subspace S, then dimS = m.(b) The intersection of two subspaces of a vector space cannot be empty.(c) If Ax = Ay, then x = y.(d) The row space of A has a unique basis that can be computed by reducing A to(e) If a square matrix A has independent columns, so does A2.",vector spaces
"Chapter 7 Computations with Matrices17. (Suggested by Moler and Van Loan) Compute b−Ay and b−Az whenIs y closer than z to solving Ax = b? Answer in two ways: Compare the residualb−Ay to b−Az. Then compare y and z to the true x = (1,−1), Sometimes we wanta small residual, sometimes a small δx.Problems 18–20 are about vector norms other than the usual ∥x∥ = √x·x.18. The “ℓ1 norm” is ∥x∥1 = |x|1+···+|x|n. The “ℓ∞ norm” is ∥x∥∞ = max|xi|. Compute∥x∥, ∥x∥1 and ∥x∥∞ for the vectors19. Prove that ∥x∥∞ ≤ ∥x∥ ≤ ∥x∥1. Show from the Schwarz inequality that the ratios∥x∥/∥x∥∞ and ∥x∥1/∥x∥ are never larger than √n. Which vector (x1,...,xn) givesratios equal to √n?20. All vector norms must satisfy the triangle inequality. Prove that∥x+y∥∞ ≤ ∥x∥∞ +∥y∥∞∥x+y∥1 ≤ ∥x∥1 +∥y∥1.21. Compute the exact inverse of the Hilbert matrix A by elimination. Then computeA−1 again by rounding all numbers to three ﬁgures:A = hilb(3) =22. For the same A, compute b = Ax for x = (1,1,1) and x = (0,6,−3.6). A small change∆b produces a large change ∆x.23. Compute λmax and λmin for the 8 by 8 Hilbert matrix aij = 1/(i + j − 1). If Ax = bwith ∥b∥ = 1, how large can ∥x∥ be? If b has roundoff error less than 10−16, howlarge an error can this cause in x?24. If you know L, U, Q, and R, is it faster to solve LUx = b or QRx = b?25. Choosing the largest available pivot in each column (partial pivoting), factor each Ainto PA = LU:",computations
"Chapter 5 Eigenvalues and Eigenvectors27. Prove that AHA is always a Hermitian matrix, Compute AHA and AAH:28. If Az = 0, then AHAz = 0. If AHAz = 0, multiply by zH to prove that Az = 0. Thenullspaces of A and AHA are. AHA is an invertible Hermitian matrix when thenullspace of A contains only z =29. When you multiply a Hermitian matrix by a real number c, is cA still Hermitian? Ifc = i, show that iA is skew-Hermitian. The 3 by 3 Hermitian matrices are a subspace,provided that the “scalars” are real numbers.30. Which classes of matrices does P belong to: orthogonal, invertible, Hermitian, uni-tary, factorizable into LU, factorizable into QR?31. Compute P2, P3, and P100 in Problem 30. What are the eigenvalues of P?32. Find the unit eigenvectors of P in Problem 30, and put them into the columns of aunitary matrix U. What property of P makes these eigenvectors orthogonal?33. Write down the 3 by 3 circulant matrix C = 2I + 5P + 4P2. It has the same eigen-vectors as P in Problem 30. Find its eigenvalues.34. If U is unitary and Q is a real orthogonal matrix, show that U−1 is unitary and alsoUQ is unitary. Start from UHU = I and QTQ = I.35. Diagonalize A (real λ’s) and K (imaginary λ’s) to reach UΛUH:36. Diagonalize this orthogonal matrix to reach Q = UΛUH. Now all λ’s are37. Diagonalize this unitary matrix V to reach V = UΛUH. Again all |λ| = 1:",eigenvec_val
"Vector Spaces and SubspacesElimination can simplify, one entry at a time, the linear system Ax = b. Fortunately italso simpliﬁes the theory. The basic questions of existence and uniqueness—Is thereone solution, or no solution, or an inﬁnity of solutions?—are much easier to answerafter elimination, We need to devote one more section to those questions, to ﬁnd everysolution for an m by n system. Then that circle of ideas will be complete.But elimination produces only one kind of understanding of Ax = b. Our chief objectis to achieve a different and deeper understanding. This chapter may be more difﬁcultthan the ﬁrst one. It goes to the heart of linear algebra.For the concept of a vector space, we start immediately with the most importantspaces. They are denoted by R1,R2,R3,...; the space Rn consists of all column vectorswith n components. (We write R because the components are real numbers.) R2 isrepresented by the usual x-y plane; the two components of the vector become the x andy coordinates of the corresponding point. The three components of a vector in R3 give apoint in three-dimensional space. The one-dimensional space R1 is a line.The valuable thing for linear algebra is that the extension to n dimensions is sostraightforward. For a vector in R7 we just need the seven components, even if thegeometry is hard to visualize. Within all vector spaces, two operations are possible:We can add any two vectors, and we can multiply all vectors by scalars.In other words, we can take linear combinations.Addition obeys the commutative law x + y = y + x; there is a “zero vector” satisfying0+x = x; and there is a vector “−x” satisfying −x+x = 0. Eight properties (includingthose three) are fundamental; the full list is given in Problem 5 at the end of this section.A real vector space is a set of vectors together with rules for vector addition and mul-tiplication by real numbers. Addition and multiplication must produce vectors in thespace, and they must satisfy the eight conditions.",vector spaces
"3.5 The Fast Fourier TransformIt makes an angle θ with the horizontal. The whole plane enters in Chapter 5, wherecomplex numbers will appear as eigenvalues (even of real matrices). Here we need onlyspecial points w, all of them on the unit circle, in order to solve wn = 1.w = e2π/8 = cos 2π8 + i sin 2πFigure 3.11: The eight solutions to z8 = 1 are 1,w,w2,...,w7 with w = (1+i)/The square of w can be found directly (it just doubles the angle):w2 = (cosθ +isinθ)2 = cos2θ −sin2 θ +2isinθ cosθ.The real part cos2θ − sin2θ is cos2θ, and the imaginary part 2 sinθ cosθ is sin2θ.(Note that i is not included; the imaginary part is a real number.) Thus w2 = cos2θ +isin2θ. The square of w is still on the unit circle, but at the double angle 2θ. Thatmakes us suspect that wn lies at the angle nθ, and we are right.There is a better way to take powers of w. The combination of cosine and sine is acomplex exponential, with amplitude one and phase angle θ:cosθ +isinθ = eiθ.The rules for multiplying, like (e2)(e3) = e5, continue to hold when the exponents iθ areimaginary. The powers of w = eiθ stay on the unit circle:The nth power is at the angle nθ. When n = −1, the reciprocal 1/w has angle −θ. Ifwe multiply cosθ +isinθ by cos(−θ)+isin(−θ), we get the answer 1:eiθe−iθ = (cosθ +isinθ)(cosθ −isinθ) = cos2θ +sin2θ = 1.Note. I remember the day when a letter came to MIT from a prisoner in New York,asking if Euler’s formula (2) was true. It is really astonishing that three of the key",orthogonality
"1.6 Inverses and TransposesThus A−1Ax = x. The matrix A−1 times A is the identity matrix. Not all matrices haveinverses. An inverse is impossible when Ax is zero and x is nonzero. Then A−1 wouldhave to get back from Ax = 0 to x. No matrix can multiply that zero vector Ax andproduce a nonzero vector x.Our goals are to deﬁne the inverse matrix and compute it and use it, when A−1exists—and then to understand which matrices don’t have inverses.The inverse of A is a matrix B such that BA = I and AB = I. There is atmost one such B, and it is denoted by A−1:Note 1. The inverse exists if and only if elimination produces n pivots (row exchangesallowed). Elimination solves Ax = b without explicitly ﬁnding A−1.Note 2. The matrix A cannot have two different inverses, Suppose BA = I and alsoAC = I. Then B = C, according to this “proof by parentheses”:This shows that a left-inverse B (multiplying from the left) and a right-inverse C (multi-plying A from the right to give AC = I) must be the same matrix.Note 3. If A is invertible, the one and only solution to Ax = b is x = A−1b:x = A−1Ax = A−1b.Note 4. (Important) Suppose there is a nonzero vector x such that Ax = 0. Then Acannot have an inverse. To repeat: No matrix can bring 0 back to x.If A is invertible, then Ax = 0 can only have the zero solution x = 0.Note 5. A 2 by 2 matrix is invertible if and only if ad −bc is not zero:2 by 2 inverseThis number ad − bc is the determinant of A. A matrix is invertible if its determinantis not zero (Chapter 4). In MATLAB, the invertibility test is to ﬁnd n nonzero pivots.Elimination produces those pivots before the determinant appears.Note 6. A diagonal matrix has an inverse provided no diagonal entries are zero:When two matrices are involved, not much can be done about the inverse of A + B.The sum might or might not be invertible. Instead, it is the inverse of their product",gauss elim
"Example 1. A =has eigenvalues 1 and 0. Each B is M−1AM:, then B =triangular with λ = 0 and 0., then B =projection with λ = 0 and 0., then B = an arbitrary matrix with λ = 0 and 0.In this case we can produce any B that has the correct eigenvalues. It is an easy case,because the eigenvalues 1 and 0 are distinct. The diagonal A was actually Λ, the out-standing member of this family of similar matrices (the capo). The Jordan form willworry about repeated eigenvalues and a possible shortage of eigenvectors. All we sayno is that every M−1AM has the same number of independent eigenvectors as A (eacheigenvector is multiplied by M−1).The ﬁrst step is to look at the linear transformations that lie behind the matrices.Rotations, reﬂections, and projections act on n-dimensional space. The transformationcan happen without linear algebra, but linear algebra turns it into matrix multiplication.Change of Basis = Similarity TransformationThe similar matrix B = M−1AM is closely connected to A, if we go back to linear trans-formations. Remember the key idea: Every linear transformation is represented by amatrix. The matrix depends on the choice of basis! If we change the basis by M wechange the matrix A to a similar matrix B.Similar matrices represent the same transformation T with respect so differentbases. The algebra is almost straightforward. Suppose we have a basis v1,...,vn. Thejth column of A comes from applying T to v j:Tvj = combination of the basis vectors = a1jv1 +···+anjvn.For a new basis V1,...,Vn, the new matrix B is constructed in the same way: TVj =combination of the V’s = b1 jV1 + ··· + bnjVn. But also each V must be a combinationof the old basis vectors: Vj = ∑mijvi. That matrix M is really representing the identitytransformation (!) when the only thing happening is the change of basis (T is I). The in-verse matrix M−1 also represents the identity transformation. when the basis is changedfrom the v’s back to the V’s. Now the product rule gives the result we want:The matrices A and B that represent the same linear transformation Twith respect to two different bases (the v’s and the V’s) are similar:",eigenvec_val
"(c) Why does no matrix transform (2,6) to (1,0) and (1,3) to (0,1)?37. (a) What matrix M transforms (1,0) and (0,1) to (r,t) and (s,u)?(b) What matrix N transforms (a,c) and (b,d) to (1,0) and (0,1)?(c) What condition on a, b, c, d will make part (b) impossible?38. (a) How do M and N in Problem 37 yield the matrix that transforms (a,c) to (r,t)and (b,d) to (s,u)?(b) What matrix transforms (2,5) to (1,1) and (1,3) to (0,2)?39. If you keep the same basis vectors but put them in a different order, the change-of-basis matrix M is amatrix. If you keep the basis vectors in order but changetheir lengths, M is a40. The matrix that transforms (1,0) and (0,1) to (1,4) and (1,5) is M =combination a(1,4) + b(1,5) that equals (1,0) has (a,b) = (those new coordinates of (1,0) related to M or M−1?41. What are the three equations for A, B, C if the parabola Y = A + Bx +Cx2 equals 4at x = a, 5 at x = b, and 6 at x = c? Find the determinant of the 3 by 3 matrix. Forwhich numbers a, b, c will it be impossible to ﬁnd this parabola Y?42. Suppose v1, v2, v3 are eigenvectors for T. This means T(vi) = λivi for i = 1,2,3.What is the matrix for T when the input and output bases are the v’s?43. Every invertible linear transformation can have I as its matrix. For the output basisjust choose wi = T(vi). Why must T be invertible?44. Suppose T is reﬂection across the x-axis and S is reﬂection across the y-axis. Thedomain V is the x-y plane. If v = (x,y) what is S(T(v))? Find a simpler descriptionof the product ST.45. Suppose T is reﬂection across the 45° line, and S is reﬂection across the y-axis, Ifv = (2,1) then T(v) = (1,2). Find S(T(v)) and T(S(v)). This shows that generally46. Show that the product ST of two reﬂections is a rotation. Multiply these reﬂectionmatrices to ﬁnd the rotation angle:47. The 4 by 4 Hadamard matrix is entirely +1 and −1:",vector spaces
"6.3 Singular Value Decomposition10. Suppose A is a 2 by 2 symmetric matrix with unit eigenvectors u1 and u2. If itseigenvalues are λ1 = 3 and λ2 = −2, what are U, Σ, and V T?11. Suppose A is invertible (with σ1 > σ2 > 0). Change A by as small a matrix as possibleto produce a singular matrix A0. Hint: U and V do not change:12. (a) If A changes to 4A, what is the change in the SVD?(b) What is the SVD for AT and for A−1?13. Why doesn’t the SVD for A+I just use Σ+I?14. Find the SVD and the pseudoinverse 0+ of the m by n zero matrix.15. Find the SVD and the pseudoinverse VΣ+UT of1 1 1 116. If an m by n matrix Q has orthonormal columns, what is Q+?17. Diagonalize ATA to ﬁnd its positive deﬁnite square root S = VΣ1/2V T and its polardecomposition A = QS:18. What is the minimum-length least-squares solution x+ = A+b to the following?You can compute A+, or ﬁnd the general solution to ATA�x = ATb and choose thesolution that is in the row space of A. This problem ﬁts the best plane C+Dt +Ez tob = 0 and also b = 2 at t = z = 0 (and b = 2 at t = z = 1).(a) If A has independent columns, its left-inverse (ATA)−1AT is A+.(b) If A has independent rows, its right-inverse AT(AAT)−1 is A+.In both cases, verify that x+ = A+b is in the row space. and ATAx+ = ATb.19. Split A = UΣV T into its reverse polar decomposition QS′.20. Is (AB)+ = B+A+ always true for pseudoinverses? I believe not.",pos_def_matrices
"Chapter 8 Linear Programming and Game TheoryWith x5 entering the basis, x1 or x2 must leave. In the ﬁrst equation, increase x5 anddecrease x1 while keeping x1 +2x5 = 8. Then x1 will be down to zero when x5 reaches4. The second equation keeps x2 + 3x5 = 9. Here x5 can only increase as far as 3. Togo further would make x2 negative, so the leaving variable is x2. The new corner hasx = (2,0,0,0,3). The cost is down to −9.In Ax = b, the right sides divided by the coefﬁcients of the entering3. The smallest ratio 93 tells which variable hits zero ﬁrst, and mustleave. We consider only positive ratios, because if the coefﬁcient of x5 were −3, thenincreasing x5 would actually increase x2. (At x5 = 10 the second equation would givex2 = 39.) The ratio 93 says that the second variable leaves. It also gives x5 = 3.If all coefﬁcients of x5 had been negative, this would be an unbounded case: we canmake x5 arbitrarily large, and bring the cost down toward −∞.The current step ends at the new corner x = (2,0,0,0,3). The next step will only beeasy if the basic variables x1 and x5 stand by themselves (as x1 and x2 originally did).Therefore, we “pivot” by substituting x5 = 13(9−x2 −x3) into the cost function and theﬁrst equation. The new problem, starting from the new corner, is:7x3 −x4 −(9−x2 −x3) = x2 +8x3 −x4 −9The next step is now easy. The only negative coefﬁcient −1 in the cost makes x4 theentering variable. The ratios of 20, the right sides divided by the x4 column, makex1 the leaving variable. The new corner is x∗ = (0,0,0, 13,3). The new cost −91In a large problem, a departing variable might reenter the basis later on. But the costkeeps going down—except in a degenerate case—so the m basic variables can’t be thesame as before. No corner is ever revisited! The simplex method must end at the optimalcorner (or at −∞ if the cost turns out to be unbounded). What is remarkable is the speedat which x∗ is found.The cost coefﬁcients 7, −1, −3 at the ﬁrst corner and 1, 8, −1 at thesecond corner decided the entering variables. (These numbers go into r, the crucial vec-tor deﬁned below. When they are all positive we stop.) The ratios decided the leavingA corner is degenerate if more than the usual n com-ponents of x are zero. More than n planes pass through the corner, so a basic variablehappens to vanish. The ratios that determine the leaving variable will include zeros, andthe basis might change without actually moving from the corner. In theory, we couldstay at a corner and cycle forever in the choice of basis.",linear_prog
"Figure 6.6: The farthest x = x1/λ1 and the closet x = xn/√λn both give xTAx = xTλx = 1. These are the majoraxes of the ellipse.This “maximin principle” makes λ2 the maximum over all v of the minimum of R(x) withxTv = 0. That offers a way to estimate λ2 without knowing λ1.Example 3. Throw away the last row and column of any symmetric matrix:The second eigenvalue λ2(A) = 2 is above the lowest eigenvalue λ1(B) = 1. The lowesteigenvalue λ1(A) = 2−2 is below λ1(B). So λ1(B) is caught between.This example chose v = (0,0,1) so the constraint xTv = 0 knocked out the third com-ponent of x (thereby reducing A to B).The complete picture is an intertwining of eigenvalues:λ1(A) ≤ λ1(B) ≤ λ2(A) ≤ λ2(B) ≤ ··· ≤ λn−1(B) ≤ λn(A).This has a natural interpretation for an ellipsoid, when it is cut by a plane through theorigin. The cross section is an ellipsoid of one lower dimension. The major axis Of thiscross section cannot be longer than the major axis of the whole ellipsoid: λ1(B) ≥ λ1(A).But the major axis of the cross section is at least as long as the second axis of the originalellipsoid: λ1(B) ≤ λ2(A). Similarly the minor axis of the cross section is smaller thanthe original second axis, and larger than the original minor axis: λ2(A) ≤ λ2(B) ≤ λ3(A).You can see the same thing in mechanics. When springs and masses are oscillating,suppose one mass is held at equilibrium. Then the lowest frequency is increased but notabove λ2. The highest frequency is decreased, but not below λn−1.We close with three remarks, I hope your intuition says that they are correct.",pos_def_matrices
"33. Find the pieces xr and xn, and draw Figure 3.4 properly, ifProblems 34–44 are about orthogonal subspaces.34. Put bases for the orthogonal subspaces V and W into the columns of matrices V andW. Why does V TW = zero matrix? This matches vTw = 0 for vectors.35. The ﬂoor and the wall are not orthogonal subspaces because they share a nonzerovector (along the line where they meet). Two planes in R3 cannot be orthogonal!Find a vector in both column spaces C(A) and C(B):This will be a vector Ax and also B�x. Think 3 by 4 with the matrix [A B].36. Extend Problem 35 to a p-dimensional subspace V and a q-dimensional subspace Wof Rn. What inequality on p+q guarantees that V intersects W in a nonzero vector?These subspaces cannot be orthogonal.37. Prove that every y in N(AT) is perpendicular to every Ax in the column space, usingthe matrix shorthand of equation (8). Start from ATy = 0.38. If S is the subspace of R3 containing only the zero vector, what is S⊥? If S is spannedby (1,1,1), what is S⊥? If S is spanned by (2,0,0) and (0,0,3), what is S⊥?39. Suppose S only contains (1,5,1) and (2,2,2) (not a subspace). Then S⊥ is thenullspace of the matrix A =. S⊥ is a subspace even if S is not.40. Suppose L is a one-dimensional subspace (a line) in R3. Its orthogonal complementperpendicular to L. Then (L⊥)⊥ is aperpendicular to L⊥. Infact (L⊥)⊥ is the same as41. Suppose V is the whole space R4. Then V⊥ contains only the vector. So (V⊥)⊥ is the same as42. Suppose S is spanned by the vectors (1,2,2,3) and (1,3,3,2). Find two vectors thatspan S⊥. This is the same as solving Ax = 0 for which A?43. If P is the plane of vectors in R4 satisfying x1 + x2 + x3 + x4 = 0, write a basis forP⊥. Construct a matrix that has P as its nullspace.44. If a subspace S is contained in a subspace V, prove that S⊥ contains V⊥.Problems 45–50 are about perpendicular columns and rows.",orthogonality
"Chapter 6 Positive Deﬁnite Matrices(a) To prove that the p +q vectors x1,...,xp, Cy1,...,Cyq are independent, assumethat some combination gives zero:a1x1 +···+apxp = b1Cy1 +···+bqCyqShow that zTAz = λ1a2p ≥ 0 and zTAz = µ1b2(b) Deduce that the a’s and b’s are zero (proving linear independence). From thatdeduce p+q ≤ n.(c) The same argument for the n − p negative λ’s and the n − q positive µ’s givesn − p + n − q ≤ n. (We again assume no zero eigenvalues—which are handledseparately). Show that p + q = n, so the number p of positive λ’s equals thenumber n−q of positive µ’s—which is the law of inertia.37. If C is nonsingular, show that A and CTAC have the same rank. Thus they have thesame number of zero eigenvalues.38. Find by experiment the number of positive, negative, and zero eigenvalues ofwhen the block B (of order 139. Do A and CTAC always satisfy the law of inertia when C is not square?40. In equation (9) with m1 = 1 and m2 = 2, verify that the normal modes are M-41. Find the eigenvalues and eigenvectors of Ax = λMx:42. If the symmetric matrices A and M are indeﬁnite, Ax = λMx might not have realeigenvalues. Construct a 2 by 2 example.43. A group of nonsingular matrices includes AB and A−1 if it includes A and B. “Prod-ucts and inverses stay in the group.” Which of these sets are groups? Positive deﬁnitesymmetric matrices A, orthogonal matrices Q, all exponentials etA of a ﬁxed matrixA, matrices P with positive eigenvalues, matrices D with determinant 1. Invent agroup containing only positive deﬁnite matrices.",pos_def_matrices
"8.2 The Simplex Method3. In Example 3, suppose the cost is 3x + y. With rearrangement, the cost vector isc = (0,1,3,0). Show that r ≥ 0 and, therefore, that corner P is optimal.4. Suppose the cost function in Example 3 is x − y, so that after rearrangement c =(0,−1,1,0) at the corner P. Compute r and decide which column u should enter thebasis. Then compute B−1u and show from its sign that you will never meet anothercorner. We are climbing the y-axis in Figure 8.3, and x−y goes to −∞.5. Again in Example 3, change the cost to x+3y. Verify that the simplex method takesyou from P to Q to R, and that the corner R is optimal.6. Phase I ﬁnds a basic feasible solution to Ax = b (a corner). After changing signsto make b ≥ 0, consider the auxiliary problem of minimizing w1 + w2 + ··· + wm,subject to x ≥ 0, w ≥ 0, Ax + w = b. Whenever Ax = b has a nonnegative solution,the minimum cost in this problem will be zero—with w∗ = 0.(a) Show that, for this new problem, the corner x = 0, w = b is both basic and fea-sible. Therefore its Phase I is already set, and the simplex method can proceedto ﬁnd the optimal pair x∗, w∗. If w∗ = 0, then x∗ is the required corner in the(b) With A = [1 1] and b = [3], write out the auxiliary problem, its Phase I vectorx = 0, w = b, and its optimal vector. Find the corner of the feasible set x1−x2 = 3,x1 ≥ x2 ≥ 0, and draw a picture of this set.7. If we wanted to maximize instead of minimize the cost (with Ax = b and x ≥ 0),what would be the stopping test on r, and what rules would choose the column of Nto make basic and the column of B to make free?8. Minimize 2x1 +x2, subject to x1 +x2 ≥ 4, x1 +3x2 ≥ 12, x1 −x2 ≥ 0, x ≥ 0.9. Verify the inverse in equation (5), and show that BE has Bv = u in its kth column.Then BE is the correct basis matrix for the next stop, E−1B−1 is its inverse, and E−1updates the basis matrix correctly.10. Suppose we want to minimize cx = x1 −x2, subject to(all x1,x2,x3,x4 ≥ 0).Starting from x = (0,0,6,12), should x1 or x2 be increased from its current value ofzero? How far can it be increased until the equations force x3 or x4 down to zero? Atthat point, what is the new x?11. For the matrix P = I − AT(AAT)−1A, show that if x is in the nullspace of A, thenPx = x. The nullspace stays unchanged under this projection.12. (a) Minimize the cost cTx = 5x1 +4x2 +8x3 on the plane x1 +x2 +x3 = 3, by testingthe vertices P, Q, R, where the triangle is cut off by the requirement x ≥ 0.",linear_prog
"2.3 Linear Independence, Basis, and Dimension(b) Those vectors (are)(are not)(might be) linearly independent.(c) Any four of those vectors (are)(are not)(might be) a basis for R4.(d) If those vectors are the columns of A, then Ax = b (has) (does not have) (mightnot have) a solution.23. The columns of A are n vectors from Rm. If they are linearly independent, what isthe rank of A? If they span Rm, what is the rank? If they are a basis for Rm, what24. Find a basis for the plane x−2y+3z = 0 in R3. Then ﬁnd a basis for the intersectionof that plane with the xy-plane. Then ﬁnd a basis for all vectors perpendicular to the25. Suppose the columns of a 5 by 5 matrix A are a basis for R5.(a) The equation Ax = 0 has only the solution x = 0 because(b) If b is in R5 then Ax = b is solvable becauseConclusion: A is invertible. Its rank is 5.26. Suppose S is a ﬁve-dimensional subspace of R6. True or false?(a) Every basis for S can be extended to a basis for R6 by adding one more vector.(b) Every basis for R6 can be reduced to a basis for S by removing one vector.27. U comes from A by subtracting row 1 from row 3:Find bases for the two column spaces. Find bases for the two row spaces. Find basesfor the two nullspace.28. True or false (give a good reason)?(a) If the columns of a matrix are dependent, so are the rows.(b) The column space of a 2 by 2 matrix is the same as its row space.(c) The column space of a 2 by 2 matrix has the same dimension as its row space.(d) The columns of a matrix are a basis for the column space.29. For which numbers c and d do these matrices have rank 2?1 2 5 0 50 0 0 d",vector spaces
"Chapter 6 Positive Deﬁnite MatricesThen CTAC must have one positive and one negative eigenvalue, like A.Example 6. This application is the important one:For any symmetric matrix A, the signs of the pivots agree with the signsof the eigenvalues. The eigenvalue matrix Λ and the pivot matrix D have thesame number of positive entries, negative entries, and zero entries.We will assume that A allows the symmetric factorization A = LDLT (without row ex-changes). By the law of inertia, A has the same number of positive eigenvalues as D.But the eigenvalues of D are just its diagonal entries (the pivots). Thus the number ofpositive pivots matches the number of positive eigenvalues of A.That is both beautiful and practical. It is beautiful because it brings together (forsymmetric matrices) two parts of this book that were previously separate: pivots andeigenvalues. It is also practical, because the pivots can locate the eigenvalues:A has positive pivotsA−2I has a negative pivotA has positive eigenvalues, by our test. But we know that λmin is smaller than 2, becausesubtracting 2 dropped it below zero. The next step looks at A−I, to see if λmin < 1. (Itis, because A−I has a negative pivot.) That interval containing λ is cut in half at everystep by checking the signs of the pivots.This was almost the ﬁrst practical method of computing eigenvalues. It was dominantabout 1960, after one important improvement—to make A tridiagonal ﬁrst. Then thepivots are computed in 2n steps instead of 16n3. Elimination becomes fast, and the searchfor eigenvalues (by halving the intervals) becomes simple. The current favorite is theQR method in Chapter 7.The Generalized Eigenvalue ProblemPhysics, engineering, and statistics are usually kind enough to produce symmetric ma-trices in their eigenvalue problems. But sometimes Ax = λx is replaced by Ax = λMx.There are two matrices rather than one.An example is the motion of two unequal masses in a line of springs:dt2 +2v−w = 0dt2 −v+2w = 0When the masses were equal, m1 = m2 = 1, this was the old system u′′ +Au = 0. Nowit is Mu′′ +Au = 0, with a mass matrix M. The eigenvalue problem arises when we look",pos_def_matrices
"3.10 Which constant function is closest to y = x4 (in the least-squares sense) over theinterval 0 ≤ x ≤ 1?3.11 If Q is orthogonal, is the same true of Q3?3.12 Find all 3 by 3 orthogonal matrices whose entries are zeros and ones.3.13 What multiple of a1 should be subtracted from a2, to make the result orthogonal toa1? Sketch a ﬁgure.into QR, recognizing that the ﬁrst column is already a unit vector.3.15 If every entry in an orthogonal matrix is either 14, how big is the matrix?3.16 Suppose the vectors q1,...,qn are orthonormal. If b = c1q1 + ··· + cnqn, give aformula for the ﬁrst coefﬁcient c1 in terms of b and the q’s.3.17 What words describe the equation ATA�x = ATb, the vector p = A�x = Pb, and thematrix P = A(ATA)−1AT?3.18 If the orthonormal vectors q1 = (23) and q2 = (−13) are the columns ofQ, what are the matrices QTQ and QQT? Show that QQT is a projection matrix(onto the plane of q1 and q2).3.19 If v1,...,vn is an orthonormal basis for Rn, show that v1vT3.20 True or false: If the vectors x and y are orthogonal, and P is a projection, then Pxand Py are orthogonal.3.21 Try to ﬁt a line b =C+Dt through the points b = 0, t = 2, and b = 6, t = 2, and showthat the normal equations break down. Sketch all the optimal lines, minimizing thesum of squares of the two errors.3.22 What point on the plane x+y−z = 0 is closest to b = (2,1,0)?3.23 Find an orthonormal basis for R3 starting with the vector (1,1,1).3.24 CT scanners examine the patient from different directions and produce a matrixgiving the densities of bone and tissue at each point. Mathematically, the problemis to recover a matrix from its projections. in the 2 by 2 case, can you recover thematrix A if you know the sum along each row and down each column?3.25 Can you recover a 3 by 3 matrix if you know its row sums and column sums, andalso the sums down the main diagonal and the four other parallel diagonals?",orthogonality
"Chapter 1 Matrices and Gaussian EliminationOne subscript is enough for a vector. The jth component of x is denoted by x j. (Themultiplication above had x1 = 2, x2 = 5, x3 = 0.) Normally x is written as a columnvector—like an n by 1 matrix. But sometimes it is printed on a line, as in x = (2,5,0).The parentheses and commas emphasize that it is not a 1 by 3 matrix. It is a columnvector, and it is just temporarily lying down.To describe the product Ax, we use the “sigma” symbol Σ for summation:The ith component of Ax isThis sum takes us along the ith row of A. The column index j takes each value from 1to n and we add up the results—the sum is ai1x1 +ai2x2 +···+ainxn.We see again that the length of the rows (the number of columns in A) must matchthe length of x. An m by n matrix multiplies an n-dimensional vector (and producesan m-dimensional vector). Summations are simpler than writing everything out in full,but matrix notation is better. (Einstein used “tensor notation,” in which a repeated indexautomatically means summation. He wrote aijx j or even a ji x j, without the Σ. Not beingEinstein, we keep the Σ.)The Matrix Form of One Elimination StepSo far we have a convenient shorthand Ax = b for the original system of equations.What about the operations that are carried out during elimination? In our example, theﬁrst step subtracted 2 times the ﬁrst equation from the second. On the right-hand side,2 times the ﬁrst component of b was subtracted from the second component. The sameresult is achieved if we multiply b by this elementary matrix (or elimination matrix):This is veriﬁed just by obeying the rule for multiplying a matrix and a vector:The components 5 and 9 stay the same (because of the 1, 0, 0 and 0, 0, 1 in the rows ofE). The new second component −12 appeared after the ﬁrst elimination step.It is easy to describe the matrices like E, which carry out the separate eliminationsteps. We also notice the “identity matrix,” which does nothing at all.The identity matrix I, with 1s on the diagonal and 0s everywhere else,leaves every vector unchanged. The elementary matrix Eij subtracts ℓ times",gauss elim
"2.2 Solving Ax = 0 and Ax = b45. Write all known relations between r and m and n if Ax = b has(a) no solution for some b.(b) inﬁnitely many solutions for every b.(c) exactly one solution for some b, no solution for other b.(d) exactly one solution for every b.46. Apply Gauss-Jordan elimination (right-hand side becomes extra column) to Ux = 0and Ux = c. Reach Rx = 0 and Rx = d:1 2 3 00 0 4 01 2 3 50 0 4 8Solve Rx = 0 to ﬁnd xn (its free variable is x2 = 1). Solve Rx = d to ﬁnd xp (its freevariable is x2 = 0).47. Apply elimination with the extra column to reach Rx = 0 and Rx = d:3 0 6 00 0 2 00 0 0 03 0 6 90 0 2 40 0 0 5Solve Rx = 0 (free variable = 1). What are the solutions to Rx = d?48. Reduce to Ux = c (Gaussian elimination) and then Rx = d:1 0 2 31 3 2 02 0 4 9Find a particular solution xp and all nullspace solutions xn.49. Find A and B with the given property or explain why you can’t.(a) The only solution to Ax =(b) The only solution to Bx =50. The complete solution to Ax =51. The nullspace of a 3 by 4 matrix A is the line through (2,3,1,0).(a) What is the rank of A and the complete solution to Ax = 0?(b) What is the exact row reduced echelon form R of A?",vector spaces
"2.3 Linear Independence, Basis, and Dimension6. Choose three independent columns of U. Then make two other choices. Do the samefor A. You have found bases for which spaces?2 3 4 10 6 7 00 0 0 90 0 0 02 3 4 10 6 7 00 0 0 94 6 8 27. If w1, w2, w3 are independent vectors, show that the differences v1 = w2 −w3, v2 =w1 − w3, and v3 = w1 − w2 are dependent. Find a combination of the v’s that gives8. If w1, w2, w3 are independent vectors, show that the sums v1 = w2+w3, v2 = w1+w3,and v3 = w1 +w2 are independent. (Write c1v1 +c2v2 +c3v3 = 0 in terms of the w’s.Find and solve equations for the c’s.)9. Suppose v1, v2, v3, v4 are vectors in R3.(a) These four vectors are dependent because(b) The two vectors v1 and v2 will be dependent if(c) The vectors v1 and (0,0,0) are dependent because10. Find two independent vectors on the plane x+2y−3z−t = 0 in R4. Then ﬁnd threeindependent vectors. Why not four? This plane is the nullspace of what matrix?Problems 11–18 are about the space spanned by a set of vectors. Take all linearcombinations of the vectors11. Describe the subspace of R3 (is it a line or a plane or R3?) spanned by(a) the two vectors (1,1,−1) and (−1,−1,1).(b) the three vectors (0,1,1) and (1,1,0) and (0,0,0).(c) the columns of a 3 by 5 echelon matrix with 2 pivots.(d) all vectors with positive components.12. The vector b is in the subspace spanned by the columns of A when there is a solution. The vector c is in the row space of A when there is a solution toor false: If the zero vector is in the row space, the rows are dependent.13. Find the dimensions of (a) the column space of A, (b) the column space of U, (c) therow space of A, (d) the row space of U. Which two of the spaces are the same?",vector spaces
"Chapter 6 Positive Deﬁnite Matrices1. For what range of numbers a and b are the matrices A and B positive deﬁnite?2. Decide for or against the positive deﬁniteness of3. Construct an indeﬁnite matrix with its largest entries on the main diagonal:with |b| < 1 can have detA < 0.4. Show from the eigenvalues that if A is positive deﬁnite, so is A2 and so is A−1.5. If A and B are positive deﬁnite, then A+B is positive deﬁnite. Pivots and eigenvaluesare not convenient for A+B. Much better to prove xT(A+B)x > 0.6. From the pivots, eigenvalues, and eigenvectors of A =, write A as RTR in three7. If A = QΛQT is symmetric positive deﬁnite, then R = QΛQT is its symmetric pos-itive deﬁnite square root. Why does R have positive eigenvalues? Compute R andverify R2 = A for8. If A is symmetric positive deﬁnite and C is nonsingular, prove that B = CTAC is also9. If A = RTR prove the generalized Schwarz inequality |xTAy|2 ≤ (xTAx)(yTAy).10. The ellipse u2 +4v2 = 1 corresponds to A =. Write the eigenvalues and eigen-vectors, and sketch the ellipse.11. Reduce the equation 3u2 − 22uv + 2v2 = 1 to a sum of squares by ﬁnding theeigenvalues of the corresponding A, and sketch the ellipse.",pos_def_matrices
"2.5 Graphs and Networks7. If that second graph represents six games between four teams, and the score dif-ferences are b1,...,b6, when is it possible to assign potentials x1,...,x4 so that thepotential differences agree with the b’s? You are ﬁnding (from Kirchhoff or fromelimination) the conditions that make Ax = b solvable.8. Write down the dimensions of the four fundamental subspaces for this 6 by 4 inci-dence matrix, and a basis for each subspace.9. Compute ATA and ATCA, where the 6 by 6 diagonal matrix C has entries c1,...,c6.How can you tell from the graph where the c’s will appear on the main diagonal of10. Draw a graph with numbered and directed edges (and numbered nodes) whose inci-Is this graph a tree? (Are the rows of A independent?) Show that removing the lastedge produces a spanning tree. Then the remaining rows are a basis for11. With the last column removed from the preceding A, and with the numbers 1. 2, 2, 1on the diagonal of C, write out the 7 by 7 systemC−1y + Ax =Eliminating y1, y2, y3, y4 leaves three equations ATCAx = −f for x1, x2, x3. Solvethe equations when f = (1,1,6). With those currents entering nodes 1, 2, 3 of thenetwork, what are the potentials at the nodes and currents on the edges?12. If A is a 12 by 7 incidence matrix from a connected graph, what is its rank? Howmany free variables are there in the solution to Ax = b? How many free variablesare there in the solution to ATy = f? How many edges must be removed to leave a13. In the graph above with 4 nodes and 6 edges, ﬁnd all 16 spanning trees.14. If MIT beats Harvard 35-0, Yale ties Harvard, and Princeton beats Yale 7-6, whatscore differences in the other 3 games (H-P MIT-P, MIT-Y) will allow potential dif-ferences that agree with the score differences? If the score differences are known forthe games in a spanning tree, they are known for all games.15. In our method for football rankings, should the strength of the opposition be consid-ered — or is that already built in?",vector spaces
"1.2 The Geometry of Linear EquationsThe problem is to ﬁnd the combination of the column vectors on the left side thatproduces the vector on the right side. Those vectors (2,1) and (−1,1) are representedby the bold lines in Figure 1.2b. The unknowns are the numbers x and y that multiplythe column vectors. The whole idea can be seen in that ﬁgure, where 2 times column1 is added to 3 times column 2. Geometrically this produces a famous parallelogram.Algebraically it produces the correct vector (1,5), on the right side of our equations.The column picture conﬁrms that x = 2 and y = 3.More time could be spent on that example, but I would rather move forward to n = 3.Three equations are still manageable, and they have much more variety:−2u + 7v + 2w =Again we can study the rows or the columns, and we start with the rows. Each equationdescribes a plane in three dimensions. The ﬁrst plane is 2u+v+w = 5, and it is sketchedin Figure 1.3. It contains the points (52,0,0) and (0,5,0) and (0,0,5). It is determinedby any three of its points—provided they do not lie on a line.b(1, 1, 2) = point of intersectionwith third plane = solution4u − 6v = −2 (vertical plane)line of intersection: ﬁrst two planes2u + v + w = 5 (sloping plane)Figure 1.3: The row picture: three intersecting planes from three linear equations.Changing 5 to 10, the plane 2u+v+w = 10 would be parallel to this one. It contains(5,0,0) and (0,10,0) and (0,0,10), twice as far from the origin—which is the centerpoint u = 0, v = 0, w = 0. Changing the right side moves the plane parallel to itself, andthe plane 2u+v+w = 0 goes through the origin.",gauss elim
"3.2 Cosines and Projections onto Lines18. Draw the projection of b onto a and also compute it from p = �xa:19. In Problem 17, ﬁnd the projection matrix P = aaT/aTa onto the line through eachvector a. Verify in both cases that P2 = P. Multiply Pb in each case to compute the20. Construct the projection matrices P1 and P2 onto the lines through the a’s in Problem18. Is it true that (P1 +P2)2 = P1 +P2? This would be true if P1P2 = 0.For Problems 21–26, consult the accompanying ﬁgures.21. Compute the projection matrices aaT/aTa onto the lines through a1 = (−1,2,2) anda2 = (2,2,−1), Multiply those projection matrices and explain why their productP1P2 is what it is.22. Project b = (1,0,0) onto the lines through a1 and a2 in Problem 21 and also ontoa3 = (2,−1,2). Add the three projections p1 + p2 + p3.23. Continuing Problems 21–22, ﬁnd the projection matrix P3 onto a3 = (2,−1,2). Ver-ify that P1 +P2 +P3 = I. The basis a1, a2, a3 is orthogonal!24. Project the vector b = (1,1) onto the lines through a1 = (1,0) and a2 = (1,2). Drawthe projections p1 and p2 and add p1 + p2. The projections do not add to b becausethe a’s are not orthogonal.25. In Problem 24, the projection of b onto the plane of a1 and a2 will equal b. FindP = A(ATA)−1AT for A = [a1 a2]",orthogonality
"Chapter 1 Matrices and Gaussian EliminationOne Linear System = Two Triangular SystemsThere is a serious practical point about A = LU. It is more than just a record of elimi-nation steps; L and U are the right matrices to solve Ax = b. In fact A could be thrownaway! We go from b to c by forward elimination (this uses L) and we go from c to x byback-substitution (that uses U). We can and should do it without A:Splitting of Ax = bMultiply the second equation by L to give LUx = Lc, which is Ax = b. Each triangularsystem is quickly solved. That is exactly what a good elimination code will do:1. Factor (from A ﬁnd its factors L and U).2. Solve (from L and U and b ﬁnd the solution x).The separation into Factor and Solve means that a series of b’s can be processed. TheSolve subroutine obeys equation (8): two triangular systems in n2/2 steps each. Thesolution for any new right-hand side b can be found in only n2 operations. That isfar below the n3/3 steps needed to factor A on the left-hand side.Example 6. This is the previous matrix A with a right-hand side b = (1,1,1,1).splits into Lc = b and Ux = c.For these special “tridiagonal matrices,” the operation count drops from n2 to 2n. Yousee how Lc = b is solved forward (c1 comes before c2). This is precisely what happensduring forward elimination. Then Ux = c is solved backward (x4 before x3).Remark 1. The LU form is “unsymmetric” on the diagonal: L has 1s where U has the",gauss elim
"Chapter 7 Computations with Matricesbeyond symmetry, as we certainly want to do, there will have to be a major change. Thisis easy to see for the very unsymmetric matricesThe eigenvalues all equal one, but the proper condition number is not λmax/λmin = 1.The relative change in x is not bounded by the relative change in b. CompareA 1% change in b has produced a hundredfold change in x; the ampliﬁcation factor is1002. Since c represents an upper bound, the condition number must be at least 10,000.The difﬁculty here is that a large off-diagonal entry in A means an equally large entry inA−1. Expecting A−1 to get smaller as A gets bigger is often wrong.For a proper deﬁnition of the condition number, we look back at equation (3). Wewere trying to make x small and b = Ax large. When A is not symmetric, the maximum of∥Ax∥/∥x∥ may be found at a vector x that is not one of the eigenvectors. This maximumis an excellent measure of the size of A. It is the norm of A.The norm of A is the number ∥A∥ deﬁned byIn other words, ∥A∥ bounds the “amplifying power” of the matrix:for all vectors x.The matrices A and A−1 in equation (4) have norms somewhere between 100 and 101.They can be calculated exactly, but ﬁrst we want to complete the connection betweennorms and condition numbers. Because b = Ax and δx = A−1δb, equation (6) givesThis is the replacement for equation (3), when A is not symmetric. In the symmetric case,∥A∥ is the same as λmax, and ∥A−1∥ is the same as 1/λmin. The correct replacement forλmax/λmin is the product ∥A∥∥A−1∥—which is the condition number.The condition number of A is c = ∥A∥∥A−1∥. The relative error satisﬁesdirectly from equation (7).If we perturb the matrix A instead of the right-hand side b, thenfrom equation (10) below.",computations
"Determinants are much further from the center of linear algebra than they were a hundredyears ago. Mathematics keeps changing direction! After all, a single number can tellonly so much about a matrix. Still, it is amazing how much this number can do.One viewpoint is this: The determinant provides an explicit “formula” for each entryof A−1 and A−1b. This formula will not change the way we compute; even the deter-minant itself is found by elimination. In fact, elimination can be regarded as the mostefﬁcient way to substitute the entries of an n by n matrix into the formula. What theformula does is to show how A−1 depends on the n2 entries of A, and how it varies whenWe can list four of the main uses of determinants:1. They test for invertibility. If the determinant of A is zero, then A is singular. IfdetA ̸= 0, then A is invertible (and A−1 involves 1/detA).The most important application, and the reason this chapter is essential to the book,is to the family of matrices A − λI. The parameter λ is subtracted all along the maindiagonal, and the problem is to ﬁnd the eigenvalues for which A − λI is singular. Thetest is det(A−λI) = 0. This polynomial of degree n in λ has exactly n roots. The matrixhas n eigenvalues, This is a fact that follows from the determinant formula, and not from2. The determinant of A equals the volume of a box in n-dimensional space. The edgesof the box come from the rows of A (Figure 4.1). The columns of A would give anentirely different box with the same volume.The simplest box is a little cube dV = dxdydz, as in��� f(x,y,z)dV. Suppose wechange to cylindrical coordinates by x = rcosθ, y = rsinθ, z = z. Just as a small inter-val dx is stretched to (dx/du)du—when u replaces x in a single integral—so the volumeelement becomes J drdθ dz. The Jacobian determinant is the three-dimensional ana-",determinants
"4.4 Applications of Determinants2. The Solution of Ax = b.The multiplication x = A−1b is just CTb divided bydetA.There is a famous way in which to write the answer (x1,...,xn):Cramer’s rule: The jth component of x = A−1b is the ratiox j = detB j�� has b in column j.Proof. Expand detB j in cofactors of its jth column (which is b). Since the cofactorsignore that column, detB j is exactly the jth component in the product CTb:detB j = b1C1 j +b2C2j +···+bnCnj.Dividing this by detA gives x j. Each component of x is a ratio of two determinants. Thatfact might have been recognized from Gaussian elimination, but it never was.Example 2. The solution ofhas 0 and 6 in the ﬁrst column for x1 and in the second column for x2:The denominators are always detA. For 1000 equations Cramer’s Rule would need 1001determinants. To my dismay I found in a book called Mathematics for the Millions thatCramer’s Rule was actually recommended (and elimination was thrown aside):To deal with a set involving the four variables u, v, w, z, we ﬁrst have toeliminate one of them in each of three pairs to derive three equations in threevariables and then proceed as for the three-fold left-hand set to derive valuesfor two of them. The reader who does so as an exercise will begin to realizehow formidably laborious the method of elimination becomes, when we haveto deal with more than three variables. This consideration invites us to explorethe possibility of a speedier method...3. The Volume of a Box. The connection between the determinant and the volume isclearest when all angles are right angles—the edges are perpendicular, and the box isrectangular. Then the volume is the product of the edge lengths: volume = ℓ1ℓ2···ℓn.",determinants
"Chapter 2 Vector SpacesYou must notice that the word “dimensional” is used in two different ways. We speakabout a four-dimensional vector, meaning a vector in R4. Now we have deﬁned a four-dimensional subspace; an example is the set of vectors in R6 whose ﬁrst and last com-ponents are zero. The members of this four-dimensional subspace are six-dimensionalOne ﬁnal note about the language of linear algebra. We never use the terms “basis of amatrix” or “rank of a space” or “dimension of a basis.” These phrases have no meaning.It is the dimension of the column space that equals the rank of the matrix, as we provein the coming section.Problems 1–10 are about linear independence and linear dependence.1. Show that v1, v2, v3 are independent but v1, v2, v3, v4 are dependent:Solve c1v1 +···+c4v4 = 0 or Ac = 0. The v’s go in the columns of A.2. Find the largest possible number of independent vectors amongThis number is theof the space spanned by the v’s.3. Prove that if a = 0, d = 0, or f = 0 (3 cases), the columns of U are dependent:4. If a, d, f in Problem 3 are all nonzero, show that the only solution to Ux = 0 is x = 0.Then U has independent columns.5. Decide the dependence or independence of(a) the vectors (1,3,2), (2,1,3), and (3.2,1).(b) the vectors (1,−3,2), (2,1,−3), and (−3,2,1).",vector spaces
"Chapter 1 Matrices and Gaussian Elimination23. For the systemu + 3v + 3w =u + 3v + 5w = 2,what is the triangular system after forward elimination, and what is the solution?24. Solve the system and ﬁnd the pivots when−u + 2v −+ 2z = 5.You may carry the right-hand side as a ﬁfth column (and omit writing u, v, w, z untilthe solution at the end).25. Apply elimination to the system3u + 3v − w =+ w = −1.When a zero arises in the pivot position, exchange that equation for the one below itand proceed. What coefﬁcient of v in the third equation, in place of the present −1,would make it impossible to proceed—and force elimination to break down?26. Solve by elimination the system of two equations3x + 6y = 18.Draw a graph representing each equation as a straight line in the x-y plane; the linesintersect at the solution. Also, add one more line—the graph of the new secondequation which arises after elimination.27. Find three values of a for which elimination breaks down, temporarily or perma-4u + av = 2.Breakdown at the ﬁrst step can be ﬁxed by exchanging rows—but not breakdown at28. True or false:(a) If the third equation starts with a zero coefﬁcient (it begins with 0u) then nomultiple of equation 1 will be subtracted from equation 3.",gauss elim
"Figure 3.8: Projection onto the column space of a 3 by 2 matrix.2. The error vector must be perpendicular to each column a1,...,an of A:This is again AT(b − A�x) = 0 and ATA�x = ATb, The calculus way is to take partialderivatives of E2 = (Ax − b)T(Ax − b). That gives the same 2ATAx − 2ATb = 0. Thefastest way is just to multiply the unsolvable equation Ax = b by AT. All these equivalentmethods produce a square coefﬁcient matrix ATA. It is symmetric (its transpose is notAAT!) and it is the fundamental matrix of this chapter.The equations ATA�x = ATb are known in statistics as the normal equations.When Ax = b is inconsistent, its least-squares solution minimizes ∥Ax −ATA is invertible exactly when the columns of A are linearly independent!The projection of b onto the column space is the nearest point A�x:p = A�x = A(ATA)−1ATb.We choose an example in which our intuition is as good as the formulas:gives the best x.",orthogonality
"Chapter 5 Eigenvalues and EigenvectorsSymmetric and Hermitian matrices are certainly normal: If A = AH, then AAH andAHA both equal A2. Orthogonal and unitary matrices are also normal: UUH and UHUboth equal I. Two steps will work for any normal matrix:1. If N is normal, then so is the triangular T = U−1NU:TT H = U−1NUUHNHU = U−1NNHU = U−1NHNU = UHNHUU−1NU = T HT.2. A triangular T that is normal must be diagonal! (See Problems 19–20 at the end ofThus, if N is normal, the triangular T =U−1NU must be diagonal. Since T has the sameeigenvalues as N, it must be Λ. The eigenvectors of N are the columns of U, and theyare orthonormal. That is the good case. We turn now from the best possible matrices(normal) to the worst possible (defective).This section has done its best while requiring M to be a unitary matrix U. We gotM−1AM into a triangular form T. Now we lift this restriction on M. Any matrix isallowed, and the goal is to make M−1AM as nearly diagonal as possible.The result of this supreme effort at diagonalization is the Jordan form J. If A has a fullset of eigenvectors, we take M = S and arrive at J = S−1AS = Λ. Then the Jordan formcoincides with the diagonal Λ. This is impossible for a defective (nondiagonalizable)matrix. For every missing eigenvector, the Jordan form will have a 1 just above its maindiagonal. The eigenvalues appear on the diagonal because J is triangular. And distincteigenvalues can always be decoupled.It is only a repeated λ that may (or may not!) require an off-diagonal 1 in J.5U If A has s independent eigenvectors, it is similar to a matrix with s blocks:J = M−1AM =Each Jordan block Ji is a triangular matrix that has only a single eigenvalue λiand only one eigenvector:",eigenvec_val
"Chapter 5 Eigenvalues and EigenvectorsYou see the pattern: Every Fibonacci number is the sum of the two previous F’s:Fk+2 = Fk+1 +Fk.That is the difference equation. It turns up in a most fantastic variety of applications,and deserves a book of its own. Leaves grow in a spiral pattern, and on the apple or oakyou ﬁnd ﬁve growths for every two turns around the stem. The pear tree has eight forevery three turns, and the willow is 13:5. The champion seems to be a sunﬂower whoseseeds chose an almost unbelievable ratio of F12/F13 = 144/233.2How could we ﬁnd the 1000th Fibonacci number, without starting at F0 = 0 andF1 = 1, and working all the way out to F1000? The goal is to solve the difference equationFk+2 = Fk+1 +Fk. This can be reduced to a one-step equation uk+1 = Auk. Every stepmultiplies uk = (Fk+1,Fk) by a matrix A:Fk+2 = Fk+1 +FkThe one-step system uk+1 = Auk is easy to solve, It starts from u0. After one step itproduces u1 = Au0. Then u2 is Au1, which is A2u0. Every step brings a multiplicationby A, and after k steps there are k multiplications:The solution to a difference equation uk+1 = Auk is uk = Aku0.The real problem is to ﬁnd some quick way to compute the powers Ak, and thereby ﬁndthe 1000th Fibonacci number. The key lies in the eigenvalues and eigenvectors:If A can be diagonalized, A = SΛS−1, then Ak comes from Λk:uk = Aku0 = (SΛS−1)(SΛS−1)···(SΛS−1)u0 = SΛkS−1u0.The columns of S are the eigenvectors of A. Writing S−1u0 = c, the solutionuk = SΛkc =�� = c1λ kAfter k steps, uk is a combination of the n “pure solutions” λ kx.These formulas give two different approaches to the same solution uk = SΛkS−1u0.The ﬁrst formula recognized that Ak is identical with SΛkS−1, and we could stop there.2For these botanical applications, see D’Arcy Thompson’s book On Growth and Form (Cambridge UniversityPress, 1942) or Peter Stevens’s beautiful Patterns in Nature (Little, Brown, 1974). Hundreds of other propertiesof the Fn have been published in the Fibonacci Quarterly. Apparently Fibonacci brought Arabic numerals intoEurope, about 1200 A.D.",eigenvec_val
"15. If every row of A adds to zero, prove that detA = 0. If every row adds to 1, provethat det(A−I) = 0. Show by example that this does not imply detA = 1.16. Find these 4 by 4 determinants by Gaussian elimination:11 12 13 1421 22 23 2431 32 33 3441 42 43 4417. Find the determinants ofFor which values of λ is A−λI a singular matrix?18. Evaluate detA by reducing the matrix to triangular form (rules 5 and 7).What are the determinants of B, C, AB, ATA, and CT?19. Suppose that CD = −DC, and ﬁnd the ﬂaw in the following argument: Taking de-terminants gives (detC)(detD) = −(detD)(detC), so either detC = 0 or detD = 0.Thus CD = −DC is only possible if C or D is singular.20. Do these matrices have determinant 0, 1, 2, or 3?21. The inverse of a 2 by 2 matrix seems to have determinant = 1:ad −bc = 1.What is wrong with this calculation? What is the correct detA−1?Problems 22–28 use the rules to compute speciﬁc determinants.22. Reduce A to U and ﬁnd detA = product of the pivots:",determinants
"2.5 Graphs and NetworksI am not entirely happy with the 3 by 4 matrix in the previous section. From a theoreticalpoint of view it was very satisfactory; the four subspaces were computable and theirdimensions r, n − r, r, m − r were nonzero. But the example was not produced by agenuine application. It did not show how fundamental those subspaces really are.This section introduces a class of rectangular matrices with two advantages. Theyare simple, and they are important. They are incidence matrices of graphs, and everyentry is 1, −1, or 0. What is remarkable is that the same is true of L and U and basisvectors for all four subspaces. Those subspaces play a central role in network theory.We emphasize that the word “graph” does not refer to the graph of a function (like aparabola for y = x2). There is a second meaning, completely different, which is closer tocomputer science than to calculus—and it is easy to explain. This section is optional, butit gives a chance to see rectangular matrices in action—and how the square symmetricmatrix ATA turns up in the end.A graph consists of a set of vertices or nodes, and a set of edges that connect them.The graph in Figure 2.6 has 4 nodes and 5 edges. It does not have an edge betweennodes 1 and 4 (and edges from a node to itself are forbidden). This graph is directed,because of the arrow in each edge.The edgenode incidence matrix is 5 by 4, with a row for every edge. If the edge goesfrom node j to node k, then that row has −1 in column j and +1 in column k. Theincidence matrix A is shown next to the graph (and you could recover the graph if youonly had A). Row 1 shows the edge from node 1 to node 2. Row 5 comes from the ﬁfthedge, from node 3 to node 4.Figure 2.6: A directed graph (5 edges, 4 nodes, 2 loops) and its incidence matrix A.Notice the columns of A. Column 3 gives information about node 3—it tells whichedges enter and leave. Edges 2 and 3 go in, edge 5 goes out (with the minus sign). A issometimes called the connectivity matrix, or the topology matrix. When the graph has medges and n nodes, A is m by n (and normally m > n). Its transpose is the “node-edge”Each of the four fundamental subspaces has a meaning in terms of the graph. We cando linear algebra, or write about voltages and currents. We do both!",vector spaces
"1.5 Triangular Factors and Row Exchanges31. Tridiagonal matrices have zero entries except on the main diagonal and the twoadjacent diagonals. Factor these into A = LU and A = LDV:32. Solve the triangular system Lc = b to ﬁnd c. Then solve Ux = c to ﬁnd x:For safety ﬁnd A = LU and solve Ax = b as usual. Circle c when you see it.33. Solve Lc = b to ﬁnd c. Then solve Ux = c to ﬁnd x. What was A?34. If A and B have nonzeros in the positions marked by x, which zeros are still zero intheir factors L and U?0 x x x0 0 x x35. (Important) If A has pivots 2, 7, 6 with no row exchanges, what are the pivots for theupper left 2 by 2 submatrix B (without row 3 and column 3)? Explain why.36. Starting from a 3 by 3 matrix A with pivots 2, 7, 6, add a fourth row and column toproduce M. What are the ﬁrst three pivots for M, and why? What fourth row andcolumn are sure to produce 9 as the fourth pivot?37. Use chol(pascal(5)) to ﬁnd the triangular factors of MATLAB’s pascal(5). Rowexchanges in [L, U] = lu(pascal(5)) spoil Pascal’s pattern!38. (Review) For which numbers c is A = LU impossible—with three pivots?39. Estimate the time difference for each new right-hand side b when n = 800. Create A= rand(800) and b = rand(800,1) and B = rand(800,9). Compare the times fromtic; A\b; toc and tic; A\B; toc (which solves for 9 right sides).Problems 40–48 are about permutation matrices.",gauss elim
"3.3 Projections and Least Squares20. If P is the projection onto the column space of A, what is the projection onto the left21. Suppose L1 is the line through the origin in the direction of a1 and L2 is the linethrough b in the direction of a2. To ﬁnd the closest points x1a1 and b + x2a2 on thetwo lines, write the two equations for the x1 and x2 that minimize ∥x1a1 −x2a2 −b∥.Solve for x if a1 = (1,1,0), a2 = (0,1,0), b = (2,1,4).22. Find the best line C +Dt to ﬁt b = 4,2,−1,0,0 at times t = −2,−1,0,1,2.23. Show that the best least-squares ﬁt to a set of measurements y1,...,ym by a horizontalline (a constant function y = C) is their averageC = y1 +···+ym24. Find the best straight-line ﬁt to the following measurements, and sketch your solu-25. Suppose that instead of a straight line, we ﬁt the data in Problem 24 by a parabola:y = C +Dt +Et2. In the inconsistent system Ax = b that comes from the four mea-surements, what are the coefﬁcient matrix A, the unknown vector x, and the datavector b? You need not compute �x.26. A Middle-Aged man was stretched on a rack to lengths L = 5, 6, and 7 feet underapplied forces of F = 1, 2, and 4 tons. Assuming Hooke’s law L = a+bF, ﬁnd hisnormal length a by least squares.Problems 27–31 introduce basic ideas of statistics—the foundation for least27. (Recommended) This problem projects b = (b1,...,bm) onto the line through a =(1,...,1). We solve m equations ax = b in 1 unknown (by least squares).(a) Solve aTa�x = aTb to show that is the mean (the average) of the b’s,(b) Find e = b−a�x, the variance ∥e∥2, and the standard deviation ∥e∥.(c) The horizontal line �b = 3 is closest to b = (1,2,6), Check that p = (3,3,3) isperpendicular to e and ﬁnd the projection matrix P.28. First assumption behind least squares: Each measurement error has mean zero. Mul-tiply the 8 error vectors b − Ax = (±1,±1,±1) by (ATA)−1AT to show that the 8vectors �x−x also average to zero. The estimate �x is unbiased.",orthogonality
"One aim of this book is to explain the useful parts of matrix theory. In comparisonwith older texts in abstract linear algebra, the underlying theory has not been radicallychanged. One of the best things about the subject is that the theory is really essentialfor the applications. What is different is the change in emphasis which comes with anew point of view. Elimination becomes more than just a way to ﬁnd a basis for therow space, and the Gram-Schmidt process is not just a proof that every subspace has anorthonormal basis. Instead, we really need these algorithms. And we need a convenientdescription, A = LU or A = QR, of what they do.This chapter will take a few more steps in the same direction. I suppose these steps aregoverned by computational necessity, rather than by elegance, and I don’t know whetherto apologize for that; it makes them sound very superﬁcial, and that is wrong. They dealwith the oldest and most fundamental problems of the subject, Ax = b and Ax = λx, butthey are continually changing and improving. In numerical analysis there is a survivalof the ﬁttest, and we want to describe some ideas that have survived so far. They fall1. Techniques for Solving Ax = b.Elimination is a perfect algorithm, exceptwhen the particular problem has special properties—as almost every problem has. Sec-tion 7.4 will concentrate on the property of sparseness, when most of the entries in Aare zero. We develop iterative rather than direct methods for solving Ax = b. An iter-ative method is “self-correcting,” and never reaches the exact answer. The object is toget close more quickly than elimination. In some problems, that can be done; in manyothers, elimination is safer and faster if it takes advantage of the zeros. The competitionis far from over, and we will identify the spectral radius that controls the speed of con-vergence to x = A−1b.2. Techniques for Solving Ax = λx.The eigenvalue problem is one of the out-",computations
"Chapter 2 Vector Spaces(b) The ﬁrst 3 rows of U are a basis for the row space of A—true or false?Columns 1, 3, 6 of U are a basis for the column space of A—true or false?The four rows of A are a basis for the row space of A—true or false?(c) Find as many linearly independent vectors b as possible for which Ax = b has a(d) In elimination on A, what multiple of the third row is subtracted to knock out1.12 If A is an n by n − 1 matrix, and its rank is n − 2, what is the dimension of its1.13 Use elimination to ﬁnd the triangular factors in A = LU, ifa a a aa b b ba b c dUnder what conditions on the numbers a, b, c, d are the columns linearly indepen-1.14 Do the vectors (1,1,3), (2,3,6), and (1,4,3) form a basis for R3?1.15 What do you know about C(A) when the number of solutions to Ax = b is(a) 0 or 1, depending on b.(b) ∞, independent of b.(c) 0 or ∞, depending on b.(d) 1, regardless of b.1.16 In the previous exercise, how is r related to m and n in each example?1.17 If x is a vector in Rn, and xTy = 0 for every y, prove that x = 0.1.18 If A is an n by n matrix such that A2 = A and rankA = n, prove that A = I.1.19 What subspace of 3 by 3 matrices is spanned by the elementary matrices Eij, with1s on the diagonal and at most one nonzero entry below?1.20 How many 5 by 5 permutation matrices are there? Are they linearly independent?Do they span the space of all 5 by 5 matrices? No need to write them all down.1.21 What is the rank of the n by n matrix with every entry equal to 1? How about the“checkerboard matrix,” with aij = 0 when i+ j is even, aij = 1 when i+ j is odd?",vector spaces
"3.4 Orthogonal Bases and Gram-Schmidtis actually too big when there is no control on the size of components v j. A much betteridea is to keep the familiar deﬁnition of length, using a sum of squares, and to includeonly those vectors that have a ﬁnite length:The inﬁnite series must converge to a ﬁnite sum. This leaves (1, 13,...) but not (1,1,1,...).Vectors with ﬁnite length can be added (∥v+w∥ ≤ ∥v∥+∥w∥) and multiplied by scalars,so they form a vector space. It is the celebrated Hilbert space.Hilbert space is the natural way to let the number of dimensions become inﬁnite,and at the same time to keep the geometry of ordinary Euclidean space. Ellipses becomeinﬁnite-dimensional ellipsoids, and perpendicular lines are recognized exactly as before.The vectors v and w are orthogonal when their inner product is zero:vTw = v1w1 +v2w2 +v3w3 +··· = 0.This sum is guaranteed to converge, and for any two vectors it still obeys the Schwarzinequality |vTw| ≤ ∥v∥∥w∥. The cosine, even in Hilbert space, is never larger than 1.There is another remarkable thing about this space: It is found under a great manydifferent disguises. Its “vectors” can turn into functions, which is the second point.2. Lengths and Inner Products. Suppose f(x) = sinx on the interval 0 ≤ x ≤ 2π. Thisf is like a vector with a whole continuum of components, the values of sinx along thewhole interval. To ﬁnd the length of such a vector, the usual rule of adding the squaresof the components becomes impossible. This summation is replaced, in a natural andinevitable way, by integration:Length ∥ f∥ of functionOur Hilbert space has become a function space. The vectors are functions, we have away to measure their length, and the space contains all those functions that have a ﬁnitelength—just as in equation (16). It does not contain the function F(x) = 1/x, becausethe integral of 1/x2 is inﬁnite.The same idea of replacing summation by integration produces the inner product oftwo functions: If f(x) = sinx and g(x) = cosx, then their inner product isThis is exactly like the vector inner product f Tg. It is still related to the length by(f, f) = ∥ f∥2. The Schwarz inequality is still satisﬁed: |(f,g)| ≤ ∥ f∥∥g∥. Of course,two functions like sinx and cosx—whose inner product is zero—will be called orthogo-nal. They are even orthonormal after division by their length √π.",orthogonality
"The overall projection matrix isProjection onto a plane = sum of projections onto orthonormal q1 and q2.Example 4. When the measurement times average to zero, ﬁtting a straight line leads toorthogonal columns. Take t1 = −3, t2 = 0, and t3 = 3. Then the attempt to ﬁt y = C+Dtleads to three equations in two unknowns:The columns (1,1,1) and (−3,0,3) are orthogonal. We can project y separately ontoeach column, and the best coefﬁcients �C and �D can be found separately:Notice that �C = (y1 + y2 + y3)/3 is the mean of the data.�C gives the best ﬁt by ahorizontal line, whereas �Dt is the best ﬁt by a straight line through the origin. Thecolumns are orthogonal, so the sum of these two separate pieces is the best ﬁt by anystraight line whatsoever. The columns are not unit vectors, so �C and �D have the lengthsquared in the denominator.Orthogonal columns are so much better that it is worth changing to that case. if theaverage of the observation times is not zero—it is ¯t = (t1 + ··· +tm)/m—then the timeorigin can be shifted by ¯t. Instead of y = C+Dt we work with y = c+d(t − ¯t). The bestline is the same! As in the example, we ﬁnd(t1 − ¯t) ···(t1 − ¯t)2 +···+(tm − ¯t)2= ∑(ti − ¯t)yi∑(ti − ¯t)2 .The best �c is the mean, and we also get a convenient formula for �d. The earlier ATAhad the off-diagonal entries ∑ti, and shifting the time by ¯t made these entries zero. Thisshift is an example of the Gram-Schmidt process, which orthogonalizes the situation inOrthogonal matrices are crucial to numerical linear algebra, because they introduceno instability. While lengths stay the same, roundoff is under control. Orthogonalizingvectors has become an essential technique. Probably it comes second only to elimina-tion. And it leads to a factorization A = QR that is nearly as famous as A = LU.",orthogonality
"Chapter 2 Vector Spaces52. Reduce these matrices A and B to their ordinary echelon forms U:1 2 2 4 61 2 3 6 90 0 1 2 3Find a special solution for each free variable and describe every solution to Ax = 0and Bx = 0. Reduce the echelon forms U to R, and draw a box around the identitymatrix in the pivot rows and pivot columns.53. True or False? (Give reason if true, or counterexample to show it is false.)(a) A square matrix has no free variables.(b) An invertible matrix has no free variables.(c) An m by n matrix has no more than n pivot variables.(d) An m by n matrix has no more than m pivot variables.54. Is there a 3 by 3 matrix with no zero entries for which U = R = I?55. Put as many 1s as possible in a 4 by 7 echelon matrix U and in a reduced form Rwhose pivot columns are 2, 4, 5.56. Suppose column 4 of a 3 by 5 matrix is all 0s. Then x4 is certainly aThe special solution for this variable is the vector x =57. Suppose the ﬁrst and last columns of a 3 by 5 matrix are the same (nonzero). Thenis a free variable. Find the special solution for this variable.58. The equation x − 3y − z = 0 determines a plane in R3. What is the matrix A in thisequation? Which are the free variables? The special solutions are (3,1,0) andThe parallel plane x−3y−z = 12 contains the particular point (12,0,0). All pointson this plane have the following form (ﬁll in the ﬁrst components):59. Suppose column 1 + column 3 + column 5 = 0 in a 4 by 5 matrix with four pivots.Which column is sure to have no pivot (and which variable is free)? What is thespecial solution? What is the nullspace?Problems 60–66 ask for matrices (if possible) with speciﬁc properties.60. Construct a matrix whose nullspace consists of all combinations of (2,2,1,0) and61. Construct a matrix whose nullspace consists of all multiples of (4,3,2,1).",vector spaces
"Chapter 2 Vector SpacesThis law applies equally to AT, which has m columns. AT is just as good a matrix as A.But the dimension of its column space is also r, soThe left nullspace N(AT) has dimension m−r.The m−r solutions to yTA = 0 are hiding somewhere in elimination. The rows of Acombine to produce the m−r zero rows of U. Start from PA = LU, or L−1PA = U. Thelast m−r rows of the invertible matrix L−1P must be a basis of y’s in the left nullspace—because they multiply A to give the zero rows in U.In our 3 by 4 example, the zero row was row 3 − 2(row 2) + 5(row 1). Thereforethe components of y are 5, −2, 1. This is the same combination as in b3 −2b2 +5b1 onthe right-hand side, leading to 0 = 0 as the ﬁnal equation. That vector y is a basis forthe left nullspace, which has dimension m − r = 3 − 2 = 1. It is the last row of L−1P,and produces the zero row in U—and we can often see it without computing L−1. Whendesperate, it is always possible just to solve ATy = 0.I realize that so far in this book we have given no reason to care about N(AT). It iscorrect but not convincing if I write in italics that the left nullspace is also important. Thenext section does better by ﬁnding a physical meaning for y from Kirchhoff’s CurrentNow we know the dimensions of the four spaces. We can summarize them in a table,and it even seems fair to advertise them as theFundamental Theorem of Linear Algebra, Part I1. C(A) = column space of A; dimension r.2. N(A) = nullspace of A; dimension n−r.3. C(AT) = row space of A; dimension r.4. N(AT) = left nullspace of A; dimension m−r.Example 1. A =has m = n = 2, and rank r = 1.1. The column space contains all multiples of. The second column is in the samedirection and contributes nothing new.2. The nullspace contains all multiples of. This vector satisﬁes Ax = 0.3. The row space contains all multiples of. I write it as a column vector, sincestrictly speaking it is in the column space of AT.4. The left nullspace contains all multiples of y =. The rows of A with coefﬁ-cients −3 and 1 add to zero, so ATy = 0.",vector spaces
"6.3 Singular Value Decompositionthat A must have independent columns.) In the reverse order A = S′Q, the matrix S′ isthe symmetric positive deﬁnite square root of AAT.4. Least Squares For a rectangular system Ax = b. the least-squares solution comesfrom the normal equations ATA�x = ATb. If A has dependent columns then ATA is notinvertible and �x is not determined. Any vector in the nullspace could be added to �x. Wecan now complete Chapter 3, by choosing a “best” (shortest) �x for every Ax = b.Ax = b has two possible difﬁculties: Dependent rows or dependent columns. Withdependent rows, Ax = b may have no solution. That happens when b is outside thecolumn space of A. Instead of Ax = b. we solve ATA�x = ATb. But if A has dependentcolumns, this �x will not be unique. We have to choose a particular solution of ATA�x =ATb, and we choose the shortest.The optimal solution of Ax = b is the minimum length solution of ATA�x = ATb.That minimum length solution will be called x+. It is our preferred choice as the bestsolution to Ax = b (which had no solution), and also to ATA�x = ATb (which had toomany). We start with a diagonal example.Example 5. A is diagonal, with dependent rows and dependent columns:The columns all end with zero. In the column space, the closest vector to b = (b1,b2,b3)is p = (b1,b2,0). The best we can do with Ax = b is to solve the ﬁrst two equations,since the third equation is 0 = b3. That error cannot be reduced, but the errors in the ﬁrsttwo equations will be zero. ThenNow we face the second difﬁculty. To make �x as short as possible, we choose thetotally arbitrary �x3 and �x4 to be zero. The minimum length solution is x+:x+ = A+b is shortestThis equation ﬁnds x+, and it also displays the matrix that produces x+ from b. Thatmatrix is the pseudoinverse A+ of our diagonal A. Based on this example, we know Σ+",pos_def_matrices
"7.3 Computation of Eigenvaluessteps of the shifted algorithm, the matrix Ak looks like this:We accept the computed λ ′1 as a very close approximation to the true λ1. To ﬁnd thenext eigenvalue, the QR algorithm continues with the smaller matrix (3 by 3, in theillustration) in the upper left-hand corner. Its subdiagonal elements will be somewhatreduced by the ﬁrst QR steps, and another two steps are sufﬁcient to ﬁnd λ2. This givesa systematic procedure for ﬁnding all the eigenvalues. In fact, the QR method is nowcompletely described. It only remains to catch up on the eigenvectors—that is a singleinverse power step—and to use the zeros that Householder created.2. When A0 is tridiagonal or Hessenberg, each QR step is very fast. The Gram-Schmidtprocess (factoring into QR) takes O(n3) operations for a full matrix A. For a Hessenbergmatrix this becomes O(n2), and for a tridiagonal matrix it is O(n). Fortunately, each newAk is again in Hessenberg or tridiagonal form:∗ ∗ ∗ ∗∗ ∗ ∗ ∗0 ∗ ∗ ∗0 0 ∗ ∗∗ ∗ ∗ ∗0 ∗ ∗ ∗0 0 ∗ ∗0 0 0 ∗You can easily check that this multiplication leaves Q0 with the same three zeros as A0.Hessenberg times triangular is Hessenberg. So is triangular times Hessenberg:A1 = R0Q0 =∗ ∗ ∗ ∗0 ∗ ∗ ∗0 0 ∗ ∗0 0 0 ∗∗ ∗ ∗ ∗∗ ∗ ∗ ∗0 ∗ ∗ ∗0 0 ∗ ∗The symmetric case is even better, since A1 = Q−10 A0Q0 = QT0A0Q0 stays symmetric. Bythe reasoning just completed, A1 is also Hessenberg. So A1 must be tridiagonal. Thesame applies to A2,A3,..., and every QR step begins with a tridiagonal matrix.The last point is the factorization itself, producing the Qk and Rk from each Ak (orreally from Ak − αkI). We may use Householder again, but it is simpler to annihilateeach subdiagonal element in turn by a “plane rotation” Pij. The ﬁrst is P21:Rotation to kill a21",computations
"1.4 Matrix Notation and Matrix Multiplication(b) If the third equation has zero as its second coefﬁcient (it contains 0v) then nomultiple of equation 2 will be subtracted from equation 3.(c) If the third equation contains 0u and 0v, then no multiple of equation 1 or equa-tion 2 will be subtracted from equation 3.29. (Very optional) Normally the multiplication of two complex numbersinvolves the four separate multiplications ac, bd, be, ad. Ignoring i, can you computeac−bd and bc+ad with only three multiplications? (You may do additions, such asforming a+b before multiplying, without any penalty.)30. Use elimination to solve+ 2v + 2w = 112u + 3v − 4w =+ 2v + 2w = 102u + 3v − 4w =31. For which three numbers a will elimination fail to give three pivots?32. Find experimentally the average size (absolute value) of the ﬁrst and second and thirdpivots for MATLAB’s lu(rand(3,3)). The average of the ﬁrst pivot from abs(A(1,1))Matrix Notation and Matrix MultiplicationWith our 3 by 3 example, we are able to write out all the equations in full. We can listthe elimination steps, which subtract a multiple of one equation from another and reacha triangular matrix. For a large system, this way of keeping track of elimination wouldbe hopeless; a much more concise record is needed.We now introduce matrix notation to describe the original system, and matrix mul-tiplication to describe the operations that make it simpler. Notice that three differenttypes of quantities appear in our example:−2u + 7v + 2w =",gauss elim
"20. In Hilbert space, ﬁnd the length of the vector v = (1/length of the function f(x) = ex (over the interval 0 ≤ x ≤ 1). What is the innerproduct over this interval of ex and e−x?21. What is the closest function acosx + bsinx to the function f(x) = sin2x on the in-terval from −π to π? What is the closest straight line c+dx?22. By setting the derivative to zero, ﬁnd the value of b1 that minimizesCompare with the Fourier coefﬁcient b1.23. Find the Fourier coefﬁcients a0, a1, b1 of the step function y(x), which equals 1 onthe interval 0 ≤ x ≤ π and 0 on the remaining interval π < x < 2π:24. Find the fourth Legendre polynomial. It is a cubic x3+ax2+bx+c that is orthogonalto 1, x, and x2 − 13 over the interval −1 ≤ x ≤ 1.25. What is the closest straight line to the parabola y = x2 over −1 ≤ x ≤ 1?26. In the Gram-Schmidt formula (10), verify that C is orthogonal to q1 and q2.27. Find an orthonormal basis for the subspace spanned by a1 = (1,−1,0,0), a2 =(0,1,−1,0), a3 = (0,0,1,−1).28. Apply Gram-Schmidt to (1,−1,0), (0,1,−1), and (1,0,−1), to ﬁnd an orthonormalbasis on the plane x1 +x2 +x3 = 0. What is the dimension of this subspace, and howmany nonzero vectors come out of Gram-Schmidt?29. (Recommended) Find orthogonal vectors A, B, C by Gram-Schmidt from a, b, c:A, B, C and a, b, c are bases for the vectors perpendicular to d = (1,1,1,1).30. If A = QR then ATA = RTR =on A corresponds to elimination on ATA. CompareFor ATA, the pivots are 2, 33 and the multipliers are −1",orthogonality
"Chapter 6 Positive Deﬁnite MatricesThus Ak is positive deﬁnite. Its eigenvalues (not the same λ1!) must be positive. Itsdeterminant is their product, so all upper left determinants are positive.If condition III holds, so does condition IV: According to Section 4.4, the kth pivotdk is the ratio of detAk to detAk−1. If the determinants are all positive, so are the pivots.If condition IV holds, so does condition I: We are given positive pivots, and mustdeduce that xTAx > 0. This is what we did in the 2 by 2 case, by completing the square.The pivots were the numbers outside the squares. To see how that happens for symmetricmatrices of any size, we go back to elimination on a symmetric matrix: A = LDLT.Example 1. Positive pivots 2, 3I want to split xTAx into xTLDLTx:So xTAx is a sum of squares with the pivots 2, 3xTAx = (LTx)TD(LTx) = 2Those positive pivots in D multiply perfect squares to make xTAx positive. Thus condi-tion IV implies condition I, and the proof is complete.It is beautiful that elimination and completing the square are actually the same. Elim-ination removes x1 from all later equations. Similarly, the ﬁrst square accounts for allterms in xTAx involving x1. The sum of squares has the pivots outside. The multipliersℓij are inside! You can see the numbers −13 inside the squares in the example.Every diagonal entry aii must be positive. As we know from the examples, however,it is far from sufﬁcient to look only at the diagonal entries.The pivots di are not to be confused with the eigenvalues. For a typical positivedeﬁnite matrix, they are two completely different sets of positive numbers, In our 3 by 3example, probably the determinant test is the easiest:detA3 = detA = 4.The pivots are the ratios d1 = 2, d2 = 32, d3 = 43. Ordinarily the eigenvalue test is thelongest computation. For this A we know the λ’s are all positive:",pos_def_matrices
"1.5 Triangular Factors and Row ExchangesE−1 applied to F−1 applied to G−1 applied to I produces A.The order is right for the ℓ’s to fall into position. This always happens! Note thatparentheses in E−1F−1G−1 were not necessary because of the associative law.A = LU: The n by n caseThe factorization A = LU is so important that we must say more. It used to be missingin linear algebra courses when they concentrated on the abstract side. Or maybe it wasthought to be too hard—but you have got it. If the last Example 4 allows any U insteadof the particular U = I, we can see how the rule works in general. The matrix L, appliedto U, brings back A:row 1 of Urow 2 of Urow 3 of U�� = original A.The proof is to apply the steps of elimination. On the right-hand side they take A to U.On the left-hand side they reduce L to I, as in Example 4. (The ﬁrst step subtracts ℓ21times (1,0,0) from the second row, which removes ℓ21.) Both sides of (7) end up equalto the same matrix U, and the steps to get there are all reversible. Therefore (7) is correctand A = LU.A = LU is so crucial, and so beautiful, that Problem 8 at the end of this sectionsuggests a second approach. We are writing down 3 by 3 matrices, but you can see howthe arguments apply to larger matrices. Here we give one more example, and then putA = LU to use.Example 5. (A = LU, with zeros in the empty spaces)That shows how a matrix A with three diagonals has factors L and U with two diagonals.This example comes from an important problem in differential equations (Section 1.7).The second difference in A is a backward difference L times a forward difference U.",gauss elim
"Chapter 2 Vector SpacesRotations Q, Projections P, and Reﬂections HThis section began with 90° rotations, projections onto the x-axis, and reﬂections throughthe 45° line. Their matrices were especially simple:The underlying linear transformations of the x-y plane are also simple. But rotationsthrough other angles, projections onto other lines, and reﬂections in other mirrors arealmost as easy to visualize, They are still linear transformations, provided that the originis ﬁxed: A0 = 0. They must be represented by matrices. Using the natural basis, we want to discover those matrices.1. Rotation Figure 2.10 shows rotation through an angle θ. It also shows the effect onthe two basis vectors. The ﬁrst one goes to (cosθ,sinθ), whose length is still 1; itlies on the “θ-line.” The second basis vector (0,1) rotates into (−sinθ,cosθ). Byrule (6), those numbers go into the columns of the matrix (we use c and s for cosθand sinθ). This family of rotations Qθ is a perfect chance to test the correspondencebetween transformations and matrices:Does the inverse of Qθ equal Q−θ (rotation backward through θ)? Yes.Does the square of Qθ equal Q2θ (rotation through a double angle)? Yes.Does the product of Qθ and Qϕ equal Qθ+ϕ (rotation through θ then ϕ)?cosθ cosϕ −sinθ sinϕsinθ cosϕ +cosθ sinϕThe last case contains the ﬁrst two. The inverse appears when ϕ is −θ, and thesquare appears when ϕ is +θ. All three questions were decided by trigonometricidentities (and they give a new way to remember those identities). It was no accidentthat all the answers were yes. Matrix multiplication is deﬁned exactly so that theproduct of the matrices corresponds to the product of the transformations.Suppose A and B are linear transformations from V to W and from Uto V. Their product AB starts with a vector u in U, goes to Bu in V, and",vector spaces
"In contrast, the other two subspaces are in R3. The column space is the line through(1,2,3). The left nullspace must be the perpendicular plane y1 + 2y2 + 3y3 = 0. Thatequation is exactly the content of yTA = 0.The ﬁrst two subspaces (the two lines) had dimensions 1+1 = 2 in the space R2. Thesecond pair (line and plane) had dimensions 1 + 2 = 3 in the space R3. In general, therow space and nullspace have dimensions that add to r + (n − r) = n. The other pairadds to r +(m−r) = m. Something more than orthogonality is occurring, and I have toask your patience about that one further point: the dimensions.It is certainly true that the null space is perpendicular to the row space—but it is notthe whole truth. N(A) contains every vector orthogonal to the row space. The nullspacewas formed from all solutions to Ax = 0.Deﬁnition. Given a subspace V of Rn, the space of all vectors orthogonal to V is calledthe orthogonal complement of V. It is denoted by V⊥ = “V perp.”Using this terminology, the nullspace is the orthogonal complement of the row space:N(A) = (C(AT))⊥. At the same time, the row space contains all vectors that are orthog-onal to the nullspace. A vector z can’t be orthogonal to the nullspace but outside the rowspace. Adding z as an extra row of A would enlarge the row space, but we know thatthere is a ﬁxed formula r +(n−r) = n:dim(row space)+dim(nullspace) = number of columns.Every vector orthogonal to the nullspace is in the row space: C(AT) = (N(A))⊥.The same reasoning applied to AT produces the dual result: The left nullspace N(AT)and the column space C(A) are orthogonal complements. Their dimensions add up to(m − r) + r = m, This completes the second half of the fundamental theorem of linearalgebra. The ﬁrst half gave the dimensions of the four subspaces. including the fact thatrow rank = column rank. Now we know that those subspaces are perpendicular. Morethan that, the subspaces are orthogonal complements.Fundamental Theorem of Linear Algebra, Part IIThe nullspace is the orthogonal complement of the row space in Rn.The left nullspace is the orthogonal complement of the column space in Rm.To repeat, the row space contains everything orthogonal to the nullspace. The columnspace contains everything orthogonal to the left nullspace. That is just a sentence, hiddenin the middle of the book, but it decides exactly which equations can be solved! Lookedat directly, Ax = b requires b to be in the column space. Looked at indirectly. Ax = brequires b to be perpendicular to the left nullspace.Ax = b is solvable if and only if yTb = 0 whenever yTA = 0.",orthogonality
"6.2 Tests for Positive Deﬁniteness29. The symmetric factorization A = LDLT means that xTAx = xTLDLTx:The left-hand side is ax2 + 2bxy + cy2. The right-hand side is a(x + bThe second pivot completes the square! Test with a = 2, b = 4, c = 10.30. Without multiplying A =the determinant of A.the eigenvalues of A.the eigenvectors of A.a reason why A is symmetric positive deﬁnite.31. For the semideﬁnite matriceswrite xTAx as a sum of two squares and xTBx as one square.32. Apply any three tests to each of the matricesto decide whether they are positive deﬁnite, positive semideﬁnite, or indeﬁnite.33. For C =, conﬁrm that CTAC has eigenvalues of the same signsas A. Construct a chain of nonsingular matrices C(t) linking C to an orthogonalQ. Why is it impossible to construct a nonsingular chain linking C to the identity34. If the pivots of a matrix are all greater than 1, are the eigenvalues all greater than 1?Test on the tridiagonal −1, 2, −1 matrices.35. Use the pivots of A− 12I to decide whether A has an eigenvalue smaller than 136. An algebraic proof of the law of inertia starts with the orthonormal eigenvectorsx1,...,xp of A corresponding to eigenvalues λi > 0. and the orthonormal eigenvectorsy1,...,yq of CTAC corresponding to eigenvalues µi < 0.",pos_def_matrices
"4.2 Properties of the Determinant5. Subtracting a multiple of one row from another row leaves the same determinant.Rule 3 would say that there is a further term −ℓ��, but that term is zero by rule 4. Theusual elimination steps do not affect the determinant!6. If A has a row of zeros, then detA = 0.One proof is to add some other row to the zero row. The determinant is unchanged, byrule 5. Because the matrix will now have two identical rows, detA = 0 by rule 4.7. If A is triangular then detA is the product a11a22···ann of the diagonal entries. Ifthe triangular A has 1s along the diagonal, then detA = 1.Proof. Suppose the diagonal entries are nonzero. Then elimination can remove all theoff-diagonal entries, without changing the determinant (by rule 5). If A is lower triangu-lar, the steps are downward as usual. If A is upper triangular, the last column is clearedout ﬁrst—using multiples of ann. Either way we reach the diagonal matrix D:detD = a11a22···anndetI = a11a22···ann.To ﬁnd detD we patiently apply rule 3. Factoring out a11 and then a22 and ﬁnally annleaves the identity matrix. At last we have a use for rule 1: detI = 1.If a diagonal entry is zero then elimination will produce a zero row. By rule 5 theseelimination steps do not change the determinant. By rule 6 the zero row means a zerodeterminant. This means: When a triangular matrix is singular (because of a zero on themain diagonal) its determinant is zero.This is a key property. All singular matrices have a zero determinant.8. If A is singular, then detA = 0. If A is invertible, then detA ̸= 0.is not invertible if and only ifad −bc = 0.",determinants
"1. A is diagonalizable: The columns of S are eigenvectors and S−1AS = Λ.2. A is arbitrary: The columns of M include “generalized eigenvectors” of A, and theJordan form M−1AM = J is block diagonal.3. A is arbitrary: The unitary U can be chosen so that U−1AU = T is triangular.4. A is normal, AAH = AHA: then U can be chosen so that U−1AU = Λ.Special cases of normal matrices, all with orthonormal eigenvectors:(a) If A = AH is Hermitian, then all λi are real.(b) If A = AT is real symmetric, then Λ is real and U = Q is orthogonal.(c) If A = −AH is skew-Hermitian, then all λi are purely imaginary.(d) If A is orthogonal or unitary, then all |λi| = 1 are on the unit circle.1. If B is similar to A and C is similar to B, show that C is similar to A. (Let B = M−1AMand C = N−1BN.) Which matrices are similar to I?2. Describe in words all matrices that are similar to, and ﬁnd two of them.3. Explain why A is never similar to A+I.4. Find a diagonal M, made up of 1s and −1s, to show that5. Show (if B is invertible) that BA is similar to AB.6. (a) If CD = −DC (and D is invertible), show that C is similar to −C.(b) Deduce that the eigenvalues of C must come in plus-minus pairs.(c) Show directly that if Cx = λx, then C(Dx) = −λ(Dx).7. Consider any A and a “Givens rotation” M in the 1–2 plane:Choose the rotation angle θ to produce zero in the (3,1) entry of M−1AM.",eigenvec_val
"Chapter 2 Vector Spaces19. What are the special solutions to Rx = 0 and RTy = 0 for these R?1 0 2 30 1 4 50 0 0 020. If A has rank r, then it has an r by r submatrix S that is invertible. Find that submatrixS from the pivot rows and pivot columns of each A:21. Explain why the pivot rows and pivot columns of A (not R) always give an r by rinvertible submatrix of A.22. Find the ranks of AB and AM (rank 1 matrix times rank 1 matrix):23. Multiplying the rank 1 matrices A = uvT and B = wzT gives uzT times the number. AB has rank 1 unless24. Every column of AB is a combination of the columns of A. Then the dimensions ofthe column spaces give rank(AB) ≤ rank(A).Problem: Prove also that rank(AB) ≤ rank(B).25. (Important) Suppose A and B are n by n matrices, and AB = I. Prove from rank(AB) ≤rank(A) that the rank of A is n. So A is invertible and B must be its two-sided inverse.Therefore BA = I (which is not so obvious!).26. If A is 2 by 3 and C is 3 by 2, show from its rank that CA ̸= I. Give an example inwhich AC = I. For m < n, a right inverse is not a left inverse.27. Suppose A and B have the same reduced-row echelon form R. Explain how to changeA to B by elementary row operations. So B equals an28. Every m by n matrix of rank r reduces to (m by r) times (r by n):A = (pivot columns of A)(ﬁrst r rows of R) = (COL)(ROW).Write the 3 by 4 matrix A at the start of this section as the product of the 3 by 2matrix from the pivot columns and the 2 by 4 matrix from R:−1 −3 3 4",vector spaces
"7.4 Iterative Methods for Ax = b1. S = diagonal part of A (Jacobi’s method).2. S = triangular pail of A (Gauss-Seidel method).3. S = combination of 1 and 2 (successive overrelaxation or SOR).S is also called a preconditioner, and its choice is crucial in numerical analysis.Example 1 (Jacobi). Here S is the diagonal part of A:If the components of x are v and w, the Jacobi step Sxk+1 = Txk +b is2vk+1 = wk +b12wk+1 = vk +b2,The decisive matrix S−1T has eigenvalues ±12, which means that the error is cut in half(one more binary digit becomes correct) at every step. In this example, which is muchtoo small to be typical, the convergence is fast.For a larger matrix A, there is a very practical difﬁculty. The Jacobi iteration re-quires us to keep all components of xk until the calculation of xk+1 is complete. Amuch more natural idea, which requires only half as much storage, is to start using eachcomponent of the new xk+1 as soon as it is computed; xk+1 takes the place of xk a com-ponent at a time. Then xk can be destroyed as fast as xk+1 is created, The ﬁrst componenta11(x1)k+1 = (−a12x2 −a13x3 −···−a1nxn)k +b1.The next step operates immediately with this new value of x1, to ﬁnd (x2)k+1:a22(x2)k+1 = −a21(x1)k+1 +(−a23x3 −···−a2nxn)k +b2.And the last equation in the iteration step will use new values exclusively:ann(xn)k+1 = (−an1x1 −an2x2 −···−ann−1xn−1)k+1 +bn.This is called the Gauss-Seidel method, even though it was apparently unknown toGauss and not recommended by Seidel. That is a surprising bit of history, because it isnot a bad method. When the terms in xk+1 are moved to the left-hand side, S is seen asthe lower triangular part of A. On the right-hand side, T is strictly upper triangular.Example 2 (Gauss-Seidel). Here S−1T has smaller eigenvalues:",computations
"Chapter 5 Eigenvalues and EigenvectorsIn the opposite direction, suppose AB = BA. Starting from Ax = λx, we haveABx = BAx = Bλx = λBx.Thus x and Bx are both eigenvectors of A, sharing the same λ (or else Bx = 0). If weassume for convenience that the eigenvalues of A are distinct—the eigenspaces are allone-dimensional—then Bx must be a multiple of x. in other words x is an eigenvector ofB as well as A. The proof with repeated eigenvalues is a little longer.Heisenberg’s uncertainty principle comes from noncommuting matrices, like posi-tion P and momentum Q. Position is symmetric, momentum is skew-symmetric, andtogether they satisfy QP − PQ = I. The uncertainty principle follows directly from theSchwarz inequality (Qx)T(Px) ≤ ∥Qx∥∥Px∥ of Section 3.2:∥x∥2 = xTx = xT(QP−PQ)x ≤ 2∥Qx∥∥Px∥.The product of ∥Qx∥/∥x∥ and ∥Px∥/∥x∥—momentum and position errors, when thewave function is x—is at least 12. It is impossible to get both errors small, because whenyou try to measure the position of a particle you change its momentum.At the end we come back to A = SΛS−1. That factorization is particularly suited totake powers of A, and the simplest case A2 makes the point. The LU factorization ishopeless when squared, but SΛS−1 is perfect. The square is SΛ2S−1, and the eigenvec-tors are unchanged. By following those eigenvectors we will solve difference equations1. Factor the following matrices into SΛS−1:2. Find the matrix A whose eigenvalues are 1 and 4, and whose eigenvectors are, respectively. (Hint: A = SΛS−1.)3. Find all the eigenvalues and eigenvectors ofand write two different diagonalizing matrices S.4. If a 3 by 3 upper triangular matrix has diagonal entries 1, 2, 7, how do you know itcan be diagonalized? What is Λ?",eigenvec_val
"Chapter 8 Linear Programming and Game TheorySpanning Trees and the Greedy AlgorithmA fundamental network model is the shortest path problem—in which the edges havelengths instead of capacities. We want the shortest path from source to sink. If the edgesare telephone lines and the lengths are delay times, we are ﬁnding the quickest routefor a call, If the nodes are computers, we are looking for the perfect message-passingA closely related problem ﬁnds the shortest spanning tree—a set of n − 1 edgesconnecting all the nodes of the network. Instead of getting quickly between a sourceand a sink, we are now minimizing the cost of connecting all the nodes. There are noloops, because the cost to close a loop is unnecessary. A spanning tree connects thenodes without loops, and we want the shortest one. Here is one possible algorithm:1. Start from any node s and repeat the following step:Add the shortest edge that connects the current tree to a new node.In Figure 8.7, the edge lengths would come in the order 1, 2, 7, 4, 3, 6. The last stepskips the edge of length 5, which closes a loop. The total length is 23—but is it minimal?We accepted the edge of length 7 very early, and the second algorithm holds out longer.Figure 8.7: A network and a shortest spanning tree of length 23.2. Accept edges in increasing order of length, rejecting edges that complete a loop.Now the edges come in the order 1, 2, 3, 4, 6 (again rejecting 5), and 7. They are thesame edges—although that will not always happen. Their total length is the same—andthat does always happen. The spanning tree problem is exceptional, because it can besolved in one pass.In the language of linear programming, we are ﬁnding the optimal corner ﬁrst. Thespanning tree problem is being solved like back-substitution, with no false steps. Thisgeneral approach is called the greedy algorithm. Here is another greedy idea:3. Build trees from all n nodes, by repeating the following step:Select any tree and add the minimum-length edge going out from that tree.The steps depend on the selection order of the trees. To stay with the same tree isalgorithm 1. To take the lengths in order is algorithm 2. To sweep through all the trees",linear_prog
"Chapter 2 Vector Spaces16. If there is an edge between every pair of nodes (a complete graph), how many edgesare there? The graph has n nodes, and edges from a node to itself are not allowed.17. For both graphs drawn below, verify Euler’s formula:(# of nodes) − (# of edges) + (# of loops) = 1.18. Multiply matrices to ﬁnd ATA, and guess how its entries come from the graph:(a) The diagonal of ATA tells how many(b) The off-diagonals −1 or 0 tell which pairs of nodes are19. Why does the nullspace of ATA contain (1,1,1,1)? What is its rank?20. Why does a complete graph with n = 6 nodes have m = 15 edges? A spanning treeconnecting all six nodes hasedges. There are nn−2 = 64 spanning trees!21. The adjacency matrix of a graph has Mij = 1 if nodes i and j are connected by anedge (otherwise Mi j = 0). For the graph in Problem 6 with 6 nodes and 4 edges,write down M and also M2. Why does (M2)ij count the number of 2-step paths fromnode i to node j?We know how a matrix moves subspaces around when we multiply by A. The nullspacegoes into the zero vector. All vectors go into the column space, since Ax is always acombination of the columns. You will soon see something beautiful—that A takes itsrow space into its column space, and on those spaces of dimension r it is 100 percent in-vertible. That is the real action of A. It is partly hidden by nullspaces and left nullspaces,which lie at right angles and go their own way (toward zero).What matters now is what happens inside the space—which means inside n-dimensionalspace, if A is n by n. That demands a closer look.Suppose x is an n-dimensional vector. When A multiplies x, it transforms that vectorinto a new vector Ax. This happens at every point x of the n-dimensional space Rn.The whole space is transformed, or “mapped into itself,” by the matrix A. Figure 2.9illustrates four transformations that come from matrices:",vector spaces
"2.2 Solving Ax = 0 and Ax = b5. Choose b = (0,6,−6), which has b3 + b2 − 5b1 = 0. Elimination takes Ax = b toUx = c = (0,6,0). Back-substitute with free variables = 0:Particular solution to Axp = (0,6,−6)The complete solution to Ax = (0,6,−6) is (this xp) + (all xn).6. In the reduced R, the third column changes from (3,2,0) to (0,1,0). The right-handside c = (0,6,0) becomes d = (−9,3,0). Then −9 and 3 go into xp:1 2 3 5 00 0 2 2 60 0 0 0 01 2 0 2 −90 0 1 10 0 0 0That ﬁnal matrix [R d] is rref([A b]) = rref([U c]). The numbers 2 and 0 and 2and 1 in the free columns of R have opposite sign in the special solutions (the nullspacematrix N). Everything is revealed by Rx = d.1. Construct a system with more unknowns than equations, but no solution. Change theright-hand side to zero and ﬁnd all solutions xn.2. Reduce A and B to echelon form, to ﬁnd their ranks. Which variables are free?1 2 0 10 1 1 01 2 0 1Find the special solutions to Ax = 0 and Bx = 0. Find all solutions.3. Find the echelon form U, the free variables, and the special solutions:0 1 0 30 2 0 6Ax = b is consistent (has a solution) when b satisﬁes b2 =. Find the completesolution in the same form as equation (4).",vector spaces
"Chapter 7 Computations with Matricesx0 = 0, r0 = b, p0 = r0for n = 1 to N −1for n = 1 to Nstep length xn−1 to xnfor j = 1 to nxn = xn−1 +αnpn−1h jn = qTrn = rn−1 −αnApn−1v = v−h jnq jpn = rn +βnpn−1Note: Only 1 matrix vector multiplication Aq and Ap18. In Arnoldi, show that q2 is orthogonal to q1. The Arnoldi method is Gram-Schmidtorthogonalization applied to the Krylov matrix: KN = QNRN. The eigenvalues ofNAQN are often very close to those of A, even for N ≪ n. The Lanczos iteration isArnoldi for symmetric matrices (all coded in ARPACK).19. In conjugate gradients, show that r1 is orthogonal to r0 (orthogonal residuals), andpTAp0 = 0 (search directions are A-orthogonal). The iteration solves Ax = b byminimizing the error eTAe in the Krylov subspace. It is a fantastic algorithm.",computations
"1.4 What is the echelon form U of A?What are the dimensions of its four fundamental subspaces?1.5 Find the rank and the nullspace of0 0 1 20 0 1 21 1 1 01.6 Find bases for the four fundamental subspaces associated with1 1 0 00 1 0 11.7 What is the most general solution to u+v+w = 1, u−w = 2?1.8 (a) Construct a matrix whose nullspace contains the vector x = (1,1,2).(b) Construct a matrix whose left nullspace contains y = (1,5).(c) Construct a matrix whose column space is spanned by (1,1,2) and whose rowspace is spanned by (1,5).(d) If you are given any three vectors in R6 and any three vectors in R5, is there a6 by 5 matrix whose column space is spanned by the ﬁrst three and whose rowspace is spanned by the second three?1.9 In the vector space of 2 by 2 matrices,(a) is the set of rank 1 matrices a subspace?(b) what subspace is spanned by the permutation matrices?(c) what subspace is spanned by the positive matrices (all aij > 0)?(d) what subspace is spanned by the invertible matrices?1.10 Invent a vector space that contains all linear transformations from Rn to Rn. Youhave to decide on a rule for addition. What is its dimension?1.11 (a) Find the rank of A, and give a basis for its nullspace.A = LU =3 2 4 11 2 0 1 2 10 0 2 2 0 00 0 0 0 0 10 0 0 0 0 0",vector spaces
"Orthogonal Vectors and SubspacesA basis is a set of independent vectors that span a space. Geometrically, it is a set ofcoordinate axes. A vector space is deﬁned without those axes, but every time I think ofthe x-y plane or three-dimensional space or Rn, the axes are there. They are usually per-pendicular! The coordinate axes that the imagination constructs are practically alwaysorthogonal. In choosing a basis, we tend to choose an orthogonal basis.The idea of an orthogonal basis is one of the foundations of linear algebra. We needa basis to convert geometric constructions into algebraic calculations, and we need anorthogonal basis to make those calculations simple. A further specialization makes thebasis just about optimal: The vectors should have length 1. For an orthonormal basis(orthogonal unit vectors), we will ﬁnd1. the length ∥x∥ of a vector;2. the test xTy = 0 for perpendicular vectors; and3. how to create perpendicular vectors from linearly independent vectors.More than just vectors, subspaces can also be perpendicular. We will discover, sobeautifully and simply that it will be a delight to see, that the fundamental subspacesmeet at right angles. Those four subspaces are perpendicular in pairs, two in Rm andtwo in Rn. That will complete the fundamental theorem of linear algebra.The ﬁrst step is to ﬁnd the length of a vector. It is denoted by ∥x∥, and in twodimensions it comes from the hypotenuse of a right triangle (Figure 3.1a). The squareof the length was given a long time ago by Pythagoras: ∥x∥2 = x2In three-dimensional space, x = (x1,x2,x3) is the diagonal of a box (Figure 3.1b). Itslength comes from two applications of the Pythagorean formula. The two-dimensionalcase takes care of (x1,x2,0) = (1,2,0) across the base. This forms a right angle with thevertical side (0,0,x3) = (0,0,3). The hypotenuse of the bold triangle (Pythagoras again)",orthogonality
"Chapter 6 Positive Deﬁnite MatricesRemark 1. The maximin principle extends to j-dimensional subspaces S j:Remark 2. There is also a minimax principle for λn−j:If j = 1, we are maximizing R(x) over one constraint xTv = 0. That maximum is betweenthe unconstrained λn−1 and λn. The toughest constraint makes x perpendicular to the topeigenvector v = xn. Then the best x is the next eigenvector xn−1. The “minimum of theRemark 3. For the generalized problem Ax = λMx, the same principles hold if M ispositive deﬁnite. In the Rayleigh quotient, xTx becomes xTMx:Even for unequal masses in an oscillating system (M ̸= I), holding one mass at equilib-rium will raise the lowest frequency and lower the highest frequency.1. Consider the system Ax = b given byConstruct the corresponding quadratic P(x1,x2,x3), compute its partial derivatives∂P/∂xi, and verify that they vanish exactly at the desired solution.2. Complete the square in P = 12xTAx − xTb = 12(x − A−1b)TA(x − A−1b) + constant.This constant equals Pmin because the term before it is never negative. (Why?)3. Find the minimum, if there is one of P1 = 12x2+xy+y2−3y and P2 = 1matrix A is associated with P2?4. (Review) Another quadratic that certainly has its minimum at Ax = b isComparing Q with P, and ignoring the constant 12bTb, what system of equations dowe get at the minimum of Q? What are these equations called in the theory of least",pos_def_matrices
"3.3 Projections and Least SquaresFigure 3.9: Straight-line approximation matches the projection p of b.If those equations Ax = b could be solved, there would be no errors. They can’t be solvedbecause the points are not on a line. Therefore they are solved by least squares:The best solution is �C = 97, �D = 47 and the best line is 9Note the beautiful connections between the two ﬁgures. The problem is the same butthe art shows it differently. In Figure 3.9b, b is not a combination of the columns (1,1,1)and (−1,1,2). In Figure 3.9, the three points are not on a line. Least squares replacespoints b that are not on a line by points p that are! Unable to solve Ax = b, we solve7t has heights 57 at the measurement times −1, 1, 2. Those pointsdo lie on a line. Therefore the vector p = (57 ) is in the column space. This vectoris the projection. Figure 3.9b is in three dimensions (or m dimensions if there are mpoints) and Figure 3.9a is in two dimensions (or n dimensions if there are n parameters).Subtracting p from b, the errors are e = (27). Those are the vertical errors inFigure 3.9a, and they are the components of the dashed vector in Figure 3.9b. This errorvector is orthogonal to the ﬁrst column (1,1,1), since −27 = 0. It is orthogonalto the second column (−1,1,2), because −27 = 0. It is orthogonal to the columnspace, and it is in the left nullspace.Question: If the measurements b = (27) were those errors, what would be thebest line and the best �x? Answer: The zero line—which is the horizontal axis—and�x = 0. Projection to zero.We can quickly summarize the equations for ﬁtting by a straight line. The ﬁrst columnof A contains 1s, and the second column contains the times ti. Therefore ATA containsthe sum of the 1s and the ti and the t2",orthogonality
"5. For any symmetric matrix A, compute the ratio R(x) for the special choice x =(1,...,1). How is the sum of all entries aij related to λ1 and λn?6. With A =, ﬁnd a choice of x that gives a smaller R(x) than the bound λ1 ≤ 2that comes from the diagonal entries. What is the minimum value of R(x)?7. If B is positive deﬁnite, show from the Rayleigh quotient that the smallest eigenvalueof A+B is larger than the smallest eigenvalue of A.8. If λ1 and µ1 are the smallest eigenvalues of A and B, show that the smallest eigen-value θ1 of A+B is at least as large as λ1 + µ1. (Try the corresponding eigenvectorx in the Rayleigh quotients.)Note. Problems 7 and 8 are perhaps the most typical and most important resultsthat come easily from Rayleigh’s principle, but only with great difﬁculty from the9. If B is positive deﬁnite, show from the minimax principle (12) that the second small-est eigenvalue is increased by adding B : λ2(A+B) > λ2(A).10. If you throw away two rows and columns of A, what inequalities do you expectbetween the smallest eigenvalue µ of the new matrix and the original λ’s?11. Find the minimum values of12. Prove from equation (11) that R(x) is never larger than the largest eigenvalue λn.13. The minimax principle for λj involves j-dimensional subspaces S j:Equivalent to equation (15)λ j = minx in S j R(x)(a) If λj is positive, infer that every S j contains a vector x with R(x) > 0.(b) Deduce that S j contains a vector y = C−1x with yTcTACy/yTy > 0.(c) Conclude that the jth eigenvalue of CTAC, from its minimax principle, is alsopositive—proving again the law of inertia in Section 6.2.14. Show that the smallest eigenvalue λ1 of Ax = λMx is not larger than the ratio a11/m11of the corner entries.15. Which particular subspace S2 in Problem 13 gives the minimum value λ2? In otherwords, over which S2 is the maximum of R(x) equal to λ2?",pos_def_matrices
"Chapter 8 Linear Programming and Game TheoryThere is a simple way to change the inequality x+2y ≥ 4 to an equation. Just introducethe difference as a slack variable w = x + 2y − 4. This is our equation! The old con-straint x+2y ≥ 4 is converted into w ≥ 0, which matches perfectly the other inequalityconstraints x ≥ 0, y ≥ 0. Then we have only equations and simple nonnegativity con-straints on x, y, w. The variables w that “take up the slack” are now included in the vectorMinimize cx subject to Ax = b and x ≥ 0.The row vector c contains the costs; in our example, c = [2 3 0]. The condition x ≥ 0puts the problem into the nonnegative part of Rn. Those inequalities cut back on thesolutions to Ax = b. Elimination is in danger, and a completely new idea is needed.The Diet Problem and Its DualOur example with cost 2x + 3y can be put into words. It illustrates the “diet problem”in linear programming, with two sources of protein—say steak and peanut butter. Eachpound of peanut butter gives a unit of protein, and each steak gives two units. At leastfour units are required in the diet. Therefore a diet containing x pounds of peanut butterand y steaks is constrained by x+2y ≥ 4, as well as by x ≥ 0 and y ≥ 0. (We cannot havenegative steak or peanut butter.) This is the feasible set, and me p1001cm is to minimizethe cost. If a pound of peanut butter costs $2 and a steak is $3. then the cost of the wholediet is 2x+3y. Fortunately, the optimal diet is two steaks: x∗ = 0 and y∗ = 2.Every linear program, including this one, has a dual. If the original prohe1v a min-imization, its dual is a maximization. The minimum in the given “primal problem”equals the maximum in its dual. This is the key to linear programming, and it will beexplained in Section 8.3. Here we stay with the diet problem and try to interpret its dual.In place of the shopper, who buys enough protein at minimal cost, the dual problemis faced by a druggist. Protein pills compete with steak and peanut butter. Immediatelywe meet the two ingredients of a typical linear program: The druggist maximizes thepill price p, but that price is subject to linear constraints. Synthetic protein must notcost more than the protein in peanut butter ($2 a unit) or the protein in steak ($3 for twounits). The price must be nonnegative or the druggist will not sell. Since four units ofprotein are required, the income to the druggist will be 4p:Maximize 4p, subject to p ≤ 2, 2p ≤ 3, and p ≥ 0.In this example the dual is easier to solve than the primal; it has only one unknownp. The constraint 2p ≤ 3 is the tight one that is really active, and the maximum priceof synthetic protein is p = $1.50. The maximum revenue is 4p = $6, and the shopperends up paying the same for natural and synthetic protein. That is the duality theorem:",linear_prog
"s [ cs ]c [ cs ]Figure 2.10: Rotation through θ (left). Projection onto the θ-line (right).ﬁnishes with ABu in W. This “composition” AB is again a linear transfor-mation (from U to W). Its matrix is the product of the individual matricesrepresenting A and B.For AdiffAint, the composite transformation was the identity (and AintAdiff annihilatedall constants). For rotations, the order of multiplication does not matter. Then U =V = W is the x-y plane, and QθQϕ is the same as QϕQθ. For a rotation and areﬂection, the order makes a difference.Technical note: To construct the matrices, we need bases for V and W, and then forU and V. By keeping the same basis for V, the product matrix goes correctly fromthe basis in U to the basis in W. If we distinguish the transformation A from itsmatrix (call that [A]), then the product rule 2V becomes extremely concise: [AB] =[A][B]. The rule for multiplying matrices in Chapter 1 was totally determined by thisrequirement—it must match the product of linear transformations.2. Projection Figure 2.10 also shows the projection of (1,0) onto the θ-line. Thelength of the projection is c = cosθ. Notice that the point of projection is not (c,s), asI mistakenly thought; that vector has length 1 (it is the rotation), so we must multiplyby c. Similarly the projection of (0,1) has length s, and falls at s(c,s) = (cs,s2), Thatgives the second column of the projection matrix P:This matrix has no inverse, because the transformation has no inverse. Points on theperpendicular line are projected onto the origin; that line is the nullspace of P. Pointson the θ-line are projected to themselves! Projecting twice is the same as projectingonce, and P2 = P:c2(c2 +s2) cs(c2 +s2)cs(c2 +s2) s2(c2 +s2)",vector spaces
"5.4 Differential Equations and eAt20. By back-substitution or by computing eigenvectors, solve21. Find λ’s and x’s so that u = eλtx solvesWhat combination u = c1eλ1tx1 +c2eλ2tx2 starts from u(0) = (5,−2)?22. Solve Problem 21 for u(t) = (y(t),z(t)) by back-substitution:The solution for y will be a combination of e4t and et.23. Find A to change y′′ = 5y′ +4y into a vector equation for u(t) = (y(t),y′(t)):What are the eigenvalues of A? Find them also by substituting y = eλt into the scalarequation y′′ = 5y′ +4y.24. A door is opened between rooms that hold v(0) = 30 people and w(0) = 10 people.The movement between rooms is proportional to the difference v−w:Show that the total v+w is constant (40 people). Find the matrix in du/dt = Au, andits eigenvalues and eigenvectors.What are v and w at t = 1?25. Reverse the diffusion of people in Problem 24 to du/dt = −Au:The total v+w still remains constant. How are the λ’s changed now that A is changedto −A? But show that v(t)grows to inﬁnity from v(0) = 30.",eigenvec_val
"6.2 Tests for Positive DeﬁnitenessMy class often asks about unsymmetric positive deﬁnite matrices. I never use thatterm. One reasonable deﬁnition is that the symmetric part 12(A+AT) should be positivedeﬁnite. That guarantees that the real parts of the eigenvalues are positive. But it is nothas λ > 0 but 1If Ax = λx, then xHAx = λxHx and xHAHx = λxHx.2xH(A+AH)x = (Reλ)xHx > 0, so that Reλ > 0.Ellipsoids in n DimensionsThroughout this book, geometry has helped the matrix algebra. A linear equation pro-duced a plane. The system Ax = b gives an intersection of planes. Least squares givesa perpendicular projection. The determinant is the volume of a box. Now, for a positivedeﬁnite matrix and its xTAx, we ﬁnally get a ﬁgure that is curved. It is an ellipse in twodimensions, and an ellipsoid in n dimensions.The equation to consider is xTAx = 1. If A is the identity matrix, this simpliﬁes to2 + ··· + x2n = 1. This is the equation of the “unit sphere” in Rn. If A = 4I, thesphere gets smaller. The equation changes to 4x2n = 1. Instead of (1,0,...,0),it goes through (12,0,...,0). The center is at the origin, because if x satisﬁes xTAx = 1,so does the opposite vector −x. The important step is to go from the identity matrix to athe equation is xTAx = 4x2Since the entries are unequal (and positive!) the sphere changes to an ellipsoid.One solution is x = (12,0,0) along the ﬁrst axis. Another is x = (0,1,0). The majoraxis has the farthest point x = (0,0,3). It is like a football or a rugby ball, but not quite—those are closer to x23 = 1. The two equal coefﬁcients make them circular inthe x1-x2 plane, and much easier to throw!Now comes the ﬁnal step, to allow nonzeros away from the diagonal of A.Example 3. A =and xTAx = 5u2 + 8uv + 5v2 = 1. That ellipse is centered atu = v = 0, but the axes are not so clear. The off-diagonal 4s leave the matrix positivedeﬁnite, but they rotate the ellipse—its axes no longer line up with the coordinate axes(Figure 6.2). We will show that the axes of the ellipse point toward the eigenvector ofA. Because A = AT, those eigenvectors and axes are orthogonal. The major axis of theellipse corresponds to the smallest eigenvalue of A.To locate the ellipse we compute λ1 = 1 and λ2 = 9. The unit eigenvectors are2. Those are at 45° angles with the u-v axes, and they arelined up with the axes of the ellipse. The way to see the ellipse properly is to rewrite",pos_def_matrices
"(done by elimination). Determinants give formulas for the answers.1. Computation of A−1. The 2 by 2 case shows how cofactors go into A−1:We are dividing by the determinant, and A is invertible exactly when detA is nonzero.The number C11 = d is the cofactor of a. The number C12 = −c is the cofactor of b (notethe minus sign). That number C12 goes in row 2, column 1!The row a, b times the column C11, C12 produces ad −bc. This is the cofactor expan-sion of detA. That is the clue we need: A−1 divides the cofactors by detA.Our goal is to verify this formula for A−1. We have to see why ACT = (detA)I:With cofactorsC11,...,C1n in the ﬁrst column and not the ﬁrst row, they multiply a11,...,a1nand give the diagonal entry detA. Every row of A multiplies its cofactors (the cofactorexpansion) to give the same answer detA on the diagonal.The critical question is: Why do we get zeros off the diagonal? If we combine theentries a1 j from row 1 with the cofactors C2j for row 2, why is the result zero?row 1 of A, row 2 of Ca11C21 +a12C22 +···+a1nC2n = 0.The answer is: We are computing the determinant of a new matrix B, with a new row 2.The ﬁrst row of A is copied into the second row of B. Then B has two equal rows, anddetB = 0. Equation (3) is the expansion of detB along its row 2, where B has exactlythe same cofactors as A (because the second row is thrown away to ﬁnd those cofactors).The remarkable matrix multiplication (2) is correct.That multiplication ACT = (detA)I immediately gives A−1. Remember that the cofac-tor from deleting row i and column j of A goes into row j and column i of CT. Dividingby the number detA (if it is not zero!) gives A−1 = CT/detA.Example 1. The inverse of a sum matrix is a difference matrix:The minus signs enter because cofactors always include (−1)i+j.",determinants
"3.4 Orthogonal Bases and Gram-Schmidt10. If q1 and q2 are the outputs from Gram-Schmidt, what were the possible input vectors11. Show that an orthogonal matrix that is upper triangular must be diagonal.12. What multiple of a1 =should be subtracted from a2 =to make the resultorthogonal to a1? Factorinto QR with orthonormal vectors in Q.13. Apply the Gram-Schmidt process toand write the result in the form A = QR.14. From the nonorthogonal a, b, c, ﬁnd orthonormal vectors q1, q2, q3:15. Find an orthonormal set q1, q2, q3 for which q1, q2 span the column space ofWhich fundamental subspace contains q3? What is the least-squares solution ofAx = b if b = [1 2 7]T?16. Express the Gram-Schmidt orthogonalization of a1, a2 as A = QR:Given n vectors ai with m components, what are the shapes of A, Q, and R?17. With the same matrix A as in Problem 16, and with b = [1 1 1]T, use A = QR tosolve the least-squares problem Ax = b.18. If A = QR, ﬁnd a simple formula for the projection matrix P onto the column space19. Show that these modiﬁed Gram-Schmidt steps produce the same C as in equationC = C∗ −(qTThis is much more stable, to subtract the projections one at a time.",orthogonality
"Chapter 1 Matrices and Gaussian EliminationOf course the shapes of these matrices must match properly—B and C have the sameshape, so they can be added, and A and D are the right size for premultiplication andpostmultiplication. The proof of this law is too boring for words.The property that fails to hold is a little more interesting:Matrix multiplication is not commutative: Usually FE ̸= EF.Example 4. Suppose E subtracts twice the ﬁrst equation from the second. Suppose Fis the matrix for the next step, to add row 1 to row 3:These two matrices do commute and the product does both steps at once:In either order, EF or FE, this changes rows 2 and 3 using row 1.Example 5. Suppose E is the same but G adds row 2 to row 3. Now the order makes adifference. When we apply E and then G, the second row is altered before it affects thethird. If E comes after G, then the third equation feels no effect from the ﬁrst. You willsee a zero in the (3,1) entry of EG, where there is a −2 in GE:Thus EG ̸= GE. A random example would show the same thing—most matrices don’tcommute. Here the matrices have meaning. There was a reason for EF = FE, and areason for EG ̸= GE. It is worth taking one more step, to see what happens with allthree elimination matrices at once:The product GFE is the true order of elimination. It is the matrix that takes the originalA to the upper triangular U. We will see it again in the next section.The other matrix EFG is nicer. In that order, the numbers −2 from E and 1 from Fand G were not disturbed. They went straight into the product. It is the wrong order forelimination. But fortunately it is the right order for reversing the elimination steps—which also comes in the next section.Notice that the product of lower triangular matrices is again lower triangular.",gauss elim
"Chapter 5 Eigenvalues and EigenvectorsThe only eigenvector of A is (1,0,0). Its Jordan form has only one block, and A mustbe similar to J1. The matrix B has the additional eigenvector (0,1,0), and its Jordanform is J2 with two blocks, As for J3 = zero matrix, it is in a family by itself; the onlymatrix similar to J3 is M−10M = 0. A count of the eigenvectors will determine J whenthere is nothing more complicated than a triple eigenvalue.Example 6. Application to difference and differential equations (powers and expo-nentials). If A can be diagonalized, the powers of A = SΛS−1 are easy: Ak = SΛkS−1. Inevery case we have Jordan’s similarity A = MJM−1, so now we need the powers of J:Ak = (MJM−1)(MJM−1)···(MJM−1) = MJkM−1.J is block-diagonal, and the powers of each block can be taken separately:This block Ji will enter when λ is a triple eigenvalue with a single eigenvector. Itsexponential is in the solution to the corresponding differential equation:Here I +Jit +(Jit)2/2!+··· produces 1+λt +λ 2t2/2!+··· = eλt on the diagonal.The third column of this exponential comes directly from solving du/dt = Jiu:This can be solved by back-substitution (since Ji is triangular). The last equation du3/dt =λu3 yields u3 = eλt. The equation for u2 is du2/dt = λu2 +u3, and its solution is teλt.The top equation is du1/dt = λu1 + u2, and its solution is 12t2eλt. When λ has multi-plicity m with only one eigenvector, the extra factor t appears m−1 times.These powers and exponentials of J are a part of the solutions uk and u(t). The otherpart is the M that connects the original A to the more convenient matrix J:if uk+1 = Aukthen uk = Aku0 = MJkM−1u0if du/dt = Au then u(t) = eAtu(0) = MeJtM−1u(0).When M and J are S and Λ (the diagonalizable case) those are the formulas of Sections5.3 and 5.4. Appendix B returns to the nondiagonalizable case, and shows how theJordan form can be reached. I hope the following table will be a convenient summary.",eigenvec_val
"6.2 Tests for Positive Deﬁniteness12. In three dimensions, λ1y23 = 1 represents an ellipsoid when all λi > 0.Describe all the different kinds of surfaces that appear in the positive semideﬁnitecase when one or more of the eigenvalues is zero.13. Write down the ﬁve conditions for a 3 by 3 matrix to be negative deﬁnite (−A ispositive deﬁnite) with special attention to condition III: How is det(−A) related to14. Decide whether the following matrices are positive deﬁnite, negative deﬁnite, semidef-Is there a real solution to −x2 −5y2 −9z2 −4xy−6xz−8yz = 1?15. Suppose A is symmetric positive deﬁnite and Q is an orthogonal matrix. True or(a) QTAQ is a diagonal matrix.(b) QTAQ is symmetric positive deﬁnite.(c) QTAQ has the same eigenvalues as A.(d) e−A is symmetric positive deﬁnite.16. If A is positive deﬁnite and a11 is increased, prove from cofactors that the determinantis increased. Show by example that this can fail if A is indeﬁnite.17. From A = RTR. show for positive deﬁnite matrices that detA ≤ a11a22···ann. (Thelength squared of column j of R is a j j. Use determinant = volume.)18. (Lyapunov test for stability of M) Suppose AM + MHA = −I with positive deﬁniteA. If Mx = λx show that ReA < 0. (Hint: Multiply the ﬁrst equation by xH and x.)19. Which 3 by 3 symmetric matrices A produce these functions f = xTAx? Why is theﬁrst matrix positive deﬁnite but not the second one?(a) f = 2(x2(b) f = 2(x23 −x1x2 −x1x3 −x2x3).20. Compute the three upper left determinants to establish positive deﬁniteness. Verifythat their ratios give the second and third pivots.",pos_def_matrices
"1. A multiple of the identity matrix, A = cI, stretches every vectorby the same factor c. The whole space expands or contracts (orsomehow goes through the origin and out the opposite side, when2. A rotation matrix turns the whole space around the origin. Thisexample turns all vectors through 90°, transforming every point3. A reﬂection matrix transforms every vector into its image onthe opposite side of a mirror. In this example the mirror is the45° line y = x, and a point like (2,2) is unchanged. A point like(2,−2) is reversed to (−2,2). On a combination like v = (2,2)+(2,−2) = (4,0), the matrix leaves one part and reverses the otherpart. The output is Av = (2,2)+(−2,2) = (0,4)That reﬂection matrix is also a permutation matrix! It is alge-braically so simple, sending (x,y) to (y,x), that the geometric pic-A projection matrix takes the whole space onto a lower-dimensional subspace (not invertible). The example transformseach vector (x,y) in the plane to the nearest point (x,0) on the hor-izontal axis. That axis is the column space of A. The y-axis thatprojects to (0,0) is the nullspace.Figure 2.9: Transformations of the plane by four matrices.Those examples could be lifted into three dimensions. There are matrices to stretchthe earth or spin it or reﬂect it across the plane of the equator (forth pole transforming tosouth pole). There is a matrix that projects everything onto that plane (both poles to thecenter). It is also important to recognize that matrices cannot do everything, and sometransformations T(x) are not possible with Ax:(i) It is impossible to move the origin, since A0 = 0 for every matrix.(ii) If the vector x goes to x′, then 2x must go to 2x′. in general cx must go to cx′, since(iii) If the vectors x and y go to x′ and y′, then their sum x+y must go to x′ +y′—sinceMatrix multiplication imposes those rules on the transformation. The second rule con-tains the ﬁrst (take c = 0 to get A0 = 0). We saw rule (iii) in action when (4,0) was",vector spaces
"Chapter 5 Eigenvalues and Eigenvectors0 1 0 00 0 1 00 0 0 11 0 0 0This is an orthogonal matrix, so by Property 3′ it must have orthogonal eigenvectors.They are the columns of the Fourier matrix! Its eigenvalues must have absolute value 1.They are the numbers 1,w,...,wn−1 (or 1,i,i2,i3 in this 4 by 4 ease). It is a real matrix,but its eigenvalues and eigenvectors are complex.One ﬁnal note, Skew-Hermitian matrices satisfy KH = −K, just as skew-symmetricmatrices satisfy KT = −K. Their properties follow immediately from their close link toIf A is Hermitian then K = iA is skew-Hermitian.The eigenvalues of K are purely imaginary instead of purely real; we multiply i. Theeigenvectors are not changed. The Hermitian example on the previous pages would leadK = iA =The diagonal entries are multiples of i (allowing zero). The eigenvalues are 8i and −i.The eigenvectors are still orthogonal, and we still have K = UΛUH—with a unitary Uinstead of a real orthogonal Q, and with 8i and −i on the diagonal of Λ.This section is summarized by a table of parallels between real and complex.Rn (n real components)Cn (n complex components)length: ∥x∥2 = x2length: ∥x∥2 = |x1|2 +···+|xn|2ij = A jiij = A jiinner product: xTy = x1y1 +···+xnyninner product: xHy = x1y1 +···+xnynorthogonality: xTy = 0orthogonality: xHy = 0symmetric matrices: AT = AHermitian matrices: AH = AA = QΛQ−1 = QΛQT (real Λ)A = UΛU−1 = UΛUH (real Λ)skew-symmetric KT = −Kskew-Hermitian KH = −Korthogonal QTQ = I or QT = Q−1unitary UHU = I or UH = U−1(Qx)T(Qy) = xTy and ∥Qx∥ = ∥x∥(Ux)H(Uy) = xHy and ∥Ux∥ = ∥x∥The columns, rows, and eigenvectors of Q and U are orthonormal, and every |λ| = 1",eigenvec_val
"Chapter 5 Eigenvalues and Eigenvectors1. Prove that every third Fibonacci number in 0,1,1.2,3,... is even.2. Bernadelli studied a beetle “which lives three years only. and propagates in as thirdyear.” They survive the ﬁrst year with probability 12, and the second with probability3, and then produce six females on the way out:Show that A3 = I, and follow the distribution of 3000 beetles for six years.3. For the Fibonacci matrix A =, compute A2, A3, and A4. Then use the text anda calculator to ﬁnd F20.4. Suppose each “Gibonacci” number Gk+2 is the average of the two previous numbersGk+1 and Gk. Then Gk+2 = 1(a) Find the eigenvalues and eigenvectors of A.(b) Find the limit as n → ∞ of the matrices An = SΛnS−1.(c) If G0 = 0 and G1 = 1, show that the Gibonacci numbers approach 25. Diagonalize the Fibonacci matrix by completing S−1:Do the multiplication SΛkS−1�1to ﬁnd its second component. This is the kth Fi-bonacci number Fk = (λ k6. The numbers λ k1 and λ k2 satisfy the Fibonacci rule Fk+2 = Fk+1 +Fk:Prove this by using the original equation for the λ’s (multiply it by λ k). Then anycombination of λ k1 and λ k2 satisﬁes the rule. The combination Fk = (λ kλ2) gives the right start of F0 = 0 and F1 = 1.",eigenvec_val
"1.4 Matrix Notation and Matrix Multiplication48. Block multiplication says that elimination on column 1 produces49. Elimination for a 2 by 2 block matrix: When A−1A = I, multiply the ﬁrst block rowby CA−1 and subtract from the second row, to ﬁnd the “Schur complement” S:50. With i2 = −1, the product (A + iB)(x + iy) is Ax + iBx + iAy − By. Use blocks toseparate the real part from the imaginary part that multiplies i:51. Suppose you solve Ax = b for three special right-hand sides b:If the solutions x1, x2, x3 are the columns of a matrix X, what is AX?52. If the three solutions in Question 51 are x1 = (1,1,1) and x2 = (0,1,1) and x3 =(0,0,1), solve Ax = b when b = (3,5,8). Challenge problem: What is A?53. Find all matrices54. If you multiply a northwest matrix A and a southeast matrix B, what type of matri-ces are AB and BA? “Northwest” and “southeast” mean zeros below and above theantidiagonal going from (1,n) to (n,1).55. Write 2x+3y+z+5t = 8 as a matrix A (how many rows?) multiplying the columnvector (x,y,z,t) to produce b. The solutions ﬁll a plane in four-dimensional space.The plane is three-dimensional with no 4D volume.56. What 2 by 2 matrix P1 projects the vector (x,y) onto the x axis to produce (x,0)?What matrix P2 projects onto the y axis to produce (0,y)? If you multiply (5,7) byP1 and then multiply by P2, you get (57. Write the inner product of (1,4,5) and (x,y,z) as a matrix multiplication Ax. A hasone row. The solutions to Ax = 0 lie on aperpendicular to the vectorcolumns of A are only in",gauss elim
"3.5 The Fast Fourier TransformFigure 3.12: Flow graph for the Fast Fourier Transform with n = 4.0,...,7 in binary and reverse the order of their bits. The subscripts appear in “bit-reversed order” on the left side of the graph. Even numbers come before odd (numbersending in 0 come before numbers ending in 1).1. What are F2 and F4 for the 4 by 4 Fourier matrix F?2. Find a permutation P of the columns of F that produces FP = F (n by n), Combinewith FF = nI to ﬁnd F2 and F4 for the n by n Fourier matrix.3. If you form a 3 by 3 submatrix of the 6 by 6 matrix F6, keeping only the entries inits ﬁrst, third, and ﬁfth rows and columns, what is that submatrix?4. Mark all the sixth roots of 1 in the complex plane. What is the primitive root w6?(Find its real and imaginary part.) Which power of w6 is equal to 1/w6? What is1+w+w2 +w3 +w4 +w5?5. Find all solutions to the equation eix = −1, and all solutions to eiθ = i.6. What are the square and the square root of w128, the primitive 128th root of 1?7. Solve the 4 by 4 system (6) if the right-hand sides are y0 = 2, y1 = 0, y2 = 2, y3 = 0.In other words, solve F4c = y.8. Solve the same system with y = (2,0,−2,0) by knowing F−1and computing c =4 y. Verify that c0 +c1eix +c2e2ix +c3e3ix takes the values 2, 0, −2, 0 at the points9. (a) If y = (1,1,1,1), show that c = (1,0,0,0) satisﬁes F4c = y.(b) Now suppose y = (1,0,0,0), and ﬁnd c.",orthogonality
"5.3 Difference Equations and Powers AkBut the second approach brings out the analogy with a differential equation: The pureexponential solutions eλitxi are now the pure powers λ ki xi. The eigenvectors xi areampliﬁed by the eigenvalues λi. By combining these special solutions to match u0—thatis where c came from—we recover the correct solution uk = SΛkS−1u0.In any speciﬁc example like Fibonacci’s, the ﬁrst step is to ﬁnd the eigenvalues:det(A−λI) = λ 2 −λ −1The second row of A−λI is (1,−λ). To get (A−λI)x = 0, the eigenvector is x = (λ,1),The ﬁrst Fibonacci numbers F0 = 0 and F1 = 1 go into u0, and S−1u0 = c:Those are the constants in uk = c1λ k1x1 + c2λ k2x2. Both eigenvectors x1 and x2 havesecond component 1. That leaves Fk = c1λ k2 in the second component of uk:This is the answer we wanted. The fractions and square roots look surprising becauseFibonacci’s rule Fk+2 = Fk+1 +Fk must produce whole numbers, Somehow that formulafor Fk must give an integer. In fact, since the second term [(1 −2, it must just move the ﬁrst term to the nearest integer:F1000 = nearest integer to 1This is an enormous number, and F1001 will be even bigger. The fractions are becominginsigniﬁcant, and the ratio F1001/F1000 must be very close to (1+5)/2 ≈ 1.618. Since2 is insigniﬁcant compared to λ k1, the ratio Fk+1/Fk approaches λ1.That is a typical difference equation, leading to the powers of A =5 because the eigenvalues did. If we choose a matrix with λ1 = 1 and λ2 = 6. we canfocus on the simplicity of the computation—after A has been diagonalized:λ = 1 and 6,",eigenvec_val
"5.2 Diagonalization of a MatrixProblems 25–28 are about the diagonalizability of A.25. True or false: If the eigenvalues of A are 2, 2, 5, then the matrix is certainly26. If the eigenvalues of A are 1 and 0, write everything you know about the matrices A27. Complete these matrices so that detA = 25. Then trace = 10, and λ = 5 is repeated!Find an eigcnvector with Ax = 5x. These matrices will nothe diagonalizabie becausethere is no second line of eigenvectors.28. The matrix A =is not diagonalizable because the rank of A − 3I isChange one entry to make A diagonalizable. Which entries could you change?Problems 29–33 are about powers of matrices.29. Ak = SΛkS−1 approaches the zero matrix as k → ∞ if and only if every λ has absolute. Does Ak → 0 or Bk → 0?30. (Recommended) Find Λ and S to diagonalize A in Problem 29. What is the limit ofΛk as k → ∞? What is the limit of SΛkS−1? In the columns of this limiting matrix31. Find Λ and S to diagonalize B in Problem 29. What is B10u0 for these u0?32. Diagonalize A and compute SΛkS−1 to prove this formula for Ak:3k +1 3k −13k −1 3k +133. Diagonalize B and compute SΛkS−1 to prove this formula for Bk:",eigenvec_val
"Chapter 2 Vector SpacesFigure 2.1: The column space C(A), a plane in three-dimensional space.These are the same three equations in two unknowns. Now the problem is: Find numbersu and v that multiply the ﬁrst and second columns to produce b. The system is solvableexactly when such coefﬁcients exist, and the vector (u,v) is the solution x.We are saying that the attainable right-hand sides b are all combinations of the columnsof A. One possible right-hand side is the ﬁrst column itself; the weights are u = 1 andv = 0. Another possibility is the second column: u = 0 and v = 1. A third is the right-hand side b = 0. With u = 0 and v = 0, the vector b = 0 will always be attainable.We can describe all combinations of the two columns geometrically: Ax = b can besolved if and only if b lies in the plane that is spanned by the two column vectors (Figure2.1). This is the thin set of attainable b. If b lies off the plane, then it is not a combinationof the two columns. In that case Ax = b has no solution.What is important is that this plane is not just a subset of R3 it is a subspace. It isthe column space of A, consisting of all combinations of the columns. It is denoted byC(A). Requirements (i) and (ii) for a subspace of Rm are easy to check:(i) Suppose b and b′ lie in the column space, so that Ax = b for some x and Ax′ = b′for some x′. Then A(x + x′) = b + b′, so that b + b′ is also a combination of thecolumns. The column space of all attainable vectors b is closed under addition.(ii) If b is in the column space C(A), so is any multiple cb. If some combinationof columns produces b (say Ax = b), then multiplying that combination by c willproduce cb. In other words, A(cx) = cb.For another matrix A, the dimensions in Figure 2.1 may be very different. The small-est possible column space (one vector only) comes from the zero matrix A = 0. The",vector spaces
"Chapter 1 Matrices and Gaussian Eliminationthe plane of columns 2 and 3. Only two columns are independent.The vector b = (2,5,7) is in that plane of the columns—it is column 1 plus column3—so (1, 0, 1) is a solution. We can add an multiple of the combination (3,−1,−2) thatgives b = 0. So there is a whole line of solutions—as we know from the row picture.The truth is that we knew the columns would combine to give zero, because the rowsdid. That is a fact of mathematics, not of computation—and it remains true in dimensionn. If the n planes have no point in common, or inﬁnitely many points, then the ncolumns lie in the same plane.If the row picture breaks down, so does the column picture. That brings out thedifference between Chapter 1 and Chapter 2. This chapter studies the most importantproblem—the nonsingular case—where there is one solution and it has to be found.Chapter 2 studies the general case, where there may be many solutions or none. Inboth cases we cannot continue without a decent notation (matrix notation) and a decentalgorithm (elimination). After the exercises, we start with elimination.1. For the equations x + y = 4, 2x − 2y = 4, draw the row picture (two intersectinglines) and the column picture (combination of two columns equal to the columnvector (4,4) on the right side).2. Solve to ﬁnd a combination of the columns that equals b:u − v − w =v + w =3. (Recommended) Describe the intersection of the three planes u+v+w+z = 6 andu+w+z = 4 and u+w = 2 (all in four-dimensional space). Is it a line or a point oran empty set? What is the intersection if the fourth plane u = −1 is included? Finda fourth equation that leaves us with no solution.4. Sketch these three lines and decide if the equations are solvable:3 by 2 systemx + 2y =What happens if all right-hand sides are zero? Is there any nonzero choice of right-hand sides that allows the three lines to intersect at the same point?5. Find two points on the line of intersection of the three planes t = 0 and z = 0 andx+y+z+t = 1 in four-dimensional space.",gauss elim
"Chapter 5 Eigenvalues and EigenvectorsThere is nothing exceptional about λ = 0. Like every other number, zero might bean eigenvalue and it might not. If it is, then its eigenvectors satisfy Ax = 0x. Thus x isin the nullspace of A. A zero eigenvalue signals that A is singular (not invertible); itsdeterminant is zero. Invertible matrices have all λ ̸= 0.Example 3. The eigenvalues are on the main diagonal when A is triangular:The determinant is just the product of the diagonal entries. It is zero if λ = 1, λ = 32; the eigenvalues were already sitting along the main diagonal.This example, in which the eigenvalues can be found by inspection, points to onemain theme of the chapter: To transform A into a diagonal or triangular matrix withoutchanging its eigenvalues. We emphasize once more that the Gaussian factorization A =LU is not suited to this purpose. The eigenvalues of U may be visible on the diagonal,but they are not the eigenvalues of A.For most matrices, there is no doubt that the eigenvalue problem is computationallymore difﬁcult than Ax = b. With linear systems, a ﬁnite number of elimination stepsproduced the exact answer in a ﬁnite time. (Or equivalently, Cramer’s rule gave an exactformula for the solution.) No such formula can give the eigenvalues, or Galois wouldturn in his grave. For a 5 by 5 matrix, det(A−λI) involves λ 5. Galois and Abel provedthat there can be no algebraic formula for the roots of a ﬁfth-degree polynomial.All they will allow is a few simple checks on the eigenvalues, after they have beencomputed, and we mention two good ones: sum and product.The sum of the n eigenvalues equals the sum of the n diagonal entries:A = λ1 +···+λn = a11 +···+ann.Furthermore, the product of the n eigenvalues equals the determinant of A.The projection matrix P had diagonal entries 12 and eigenvalues 1, 0. Then 1agrees with 1 + 0 as it should. So does the determinant, which is 0 · 1 = 0. A singularmatrix, with zero determinant, has one or more of its eigenvalues equal to zero.There should be no confusion between the diagonal entries and the eigenvalues. Fora triangular matrix they are the same—but that is exceptional. Normally the pivots,diagonal entries, and eigenvalues are completely different, And for a 2 by 2 matrix, thetrace and determinant tell us everything:has trace a+d, and determinant ad −bc",eigenvec_val
"Chapter 5 Eigenvalues and EigenvectorsAt the last step, an eigenvector of the 2 by 2 matrix in the lower right-hand corner goesinto a unitary M3, which is put into the corner of U3:The product U = U1U2U3 is still a unitary matrix, and U−1AU = T.This lemma applies to all matrices, with no assumption that A is diagoalizable. Wecould use it to prove that the powers Ak approach zero when all |λi| < 1, and the expo-nentials eAt approach zero when all Reλi < 0—even without the full set of eigenvectorswhich was assumed in Sections 5.3 and 5.4.Example 2. A =has the eigenvalue λ = 1 (twice).The only line of eigenvectors goes through (1,1). After dividing by2, this is the ﬁrstcolumn of U, and the triangular U−1AU = T has the eigenvalues on its diagonal:Diagonalizing Symmetric and Hermitian MatricesThis triangular form will show that any symmetric or Hermitian matrix—whether itseigenvalues are distinct or not—has a complete set of orthonormal eigenvectors. Weneed a unitary matrix such that U−1AU is diagonal. Schur’s lemma has just found it.This triangular T must be diagonal, because it is also Hermitian when A = AH:T = T H(U−1AU)H = UHAH(U−1)H = U−1AU.The diagonal matrix U−1AU represents a key theorem in linear algebra.(Spectral Theorem) Every real symmetric A can be diagonalized by anorthogonal matrix Q. Every Hermitian matrix can be diagonalized by a unitaryThe columns of Q (or U) contain orthonormal eigenvectors of A.Remark 1. In the real symmetric case, the eigenvalues and eigenvectors are real at everystep. That produces a real unitary U—an orthogonal matrix.",eigenvec_val
"5.3 Difference Equations and Powers AkThe “Perron-Frobenius theorem” gives the key properties of a positive matrix—notto be confused with a positive deﬁnite matrix, which is symmetric and has all its eigen-values positive. Here all the entries aij are positive.If A is a positive matrix, so is its largest eigenvalue: λ1 > all other |λi|.Every component of the corresponding eigenvector x1 is also positive.Proof. Suppose A > 0. The key idea is to look at all numbers t such that Ax ≥ tx forsome nonnegative vector x (other than x = 0). We are allowing inequality in Ax ≥ tx inorder to have many positive candidates t. For the largest value tmax (which is attained),we will show that equality holds: Ax = tmaxx.Otherwise, if Ax ≥ tmaxx is not an equality, multiply by A. Because A is positive, thatproduces a strict inequality A2x > tmaxAx. Therefore the positive vector y = Ax satisﬁesAy > tmaxy, and tmax could have been larger. This contradiction forces the equality Ax =tmaxx, and we have an eigenvalue. Its eigenvector x is positive (not just nonnegative)because on the left-hand side of that equality Ax is sure to be positive.To see that no eigenvalue can be larger than tmax, suppose Az = λz. Since λ and zmay involve negative or complex numbers, we take absolute values: |λ||z| = |Az| ≤ A|z|by the “triangle inequality.” This |z| is a nonnegative vector, so |λ| is one of the possiblecandidates t. Therefore |λ| cannot exceed λ1, which was tmax.Example 4 (Von Neumann’s model of an expanding economy ).We go back to the 3 by 3 matrix A that gave the consumption of steel, food, and labor.If the outputs are s1, f1, ℓ1, then the required inputs areIn economics the difference equation is backward! Instead of u1 = Au0 we have u0 =Au1. If A is small (as it is), then production does not consume everything—and theeconomy can grow. The eigenvalues of A−1 will govern this growth. But again there isa nonnegative twist, since steel, food, and labor cannot come in negative amounts. VonNeumann asked for the maximum rate t at which the economy can expand and still staynonnegative, meaning that u1 ≥ tu0 ≥ 0.Thus the problem requires u1 ≥ tAu1. It is like the Perron-Frobenius theorem, with Aon the other side. As before, equality holds when t reaches tmax—which is the eigenvalueassociated with the positive eigenvector of A−1. In this example the expansion factor isWith steel-food-labor in the ratio 1-5-5, the economy grows as quickly as possible: Themaximum growth rate is 1/λ1.",eigenvec_val
"1.6 Inverses and TransposesExample 1. Using the Gauss-Jordan Method to Find A−11 1 0 0−6 0 0 1 02 0 0 1pivot = 2 →0 −8 −2 −2 1 0pivot = −8 →0 −8 −2 −2 1 0This completes the ﬁrst half—forward elimination. The upper triangular U appears inthe ﬁrst three columns. The other three columns are the same as L−1. (This is the effectof applying the elementary operations GFE to the identity matrix.) Now the second halfwill go from U to I (multiplying by U−1). That takes L−1 to U−1L−1 which is A−1.Creating zeros above the pivots, we reach A−1:0 −8 0 −4zeros above pivots →0 −8 0 −4divide by pivots →0 0 1 −1At the last step, we divided the rows by their pivots 2 and −8 and 1. The coefﬁcientmatrix in the left-hand half became the identity. Since A went to I, the same operationson the right-hand half must have carried I into A−1. Therefore we have computed theA note for the future: You can see the determinant −16 appearing in the denominatorsof A−1. The determinant is the product of the pivots (2)(−8)(1). It enters at the endwhen the rows are divided by the pivots.Remark 1. In spite of this brilliant success in computing A−1, I don’t recommend it, Iadmit that A−1 solves Ax = b in one step. Two triangular steps are better:We could write c = L−1b and then x = U−1c = U−1L−1b. But note that we did notexplicitly form, and in actual computation should not form, these matrices L−1 and U−1.",gauss elim
"Chapter 6 Positive Deﬁnite MatricesEach of the following tests is a necessary and sufﬁcient condition for asymmetric matrix A to be positive semideﬁnite:(I′) xTAx ≥ 0 for all vectors x (this deﬁnes positive semideﬁnite).(II′) All the eigenvalues of A satisfy λi ≥ 0.(III′) No principal submatrices have negative determinants.(IV′) No pivots are negative.(V′) There is a matrix R, possibly with dependent columns, such that A = RTR.The diagonalization A = QΛQT leads to xTAx = xTQΛQTx = yTΛy. If A has rank r, thereare r nonzero λ’s and r perfect squares in yTΛy = λ1y2Note. The novelty is that condition III′ applies to all the principal submatrices, not onlythose in the upper left-hand corner. Otherwise, we could not distinguish between twomatrices whose upper left determinants were all zero:is positive semideﬁnite, andA row exchange comes with the same column exchange to maintain symmetry.is positive semideﬁnite, by all ﬁve tests:(I′) xTAx = (x1 −x2)2 +(x1 −x3)2 +(x2 −x3)2 ≥ 0 (zero if x1 = x2 = x3).(II′) The eigenvalues are λ1 = 0, λ2 = λ3 = 3 (a zero eigenvalue).(III′) detA = 0 and smaller determinants are positive.(V′) A = RTR with dependent columns in R:(1,1,1) in the nullspace.Remark. The conditions for semideﬁniteness could also be deduced from the origin con-ditions I-V for deﬁniteness by the following trick: Add a small multiple of the identitygiving a positive deﬁnite matrix A + εI. Then let ε approach zero. Since the determi-nants and eigenvalues depend continuously on ε, they will be positive until the very lastmoment. At ε = 0 they must still be nonnegative.",pos_def_matrices
"1.6 Inverses and TransposesShow that A cannot be invertible. The third row of A−1, multiplying A, should givethe third row [0 0 1 0] of A−1A = I. Why is this impossible?10. Find the inverses (in any legal way) of0 0 0 10 0 2 00 3 0 04 0 0 0a b 0 00 0 a b11. Give examples of A and B such that(a) A+B is not invertible although A and B are invertible.(b) A+B is invertible although A and B are not invertible.(c) all of A, B, and A+B are invertible.(d) In the last case use A−1(A+B)B−1 = B−1 +A−1 to show that C = B−1 +A−1 isalso invertible—and ﬁnd a formula for C−1.12. If A is invertible, which properties of A remain true for A−1?(a) A is triangular. (b) A is symmetric. (c) A is tridiagonal. (d) All entries are wholenumbers. (e) All entries are fractions (including numbers like 313. If A = [31] and B = [22], compute ATB, BTA, ABT, and BAT.14. If B is square, show that A = B+BT is always symmetric and K = B−BT is alwaysskew-symmetric—which means that KT = −K. Find these matrices A and K whenB = [1 31 1], and write B as the sum of a symmetric matrix and a skew-symmetric15. (a) How many entries can be chosen independently in a symmetric matrix of order(b) How many entries can be chosen independently in a skew-symmetric matrix(KT = −K) of order n? The diagonal of K is zero!16. (a) If A = LDU, with 1s on the diagonals of L and U, what is the correspondingfactorization of AT? Note that A and AT (square matrices with no row exchanges)share the same pivots.(b) What triangular systems will give the solution to ATy = b?17. If A = L1D1U1 and A = L2D2U2, prove that L1 = L2, D1 = D2, and U1 = U2. If A isinvertible, the factorization is unique.(a) Derive the equation L−11 L2D2 = D1U1U−12 , and explain why one side is lowertriangular and the other side is upper triangular.(b) Compare the main diagonals and then compare the off-diagonals.",gauss elim
"Chapter 1 Matrices and Gaussian EliminationIt would be a waste of time, since we only need back-substitution for x (and forwardA similar remark applies to A−1; the multiplication A−1b would still take n2 steps. Itis the solution that we want, and not all the entries in the inverse.Remark 2. Purely out of curiosity, we might count the number of operations requiredto ﬁnd A−1. The normal count for each new right-hand side is n2, half in the forwarddirection and half in back-substitution. With n right-hand sides e1,...,en this makes n3.After including the n3/3 operations on A itself, the total seems to be 4n3/3.This result is a little too high because of the zeros in the e j. Forward eliminationchanges only the zeros below the 1. This part has only n − j components, so the countfor e j is effectively changed to (n − j)2/2. Summing over all j, the total for forwardelimination is n3/6. This is to be combined with the usual n3/3 operations that areapplied to A, and the n(n2/2) back-substitution steps that ﬁnally produce the columns x jof A−1. The ﬁnal count of multiplications for computing A−1 is n3:This count is remarkably low. Since matrix multiplication already takes n3 steps, itrequires as many operations to compute A2 as it does to compute A−1! That fact seemsalmost unbelievable (and computing A3 requires twice as many, as far as we can see).Nevertheless, if A−1 is not needed, it should not be computed.Remark 3. In the Gauss-Jordan calculation we went all the way forward to U, beforestarting backward to produce zeros above the pivots. That is like Gaussian elimination,but other orders are possible. We could have used the second pivot when we were thereearlier, to create a zero above it as well as below it. This is not smart. At that timethe second row is virtually full, whereas near the end it has zeros from the upward rowoperations that have already taken place.Invertible = Nonsingular (n pivots)Ultimately we want to know which matrices are invertible and which are not. Thisquestion is so important that it has many answers. See the last page of the book!Each of the ﬁrst ﬁve chapters will give a different (but equivalent) test for invertibility.Sometimes the tests extend to rectangular matrices and one-sided inverses: Chapter 2looks for independent rows and independent columns, Chapter 3 inverts AAT or ATA.The other chapters look for nonzero determinants or nonzero eigenvalues or nonzeropivots. This last test is the one we meet through Gaussian elimination. We want to show(in a few theoretical paragraphs) that the pivot test succeeds.Suppose A has a full set of n pivots. AA−1 = I gives n separate systems Axi = eifor the columns of A−1. They can be solved by elimination or by Gauss-Jordan. Rowexchanges may be needed, but the columns of A−1 are determined.",gauss elim
"Chapter 8 Linear Programming and Game Theorywriting out all matrices in full !). For computational purposes (except for small problemsin textbooks), the day of the tableau is over.To see why, remember that after the most negative coefﬁcient in r indicates whichcolumn u will enter the basis, none of the other columns above r will be used. It wasa waste of time to compute them. In a larger problem, hundreds of columns would becomputed time and time again, just waiting for their turn to enter the basis. It makesthe theory clear to do the eliminations so completely and reach R. But in practice thisIt is quicker, and in the end simpler, to see what calculations are really necessary.Each simplex step exchanges a column of N for a column of B. Those columns aredecided by r and α. This step begins with the current basis matrix B and the currentsolution xB = B−1b.A Step of the Simplex Method1. Compute the row vector λ = cBB−1 and the reduced costs r = cN −λN.2. If r ≥ 0, stop: the current solution is optimal. Otherwise, if ri is the mostnegative component, choose u = column i of N to enter the basis.3. Compute the ratios of B−1b to B−1u, admitting only positive componentsof B−1u. (If B−1u < 0, the minimal cost is −∞.) When the smallest ratiooccurs at component k, the kth column of the current B will leave.4. Update B, B−1, or LU, and the solution xB = B−1b. Return to step 1.This is sometimes called the revised simplex method to distinguish it from the oper-ations on a tableau. It is really the simplex method itself, boiled down.This discussion is ﬁnished once we decide how to compute steps 1, 3, and 4:The most popular way is to work directly with B−1, calculating it explicitly at the ﬁrstcorner. At succeeding corners, the pivoting step is simple. When column k of the identitymatrix is replaced by u, column k of B−1 is replaced by v = B−1u. To recover the identitymatrix, elimination will multiply the old B−1 byMany simplex codes use the product form of the inverse, which saves these simplematrices E−1 instead of directly updating B−1. When needed, they are applied to b andcB. At regular intervals (maybe every 40 simplex steps), B−1 is recomputed and the E−1are erased. Equation (5) is checked in Problem 9 at the end of this section.",linear_prog
"Chapter 7 Computations with MatricesProblems 4–5 require Gershgorin’s “circle theorem”: Every eigenvalue of A lies in atleast one of the circles C1,...,Cn, where Ci has its center at the diagonal entry aii. Itsradius ri = ∑i̸=j |aij| is equal to the absolute sum along the rest of the row.Proof. Suppose xi is the largest component of x. Then Ax = λx leads to(λ −aii)xi = ∑|λ −aii| ≤ ∑|ai j| = ri.is called diagonally dominant because every |aii| > ri. Show that zero cannot lie inany of the circles, and conclude that A is nonsingular.5. Write the Jacobi matrix J for the diagonally dominant A of Problem 4, and ﬁnd thethree Gershgorin circles for J. Show that all the radii satisfy ri < 1, and that the6. The true solution to Ax = b is slightly different from the elimination solution toLUx0 = b; A−LU misses zero because of roundoff. One strategy is to do everythingin double precision, but a better and faster way is iterative reﬁnement: Compute onlyone vector r = b−Ax0 in double precision, solve LUy = r, and add the correction y tox0. Problem: Multiply x1 = x0+y by LU, write the result as a splitting Sx1 = Tx0+b,and explain why T is extremely small. This single step brings us almost exactly to x.7. For a general 2 by 2 matrixﬁnd the Jacobi iteration matrix S−1T = −D−1(L +U) and its eigenvalues µi. Findalso the Gauss-Seidel matrix −(D+L)−1U and its eigenvalues λi, and decide whether8. Change Ax = b to x = (I −A)x+b. What are S and T for this splitting? What matrixS−1T controls the convergence of xk+1 = (1−A)xk +b?9. If λ is an eigenvalue of A, thenis an eigenvalue of B = I −A. The real eigen-values of B have absolute value less than 1 if the real eigenvalues of A lie between10. Show why the iteration xk+1 = (I −A)xk +b does not converge for A =",computations
"2.2 Solving Ax = 0 and Ax = b2. With free variables = 0, ﬁnd a particular solution to Axp = b and Uxp = c.3. Find the special solutions to Ax = 0 (or Ux = 0 or Rx = 0). Each free variable, inturn, is 1. Then x = xp +(any combination xn of special solutions).When the equation was Ax = 0, the particular solution was the zero vector! It ﬁts the pat-tern, but xparticular = 0 was not written in equation (2). Now xp is added to the nullspacesolutions, as in equation (4).Question: How does the reduced form R make this solution even clearer? You willsee it in our example. Subtract equation 2 from equation 1, and then divide equation 2by its pivot. On the left-hand side, this produces R, as before. On the right-hand side,these operations change c = (1,3,0) to a new vector d = (−2,1,0):1 3 0 −1Our particular solution xp, (one choice out of many) has free variables v = y = 0.Columns 2 and 4 can be ignored. Then we immediately have u = −2 and w = 1, exactlyas in equation (4). The entries of d go directly into xp. This is because the identitymatrix is sitting in the pivot columns of R!Let me summarize this section, before working a new example. Elimination revealsthe pivot variables and free variables. If there are r pivots, there are r pivot variablesand n−r free variables. That important number r will be given a name—it is the rankSuppose elimination reduces Ax = b to Ux = c and Rx = d, with r pivotrows and r pivot columns. The rank of those matrices is r. The last m − rrows of U and R are zero, so there is a solution only if the last m−r entries ofc and d are also zero.The complete solution is x = xp + xn. One particular solution xp has all freevariables zero. Its pivot variables are the ﬁrst r entries of d, so Rxp = d.The nullspace solutions xn are combinations of n − r special solutions, withone free variable equal to 1. The pivot variables in that special solution can befound in the corresponding column of R (with sign reversed).You see how the rank r is crucial. It counts the pivot rows in the “row space” and thepivot columns in the column space. There are n − r special solutions in the nullspace.There are m−r solvability conditions on b or c or d.",vector spaces
"8.3 The Dual Problemdetermined by y ≥ 0 and AT and c. The whole theory of linear programming hinges onthe relation between primal and dual. Here is the fundamental result:Duality Theorem When both problems have feasible vectors, they haveoptimal x∗ and y∗. The minimum cost cx∗ equals the maximum income y∗b.If optimal vectors do not exist, there are two possibilities: Either both feasible sets areempty, or one is empty and the other problem is unbounded (the maximum is +∞ or theThe duality theorem settles the competition between the grocer and the druggist. Theresult is always a tie. We will ﬁnd a similar “minimax theorem” in game theory. Thecustomer has no economic reason to prefer vitamins over food, even though the druggistguarantees to match the grocer on every food—and even undercuts on expensive foods(like peanut butter). We will show that expensive foods are kept out of the optimal diet,so the outcome can be (and is) a tie.This may seem like a total stalemate, but I hope you will not be fooled. The optimalvectors contain the crucial information. In the primal problem, x∗ tells the purchaserwhat to buy. In the dual, y∗ ﬁxes the natural prices (shadow prices) at which the economyshould run. Insofar as our linear model reﬂects the true economy. x∗ and y∗ representthe essential decisions to be made.We want to prove that c∗x = y∗b. It may seem obvious that the druggist can raisethe vitamin prices y∗ to meet the grocer, hut only one thing is truly clear: Since eachfood can be replaced by its vitamin equivalent, with no increase in cost, all adequatefood diets must cost at least as much as vitamins. This is only a one-sided inequality,druggist’s price ≤ grocer’s price. It is called weak duality, and it is easy to prove forany linear program and its dual:If x and y are feasible in the primal and dual problems, then yb ≤ cx.Proof. Since the vectors are feasible, they satisfy Ax ≥ b and yA ≤ c. Because feasi-bility also includes x ≥ 0 and y ≥ 0, we can take inner products without spoiling thoseinequalities (multiplying by negative numbers would reverse them):Since the left-hand sides are identical, we have weak duality yb ≤ cx.This one-sided inequality prohibits the possibility that both problems are unbounded.If yb is arbitrarily large, a feasible x would contradict yb ≤ cx. Similarly, if cx can godown to −∞, the dual cannot admit a feasible y.Equally important, any vectors that achieve yb = cx must be optimal. At that pointthe grocer’s price equals the druggist’s price. We recognize an optimal food diet andoptimal vitamin prices by the fact that the consumer has nothing to choose:If the vectors x and y are feasible and cx = yb, then x and y are optimal.",linear_prog
"This is the basic statement of the problem. Note that it is a ﬁrst-order equation—nohigher derivatives appear—and it is linear in the unknowns, It also has constant coefﬁ-cients; the matrix A is independent of time.How do we ﬁnd u(t)? If there were only one unknown instead of two, that questionwould be easy to answer. We would have a scalar instead of a vector equation:u = u(0) at t = 0.The solution to this equation is the one thing you need to know:At the initial time t = 0, u equals u(0) because e0 = 1. The derivative of eat has therequired factor a, so that du/dt = au. Thus the initial condition and the equation areNotice the behavior of u for large times. The equation is unstable if a > 0, neutrallystable if a = 0, or stable if a < 0; the factor eat approaches inﬁnity, remains bounded,or goes to zero. If a were a complex number, a = α +iβ, then the same tests would beapplied to the real part α. The complex part produces oscillations eiβt = cosβt +isinβt.Decay or growth is governed by the factor eαt.So much for a single equation. We shall take a direct approach to systems, and lookfor solutions with the same exponential dependence on t just found in the scalar case:or in vector notationThis is the whole key to differential equations du/dt = Au: Look for pure exponentialsolutions. Substituting v = eλty and w = eλtz into the equation, we ﬁndThe factor eλt is common to every term, and can be removed. This cancellation is thereason for assuming the same exponent λ for both unknowns; it leavesThat is the eigenvalue equation. In matrix form it is Ax = λx. You can see it again if weuse u = eλtx—a number eλt that grows or decays times a ﬁxed vector x. Substitutinginto du/dt = Au gives λeλtx = Aeλtx. The cancellation of eλt produces",eigenvec_val
"4.4 Applications of Determinants37. A 3 by 3 determinant has three products “down to the right” and three “down to theleft” with minus signs. Compute the six terms in the ﬁgure to ﬁnd D. Then explainwithout determinants why this matrix is or is not invertible:38. For A4 in Problem 6, ﬁve of the 4! = 24 terms in the big formula (6) are nonzero.Find those ﬁve terms to show that D4 = −1.39. For the 4 by 4 tridiagonal matrix (entries −1, 2, −1), ﬁnd the ﬁve terms in the bigformula that give detA = 16−4−4−4+1.40. Find the determinant of this cyclic P by cofactors of row 1. How many exchangesreorder 4, 1, 2, 3 into 1, 2, 3, 4? Is |P2| = +1 or −1?0 0 0 11 0 0 00 1 0 00 0 1 00 0 1 00 0 0 11 0 0 00 1 0 041. A=2∗eye(n)−diag(ones(n−1, 1),1)−diag(ones(n−1, 1),−1) is the −1, 2, −1matrix. Change A(1,1) to 1 so detA = 1. Predict the entries of A−1 based on n = 3and test the prediction for n = 4.42. (MATLAB) The −1, 2, −1 matrices have determinant n + 1. Compute (n + 1)A−1for n = 3 and 4, and verify your guess for n = 5. (Inverses of tridiagonal matriceshave the rank-1 form uvT above the diagonal.)43. All Pascal matrices have determinant 1. If I subtract 1 from the n, n entry, why doesthe determinant become zero? (Use rule 3 or a cofactor.)1 4 10 20���� = 1 (known)1 4 10 19���� = 0 (explain).This section follows through on four major applications: inverse of A, solving Ax = b,volumes of boxes, and pivots. They are among the key computations in linear algebra",determinants
"1.3 An Example of Gaussian EliminationExample 1. Nonsingular (cured by exchanging equations 2 and 3)2u + 2v + 5w =4u + 6v + 8w =2v + 4w =2v + 4w =The system is now triangular, and back-substitution will solve it.Example 2. Singular (incurable)2u + 2v + 5w =4u + 4v + 8w =u + v +There is no exchange of equations that can avoid zero in the second pivot position. Theequations themselves may be solvable or unsolvable. If the last two equations are 3w = 6and 4w = 7, there is no solution. If those two equations happen to be consistent—as in3w = 6 and 4w = 8—then this singular case has an inﬁnity of solutions. We know thatw = 2, but the ﬁrst equation cannot decide both u and v.Section 1.5 will discuss row exchanges when the system is not singular. Then theexchanges produce a full set of pivots. Chapter 2 admits the singular case, and limpsforward with elimination. The 3w can still eliminate the 4w, and we will call 3 thesecond pivot. (There won’t be a third pivot.) For the present we trust all n pivot entriesto be nonzero, without changing the order of the equations. That is the best case, withThe Cost of EliminationOur other question is very practical. How many separate arithmetical operations doeselimination require, for n equations in n unknowns? If n is large, a computer is going totake our place in carrying out the elimination. Since all the steps are known, we shouldbe able to predict the number of operations.For the moment, ignore the right-hand sides of the equations, and count only theoperations on the left. These operations are of two kinds. We divide by the pivot toﬁnd out what multiple (say ℓ) of the pivot equation is to be subtracted. When we dothis subtraction, we continually meet a “multiply-subtract” combination; the terms inthe pivot equation are multiplied by ℓ, and then subtracted from another equation.Suppose we call each division, and each multiplication-subtraction, one operation. Incolumn 1, it takes n operations for every zero we achieve—one to ﬁnd the multiple ℓ,and the other to ﬁnd the new entries along the row. There are n−1 rows underneath theﬁrst one, so the ﬁrst stage of elimination needs n(n − 1) = n2 − n operations. (Anotherapproach to n2 − n is this: All n2 entries need to be changed, except the n in the ﬁrstrow.) Later stages are faster because the equations are shorter.",gauss elim
"Chapter 5 Eigenvalues and Eigenvectors32. Construct any 3 by 3 Markov matrix M: positive entries down each column add to1. If e = (1,1,1), verify that MTe = e. By Problem 11, λ = 1 is also an eigenvalueof M. Challenge: A 3 by 3 singular Markov matrix with trace 133. Find three 2 by 2 matrices that have λ1 = λ2 = 0. The trace is zero and the determi-nant is zero. The matrix A might not be 0 but check that A2 = 0.34. This matrix is singular with rank 1. Find three λ’s and three eigenvectors:35. Suppose A and B have the same eigenvalues λ1,...,λn with the same independenteigenvectors x1,...,xn. Then A = B. Reason: Any vector x is a combination c1x1 +···+cnxn. What is Ax? What is Bx?36. (Review) Find the eigenvalues of A, B, and C:37. When a+b = c+d, show that (1,1) is an eigenvector and ﬁnd both eigenvalues:38. When P exchanges rows 1 and 2 and columns 1 and 2, the eigenvalues don’t change.Find eigenvectors of A and PAP for λ = 11:39. Challenge problem: Is there a real 2 by 2 matrix (other than I) with A3 = I? Itseigenvalues must satisfy λ 3 = I. They can be e2πi/3 and e−2πi/3. What trace anddeterminant would this give? Construct A.40. There are six 3 by 3 permutation matrices P. What numbers can be the determinantsof P? What numbers can be pivots? What numbers can be the trace of P? What fournumbers can be eigenvalues of P?",eigenvec_val
"6.1 Minima, Maxima, and Saddle Points9. The quadratic f(x1,x2) = 3(x1 + 2x2)2 + 4x22 is positive. Find its matrix A, factor itinto LDLT, and connect the entries in D and L to 3, 2, 4 in f.10. If R = [ p qq r ], write out R2 and check that it is positive deﬁnite unless R is singular.11. (a) If A =is Hermitian (complex b), ﬁnd its pivots and determinant.(b) Complete the square for xHAx. Now xH = [x1 x2] can be complexa|x1|2 +2Rebx1x2 +c|x2|2 = a|x1 +(b/a)x2|2 +(c) Show that a > 0 and ac > |b|2 ensure that A is positive deﬁnite.(d) Are the matrices12. Decide whether F = x2y2 − 2x − 2y has a minimum at the point x = y = 1 (aftershowing that the ﬁrst derivatives are zero at that point).13. Under what conditions on a, b, c is ax2 +2bxy+cy2 > x2 +y2 for all x, y?Problems 14–18 are about tests for positive deﬁniteness.14. Which of A1, A2, A3, A4 has two positive eigenvalues? Test a > 0 and ac > b2, don’tcompute the eigenvalues. Find an x so that xTA1x < 0.15. What is the quadratic f = ax2 +2bxy+cy2 for each of these matrices? Complete thesquare to write f as a sum of one or two squares d1(16. Show that f(x,y) = x2 + 4xy + 3y2 does not have a minimum at (0,0) even thoughit has positive coefﬁcients. Write f as a difference of squares and ﬁnd a point (x,y)where f is negative.17. (Important) If A has independent columns, then ATA is square and symmetric andinvertible (Section 4.2). Rewrite xTATAx to show why it is positive except whenx = 0. Then ATA is positive deﬁnite.18. Test to see if ATA is positive deﬁnite in each case:",pos_def_matrices
"Chapter 5 Eigenvalues and EigenvectorsThe powers 6k and 1k appear in that last matrix Ak, mixed in by the eigenvectors.For the difference equation uk+1 = Auk, we emphasize the main point. Every eigen-vector x produces a “pure solution” with powers of λ:u2 = λ 2x,...When the initial u0 is an eigenvector x, this is the solution: uk = λ kx. In general u0is not an eigenvector. But if u0 is a combination of eigenvectors, the solution uk is thesame combination of these special solutions.If u0 = c1x1 + ··· + cnxn, then after k steps uk = c1λ k1x1 + ··· + cnλ kChoose the c’s to match the starting vector u0:There was an exercise in Chapter 1, about moving in and out of California, that is worthanother look. These were the rules:10 of the people outside California move in, and10 of the peopleinside California move out. We start with y0 people outside and z0 inside.At the end of the ﬁrst year the numbers outside and inside are y1 and z1:y1 = .9y0 +.2z0z1 = .1y0 +.8z0This problem and its matrix have the two essential properties of a Markov process:1. The total number of people stays ﬁxed: Each column of the Markov matrix addsup to 1. Nobody is gained or lost.2. The numbers outside and inside can never become negative: The matrix has nonegative entries. The powers Ak are all nonnegative.3We solve this Markov difference equation using uk = SΛkS−1u0. Then we show thatthe population approaches a “steady state.” First A has to be diagonalized:det(A−λI) = λ 2 −1.7λ +.73Furthermore, history is completely disregarded; each new uk+1 depends only on the current uk. Perhaps evenour lives are examples of Markov processes, but I hope not.",eigenvec_val
"Each sum on the right has m = 12n terms. Since w2n is wm, the two sums areFor the second part of equation (13), j +m in place of j produces a sign change:Inside the sums, wk(j+1)m = 1k = 1.n = e2πim/n = eπi = −1.The FFT idea is easily modiﬁed to allow other prime factors of n (not only powers of 2).If n itself is a prime, a completely different algorithm is used.Example 1. The steps from n = 4 to m = 2 areCombined, the three steps multiply c by F4 to give y. Since each step is linear, it mustcome from a matrix, and the product of those matrices must be F4:You recognize the two copies of F2 in the center. At the right is the permutation matrixthat separates c into c′ and c′′. At the left is the matrix that multiplies by w jstarted with F8, the middle matrix would contain two copies of F4. Each of those wouldbe split as above. Thus the FFT amounts to a giant factorization of the Fourier matrix!The single matrix F with n2 nonzeros is a product of approximately ℓ = log2n matrices(and a permutation) with a total of only nℓ nonzeros.The Complete FFT and the ButterﬂyThe ﬁrst step of the FFT changes multiplication by Fn to two multiplications by Fm.The even-numbered components (c0,c2) are transformed separately from (c1,c3), Figure3.12 gives a ﬂow graph for n = 4. For n = 8, the key idea is to replace each F4 box byF2 boxes. The new factor w4 = i is the square of the old factor w = w8 = e2πi/8. Theﬂow graph shows the order that the c’s enter the FFT and the log2n stages that take themthrough it—and it also shows the simplicity of the logic.Every stage needs 12n multiplications so the ﬁnal count is 12nlogn. There is an amaz-ing rule for the overall permutation of c’s before entering the FFT: Write the subscripts",orthogonality
"Chapter 5 Eigenvalues and Eigenvectors(b) Compute uk = SΛkS−1u0 for any a and b.(c) Under what condition on a and b does uk approach a ﬁnite limit as k → ∞, andwhat is the limit? Does A have to be a Markov matrix?14. Multinational companies in the Americas, Asia, and Europe have assets of $4 trillion.At the start, $2 trillion are in the Americas and $2 trillion in Europe. Each year 1American money stays home, and 14 goes to each of Asia and Europe. For Asia and2 stays home and 12 is sent to the Americas.(a) Find the matrix that gives(b) Find the eigenvalues and eigenvectors of A.(c) Find the limiting distribution of the $4 trillion as the world ends.(d) Find the distribution of the $4 trillion at year k.15. If A is a Markov matrix, show that the sum of the components of Ax equals the sumof the components of x. Deduce that if Ax = λx with λ ̸= 1, the components of theeigenvector add to zero.16. The solution to du/dt = Au =u (eigenvalues i and −i) goes around in a circle:u = (cost,sint). Suppose we approximate du/dt by forward, backward, and centereddifferences F, B, C:(F) un+1 −un = Aun or un+1 = (I +A)un (this is Euler’s method).(B) un+1 −un = Aun+1 or un+1 = (I −A)−1un (backward Euler).(C) un+1 −un = 12A(un+1 +un) or un+1 = (I − 1Find the eigenvalues of I +A, (IłA)−1, and (I − 12A). For which differenceequation does the solution un stay on a circle?17. What values of α produce instability in vn+1 = α(vn +wn), wn+1 = α(vn +wn)?18. Find the largest a, b, c for which these matrices are stable or neutrally stable:19. Multiplying term by term, check that (IłA)(I + A + A2 + ···) = I. This series rep-resents (IłA)−1. It is nonnegative when A is nonnegative, provided it has a ﬁnite",eigenvec_val
"Chapter 8 Linear Programming and Game Theory“plane” has dimension n−1.x + 2y ≥ 4x + 2y = 4x + 2y = 0Figure 8.1: Equations give lines and planes. Inequalities give halfspaces.Another constraint is fundamental to linear programming: x and y are required to benonnegative. This pair of inequalities x ≥ 0 and y ≥ 0 produces two more halfspaces.Figure 8.2 is bounded by the coordinate axes: x ≥ 0 admits all points to the right ofx = 0, and y ≥ 0 is the halfspace above y = 0.The Feasible Set and the Cost FunctionThe important step is to impose all three inequalities at once. They combine to give theshaded region in Figure 8.2. This feasible set is the intersection of the three halfspacesx +2y ≥ 4, x ≥ 0, and y ≥ 0. A feasible set is composed of the solutions to a family oflinear inequalities like Ax ≥ b (the intersection of m halfspaces). When we also requirethat every component of x is nonnegative (the vector inequality x ≥ 0), this adds n morehalfspaces. The more constraints we impose, the smaller the feasible set.It can easily happen that a feasible set is bounded or even empty. If we switch ourexample to the halfspace x+2y ≤ 4, keeping x ≥ 0 and y ≥ 0, we get the small triangleOAB. By combining both inequalities x+2y ≥ 4 and x+2y ≤ 4, the set shrinks to a linewhere x+2y = 4. If we add a contradictory constraint like x+2y ≤ −2, the feasible setThe algebra of linear inequalities (or feasible sets) is one part of our subject. Butlinear programming has another essential ingredient: It looks for the feasible point thatmaximizes or minimizes a certain cost function like 2x + 3y. The problem in linearprogramming is to ﬁnd the point that lies in the feasible set and minimizes the cost.The problem is illustrated by the geometry of Figure 8,2. The family of costs 2x+3y",linear_prog
"3.3 Projections and Least Squares3. Solve Ax = b by least squares, and ﬁnd p = A�x ifVerify that the error b− p is perpendicular to the columns of A.4. Write out E2 = ∥Ax−b∥2 and set to zero its derivatives with respect to u and v, ifCompare the resulting equations with ATA�x = ATb, conﬁrming that calculus as wellas geometry gives the normal equations. Find the solution �x and the projection p =A�x. Why is p = b?5. The following system has no solution:Sketch and solve a straight-line ﬁt that leads to the minimization of the quadratic(C−D−4)2 +(C−5)2 +(C+D−9)2? What is the projection of b onto the column6. Find the projection of b onto the column space of A:Split b into p + q, with p in the column space and q perpendicular to that space.Which of the four subspaces contains q?7. Find the projection matrix P onto the space spanned by a1 = (1,0,1) and a2 =8. If P is the projection matrix onto a k-dimensional subspace S of the whole space Rn,what is the column space of P and what is its rank?9. (a) If P = PTP, show that P is a projection matrix.(b) What subspace does the matrix P = 0 project onto?10. If the vectors a1, a2, and b are orthogonal, what are ATA and ATb? What is theprojection of b onto the plane of a1 and a2?",orthogonality
"These two eigenvectors are orthogonal:Of course any multiples x/α and y/β are equally good as eigenvectors. MATLABpicks α = ∥x∥ and β = ∥y∥, so that x/α and y/β are unit vectors; the eigenvectorsare normalized to have length 1. They are now orthonormal. If these eigenvectors arechosen to be the columns of S, then we have S−1AS = Λ as always. The diagonalizingmatrix can be chosen with orthonormal columns when A = AH.In case A is real and symmetric, its eigenvalues are real by Property 2. Its uniteigenvectors are orthogonal by Property 3. Those eigenvectors are also real; they solve(A − λI)x = 0. These orthonormal eigenvectors go into an orthogonal matrix Q, withQTQ = I and QT = Q−1.Then S−1AS = Λ becomes special—it is Q−1AQ = Λ orA = QΛQ−1 = QΛQT. We can state one of the great theorems of linear algebra:5O A real symmetric matrix can be factored into A = QΛQT. Its orthonormaleigenvectors are in the orthogonal matrix Q and its eigenvalues are in Λ.In geometry or mechanics, this is the principal axis theorem. It gives the right choiceof axes for an ellipse. Those axes are perpendicular, and they point along the eigen-vectors of the corresponding matrix. (Section 6.2 connects symmetric matrices to n-dimensional ellipses.) In mechanics the eigenvectors give the principal directions, alongwhich there is pure compression or pure tension—with no shear.In mathematics the formula A = QΛQT is known as the spectral theorem. If wemultiply columns by rows, the matrix A becomes a combination of one-dimensionalprojections—which are the special matrices xxT of rank 1, multiplied by λ:A = QΛQT =Our 2 by 2 example has eigenvalues 3 and 1:Example 3. A == combination of two projections.The eigenvectors, with length scaled to 1, areThen the matrices on the right-hand side are x1xTthey are projections onto the line through x1 and the line through x2.All symmetric matrices are combinations of one-dimensional projections—which aresymmetric matrices of rank 1.",eigenvec_val
"u = eλtx; the eigenvalue gives the rate of growth or decay, and the eigenvector x developsat this rate. The other solutions will be mixtures of these pure solutions, and the mixtureis adjusted to ﬁt the initial conditions.The key equation was Ax = λx. Most vectors x will not satisfy such an equation.They change direction when multiplied by A, so that Ax is not a multiple of x. Thismeans that only certain special numbers are eigenvalues, and only certain specialvectors x are eigenvectors. We can watch the behavior of each eigenvector, and thencombine these “normal modes” to ﬁnd the solution. To say the same thing in anotherway, the underlying matrix can be diagonalized.The diagonalization in Section 5.2 will be applied to difference equations, Fibonaccinumbers, and Markov processes, and also to differential equations. In every example,we start by computing the eigenvalues and eigenvectors; there is no shortcut to avoidthat. Symmetric matrices are especially easy. “Defective matrices” lack a full set ofeigenvectors, so they are not diagonalizable. Certainly they have to be discussed, but wewill not allow them to take over the book.We start with examples of particularly good matrices.Example 1. Everything is clear when A is a diagonal matrix:On each eigenvector A acts like a multiple of the identity: Ax1 = 3x1 and Ax2 = 2x2.Other vectors like x = (1,5) are mixtures x1 +5x2 of the two eigenvectors, and when Amultiplies x1 and x2 it produces the eigenvalues λ1 = 3 and λ2 = 2:This is Ax for a typical vector x—not an eigenvector. But the action of A is determinedby its eigenvectors and eigenvalues.Example 2. The eigenvalues of a projection matrix are 1 or 0!We have λ = 1 when x projects to itself, and λ = 0 when x projects to the zero vector.The column space of P is ﬁlled with eigenvectors, and so is the nullspace. If those spaceshave dimension r and n −r, then λ = 1 is repeated r times and λ = 0 is repeated n −rtimes (always n λ’s):1 0 0 00 0 0 00 0 0 00 0 0 1",eigenvec_val
"6.5 The Finite Element Methodidea is simple, the applications can be complicated. For problems on this scale, the oneundebatable point is their cost—I am afraid a billion dollars would be a conservativeestimate of the expense so far. I hope some readers will be vigorous enough to masterthe ﬁnite element method and put it to good use.Starting from the classical Rayleigh-Ritz principle, I will introduce the new idea of ﬁniteelements. The equation can be −u′′ = f(x) with boundary conditions u(0) = u(1) =0. This problem is inﬁnite-dimensional (the vector b is replaced by a function f, andthe matrix A becomes −d2/dx2). We can write down the energy whose minimum isrequired, replacing inner products vT f by integrals of v(x)f(x):2vTAv−vT f = 1P(v) is to be minimized over all functions v(x) that satisfy v(0) = v(1) = 0. The functionthat gives the minimum will be the solution u(x). The differential equation has beenconverted to a minimum principle, and it only remains to integrate by parts:The term vv′ is zero at both limits, because v is. Now� (v′(x))2dx is positive like xTAx.We are guaranteed a minimum.To compute the minimum exactly is equivalent to solving the differential equation ex-actly. The Rayleigh-Ritz principle produces an n-dimensional problem by choosing onlyn trial functions V1(x),...,Vn(x). From all combinations V = y1V1(x) + ··· + ynVn(x),we look for the particular combination (call it U) that minimizes P(V). This is the keyidea, to minimize over a subspace of V’s instead of over all possible v(x). The functionthat gives the minimum is U(x). We hope and expect that U(x) is near the correct u(x).Substituting V for v, the quadratic turns intoThe trial functions V are chosen in advance. That is the key step! The unknownsy1,...,yn go into a vector y. Then P(V) = 12yTAy − yTb is recognized as one of thequadratics we are accustomed to. The matrix entries Aij arejdx = coefﬁcient ofyiy j. The components b j are� Vj fdx. We can certainly ﬁnd the minimum of 1by solving Ay = b. Therefore the Rayleigh-Ritz method has three steps:1. Choose the trial functions V1,...,Vn.2. Compute the coefﬁcients Aij and b j.",pos_def_matrices
"Chapter 8 Linear Programming and Game Theory(b) Project c = (5,4,8) onto the nullspace of A = [1 1 1], and ﬁnd the maximumstep s that keeps e−sPc nonnegative.Elimination can solve Ax = b, but the four fundamental subspaces showed that a differentand deeper understanding is possible. It is exactly the same for linear programming. Themechanics of the simplex method will solve a linear program, but duality is really at thecenter of the underlying theory. Introducing the dual problem is an elegant idea, andat the same time fundamental for the applications. We shall explain as much as weThe theory begins with the given primal problem:Minimize cx, subject to x ≥ 0 and Ax ≥ b.The dual problem starts from the same A, b, and c, and reverses everything. In theprimal, c is in the cost function and b is in the constraint, In the dual, b and c areswitched, The dual unknown y is a row vector with m components, and the feasible sethas yA ≤ c instead of Ax ≥ b.In short, the dual of a minimum problem is a maximum problem. Now y ≥ 0:Maximize yb, subject to y ≥ 0 and yA ≤ c.The dual of this problem is the original minimum problem. There is complete symmetrybetween the primal and dual problems. The simplex method applies equally well to amaximization—anyway, both problems get solved at once.I have to give you some interpretation of all these reversals. They conceal a competi-tion between the minimizer and the maximizer. In the diet problem, the minimizer has nfoods (peanut butter and steak, in Section 8.1). They enter the diet in the (nonnegative)amounts x1,...,xn. The constraints represent m required vitamins, in place of the oneearlier constraint of sufﬁcient protein. The entry aij measures the ith vitamin in the jthfood, and the ith row of Ax ≥ b forces the diet to include at least bi of that vitamin. If ciis the cost of the jth food, then c1x1 +···+cnxn = cx is the cost of the diet. That cost isIn the dual, the druggist is selling vitamin pills at prices yi ≥ 0. Since food jcontains vitamins in the amounts aij, the druggist’s price for the vitamin equivalentcannot exceed the grocer’s price c j. That is the jth constraint in yA ≤ c. Working withinthis constraint on vitamin prices, the druggist can sell the required amount bi of eachvitamin for a total income of y1b1 +···+ymbm = yb—to be maximized.The feasible sets for the primal and dual problems look completely different. Theﬁrst is a subset of Rn, marked out by x ≥ 0 and Ax ≥ b. The second is a subset of Rm,",linear_prog
"1.7 Special Matrices and Applicationsto approach zero. The difference ∆u can be forward, backward, or centered:The last is symmetric about x and it is the most accurate. For the second derivative thereis just one combination that uses only the values at x and x±h:This also has the merit of being symmetric about x. To repeat, the right-hand side ap-proaches the true value of d2u/dx2 as h → 0, but we have to stop at a positive h.At each meshpoint x = jh, the equation −d2u/dx2 = f(x) is replaced by its discreteanalogue (5). We multiplied through by h2 to reach n equations Au = b:−u j+1 +2u j −u j−1 = h2 f(jh)for j = 1,...,n.The ﬁrst and last equations (j = 1 and j = n) include u0 = 0 and un+1 = 0, which areknown from the boundary conditions. These values would be shifted to the right-handside of the equation if they were not zero. The structure of these n equations (5) can bebetter visualized in matrix form. We choose h = 16, to get a 5 by 5 matrix A:From now on, we will work with equation (6). It has a very regular coefﬁcient matrix,whose order n can be very large. The matrix A possesses many special properties, andthree of those properties are fundamental:1. The matrix A is tridiagonal. All nonzero entries lie on the main diagonal and thetwo adjacent diagonals. Outside this band all entries are aij = 0. These zeros willbring a tremendous simpliﬁcation to Gaussian elimination.2. The matrix is symmetric. Each entry aij equals its mirror image a ji, so that AT = A.The upper triangular U will be the transpose of the lower triangular L, and A =LDLT. This symmetry of A reﬂects the symmetry of d2u/dx2. An odd derivativelike du/dx or d3u/dx3 would destroy the symmetry.3. The matrix is positive deﬁnite. This extra property says that the pivots are positive.Row exchanges are unnecessary in theory and in practice. This is in contrast to thematrix B at the end of this section, which is not positive deﬁnite. Without a rowexchange it is totally vulnerable to roundoff.Positive deﬁniteness brings this whole course together (in Chapter 6)!",gauss elim
"Chapter 7 Computations with MatricesA single Gauss-Seidel step takes the components vk and wk into2vk+1 = wk +b12wk+1 = vk +b2,The eigenvalues of S−1T are 14 and 0. The error is divided by 4 every time, so a sin-gle Gauss-Seidel step is worth two Jacobi steps. Since both methods require the samenumber of operations—we just use the new value instead of the old, and actually saveon storage—the Gauss-Seidel method is better.This rule holds in many applications, even though there are examples in which Jacobiconverges and Gauss-Seidel fails (or conversely). The symmetric case is straightfor-ward: When all aii > 0, Gauss-Seidel converges if and only if A is positive deﬁnite.It was discovered during the years of hand computation (probably by accident) thatconvergence is faster if we go beyond the Gauss-Seidel correction xk+1 − xk. Roughlyspeaking, those approximations stay on the same side of the solution x. An overrelax-ation factor ω moves us closer to the solution. With ω = 1, we recover Gauss-Seidel;with ω > 1, the method is known as successive overrelaxation (SOR). The optimalchoice of ω never exceeds 2. It is often in the neighborhood of 1.9.To describe overrelaxation, let D, L, and U be the parts of A on, below, and abovethe diagonal, respectively. (This splitting has nothing to do with the A = LDU of elim-ination. In fact we now have A = L + D +U.) The Jacobi method has S = D on theleft-hand side and T = −L −U on the right-hand side. Gauss-Seidel chose S = D + Land T = −U. To accelerate the convergence, we move to[D+ωL]xk+1 = [(1−ω)D−ωU]xk +ωb.Regardless of ω, the matrix on the left is lower triangular and the one on the right isupper triangular. Therefore xk+1 can still replace xk, component by component, as soonas it is computed. A typical step isaii(xi)k+1 = aii(xi)k +ω[(−ai1x1 −···−aii−1xi−1)k+1 +(−aiixi −···−ainxn)k +bi].If the old guess xk happened to coincide with the true solution x, then the new guess xk+1would stay the same, and the quantity in brackets would vanish.Example 3 (SOR). For the same A =, each overrelaxation step isIf we divide by ω, these two matrices are the S and T in the splitting AS−T; the iterationis back to Sxk+1 = Txk +b. The crucial matrix L = S−1T is2ω(1−ω) 1−ω + 1",computations
"Chapter 7 Computations with Matricesa ﬁnite number of steps (n3/3 for a full matrix, less than that for the large matrices weactually meet), Often that number is reasonable. When it is enormous, we may have tosettle for an approximate x that can be obtained more quickly—and it is no use to gopart way through elimination and then stop.Our goal is to describe methods that start from any initial guess x0, and produce animproved approximation xk+1 from the previous xk. We can stop when we want to.An iterative method is easy to invent, by splitting the matrix A. If A = S − T, thenthe equation Ax = b is the same as Sx = Tx+b. Therefore we can tryIteration from xk to xk+1Sxk+1 = Txk +b.There is no guarantee that this method is any good. A successful splitting S−T satisﬁes1. The new vector xk+1 should be easy to compute. Therefore S should be a simple(and invertible!) matrix; it may be diagonal or triangular.2. The sequence xk should converge to the true solution x. If we subtract the iterationin equation (1) from the true equation Sx = Tx+b, the result is a formula involvingonly the errors ek = x−xk:This is just a difference equation. It starts with the initial error e0, and after k stepsit produces the new error ek = (S−1T)ke0. The question of convergence is exactlythe same as the question of stability: xk → x exactly when ek → 0.The iterative method in equation (1) is convergent if and only if everyeigenvalue of S−1T satisﬁes |λ| < 1. Its rate of convergence depends on themaximum size of |λ|:Remember that a typical solution to ek+1 = S−1Tek is a combination of eigenvectors:Error after k stepsek = c1λ kThe largest |λi| will eventually be dominant, so the spectral radius ρ = |λmax| will governthe rate at which ek converges to zero. We certainly need ρ < 1.Requirements 1 and 2 above are conﬂicting. We could achieve immediate conver-gence with S = A and T = 0; the ﬁrst and only step of the iteration would be Ax1 = b. Inthat case the error matrix S−1T is zero, its eigenvalues and spectral radius are zero, andthe rate of convergence (usually deﬁned as −logρ) is inﬁnite. But Ax1 = b may be hardto solve; that was the reason for a splitting. A simple choice of S can often succeed, andwe start with three possibilities:",computations
"Chapter 6 Positive Deﬁnite MatricesFigure 6.2: The ellipse xTAx = 5u2 +8uv+5v2 = 1 and its principal axes.λ = 1 and λ = 9 are outside the squares. The eigenvectors are inside. This is differentfrom completing the square to 5(u+ 45v2, with the pivots outside.The ﬁrst square equals 1 at (1/2) at the end of the major axis. The minoraxis is one-third as long, since we need (13)2 to cancel the 9.Any ellipsoid xTAx = 1 can be simpliﬁed in the same way. The key step is to diago-nalize A = QΛQT. We straightened the picture by rotating the axes. Algebraically, thechange to y = QTx produces a sum of squares:xTAx = (xTQ)Λ(QTx) = yTΛy = λ1y2The major axis has y1 = 1/λ1 along the eigenvector with the smallest eigenvalue.The other axes are along the other eigenvectors. Their lengths are 1/Notice that the λ’s must be positive—the matrix must be positive deﬁnite—or thesesquare roots are in trouble. An indeﬁnite equation y22 = 1 describes a hyperbolaand not an ellipse. A hyperbola is a cross-section through a saddle, and an ellipse is across-section through a bowl.The change from x to y = QTx rotates the axes of the space, to match the axes ofthe ellipsoid. In the y variables we can see that it is an ellipsoid, because the equationSuppose A = QΛQT with λi > 0. Rotating y = QTx simpliﬁes xTAx = 1:This is the equation of an ellipsoid. Its axes have lengths 1/from the center. In the original x-space they point along the eigenvectors of A.",pos_def_matrices
"The same λi will appear in several blocks, if it has several independent eigen-vectors. Two matrices are similar if and only if they share the same JordanMany authors have made this theorem the climax of their linear algebra course.Frankly, I think that is a mistake. It is certainly true that not all matrices are diagonaliz-able, and the Jordan form is the most general case. For that very reason, its constructionis both technical and extremely unstable. (A slight change in A can put back all themissing eigenvectors, and remove the off-diagonal is.) Therefore the right place for thedetails is in the appendix, and the best way to start on the Jordan form is to look at somespeciﬁc and manageable examples.Example 4. T =all lead to J =These four matrices have eigenvalues 1 and 1 with only one eigenvector—so J con-sists of one block. We now check that. The determinants all equal 1. The traces (thesums down the main diagonal) are 2. The eigenvalues satisfy 1·1 = 1 and 1+1 = 2. ForT, B, and J, which are triangular, the eigenvalues are on the diagonal. We want to showthat these matrices are similar—they all belong to the same family.(T) From T to J, the job is to change 2 to 1. and a diagonal M will do it:(B) From B to J, the job is to transpose the matrix. A permutation does that:(A) From A to J, we go ﬁrst to T as in equation (4). Then change 2 to 1:Example 5. A =Zero is a triple eigenvalue for A and B, so it will appear in all their Jordan blocks. Therecan be a single 3 by 3 block, or a 2 by 2 and a 1 by I block, or three I by I blocks. ThenA and B have three possible Jordan forms:",eigenvec_val
"33. Using MATLAB, ﬁnd the largest determinant of a 4 by 4 matrix of 0s and 1s.34. If you know that detA = 6, what is the determinant of B?35. Suppose the 4 by 4 matrix M has four equal rows all containing a, b, c, d. We knowthat det(M) = 0. The problem is to ﬁnd det(I +M) by any method:Partial credit if you ﬁnd this determinant when a = b = c = d = 1. Sudden death ifyou say that det(I +M) = detI +detM.Formulas for the DeterminantThe ﬁrst formula has already appeared. Row operations produce the pivots in D:4A If A is invertible, then PA = LDU and detP = ±1. The product rule givesdetA = ±detLdetDdetU = ±(product of the pivots).The sign ±1 depends on whether the number of row exchanges is even or odd.The triangular factors have detL = detU = 1 and detD = d1···dn.In the 2 by 2 case, the standard LDU factorization isThe product of the pivots is ad − bc. That is the determinant of the diagonal matrix D.If the ﬁrst step is a row exchange, the pivots are c and (−detA)/c.Example 1. The −1,2,−1 second difference matrix has pivots 2/1,3/2,... in D:= LDU = L",determinants
"Chapter 5 Eigenvalues and EigenvectorsIf λ1 > 1, (I −A)−1 fails to be nonnegative.If λ1 = 1, (I −A)−1 fails to exist.If λ1 < 1, (I −A)−1 is a converging sum of nonnegative matrices:(I −A)−1 = I +A+A2 +A3 +··· .The 3 by 3 example has λ1 = .9, and output exceeds input. Production can go on.Those are easy to prove, once we know the main fact about a nonnegative matrix likeA: Not only is the largest eigenvalue λ1 positive, but so is the eigenvector x1. Then(I −A)−1 has the same eigenvector, with eigenvalue 1/(1−λ1).If λ1 exceeds 1, that last number is negative. The matrix (I − A)−1 will take thepositive vector x1 to a negative vector x1/(1 − λ1). In that case (I − A)−1 is deﬁnitelynot nonnegative. If λ1 = 1, then I −A is singular. The productive case is λ1 < 1, whenthe powers of A go to zero (stability) and the inﬁnite series I + A + A2 + ··· converges.Multiplying this series by I −A leaves the identity matrix—all higher powers cancel—so(I −A)−1 is a sum of nonnegative matrices, We give two examples:has λ1 = 2 and the economy is losthas λ1 = 12 and we can produce anything.The matrices (I −A)−1 in those two cases are −1Leontief’s inspiration was to ﬁnd a model that uses genuine data from the real econ-omy. The table for 1958 contained 83 industries in the United States, with a “trans-actions table” of consumption and production for each one. The theory also reachesbeyond (I −A)−1, to decide natural prices and questions of optimization. Normally la-bor is in limited supply and ought to be minimized. And, of course, the economy is notExample 3 (The prices in a closed input-output model ).The model is called “closed” when everything produced is also consumed. Nothing goesoutside the system. In that case A goes back to a Markov matrix. The columns add upto 1. We might be talking about the value of steel and food and labor, instead of thenumber of units, The vector p represents prices instead of production levels.Suppose p0 is a vector of prices. Then Ap0 multiplies prices by amounts to give thevalue of each product. That is a new set of prices which the system uses for the nextset of values A2p0. The question is whether the prices approach equilibrium. Are thereprices such that p = Ap, and does the system take us there?You recognize p as the (nonnegative) eigenvector of the Markov matrix A, with λ = 1.It is the steady state p∞, and it is approached from any starting point p0. By repeating atransaction over and over, the price tends to equilibrium.",eigenvec_val
"Chapter 2 Vector Spaces1. Linear independence or dependence.2. Spanning a subspace.3. Basis for a subspace (a set of vectors).4. Dimension of a subspace (a number).The ﬁrst step is to deﬁne linear independence. Given a set of vectors v1,...,vk, welook at their combinations c1v1 + c2v2 + ··· + ckvk. The trivial combination, with allweights ci = 0, obviously produces the zero vector: 0v1 +···+0vk = 0. The question iswhether this is the only way to produce zero. If so, the vectors are independent.If any other combination of the vectors gives zero, they are dependent.2E Suppose c1v1 +···+ckvk = 0 only happens when c1 = ··· = ck = 0. Thenthe vectors v1,...,vk are linearly independent. If any c’s are nonzero, the v’sare linearly dependent. One vector is a combination of the others.Linear dependence is easy to visualize in three-dimensional space, when all vectorsgo out from the origin. Two vectors are dependent if they lie on the same line. Threevectors are dependent if they lie in the same plane. A random choice of three vectors,without any special accident, should produce linear independence (not in a plane). Fourvectors are always linearly dependent in R3.Example 1. If v1 = zero vector, then the set is linearly dependent. We may choosec1 = 3 and all other ci = 0; this is a nontrivial combination that produces zero.Example 2. The columns of the matrix−1 −3 3 0are linearly dependent, since the second column is three times the ﬁrst. The combinationof columns with weights −3, 1, 0, 0 gives a column of zeros.The rows are also linearly dependent; row 3 is two times row 2 minus ﬁve times row1. (This is the same as the combination of b1, b2, b3, that had to vanish on the right-handside in order for Ax = b to be consistent. Unless b3 −2b2 +5b1 = 0, the third equationwould not become 0 = 0.)Example 3. The columns of this triangular matrix are linearly independent:No zeros on the diagonal",vector spaces
"Chapter 5 Eigenvalues and EigenvectorsThe most important special case is when r = 1. Then a + ib is eiθ = cosθ + isinθ. Itfalls on the unit circle in the complex plane. As θ varies from 0 to 2π, this number eiθcircles around zero at the constant radial distance |eiθ| =cos2 θ +sin2θ = 1.Example 1. x = 3+4i times its conjugate x = 3−4i is the absolute value squared:xx = (3+4i)(3−4i) = 25 = |x|2r = |x| = 5.To divide by 3+4i, multiply numerator and denominator by its conjugate 3−4i:In polar coordinates, multiplication and division are easy:reiθ times Reiα has absolute value rR and angle θ +α.reiθ divided by Reiα has absolute value r/R and angle θ −α.Lengths and Transposes in the Complex CaseWe return to linear algebra, and make the conversion from real to complex. By deﬁnition,the complex vector space Cn contains all vectors x with n complex components:x j = a j +ibj.Vectors x and y are still added component by component. Scalar multiplication cx isnow done with complex numbers c. The vectors v1,...,vk are linearly dependent ifsome nontrivial combination gives c1v1 + ... + ckvk = 0; the c j may now be complex.The unit coordinate vectors are still in Cn; they are still independent; and they still forma basis. Therefore Cn is a complex vector space of dimension n.In the new deﬁnition of length, each x2j is replaced by its modulus |x j|2:∥x∥2 = |x1|2 +···+|xn|2.Example 2. x =For real vectors there was a close connection between the length and the inner product:∥x∥2 = xTx. This connection we want to preserve. The inner product must be modiﬁedto match the new deﬁnition of length, and we conjugate the ﬁrst vector in the innerproduct. Replacing x by x, the inner product becomesxTy = x1y1 +···+xnyn.",eigenvec_val
"This chapter begins the “second half” of linear algebra. The ﬁrst half was about Ax =b. The new problem Ax = λx will still be solved by simplifying a matrix—making itdiagonal if possible. The basic step is no longer to subtract a multiple of one row fromanother: Elimination changes the eigenvalues, which we don’t want.Determinants give a transition from Ax = b to Ax = λx. In both cases the determinantleads to a “formal solution”: to Cramer’s rule for x = A−1b, and to the polynomialdet(A − λI), whose roots will be the eigenvalues. (All matrices are now square; theeigenvalues of a rectangular matrix make no more sense than its determinant.) Thedeterminant can actually be used if n = 2 or 3. For large n, computing λ is more difﬁcultthan solving Ax = b.The ﬁrst step is to understand how eigenvalues can be useful, One of their applicationsis to ordinary differential equations. We shall not assume that the reader is an expert ondifferential equations! If you can differentiate xn, sinx, and ex, you know enough. As aspeciﬁc example, consider the coupled pair of equationsThis is an initial-value problem. The unknown is speciﬁed at time t = 0 by the giveninitial values 8 and 5. The problem is to ﬁnd v(t) and w(t) for later times t > 0.It is easy to write the system in matrix form. Let the unknown vector be u(t), withinitial value u(0). The coefﬁcient matrix is A:The two coupled equations become the vector equation we want:u = u(0) at t = 0.",eigenvec_val
"Chapter 6 Positive Deﬁnite Matrices21. Removing zero rows of U leaves A = LU, where the r columns or L span the columnspace of A and the r rows of U span the row space. Then A+ has the explicit formulaWhy is A+b in the row space with UT at the front? Why does ATAA+b = ATb, sothat x+ = A+b satisﬁes the normal equation as it should?22. Explain why AA+ and A+A are projection matrices (and therefore symmetric). Whatfundamental subspaces do they project onto?In this section we escape for the ﬁrst time from linear equations. The unknown x will notbe given as the solution to Ax = b or Ax = λx. Instead, the vector x will be determinedby a minimum principle.It is astonishing how many natural laws can be expressed as minimum principles. Justthe fact that heavy liquids sink to the bottom is a consequence of minimizing their po-tential energy. And when you sit on a chair or lie on a bed, the springs adjust themselvesso that the energy is minimized. A straw in a glass of water looks bent because lightreaches your eye as quickly as possible. Certainly there are more highbrow examples:The fundamental principle of structural engineering is the minimization of total energy.1We have to say immediately that these “energies” are nothing but positive deﬁnitequadratic functions. And the derivative of a quadratic is linear. We get back to thefamiliar linear equations, when we set the ﬁrst derivatives to zero. Our ﬁrst goal inthis section is to ﬁnd the minimum principle that is equivalent to Ax = b, and theminimization equivalent to Ax = λx. We will be doing in ﬁnite dimensions exactlywhat the theory of optimization does in a continuous problem, where “ﬁrst derivatives= 0” gives a differential equation. In every problem, we are free to solve the linearequation or minimize the quadratic.The ﬁrst step is straightforward: We want to ﬁnd the “parabola” P(x) whose minimumoccurs when Ax = b. If A is just a scalar, that is easy to do:has zero slope whendx = Ax−b = 0.This point x = A−1b will be a minimum if A is positive. Then the parabola P(x) opensupward (Figure 6.4). In more dimensions this parabola turns into a parabolic bowl (aparaboloid). To assure a minimum of P(x), not a maximum or a saddle point, A must be1I am convinced that plants and people also develop in accordance with minimum principles. Perhaps civilizationis based on a law of least action. There must be new laws (and minimum principles) to be found in the socialsciences and life sciences.",pos_def_matrices
"3.1 Orthogonal Vectors and Subspacesequations can be written out as rows of A multiplying x:The main point is already in the ﬁrst equation: row 1 is orthogonal to x. Their innerproduct is zero; that is equation 1. Every right-hand side is zero, so x is orthogonal toevery row. Therefore x is orthogonal to every combination of the rows. Each x in thenullspace is orthogonal to each vector in the row space, so N(A)⊥C(AT).The other pair of orthogonal subspaces comes from ATy = 0, or yTA = 0:The vector y is orthogonal to every column. The equation says so, from the zeros onthe right-hand side. Therefore y is orthogonal to every combination of the columns.It is orthogonal to the column space, and it is a typical vector in the left nullspace:N(AT)⊥C(A). This is the same as the ﬁrst half of the theorem, with A replaced bySecond Proof. The contrast with this “coordinate-free proof” should be useful to thereader. It shows a more “abstract” method of reasoning. I wish I knew which proof isclearer, and more permanently understood.If x is in the nullspace then Ax = 0. If v is in the row space, it is a combination of therows: v = ATz for some vector z. Now, in one line:Nullspace ⊥ Row spacevTx = (ATz)Tx = zTAx = zT0 = 0.Example 3. Suppose A has rank 1, so its row space and column space are lines:The rows are multiples of (1,3). The nullspace contains x = (−3,1), which is orthogonalto all the rows. The nullspace and row space are perpendicular lines in R2:",orthogonality
"10. Construct a homogeneous equation in three unknowns whose solutions are the linearcombinations of the vectors (1,1,2) and (1,2,3). This is the reverse of the previousexercise, but the two problems are really the same.11. The fundamental theorem is often stated in the form of Fredholm’s alternative: Forany A and b, one and only one of the following systems has a solution:(i) Ax = b.(ii) ATy = 0, yTb ̸= 0.Either b is in the column space C(A) or there is a y in N(AT) such that yTb ̸= 0.Show that it is contradictory for (i) and (ii) both to have solutions.12. Find a basis for the orthogonal complement of the row space of A:Split x = (3,3,3) into a row space component xr and a nullspace component xn.13. Illustrate the action of AT by a picture corresponding to Figure 3.4, sending C(A)back to the row space and the left nullspace to zero.14. Show that x−y is orthogonal to x+y if and only if ∥x∥ = ∥y∥.15. Find a matrix whose row space contains (1,2,1) and whose nullspace contains (1,−2,1),or prove that there is no such matrix.16. Find all vectors that are perpendicular to (1,4,4,1) and (2,9,8,2).17. If V is the orthogonal complement of W in Rn, is there a matrix with row space Vand nullspace W? Starting with a basis for V, construct such a matrix.18. If S = {0} is the subspace of R4 containing only the zero vector, what is S⊥? If S isspanned by (0,0,0,1), what is S⊥? What is (S⊥)⊥?19. Why are these statements false?(a) If V is orthogonal to W, then V⊥ is orthogonal to W⊥.(b) V orthogonal to W and W orthogonal to Z makes V orthogonal to Z.20. Let S be a subspace of Rn. Explain what (S⊥)⊥ = S means and why it is true.21. Let P be the plane in R2 with equation x + 2y − z = 0. Find a vector perpendicularto P. What matrix has the plane P as its nullspace, and what matrix has P as its row22. Let S be the subspace of R4 containing all vectors with x1 +x2 +x3 +x4 = 0. Find abasis for the space S⊥, containing all vectors orthogonal to S.",orthogonality
"7.3 Computation of Eigenvalues26. Find the LU factorization of A =. On your computer, solve by eliminationwhen ε = 10−3,10−6,10−9,10−12,10−15:The true x is (1,1). Make a table to show the error for each ε. Exchange the twoequations and solve again—the errors should almost disappear.There is no one best way to ﬁnd the eigenvalues of a matrix. But there are certainlysome terrible ways which should never be tried, and also some ideas that do deserve apermanent place. We begin by describing one very rough and ready approach, the powermethod, whose convergence properties are easy to understand. We added a graphicanimation (with sound) to the course page web.mit.edu/18.06, to show the power methodWe move steadily toward a more sophisticated algorithm, which starts by making asymmetric matrix tridiagonal and ends by making it virtually diagonal. That second stepis done by repeating Gram-Schmidt, so it is known as the QR method.The ordinary power method operates on the principle of a difference equation. Itstarts with an initial guess u0 and then successively forms u1 = Au0, u2 = Au1, andin general uk+1 = Auk. Each step is a matrix-vector multiplication. After k steps itproduces uk = Aku0, although the matrix Ak will never appear. The essential thing isthat multiplication by A should be easy—if the matrix is large, it had better be sparse—because convergence to the eigenvector is often very slow. Assuming A has a full set ofeigenvectors x1,...,xn, the vector uk will be given by the usual formula:Eigenvectors weighted by λ kuk = c1λ kSuppose the largest eigenvalue λn is all by itself; there is no other eigenvalue of the samemagnitude, and |λ1| ≤ ··· ≤ |λn−1| < |λn|. Then as long as the initial guess u0 containedsome component of the eigenvector xn, so that cn ̸= 0, this component will graduallyThe vectors uk point more and more accurately toward the direction of xn. Their conver-gence factor is the ratio r = |λn−1|/|λn|. It is just like convergence to a steady state, fora Markov matrix, except now λn may not equal 1. The scaling factor λ kn in equation (1)prevents uk from growing very large or very small, in case |λn| > 1 or |λn| < 1.",computations
"3.3 Projections and Least SquaresBoth columns end with a zero, so C(A) is the x-y plane within three-dimensional spaceThe projection of b = (4,5,6) is p = (4,5,0)—the x and y components stay the samebut z = 6 will disappear. That is conﬁrmed by solving the normal equations:�x = (ATA)−1ATb =p = A�x =In this special case, the best we can do is to solve the ﬁrst two equations of Ax = b. Then�x1 = 2 and �x2 = 1. The error in the equation 0x1 +0x2 = 6 is sure to be 6.Remark 4. Suppose b is actually in the column space of A—it is a combination b = Axof the columns. Then the projection of b is still b:b in column spacep = A(ATA)−1ATAx = Ax = b.The closest point p is just b itself—which is obvious.Remark 5. At the other extreme, suppose b is perpendicular to every column, so ATb =0. In this case b projects to the zero vector:b in left nullspacep = A(ATA)−1ATb = A(ATA)−10 = 0.Remark 6. When A is square and invertible, the column space is the whole space. Everyvector projects to itself, p equals b, and �x = x:If A is invertiblep = A(ATA)−1ATb = AA−1(AT)−1ATb = b.This is the only case when we can take apart (ATA)−1, and write it as A−1(AT)−1. WhenA is rectangular that is not possible.Remark 7. Suppose A has only one column, containing a. Then the matrix ATA is thenumber aTa and �x is aTb/aTa. We return to the earlier formula.The Cross-Product Matrix ATAThe matrix ATA is certainly symmetric. Its transpose is (ATA)T = ATATT, which is ATAagain. Its i, j entry (and j, i entry) is the inner product of column i of A with column jof A. The key question is the invertibility of ATA, and fortunately",orthogonality
"2.4 The Four Fundamental Subspacesobvious. It also says something about square matrices: If the rows of a square matrixare linearly independent, then so are the columns (and vice versa). Again, that does notseem self-evident (at least, not to the author).To see once more that both the row and column spaces of U have dimension r, con-sider a typical situation with rank r = 3. The echelon matrix U certainly has threeWe claim that U also has three independent columns, and no more, The columns haveonly three nonzero components. If we can show that the pivot columns—the ﬁrst, fourth,and sixth—are linearly independent, they must be a basis (for the column space of U,not A!). Suppose a combination of these pivot columns produced zero:Working upward in the usual way, c3 must be zero because the pivot d3 ̸= 0, then c2 mustbe zero because d2 ̸= 0, and ﬁnally c1 = 0. This establishes independence and completesthe proof. Since Ax = 0 if and only if Ux = 0, the ﬁrst, fourth, and sixth columns of A—whatever the original matrix A was, which we do not even know in this example—are aThe row space and column space both became clear after elimination on A. Nowcomes the fourth fundamental subspace, which has been keeping quietly out of sight.Since the ﬁrst three spaces were C(A), N(A), and C(AT), the fourth space must beN(AT), It is the nullspace of the transpose, or the left nullspace of A. ATy = 0 meansyTA = 0, and the vector appears on the left-hand side of A.4. The left nullspace of A (= the nullspace of AT) If A is an m by n matrix, thenAT is n by m. Its nullspace is a subspace of Rm; the vector y has m components. Writtenas yTA = 0, those components multiply the rows of A to produce the zero row:The dimension of this nullspace N(AT) is easy to ﬁnd, For any matrix, the numberof pivot variables plus the number of free variables must match the total number ofcolumns. For A, that was r +(n−r) = n. In other words, rank plus nullity equals n:dimension of C(A)+dimension of N(A) = number of columns.",vector spaces
"Matrices and Gaussian EliminationThis book begins with the central problem of linear algebra: solving linear equations.The most important ease, and the simplest, is when the number of unknowns equals thenumber of equations. We have n equations in n unknowns, starting with n = 2:1x + 2y =Two unknowns 4x + 5y = 6.The unknowns are x and y. I want to describe two ways, elimination and determinants,to solve these equations. Certainly x and y are determined by the numbers 1, 2, 3, 4, 5,6. The question is how to use those six numbers to solve the system.1. Elimination Subtract 4 times the ﬁrst equation from the second equation. Thiseliminates x from the second equation. and it leaves one equation for y:Immediately we know y = 2. Then x comes from the ﬁrst equation 1x+2y = 3:Proceeding carefully, we cheek that x and y also solve the second equation. Thisshould work and it does: 4 times (x = −1) plus 5 times (y = 2) equals 6.2. Determinants The solution y = 2 depends completely on those six numbers in theequations. There most be a formula for y (and also x) It is a “ratio of determinants”and I hope you will allow me to write it down directly:",gauss elim
"Chapter 1 Matrices and Gaussian Elimination18. Under what conditions on their entries are A and B invertible?19. Compute the symmetric LDLT factorization of20. Find the inverse of21. (Remarkable) If A and B are square matrices, show that I −BA is invertible if I −ABis invertible. Start from B(I −AB) = (1−BA)B.22. Find the inverses (directly or from the 2 by 2 formula) of A, B, C:23. Solve for the columns of A−1 =24. Show that [1 23 6] has no inverse by trying to solve for the column (x,y):25. (Important) If A has row 1 + row 2 = row 3, show that A is not invertible:(a) Explain why Ax = (1,0,0) cannot have a solution.(b) Which right-hand sides (b1,b2,b3) might allow a solution to Ax = b?(c) What happens to row 3 in elimination?26. If A has column 1 + column 2 = column 3, show that A is not invertible:",gauss elim
"8.2 The Simplex Methodvectors meet all of the m + n conditions. In other words, x lies in the intersection ofm + n halfspaces. This feasible set has ﬂat sides; it may be unbounded. and it may beThe cost function cx brings to the problem a family of parallel planes. One planecx = 0 goes through the origin. The planes cx = constant give all possible costs. Asthe cost varies, these planes sweep out the whole n-dimensional space. The optimal x∗(lowest cost) occurs at the point where the planes ﬁrst touch the feasible set.Our aim is to compute x∗. We could do it (in principle) by ﬁnding all the cornersof the feasible set, and computing their costs. In practice this is impossible. Therecould be billions of corners, and we cannot compute them all. Instead we turn to thesimplex method, one of the most celebrated ideas in computational mathematics. It wasdeveloped by Dantzig as a systematic way to solve linear programs, and either by luckor genius it is an astonishing success. The steps of the simplex method are summarizedlater, and ﬁrst we try to explain them.The Geometry: Movement Along EdgesI think it is the geometric explanation that gives the method away. Phase I simply locatesone corner of the feasible set. The heart of the method goes from corner to corneralong the edges of the feasible set. At a typical corner there are n edges to choose from.Some edges lead away from the optimal but unknown x∗, and others lead graduallytoward it. Dantzig chose an edge that leads to a new corner with a lower cost. Thereis no possibility of returning to anything more expensive. Eventually a special corner isreached, from which all edges go the wrong way: The cost has been minimized. Thatcorner is the optimal vector x∗, and the method stops.The next problem is to turn the ideas of corner and edge into linear algebra. A corneris the meeting point of n different planes. Each plane is given by one equation—justas three planes (front wall, side wall, and ﬂoor) produce a corner in three dimensions.Each corner of the feasible set comes from turning n of the n + m inequalities Ax ≥ band x ≥ 0 into equations, and ﬁnding the intersection of these n planes.One possibility is to choose the n equations x1 = 0,...,xn = 0, and end up at theorigin. Like all the other possible choices, this intersection point will only be a genuinecorner if it also satisﬁes the m remaining inequality constraints. Otherwise it is not evenin the feasible set, and is a complete fake. Our example with n = 2 variables and m = 2constraints has six intersections, illustrated in Figure 8.3. Three of them are actuallycorners P, Q, R of the feasible set. They are the vectors (0,6), (2,2), and (6,0), Oneof them must be the optimal vector (unless the minimum cost is −∞). The other three,including the origin, are fakes.In general there are (n+m)!/n!m! possible intersections. That counts the number ofways to choose n plane equations out of n + m. The size of that binomial coefﬁcientmakes computing all corners totally impractical for large m and n. It is the task of Phase",linear_prog
"5.3 Difference Equations and Powers AkExample 1. This matrix A is certainly stable:has eigenvalues 0 and 1The λ’s are on the main diagonal because A is triangular. Starting from any u0, andfollowing the rule uk+1 = Auk, the solution must eventually approach zero:The larger eigenvalue λ = 12 governs the decay; after the ﬁrst step every uk is 1real effect of the ﬁrst step is to split u0 into the two eigenvectors of A:Positive Matrices and Applications in EconomicsBy developing the Markov ideas we can ﬁnd a small gold mine (entirely optional) ofmatrix applications in economics.Example 2 (Leontief’s input-output matrix).This is one of the ﬁrst great successes of mathematical economics. To illustrate it, weconstruct a consumption matrix—in which aij, gives the amount of product j that isneeded to create one unit of product i:The ﬁrst question is: Can we produce y1 units of steel, y2 units of food, and y3 units oflabor? We must start with larger amounts p1, p2, p3, because some part is consumedby the production itself. The amount consumed is Ap, and it leaves a net production ofTo ﬁnd a vector p such thatp = (I −A)−1y.On the surface, we are only asking if I −A is invertible. But there is a nonnegative twistto the problem. Demand and production, y and p, are nonnegative. Since p is (1−A)−1y,the real question is about the matrix that multiplies y:When is (I −A)−1 a nonnegative matrix?Roughly speaking, A cannot be too large. If production consumes too much, nothing isleft as output. The key is in the largest eigenvalue λ1 of A, which must be below 1:",eigenvec_val
"1q1 = 1, we have found x1 = qT1b. Similarly the second coefﬁcient is x2 = qTthat term survives when we multiply by qT2. The other terms die of orthogonality. Eachpiece of b has a simple formula, and recombining the pieces gives back b:Every vector b is equal to (qTI can’t resist putting this orthonormal basis into a square matrix Q. The vector equa-tion x1q1 +···+xnqn = b is identical to Qx = b. (The columns of Q multiply the compo-nents of x.) Its solution is x = Q−1b. But since Q−1 = QT—this is where orthonormalityenters—the solution is also x = QTb:x = QTb =The components of x are the inner products qTi b, as in equation (4).The matrix form also shows what happens when the columns are not orthonormal.Expressing b as a combination x1a1 +···+xnan is the same as solving Ax = b. The basisvectors go into the columns of A. In that case we need A−1, which takes work. In theorthonormal case we only need QT.Remark 1. The ratio aTb/aTa appeared earlier, when we projected b onto a line. Here ais q1, the denominator is 1, and the projection is (qT1b)q1. Thus we have a new interpre-tation for formula (4): Every vector b is the sum of its one-dimensional projections ontothe lines through the q’s.Since those projections are orthogonal, Pythagoras should still be correct. The squareof the hypotenuse should still be the sum of squares of the components:Remark 2. Since QT = Q−1, we also have QQT = I. When Q comes before QT, mul-tiplication takes the inner products of the rows of Q. (For QTQ it was the columns.)Since the result is again the identity matrix, we come to a surprising conclusion: Therows of a square matrix are orthonormal whenever the columns are. The rows pointin completely different directions from the columns, and I don’t see geometrically whythey are forced to be orthonormal—but they are.Rectangular Matrices with Orthogonal ColumnsThis chapter is about Ax = b, when A is not necessarily square. For Qx = b we nowadmit the same possibility—there may be more rows than columns. The n orthonormal",orthogonality
"6.3 Singular Value DecompositionFigure 6.3: The pseudoinverse A+ inverts A where it can on the column space.The row space of A is the column space of A+. Here is a formula for A+:If A = UΣV T (the SVD), then its pseudoinverse is A+ = VΣ+UT.Example 6 had σ = 3—the square root of the eigenvalue of AAT = [9]. Here it is againwith Σ and Σ+:= UΣV T =The minimum length least-squares solution is x+ = A+b = VΣ+UTb.Proof. Multiplication by the orthogonal matrix UT leaves lengths unchanged:∥Ax−b∥ = ∥UΣV Tx−b∥ = ∥ΣV Tx−UTb∥.Introduce the new unknown y = V Tx = V −1x, which has the same length as x. Then,minimizing ∥Ax−b∥ is the same as minimizing ∥Σy−UTb∥. Now Σ is diagonal and weknow the best y+. It is y+ = Σ+UTb so the best x+ is Vy+:x+ = Vy+ = VΣ+UTb = A+b.Vy+ is in the row space, and ATAx+ = ATb from the SVD.",pos_def_matrices
"2. The determinant changes sign when two rows are exchanged.����� = cb−ad = −The determinant of every permutation matrix is detP = ±1. By row exchanges, we canturn P into the identity matrix. Each row exchange switches the sign of the determinant,until we reach detI = 1. Now come all other matrices!3. The determinant depends linearly on the ﬁrst row. Suppose A, B, C are the samefrom the second row down—and row 1 of A is a linear combination of the ﬁrst rows ofB and C. Then the rule says: detA is the same combination of detB and detC.Linear combinations involve two operations—adding vectors and multiplying by scalars.Therefore this rule can be split into two parts:Add vectors in row 1Multiply by t in row 1Notice that the ﬁrst part is not the false statement det(B+C) = detB+detC. You cannotadd all the rows: only one row is allowed to change. Both sides give the answer ad +The second part is not the false statement det(tA) = t detA. The matrix tA has a factort in every row (and the determinant is multiplied by tn). It is like the volume of a box,when all sides are stretched by 4. In n dimensions the volume and determinant go up by4n. If only one side is stretched, the volume and determinant go up by 4; that is rule 3.By rule 2, there is nothing special about the ﬁrst row.The determinant is now settled, but that fact is not at all obvious. Therefore we grad-ually use these rules to ﬁnd the determinant of any matrix.4. If two rows of A are equal, then detA = 0.����� = ab−ba = 0.This follows from rule 2, since if the equal rows are exchanged, the determinant is sup-posed to change sign. But it also has to stay the same, because the matrix stays the same.The only number which can do that is zero, so detA = 0. (The reasoning fails if 1 = −1,which is the case in Boolean algebra. Then rule 4 should replace rule 2 as one of the",determinants
"e = b − pp = projection of bonto line through aFigure 3.5: The projection p is the point (on the line through a) closest to b.point p is the projection of b onto the subspace. A perpendicular line from b to S meetsthe subspace at p. Geometrically, that gives the distance between points b and subspacesS. But there are two questions that need to be asked:1. Does this projection actually arise in practical applications?2. If we have a basis for the subspace S, is there a formula for the projection p?The answers are certainly yes. This is exactly the problem of the least-squares solu-tion to an overdetermined system. The vector b represents the data from experimentsor questionnaires, and it contains too many errors to be found in the subspace S. Whenwe try to write b as a combination of the basis vectors for S, it cannot be done—theequations are inconsistent, and Ax = b has no solution.The least-squares method selects p as the best choice to replace b. There can be nodoubt of the importance of this application. In economics and statistics, least squaresenters regression analysis. In geodesy, the U.S. mapping survey tackled 2.5 millionequations in 400,000 unknowns.A formula for p is easy when the subspace is a line. We will project b onto a in severaldifferent ways, and relate the projection p to inner products and angles. Projection onto ahigher dimensional subspace is by far the most important case; it corresponds to a least-squares problem with several parameters, and it is solved in Section 3.3. The formulasare even simpler when we produce an orthogonal basis for S.inner products and cosinesWe pick up the discussion of inner products and angles. You will soon see that it is notthe angle, but the cosine of the angle, that is directly related to inner products. We lookback to trigonometry in the two-dimensional case to ﬁnd that relationship. Suppose thevectors a and b make angles α and β with the x-axis (Figure 3.6). The length ∥a∥ is thehypotenuse in the triangle OaQ. So the sine and cosine of α are",orthogonality
"Chapter 2 Vector Spaces(b) Show also that the column space of A2 is contained in the column space of A.1.31 When does the rank-1 matrix A = uvT have A2 = 0?1.32 (a) Find a basis for the space of all vectors in R6 with x1 +x2 = x3 +x4 = x5 +x6.(b) Find a matrix with that subspace as its nullspace.(c) Find a matrix with that subspace as its column space.1.33 Suppose the matrices in PA = LU are0 1 0 01 0 0 00 0 0 10 0 1 02 −1 5 −1 51 0 0 00 1 0 01 1 1 02 1 0 1(a) What is the rank of A?(b) What is a basis for the row space of A?(c) True or false: Rows 1, 2, 3 of A are linearly independent.(d) What is a basis for the column space of A?(e) What is the dimension of the left nullspace of A?(f) What is the general solution to Ax = 0?",vector spaces
"5.4 Differential Equations and eAtHere is the fundamental formula of this section: SeΛtS−1u(0) solves the differentialequation, just as SΛkS−1u0 solved the difference equation:There are two more things to be done with this example. One is to complete themathematics, by giving a direct deﬁnition of the exponential of a matrix. The otheris to give a physical interpretation of the equation and its solution. It is the kind ofdifferential equation that has useful applications.The exponential of a diagonal matrix Λ is easy; eΛt just has the n numbers eλt onthe diagonal. For a general matrix A, the natural idea is to imitate the power seriesex = 1+x+x2/2!+x3/3!+···. If we replace x by At and 1 by I, this sum is an n by neAt = I +At + (At)2The series always converges, and its sum eAt has the right properties:dt (eAt) = AeAt.From the last one, u(t) = eAtu(0) solves the differential equation. This solution mustbe the same as the form SeΛtS−1u(0) used for computation. To prove directly that thosesolutions agree, remember that each power (SΛS−1)k telescopes into Ak = SΛkS−1 (be-cause S−1 cancels S). The whole exponential is diagonalized by S:eAt = I +SΛS−1t + SΛ2S−1t2I +Λt + (Λt)2Example 1. In equation (1), the exponential of A =eAt = SeΛtS−1 =At t = 0 we get e0 = I. The inﬁnite series eAt gives the answer for all t, but a series can behard to compute. The form SeΛtS−1 gives the same answer when A can be diagonalized;it requires n independent eigenvectors in S. This simpler form leads to a combination ofn exponentials eλtx—which is the best solution of all:",eigenvec_val
"Chapter 2 Vector Spacesspan, and they are independent. So they form a basis. Notice again that a vector spacedoes not have a unique basis.Figure 2.4: A spanning set v1, v2, v3. Bases v1, v2 and v1, v3 and v2, v3.Example 9. These four columns span the column space of U, but they are not indepen-1 3 3 20 0 3 10 0 0 0There are many possibilities for a basis, but we propose a speciﬁc choice: The columnsthat contain pivots (in this case the ﬁrst and third, which correspond to the basic vari-ables) are a basis for the column space. These columns are independent, and it is easyto see that they span the space. In fact, the column space of U is just the x-y planewithin R3. C(U) is not the same as the column space C(A) before elimination—but thenumber of independent columns didn’t change.To summarize: The columns of any matrix span its column space. If they are indepen-dent, they are a basis for the column space—whether the matrix is square or rectangular.If we are asking the columns to be a basis for the whole space Rn, then the matrix mustbe square and invertible.Dimension of a Vector SpaceA space has inﬁnitely many different bases, but there is something common to all ofthese choices. The number of basis vectors is a property of the space itself:Any two bases for a vector space V contain the same number of vec-tors. This number, which is shared by all bases and expresses the number of“degrees of freedom” of the space, is the dimension of V.We have to prove this fact: All possible bases contain the same number of vectors.The x-y plane in Figure 2.4 has two vectors in every basis; its dimension is 2. In three",vector spaces
"3. The cost of producing t books like this one is nearly linear, b =C+Dt, with editingand typesetting in C and then printing and binding in D. C is the set-up cost and Dis the cost for each additional book.How to compute C and D? If there is no experimental error, then two measurementsof b will determine the line b = C + Dt. But if there is error, we must be prepared to“average” the experiments and ﬁnd an optimal line. That line is not to be confused withthe line through a on which b was projected in the previous section! In fact, since thereare two unknowns C and D to be determined, we now project onto a two-dimensionalsubspace. A perfect experiment would give a perfect C and D:This is an overdetermined system, with m equations and only two unknowns. If errorsare present, it will have no solution. A has two columns, and x = (C,D):The best solution (�C, �D) is the �x that minimizes the squared error E2:E2 = ∥b−Ax∥2 = (b1 −C −Dt1)2 +···+(bm −C −Dtm)2.The vector p = A�x is as close as possible to b. Of all straight lines b = C + Dt, we arechoosing the one that best ﬁts the data (Figure 3.9). On the graph, the errors are thevertical distances b−C −Dt to the straight line (not perpendicular distances!). It is thevertical distances that are squared, summed, and minimized.Example 2. Three measurements b1, b2, b3 are marked on Figure 3.9a:Note that the values t = −1,1,2 are not required to be equally spaced. The ﬁrst step isto write the equations that would hold if a line could go through all three points. Thenevery C +Dt would agree exactly with b:C + 2D = 3",orthogonality
"Chapter 1 Matrices and Gaussian Elimination25. When zero appears in a pivot position, A = LU is not possible! (We need nonzeropivots d, f, i in U.) Show directly why these are both impossible:26. Which number c leads to zero in the second pivot position? A row exchange isneeded and A = LU is not possible. Which c produces zero in the third pivot position?Then a row exchange can’t help and elimination fails:27. What are L and D for this matrix A? What is U in A = LU and what is the new U in28. A and B are symmetric across the diagonal (because 4 = 4). Find their triple factor-izations LDU and say how U is related to L for these symmetric matrices:29. (Recommended) Compute L and U for the symmetric matrixa a a aa b b ba b c dFind four conditions on a, b, c, d to get A = LU with four pivots.30. Find L and U for the nonsymmetric matrixa b c dFind the four conditions on a, b, c, d, r, s, t to get A = LU with four pivots.",gauss elim
"5.4 Differential Equations and eAtFigure 5.1: A model of diffusion between four segments.We are back to a ﬁrst-order system. The problem can be solved two ways. In a courseon differential equations, you would substitute y = eλt into y′′′ −3y′′ +2y′ = 0:(λ 3 −3λ 2 +2λ)eλt = 0λ(λ −1)(λ −2)eλt = 0.The three pure exponential solutions are y = e0t, y = et, and y = e2t. No eigenvectors areinvolved. In a linear algebra course, we ﬁnd the eigenvalues of A:�� = −λ 3 +3λ 2 −2λ = 0.Equations (10) and (11) are the same! The same three exponents appear: λ = 0, λ = 1,and λ = 2. This is a general rule which makes the two methods consistent; the growthrates of the solutions stay ﬁxed when the equations change form. It seems to us thatsolving the third-order equation is quicker.The physical signiﬁcance of du/dt =u is easy to explain and at the sametime genuinely important. This differential equation describes a process of diffusion.Divide an inﬁnite pipe into four segments (Figure 5.1). At time t = 0, the middle seg-ments contain concentrations v(0) and w(0) of a chemical. At each time t, the diffusionrate between two adjacent segments is the difference in concentrations. Within eachsegment, the concentration remains uniform (zero in the inﬁnite segments). The processis continuous in time but discrete in space; the unknowns are v(t) and w(t) in the twoinner segments S1 and S2.The concentration v(t) in S1 is changing in two ways. There is diffusion into S0, andinto or out of S2. The net rate of change is dv/dt, and dw/dt is similar:Flow rate into S1Flow rate into S2This law of diffusion exactly matches our example du/dt = Au:The eigenvalues −1 and −3 will govern the solution. They give the rate at which theconcentrations decay, and λ1 is the more important because only an exceptional set of",eigenvec_val
"Figure 3.4: The true action Ax = A(xrow +xnull) of any m by n matrix.is carried to the zero vector. Every Ax is in the column space. Nothing is carried to theleft nullspace. The real action is between the row space and column space, and you seeit by looking at a typical vector x. It has a “row space component” and a “nullspacecomponent,” with x = xr +xn. When multiplied by A, this is Ax = Axr +Axn:The nullspace component goes to zero: Axn = 0.The row space component goes to the column space: Axr = Ax.Of course everything goes to the column space—the matrix cannot do anything else. Itried to make the row and column spaces the same size, with equal dimension r.From the row space to the column space, A is actually invertible. Everyvector b in the column space comes from exactly one vector xr in the rowProof. Every b in the column space is a combination Ax of the columns. In fact, b isAxr, with xr in the row space, since the nullspace component gives Axn = 0, If anotherr in the row space gives Ax′r = b, then A(xr −x′r) = b−b = 0. This puts xr −x′in the nullspace and the row space, which makes it orthogonal to itself. Therefore it iszero, and xr −x′r. Exactly one vector in the row space is carried to b.Every matrix transforms its row space onto its column space.On those r-dimensional spaces A is invertible. On its nullspace A is zero. When A isdiagonal, you see the invertible submatrix holding the r nonzeros.AT goes in the opposite direction, from Rm to Rn and from C(A) back to C(AT).Of course the transpose is not the inverse! AT moves the spaces correctly, but not the",orthogonality
"2.4 The Four Fundamental Subspaces25. Which subspaces are the same for these matrices of different sizes?Prove that all three matrices have the same rank r.26. If the entries of a 3 by 3 matrix are chosen randomly between 0 and 1, what are themost likely dimensions of the four subspaces? What if the matrix is 3 by 5?27. (Important) A is an m by n matrix of rank r. Suppose there are right-hand sides b forwhich Ax = b has no solution.(a) What inequalities (< or ≤) must be true between m, n, and r?(b) How do you know that ATy = 0 has a nonzero solution?28. Construct a matrix with (1,0,1) and (1,2,0) as a basis for its row space and itscolumn space. Why can’t this be a basis for the row space and nullspace?29. Without computing A, ﬁnd bases for the four fundamental subspaces:1 2 3 40 1 2 30 0 1 230. If you exchange the ﬁrst two rows of a matrix A, which of the four subspaces staythe same? If y = (1,2,3,4) is in the left nullspace of A, write down a vector in theleft nullspace of the new matrix.31. Explain why v = (1,0,−1) cannot be a row of A and also be in the nullspace.32. Describe the four subspaces of R3 associated with33. (Left nullspace) Add the extra column b and reduce A to echelon form:1 2 3 b14 5 6 b27 8 9 b3A combination of the rows of A has produced the zero row. What combination is it?(Look at b3 −2b2 +b1 on the right-hand side.) Which vectors are in the nullspace ofAT and which are in the nullspace of A?",vector spaces
"(a) How do you know that the rows are linearly dependent?(b) Explain why all 120 terms are zero in the big formula for detA.17. Find two ways to choose nonzeros from four different rows and columns:1 0 0 10 1 1 11 1 0 11 0 0 11 0 0 20 3 4 55 4 0 32 0 0 1(B has the same zeros as A.)Is detA equal to 1+1 or 1−1 or −1−1? What is detB?18. Place the smallest number of zeros in a 4 by 4 matrix that will guarantee detA = 0.Place as many zeros as possible while still allowing detA ̸= 0.19. (a) If a11 = a22 = a33 = 0, how many of the six terms in detA will be zero?(b) If a11 = a22 = a33 = a44 = 0, how many of the 24 products a1ja2ka3ℓa4m are sure20. How many 5 by 5 permutation matrices have detP = +1? Those are even permuta-tions. Find one that needs four exchanges to reach the identity matrix.21. If detA ̸= 0, at least one of the n! terms in the big formula (6) is not zero. Deducethat some ordering of the rows of A leaves no zeros on the diagonal. (Don’t use Pfrom elimination; that PA can have zeros on the diagonal.)22. Prove that 4 is the largest determinant for a 3 by 3 matrix of 1s and −1s.23. How many permutations of (1,2,3,4) are even and what are they? Extra credit:What are all the possible 4 by 4 determinants of I +Peven?Problems 24–33 use cofactors Cij = (−1)i+j detMij. Delete row i, column j.24. Find cofactors and then transpose. Multiply CTB by A and B!25. Find the cofactor matrix C and compare ACT with A−1:",determinants
"Chapter 6 Positive Deﬁnite MatricesIf we keep xTAx = 1, then R(x) is a minimum when xTx = ∥x∥2 is as large as possible.We are looking for the point on the ellipsoid xTAx = 1 farthest from the origin—thevector x of greatest length. From our earlier description of the ellipsoid, its longest axispoints along the ﬁrst eigenvector. So R(x) is a minimum at x1.Algebraically, we can diagonalize the symmetric A by an orthogonal matrix: QTAQ =Λ. Then set x = Qy and the quotient becomes simple:The minimum of R is λ1, at the point where y1 = 1 and y2 = ··· = yn = 0:The Rayleigh quotient in equation (11) is never below λ1 and never above λn (the largesteigenvalue). Its minimum is at the eigenvector x1 and its maximum is at xn:Maximum where Axn = λnxnOne small yet important point: The Rayleigh quotient equals a11, when the trial vectoris x = (1,0,...,0). So a11 (on the main diagonal) is between λ1 and λn. You can see thisin Figure 6.6, where the horizontal distance to the ellipse (where a11x2 = 1) is betweenthe shortest distance and the longest distance:λ1 ≤ a11 ≤ λn.The diagonal entries of any symmetric matrix are between λ1 and λn. We drew Figure6.6 for a 2 by 2 positive deﬁnite matrix to see it clearly.Intertwining of the EigenvaluesThe intermediate eigenvectors x2,...,xn−1 are saddle points of the Rayleigh quotient(zero derivatives, but not minima or maxima). The difﬁculty with saddle points is thatwe have no idea whether R(x) is above or below them. That makes the intermediateeigenvalues λ2,...,λn−1 harder to estimate.For this optional topic, the key is to ﬁnd a constrained minimum or maximum. Theconstraints come from the basic property of symmetric matrices: xj is perpendicular toThe minimum of R(x) subject to xTx1 = 0 is λ2. The minimum of R(x)subject to any other constraint xTv = 0 is not above λ2:",pos_def_matrices
"Chapter 2 Vector Spacesvector (1,1,−1) and automatically contains any multiple (c,c,−c):Nullspace is a lineThe nullspace of B is the line of all points x = c, y = c, z = −c. (The line goes throughthe origin, as any subspace must.) We want to be able, for any system Ax = b, to ﬁndC(A) and N(A): all attainable right-hand sides b and all solutions to Ax = 0.The vectors b are in the column space and the vectors x are in the nullspace. We shallcompute the dimensions of those subspaces and a convenient set of vectors to generatethem. We hope to end up by understanding all four of the subspaces that are intimatelyrelated to each other and to A—the column space of A, the nullspace of A, and their two1. Construct a subset of the x-y plane R2 that is(a) closed under vector addition and subtraction, but not scalar multiplication.(b) closed under scalar multiplication but not under vector addition.Hint: Starting with u and v, add and subtract for (a). Try cu and cv for (b).2. Which of the following subsets of R3 are actually subspaces?(a) The plane of vectors (b1,b2,b3) with ﬁrst component b1 = 0.(b) The plane of vectors b with b1 = 1.(c) The vectors b with b2b3 = 0 (this is the union of two subspaces, the plane b2 = 0and the plane b3 = 0).(d) All combinations of two given vectors (1,1,0) and (2,0,1).(e) The plane of vectors (b1,b2,b3) that satisfy b3 −b2 +3b1 = 0.3. Describe the column space and the nullspace of the matrices4. What is the smallest subspace of 3 by 3 matrices that contains all symmetric matricesand all lower triangular matrices? What is the largest subspace that is contained inboth of those subspaces?5. Addition and scalar multiplication are required to satisfy these eight rules:",vector spaces
"Property 3′ Eigenvectors corresponding to different eigenvalues are orthonor-Start with Ux = λ1x and Uy = λ2y, and take inner products by Property 1′:xHy = (Ux)H(Uy) = (λ1x)H(λ2y) = λ 1λ2xHy.Comparing the left to the right, λ 1λ2 = 1 or xHy = 0. But Property 2′ is λ 1λ1 = 1, so wecannot also have λ 1λ2 = 1. Thus xHy = 0 and the eigenvectors are orthogonal.Example 4. U =has eigenvalues eit and e−it.The orthogonal eigenvectors are x = (1,−i) and y = (1,i). (Remember to take conjugatesin xHy = 1+i2 = 0.) After division by2 they are orthonormal.Here is the most important unitary matrix by far.Example 5. U = 1���� = Fourier matrixThe complex number w is on the unit circle at the angle θ = 2π/n. It equals e2πi/n. Itspowers are spaced evenly around the circle. That spacing assures that the sum of all npowers of w—all the nth roots of 1—is zero. Algebraically, the sum 1+w+···+wn−1is (wn −1)/(w−1). And wn −1 is zero!row 1 of UH times column 2 of U is 1n(1+w+w2 +···+wn−1) = wn −1row i of UH times column j of U is 1n(1+W +W 2 +···+W n−1) = W n −1W −1 = 0.In the second case, W = w j−i. Every entry of the original F has absolute value 1. Thefactor √n shrinks the columns of U into unit vectors. The fundamental identity of theﬁnite Fourier transform is UHU = I.Thus U is a unitary matrix. Its inverse looks the same except that w is replaced byw−1 = e−iθ = w. Since U is unitary, its inverse is found by transposing (which changesnothing) and conjugating (which changes w to w). The inverse of this U is U. Ux can becomputed quickly by the Fast Fourier Transform as found in Section 3.5.By Property 1′ of unitary matrices, the length of a vector x is the same as the lengthof Ux. The energy in state space equals the energy in transform space. The energy isthe sum of |x j|2, and it is also the sum of the energies in the separate frequencies. Thevector x = (1,0,...,0) contains equal amounts of every frequency component, and itsDiscrete Fourier Transform Ux = (1,1,...,1)/√n also has length 1.",eigenvec_val
"Chapter 5 Eigenvalues and EigenvectorsIn the differential equation, this produces the special solutions u = eλtx. They are thepure exponential solutions to du/dt = Au. Notice e−t and e2t:u(t) = eλ1tx1 = e−tu(t) = eλ2tx2 = e2tThese two special solutions give the complete solution. They can be multiplied by anynumbers c1 and c2, and they can be added together. When u1 and u2 satisfy the linearequation du/dt = Au, so does their sum u1 +u2:u(t) = c1eλ1tx1 +c2eλ2tx2This is superposition, and it applies to differential equations (homogeneous and linear)just as it applied to matrix equations Ax = 0. The nullspace is always a subspace, andcombinations of solutions are still solutions.Now we have two free parameters c1 and c2, and it is reasonable to hope that they canbe chosen to satisfy the initial condition u = u(0) at t = 0:c1x1 +c2x2 = u(0)The constants are c1 = 3 and c2 = 1, and the solution to the original equation isWriting the two components separately, we have v(0) = 8 and w(0) = 5:v(t) = 3e−t +5e2t,w(t) = 3e−t +2e2t.The key was in the eigenvalues λ and eigenvectors x. Eigenvalues are important inthemselves, and not just part of a trick for ﬁnding u. Probably the homeliest exampleis that of soldiers going over a bridge.1 Traditionally, they stop marching and just walkacross. If they happen to march at a frequency equal to one of the eigenvalues of thebridge, it would begin to oscillate. (Just as a child’s swing does; you soon notice thenatural frequency of a swing, and by matching it you make the swing go higher.) Anengineer tries to keep the natural frequencies of his bridge or rocket away from those ofthe wind or the sloshing of fuel. And at the other extreme, a stockbroker spends his lifetrying to get in line with the natural frequencies of the market. The eigenvalues are themost important feature of practically any dynamical system.To summarize, this introduction has shown how λ and x appear naturally and auto-matically when solving du/dt = Au. Such an equation has pure exponential solutions1One which I never really believed—but a bridge did crash this way in 1831.",eigenvec_val
"1.2 The Geometry of Linear EquationsWe use parentheses and commas when the components are listed horizontally, andsquare brackets (with no commas) when a column vector is printed vertically. Whatreally matters is addition of vectors and multiplication by a scalar (a number). In Figure1.4a you see a vector addition, component by component:In the right-hand ﬁgure there is a multiplication by 2 (and if it had been −2 the vector(a) Add vectors along axescolumns 1 + 2= linear combination equals b(b) Add columns 1 + 2 + (3 + 3)Figure 1.4: The column picture: linear combination of columns equals b.would have gone in the reverse direction):Also in the right-hand ﬁgure is one of the central ideas of linear algebra. It uses bothof the basic operations; vectors are multiplied by numbers and then added. The result iscalled a linear combination, and this combination solves our equation:Equation (2) asked for multipliers u, v, w that produce the right side b. Those numbersare u = 1, v = 1, w = 2. They give the correct combination of the columns. They alsogave the point (1,1,2) in the row picture (where the three planes intersect).",gauss elim
"36. If J is the 5 by 5 Jordan block with λ = 0, ﬁnd J2 and count its eigenvectors, andﬁnd its Jordan form (two blocks).37. The text solved du/dt = Ju for a 3 by 3 Jordan block J. Add a fourth equationdw/dt = 5w+x. Follow the pattern of solutions for z, y, x to ﬁnd w.38. These Jordan matrices have eigenvalues 0, 0, 0, 0. They have two eigenvectors (ﬁndthem). But the block sizes don’t match and J is not similar to K:0 1 0 00 0 0 00 0 0 10 0 0 00 1 0 00 0 1 00 0 0 00 0 0 0For any matrix M, compare JM with MK. If they are equal, show that M is notinvertible. Then M−1JM = K is impossible.39. Prove in three steps that AT is always similar to A (we know that the λ’s are thesame, the eigenvectors are the problem):(a) For A = one block, ﬁnd Mi = permutation so that M−1(b) For A = any J, build M0 from blocks so that M−10 JM0 = JT.(c) For any A = MJM−1: Show that AT is similar to JT and so to J and to A.40. Which pairs are similar? Choose a, b, c, d to prove that the other pairs aren’t:41. True or false, with a good reason:(a) An invertible matrix can’t be similar to a singular matrix.(b) A symmetric matrix can’t be similar to a nonsymmetric matrix.(c) A can’t be similar to −A unless A = 0.(d) A−I can’t be similar to A+I.42. Prove that AB has the same eigenvalues as BA.43. If A is 6 by 4 and B is 4 by 6, AB and BA have different sizes. Nevertheless,(a) What sizes are the blocks of G? They are the same in each matrix.(b) This equation is M−1FM = G, so F and G have the same 10 eigenvalues. F hasthe eigenvalues of AB plus 4 zeros; G has the eigenvalues of BA plus 6 zeros. ABhas the same eigenvalues as BA plus",eigenvec_val
"3.3 Projections and Least SquaresProof. It is easy to see why P2 = P. If we start with any b, then Pb lies in the subspacewe are projecting onto. When we project again nothing is changed. The vector Pb isalready in the subspace, and P(Pb) is still Pb. In other words P2 = P. Two or three orﬁfty projections give the same point p as the ﬁrst projection:P2 = A(ATA)−1ATA(ATA)−1AT = A(ATA)−1AT = P.To prove that P is also symmetric, take its transpose. Multiply the transposes inreverse order, and use symmetry of (ATA)−1, to come back to P:(ATA)−1�TAT = A(ATA)−1AT = P.For the converse, we have to deduce from P2 = P and PT = P that Pb is the projectionof b onto the column space of P. The error vector b − Pb is orthogonal to the space.For any vector Pc in the space, the inner product is zero:(b−Pb)TPc = bT(I −P)TPc = bT(P−P2)c = 0.Thus b−Pb is orthogonal to the space, and Pb is the projection onto the column space.Example 1. Suppose A is actually invertible. If it is 4 by 4, then its four columns areindependent and its column space is all of R4. What is the projection onto the wholespace? It is the identity matrix.P = A(ATA)−1AT = AA−1(AT)−1AT = I.The identity matrix is symmetric, I2 = I, and the error b−Ib is zero.The point of all other examples is that what happened in equation (5) is not allowed.To repeat: We cannot invert the separate parts AT and A when those matrices are rectan-gular. It is the square matrix ATA that is invertible.Least-Squares Fitting of DataSuppose we do a series of experiments, and expect the output b to be a linear functionof the input t. We look for a straight line b = C +Dt. For example:1. At different times we measure the distance to a satellite on its way to Mars. In thiscase t is the time and b is the distance. Unless the motor was left on or gravity isstrong, the satellite should move with nearly constant velocity v: b = b0 +vt.2. We vary the load on a structure, and measure the movement it produces. In thisexperiment t is the load and b is the reading from the strain gauge. Unless the loadis so great that the material becomes plastic, a linear relation b = C +Dt is normalin the theory of elasticity.",orthogonality
"ATA has the same nullspace as A.Certainly if Ax = 0 then ATAx = 0. Vectors x in the nullspace of A are also in thenullspace of ATA. To go in the other direction, start by supposing that ATAx = 0, andtake the inner product with x to show that Ax = 0:The two nullspaces are identical. In particular, if A has independent columns (and onlyx = 0 is in its nullspace), then the same is true for ATA:3M If A has independent columns, then ATA is square, symmetric, and invert-We show later that ATA is also positive deﬁnite (all pivots and eigenvalues are positive).This case is by far the most common and most important. Independence is not sohard in m-dimensional space if m > n. We assume it in what follows.We have shown that the closest point to b is p = A(ATA)−1ATb. This formula expressesin matrix terms the construction of a perpendicular line from b to the column space ofA. The matrix that gives p is a projection matrix, denoted by P:This matrix projects any vector b onto the column space of A.1 In other words, p = Pbis the component of b in the column space, and the error e = b − Pb is the componentin the orthogonal complement. (I −P is also a projection matrix! It projects b onto theorthogonal complement, and the projection is b−Pb.)In short, we have a matrix formula for splitting any b into two perpendicular compo-nents. Pb is in the column space C(A), and the other component (I − P)b is in the leftnullspace N(AT)—which is orthogonal to the column space.These projection matrices can be understood geometrically and algebraically.The projection matrix P = A(ATA)−1AT has two basic properties:(i) It equals its square: P2 = P.(ii) It equals its transpose: PT = P.Conversely, any symmetric matrix with P2 = P represents a projection.1There may be a risk of confusion with permutation matrices, also denoted by P, but the risk should be small,and we try never to let both appear on the same page.",orthogonality
"3.5 The Fast Fourier Transform20. Find the eigenvalues of the “periodic” −1, 2, −1 matrix C. The −1s in the cornersof C make it periodic (a circulant matrix):c0 = 2, c1 = −1, c2 = 0, c3 = −1.21. To multiply C times x, when C = FEF−1, we can multiply F(E(F−1x)) instead. Thedirect Cx uses n2 separate multiplications. Knowing E and F, the second way usesonly nlog2n+n multiplications. How many of those come from E, how many fromF, and how many from F−1?22. How could you quickly compute these four components of Fc starting from c0 +c2,c0 −c2, c1 +c3, c1 −c3? You are ﬁnding the Fast Fourier Transform!c0 +c1 +c2 +c3c0 +ic1 +i2c2 +i3c3c0 +i2c1 +i4c2 +i6c3c0 +i3c1 +i6c2 +i9c33.1 Find the length of a = (2,−2,1), and write two independent vectors that are per-3.2 Find all vectors that are perpendicular to (1,3,1) and (2,7,2), by making those therows of A and solving Ax = 0.3.3 What is the angle between a = (2,−2,1) and b = (1,2,2)?3.4 What is the projection p of b = (1,2,2) onto a = (2,−2,1)?3.5 Find the cosine of the angle between the vectors (3,4) and (4,3),3.6 Where is the projection of b = (1,1,1) onto the plane spanned by (1,0,0) and3.7 The system Ax = b has a solution if and only if b is orthogonal to which of the four3.8 Which straight line gives the best ﬁt to the following data: b = 0 at t = 0, b = 0 att = 1, b = 12 at t = 3?3.9 Construct the projection matrix P onto the space spanned by (1,1,1) and (0,1,3).",orthogonality
"7.3 Computation of EigenvaluesWhen A is symmetric, a very accurate choice is the Rayleigh quotient:αk = R(wk) = wTThis quotient R(x) has a minimum at the true eigenvector x1. Its graph is like the bottomof a parabola, so the error λ1 − αk is roughly the square of the error in the eigenvector.The convergence factors |λ1 − αk|/|λ2 − αk| are themselves converging to zero. Thenthese Rayleigh quotient shifts give cubic convergence of αk to λ1.2Tridiagonal and Hessenberg FormsThe power method is reasonable only for a matrix that is large and sparse. When toomany entries are nonzero, this method is a mistake. Therefore we ask whether there isany simple way to create zeros. That is the goal of the following paragraphs.It should be said that after computing a similar matrix Q−1AQ with more zeros thanA, we do not intend to go back to the power method. There are much more powerfulvariants, and the best of them seems to be the QR algorithm. (The shifted inverse powermethod has its place at the very end, in ﬁnding the eigenvector.) The ﬁrst step is to pro-duce quickly as many zeros as possible, using an orthogonal matrix Q. If A is symmetric,then so is Q−1AQ. No entry can become dangerously large because Q preserves lengths.To go from A to Q−1AQ, there are two main possibilities: We can produce one zero atevery step (as in elimination), or we can work with a whole column at once. For a singlezero, it is easy to use a plane rotation as illustrated in equation (7), found near the endof this section, that has cosθ and sinθ in a 2 by 2 block. Then we could cycle throughall the entries below the diagonal, choosing at each step a rotation θ that will produce azero; this is Jacobi’s method. It fails to diagonalize A after a ﬁnite number of rotations,since the zeros from early steps will be destroyed when later zeros are created.To preserve the zeros and stop, we have to settle for less than a triangular form.The Hessenberg form accepts one nonzero diagonal below the main diagonal. If aHessenberg matrix is symmetric, it only has three nonzero diagonals.A series of rotations in the right planes will produce the required zeros. Householderfound a new way to accomplish exactly the same thing. A Householder transformationis a reﬂection matrix determined by one vector v:H = I −2 vvTOften v is normalized to become a unit vector u = v/∥v∥, and then H becomes I −2uuT.In either case H is both symmetric and orthogonal:HTH = (I −2uuT)(I −2uuT) = I −4uuT +4uuTuuT = I.2Linear convergence means that every step multiplies the error by a ﬁxed factor r < 1. Quadratic convergencemeans that the error is squared at every step, as in Newton’s method xk+1 −xk = −f(xk)/ f ′(xk) for solving f(x) =0. Cubic convergence takes 10−1 to 10−3 to 10−9.",computations
"3.1 Orthogonal Vectors and Subspacesindividual vectors. That honor belongs to A−1 if it exists—and it only exists if r = m = n.We cannot ask A−1 to bring back a whole nullspace out of the zero vector.When A−1 fails to exist, the best substitute is the pseudoinverse A+. This inverts Awhere that is possible: A+Ax = x for x in the row space. On the left nullspace, nothingcan be done: A+y = 0. Thus A+ inverts A where it is invertible, and has the same rank r.One formula for A+ depends on the singular value decomposition—for which we ﬁrstneed to know about eigenvalues.1. Find the lengths and the inner product of x = (1,4,0,2) and y = (2,−2,1,3).2. Give an example in R2 of linearly independent vectors that are not orthogonal. Also,give an example of orthogonal vectors that are not independent.3. Two lines in the plane are perpendicular when the product of their slopes is −1.Apply this to the vectors x = (x1,x2) and y = (y1,y2), whose slopes are x2/x1 andy2/y1, to derive again the orthogonality condition xTy = 0.4. How do we know that the ith row of an invertible matrix B is orthogonal to the jthcolumn of B−1, if i ̸= j?5. Which pairs are orthogonal among the vectors v1, v2, v3, v4?6. Find all vectors in R3 that are orthogonal to (1,1,1) and (1,−1,0). Produce anorthonormal basis from these vectors (mutually orthogonal unit vectors).7. Find a vector x orthogonal to the row space of A, and a vector y orthogonal to thecolumn space, and a vector z orthogonal to the nullspace:8. If V and W are orthogonal subspaces, show that the only vector they have in commonis the zero vector: V∩W = {0}.9. Find the orthogonal complement of the plane spanned by the vectors (1,1,2) and(1,2,3), by taking these to be the rows of A and solving Ax = 0. Remember that thecomplement is a whole line.",orthogonality
"31. Compute the determinants S1, S2, S3 of these 1, 3, 1 tridiagonal matrices:Make a Fibonacci guess for S4 and verify that you are right.32. Cofactors of those 1, 3, 1 matrices give Sn = 3Sn−1 − Sn−2. Challenge: Show thatSn is the Fibonacci number F2n+2 by proving F2n+2 = 3F2n − F2n−2. Keep usingFibonacci’s rule Fk = Fk−1 +Fk−2.33. Change 3 to 2 in the upper left corner of the matrices in Problem 32. Why doesthat subtract Sn−1 from the determinant Sn? Show that the determinants become theFibonacci numbers 2, 5, 13 (always F2n+1).Problems 34–36 are about block matrices and block determinants.34. With 2 by 2 blocks, you cannot always use block determinants!(a) Why is the ﬁrst statement true? Somehow B doesn’t enter.(b) Show by example that equality fails (as shown) when C enters.(c) Show by example that the answer det(AD−CB) is also wrong.35. With block multiplication, A = LU has Ak = LkUk in the upper left corner:(a) Suppose the ﬁrst three pivots of A are 2, 3, −1. What are the determinants of L1,L2, L3 (with diagonal 1s), U1, U2, U3, and A1, A2, A3?(b) If A1, A2, A3 have determinants 5, 6, 7, ﬁnd the three pivots.36. Block elimination subtracts CA−1 times the ﬁrst row [A B] from the second row[C D]. This leaves the Schur complement D−CA−1B in the corner:Take determinants of these matrices to prove correct rules for square blocks:if AC = CA",determinants
"1.3 An Example of Gaussian EliminationAn Example of Gaussian EliminationThe way to understand elimination is by example. We begin in three dimensions:−2u + 7v + 2w =The problem is to ﬁnd the unknown values of u, v, and w, and we shall apply Gaussianelimination. (Gauss is recognized as the greatest of all mathematicians, but certainly notbecause of this invention, which probably took him ten minutes. Ironically, it is the mostfrequently used of all the ideas that bear his name.) The method starts by subtractingmultiples of the ﬁrst equation from the other equations. The goal is to eliminate u fromthe last two equations. This requires that we(a) subtract 2 times the ﬁrst equation from the second(b) subtract −1 times the ﬁrst equation from the third.− 8v − 2w = −128v + 3w =The coefﬁcient 2 is the ﬁrst pivot. Elimination is constantly dividing the pivot into thenumbers underneath it, to ﬁnd out the right multipliers.The pivot for the second stage of elimination is −8. We now ignore the ﬁrst equation.A multiple of the second equation will be subtracted from the remaining equations (inthis case there is only the third one) so as to eliminate v. We add the second equation tothe third or, in other words, we(c) subtract −1 times the second equation from the third.The elimination process is now complete, at least in the “forward” direction:− 8v − 2w = −12This system is solved backward, bottom to top. The last equation gives w = 2. Sub-stituting into the second equation, we ﬁnd v = 1. Then the ﬁrst equation gives u = 1.This process is called back-substitution.To repeat: Forward elimination produced the pivots 2, −8, 1. It subtracted multiplesof each row from the rows beneath, It reached the “triangular” system (3), which issolved in reverse order: Substitute each newly computed value into the equations that",gauss elim
"5.4 Differential Equations and eAt6. The higher order equation y′′ +y = 0 can be written as a ﬁrst-order system by intro-ducing the velocity y′ as another unknown:If this is du/dt = Au, what is the 2 by 2 matrix A? Find its eigenvalues and eigen-vectors, and compute the solution that starts from y(0) = 2, y′(0) = 0.7. Convert y′′ = 0 to a ﬁrst-order system du/dt = Au:This 2 by 2 matrix A has only one eigenvector and cannot be diagonalized. ComputeeAt from the series I +At +··· and write the solution eAtu(0) starting from y(0) = 3,y′(0) = 4. Check that your (y,y′) satisﬁes y′′ = 0.8. Suppose the rabbit population r and the wolf population w are governed bydt = 4r −2wdt = r +w.(a) Is this system stable, neutrally stable, or unstable?(b) If initially r = 300 and w = 200, what are the populations at time t?(c) After a long time, what is the proportion of rabbits to wolves?9. Decide the stability of u′ = Au for the following matrices:10. Decide on the stability or instability of dv/dt = w, dw/dt = v. Is there a solution11. From their trace and determinant, at what time t do the following matrices changebetween stable with real eigenvalues, stable with complex eigenvalues, and unstable?",eigenvec_val
"Chapter 5 Eigenvalues and EigenvectorsI think an example is the best way to explain B = M−1AM. Suppose T is projectiononto the line L at angle θ. This linear transformation is completely described without thehelp of a basis. But to represent T by a matrix, we do need a basis. Figure 5.5 offers twochoices, the standard basis v1 = (1,0), v2 = (0,1) and a basis V1, V2 chosen especiallyFigure 5.5: Change of basis to make the projection matrix diagonal.In fact TV1 = V1 (since V1 is already on the line L) and TV2 = 0 (since V2 is perpen-dicular to the line). In that eigenvector basis, the matrix is diagonal:B = [T]V to V =The other thing is the change of basis matrix M. For that we express V1 as a combinationv1cosθ⊥v2sinθ and put those coefﬁcients into column 1. Similarly V2 (or IV2, thetransformation is the identity) is −v1sinθ +v2cosθ, producing column 2:M = [I]V to v =The inverse matrix M−1 (which is here the transpose) goes from v to V. Combined withB and M, it gives the projection matrix in the standard basis of v’s:A = MBM−1 =We can summarize the main point. The way to simplify that matrix A—in fact to diag-onalize it—is to ﬁnd its eigenvectors. They go into the columns of M (or S) and M−1AMis diagonal. The algebraist says the same thing in the language of linear transformations:Choose a basis consisting of eigenvectors. The standard basis led to A, which was notsimple. The right basis led to B, which was diagonal.We emphasize again that M−1AM does not arise in solving Ax = b. There the basicoperation was to multiply A (on the left side only!) by a matrix that subtracts a multiple",eigenvec_val
"Chapter 1 Matrices and Gaussian Elimination5. With h = 14 and f(x) = 4π2sin2πx, the difference equation (5) isSolve for u1, u2, u3 and ﬁnd their error in comparison with the true solution u =sin2πx at x = 14, x = 12, and x = 36. What 5 by 5 system replaces (6) if the boundary conditions are changed to u(0) = 1,Problems 7–11 are about roundoff error and row exchanges.7. Compute H−1 in two ways for the 3 by 3 Hilbert matrixﬁrst by exact computation and second by rounding off each number to three ﬁgures.This matrix H is ill-conditioned and row exchanges don’t help.8. For the same matrix H, compare the right-hand sides of Hx = b when the solutionsare x = (1,1,1) and x = (0,6,−3.6).9. Solve Hx = b = (1,0,...,0) for the 10 by 10 Hilbert matrix with hij = 1/(i+ j −1),using any computer code for linear equations. Then change an entry of b by .0001and compare the solutions.10. Compare the pivots in direct elimination to those with partial pivoting for(This is actually an example that needs rescaling before elimination.)11. Explain why partial pivoting produces multipliers ℓij in L that satisfy |ℓij| ≤ 1. Canyou construct a 3 by 3 example with all |aij| ≤ 1 whose last pivot is 4? This is theworst possible, since each entry is at most doubled when |ℓij| ≤ 1.1.1 (a) Write down the 3 by 3 matrices with entriesaij = i− j",gauss elim
"7.2 Matrix Norm and Condition Number4. For the positive deﬁnite A =, compute ∥A−1∥ = 1/λ1, ∥A∥ = λ2, and c(A) =λ2/λ1. Find a right-hand side b and a perturbation δb so that the error is the worstpossible, ∥δx∥/∥x∥ = c∥δb∥/∥b∥.5. Show that if λ is any eigenvalue of A, Ax = λx, then |λ| ≤ ∥A∥.6. The matrices in equation (4) have norms between 100 and 101. Why?7. Comparing the eigenvalues of ATA and AAT, prove that ∥A∥ = ∥AT∥.8. For a positive deﬁnite A, the Cholesky decomposition is A = LDLT = RTR, whereDLT. Show directly from equation (12) that the condition number of c(R) isthe square root of c(A). Elimination without row exchanges cannot hurt a positivedeﬁnite matrix, since c(A) = c(RT)c(R).9. Show that max|λ| is not a true norm, by ﬁnding 2 by 2 counterexamples to λmax(A+B) ≤ λmax(A)+λmax(B) and λmax(AB) ≤ λmax(A)λmax(B).10. Show that the eigenvalues of B =are ±σi, the singular values of A. Hint: Try11. (a) Do A and A−1 have the same condition number c?(b) In parallel with the upper bound (8) on the error, prove a lower bound:(Consider A−1b = x instead of Ax = b.)12. Find the norms λmax and condition numbers λmax/λmin of these positive deﬁnite13. Find the norms and condition numbers from the square roots of λmax(ATA) and14. Prove that the condition number ∥A∥∥A−1∥ is at least 1.15. Why is I the only symmetric positive deﬁnite matrix that has λmax = λmin = 1? Thenthe only matrices with ∥A∥ = 1 and ∥A−1∥ = 1 must have ATA = I. They are16. Orthogonal matrices have norm ∥Q∥ = 1. If A = QR, show that ∥A∥ ≤ ∥R∥ and also∥R∥ ≤ ∥A∥. Then ∥A∥ = ∥Q∥∥R∥. Find an example of A = LU with ∥A∥ < ∥L∥∥U∥.",computations
"1.2 The Geometry of Linear EquationsAnother singular system, close to this one, has an inﬁnity of solutions. When the6 in the last equation becomes 7, the three equations combine to give 0 = 0. Now thethird equation is the sum of the ﬁrst two. In that case the three planes have a whole linein common (Figure 1.5c). Changing the right sides will move the planes in Figure 1.5bparallel to themselves, and for b = (2,5,7) the ﬁgure is suddenly different. The lowestplane moved up to meet the others, and there is a line of solutions. Problem 1.5c is stillsingular, but now it suffers from too many solutions instead of too few.The extreme case is three parallel planes. For most right sides there is no solution(Figure 1.5d). For special right sides (like b = (0,0,0)!) there is a whole plane ofsolutions—because the three parallel planes move over to become the same.What happens to the column picture when the system is singular? it has to go wrong;the question is how, There are still three columns on the left side of the equations, andwe try to combine them to produce b. Stay with equation (3):Singular case: Column pictureThree columns in the same planeSolvable only for b in that planeFor b = (2,5,7) this was possible; for b = (2,5,6) it was not. The reason is that thosethree columns lie in a plane. Then every combination is also in the plane (which goesthrough the origin). If the vector b is not in that plane, no solution is possible (Figure1.6). That is by far the most likely event; a singular system generally has no solution.But there is a chance that b does lie in the plane of the columns. In that case there are toomany solutions; the three columns can be combined in inﬁnitely many ways to produceb. That column picture in Figure 1.6b corresponds to the row picture in Figure 1.5c.b not in place(b) inﬁnity of solutionsFigure 1.6: Singular cases: b outside or inside the plane with all three columns.How do we know that the three columns lie in the same plane? One answer is to ﬁnd acombination of the columns that adds to zero. After some calculation, it is u = 3, v = 1,w = −2. Three times column 1 equals column 2 plus twice column 3. Column 1 is in",gauss elim
"Chapter 5 Eigenvalues and Eigenvectorsor matrix powers or eigenvalues—just as elimination steps were natural for Ax = b.Elimination multiplied A on the left by L−1, but not on the right by L. So U is notsimilar to A, and the pivots are not the eigenvalues.A whole family of matrices M−1AM is similar to A, and there are two questions:1. What do these similar matrices M−1AM have in common?2. With a special choice of M, what special form can be achieved by M−1AM?The ﬁnal answer is given by the Jordan form, with which the chapter ends.These combinations M−1AM arise in a differential or difference equation, when a“change of variables” u = Mv introduces the new unknown v:The new matrix in the equation is M−1AM. In the special case M = S, the system isuncoupled because Λ = S−1AS is diagonal. The eigenvectors evolve independently. Thisis the maximum simpliﬁcation, but other M’s are also useful. We try to make M−1AMeasier to work with than A.The family of matrices M−1AM includes A itself, by choosing M = I. Any of thesesimilar matrices can appear in the differential and difference equations, by the changeu = Mv, so they ought to have something in common, and they do: Similar matricesshare the same eigenvalues.Suppose that B = M−1AM. Then A and B have the same eigenvalues.Every eigenvector x of A corresponds to an eigenvector M−1x of B.Start from Ax = λx and substitute A = MBM−1:The eigenvalue of B is still λ. The eigenvector has changed from x to M−1x.We can also check that A−λI and B−λI have the same determinant:B−λI = M−1AM −λI = M−1(A−λI)Mdet(B−λI) = detM−1det(A−λI)detM = det(A−λI).The polynomials det(A − λI) and det(B − λI) are equal. Their roots—the eigenvaluesof A and B—are the same. Here are matrices B similar to A.",eigenvec_val
"3.1 Orthogonal Vectors and Subspaces23. Construct an unsymmetric 2 by 2 matrix of rank 1. Copy Figure 3.4 and put onevector in each subspace. Which vectors are orthogonal?24. Redraw Figure 3.4 for a 3 by 2 matrix of rank r = 2. Which subspace is Z (zerovector only)? The nullspace part of any vector x in R2 is xn =25. Construct a matrix with the required property or say why that is impossible.(a) Column space contains(b) Row space containshas a solution and AT� 1(d) Every row is orthogonal to every column (A is not the zero matrix).(e) The columns add up to a column of 0s, the rows add to a row of 1s.26. If AB = 0 then the columns of B are in theof A. The rows of A are in theof B. Why can’t A and B be 3 by 3 matrices of rank 2?27. (a) If Ax = b has a solution and ATy = 0, then y is perpendicular to(b) If ATy = c has a solution and Ax = 0, then x is perpendicular to28. This is a system of equations Ax = b with no solution:Find numbers y1, y2, y3 to multiply the equations so they add to 0 = 1. You havefound a vector y in which subspace? The inner product yTb is 1.29. In Figure 3.4, how do we know that Axr is equal to Ax? How do we know that thisvector is in the column space? If A =30. If Ax is in the nullspace of AT then Ax = 0. Reason: Ax is also in the. Conclusion: ATA has the same nullspace as A.31. Suppose A is a symmetric matrix (AT = A).(a) Why is its column space perpendicular to its nullspace?(b) If Ax = 0 and Az = 5z, which subspaces contain these “eigenvectors” x and z?Symmetric matrices have perpendicular eigenvectors (see Section 5.5).32. (Recommended) Draw Figure 3.4 to show each subspace for",orthogonality
"The next section will concentrate on solving linear programs. This is the time to describetwo practical situations in which we minimize or maximize a linear cost function subjectSuppose General Motors makes a proﬁt of $200 on eachChevrolet, $300 on each Buick, and $500 on each Cadillac. These get 20, 17, and 14miles per gallon, respectively, and Congress insists that the average car must get 18. Theplant can assemble a Chevrolet in 1 minute, a Buick in 2 minutes, and a Cadillac in 3minutes. What is the maximum proﬁt in 8 hours (480 minutes)?Problem Maximize the proﬁt 200x+300y+500z subject to2. Portfolio Selection. Federal bonds pay 5%, municipals pay 6%, and junk bonds pay9%. We can buy amounts x, y, z not exceeding a total of $100,000. The problem is tomaximize the interest, with two constraints:(i) no more than $20,000 can be invested in junk bonds, and(ii) the portfolio’s average quality must be no lower than municipals, so x ≥ z.Problem Maximize 5x+6y+9z subject toThe three inequalities give three slack variables, with new equations like w = x −z andinequalities w ≥ 0.1. Sketch the feasible set with constraints x + 2y ≥ 6, 2x + y ≥ 6, x ≥ 0, y ≥ 0. Whatpoints lie at the three “corners” of this set?2. (Recommended) On the preceding feasible set, what is the minimum value of thecost function x+y? Draw the line x+y = constant that ﬁrst touches the feasible set.What points minimize the cost functions 3x+y and x−y?3. Show that the feasible set constrained by 2x+5y ≤ 3, −3x+8y ≤ −5, x ≥ 0, y ≥ 0,",linear_prog
"If A is symmetric positive deﬁnite, then P(x) = 12xTAx − xTb reaches itsminimum at the point where Ax = b. At that point Pmin = −1Figure 6.4: The graph of a positive quadratic P(x) is a parabolic bowl.Proof. Suppose Ax = b. For any vector y, we show that P(y) ≥ P(x):(set b = Ax)This can’t be negative since A is positive deﬁnite—and it is zero only if y−x = 0. At allother points P(y) is larger than P(x), so the minimum occurs at x.Example 1. Minimize P(x) = x21 − x1x2 + x22 − b1x1 − b2x2. The usual approach, bycalculus, is to set the partial derivatives to zero. This gives Ax = b:∂P/∂x1 = 2x1 −x2 −b1 = 0∂P/∂x2 = −x1 +2x2 −b2 = 0Linear algebra recognizes this P(x) as 12xTAx−xTb, and knows immediately that Ax = bgives the minimum. Substitute x = A−1b into P(x):2xTAx is the internal energy and −xTb is the external work. The systemautomatically goes to x = A−1b, where the total energy P(x) is a minimum.Many applications add extra equations Cx = d on top of the minimization problem.These equations are constraints. We minimize P(x) subject to the extra requirementCx = d. Usually x can’t satisfy n equations Ax = b and also ℓ extra constraints Cx = d.We have too many equations and we need ℓ more unknowns.",pos_def_matrices
"5.2 Diagonalization of a MatrixDiagonalization of a MatrixWe start right off with the one essential computation. It is perfectly simple and will beused in every section of this chapter. The eigenvectors diagonalize a matrix:Suppose the n by n matrix A has n linearly independent eigenvectors.If these eigenvectors are the columns of a matrix S, then S−1AS is a diagonalmatrix Λ. The eigenvalues of A are on the diagonal of Λ:S−1AS = Λ =We call S the “eigenvector matrix” and Λ the “eigenvalue matrix”—using a capitallambda because of the small lambdas for the eigenvalues on its diagonal.Proof. Put the eigenvectors xi in the columns of S, and compute AS by columns:Then the trick is to split this last matrix into a quite different product SΛ:It is crucial to keep these matrices in the right order. If Λ came before S (instead ofafter), then λ1 would multiply the entries in the ﬁrst row. We want λ1 to appear in theﬁrst column. As it is, SΛ is correct. Therefore,S is invertible, because its columns (the eigenvectors) were assumed to be independent.We add four remarks before giving any examples or applications.Remark 1. If the matrix A has no repeated eigenvalues—the numbers λ1,...,λn aredistinct—then its n eigenvectors are automatically independent (see 5D below). There-fore any matrix with distinct eigenvalues can be diagonalized.Remark 2. The diagonalizing matrix S is not unique. An eigenvector x can be multipliedby a constant, and remains an eigenvector. We can multiply the columns of S by anynonzero constants, and produce a new diagonalizing S. Repeated eigenvalues leave evenmore freedom in S. For the trivial example A = I, any invertible S will do: S−1IS is isalways diagonal (Λ is just I). All vectors are eigenvectors of the identity.",eigenvec_val
"5.2 Diagonalization of a MatrixIf eigenvectors x1,...,xk correspond to different eigenvalues λ1,...,λk,then those eigenvectors are linearly independent.Suppose ﬁrst that k = 2, and that some combination of x1 and x2 produces zero:c1x1 + c2x2 = 0. Multiplying by A, we ﬁnd c1λ1x1 + c2λ2x2 = 0. Subtracting λ2 timesthe previous equation, the vector x2 disappears:c1(λ1 −λ2)x1 = 0.Since λ1 ̸= λ2 and x1 ̸= 0, we are forced into c1 = 0. Similarly c2 = 0, and the twovectors are independent; only the trivial combination gives zero.This same argument extends to any number of eigenvectors: If some combination pro-duces zero, multiply by A, subtract λk times the original combination, and xk disappears—leaving a combination of x1,...,xk−1, which produces zero. By repeating the same steps(this is really mathematical induction) we end up with a multiple of x1 that produceszero. This forces c1 = 0, and ultimately every ci = 0. Therefore eigenvectors that comefrom distinct eigenvalues are automatically independent.A matrix with n distinct eigenvalues can be diagonalized. This is the typical case.The main point of this section is S−1AS = A. The eigenvector matrix S converts A intoits eigenvalue matrix Λ (diagonal). We see this for projections and rotations.Example 1. The projection A =has eigenvalue matrix Λ =vectors go into the columns of S:AS = SΛ =That last equation can be veriﬁed at a glance. Therefore S−1AS = Λ.Example 2. The eigenvalues themselves are not so clear for a rotation:det(K −λI) = λ 2 +1.How can a vector be rotated and still have its direction unchanged? Apparently itcan’t—except for the zero vector, which is useless. But there must be eigenvalues, andwe must be able to solve du/dt = Ku. The characteristic polynomial λ 2 +1 should stillhave two roots—but those roots are not real.You see the way out. The eigenvalues of K are imaginary numbers, λ1 = i and λ2 =−i. The eigenvectors are also not real. Somehow, in turning through 90°, they are",eigenvec_val
"Chapter 2 Vector Spacestold which conditions the vectors in the space must satisfy. (Example: The nullspaceconsists of all vectors that satisfy Ax = 0.)The ﬁrst description may include useless vectors (dependent columns). The seconddescription may include repeated conditions (dependent rows). We can’t write a basisby inspection, and a systematic procedure is necessary.The reader can guess what that procedure will be. When elimination on A producesan echelon matrix U or a reduced R, we will ﬁnd a basis for each of the subspacesassociated with A. Then we have to look at the extreme case of full rank:When the rank is as large as possible, r = n or r = m or r = m = n, the matrix has aleft-inverse B or a right-inverse C or a two-sided A−1.To organize the whole discussion, we take each of the four subspaces in turn. Two ofthem are familiar and two are new.1. The column space of A is denoted by C(A). Its dimension is the rank r.2. The nullspace of A is denoted by N(A). Its dimension is n−r.3. The row space of A is the column space of AT. It is C(AT), and it is spanned by therows of A. Its dimension is also r.4. The left nullspace of A is the nullspace of AT. It contains all vectors y such thatATy = 0, and it is written N(AT). Its dimension isThe point about the last two subspaces is that they come from AT. If A is an m by nmatrix, you can see which “host” spaces contain the four subspaces by looking at theThe nullspace N(A) and row space C(AT) are subspaces of Rn.The left nullspace N(AT) and column space C(A) are subspaces of Rm.The rows have n components and the columns have m. For a simple matrix likeA = U = R =the column space is the line through [10]. The row space is the line through [1 0 0]T. Itis in R3. The nullspace is a plane in R3 and the left nullspace is a line in R2:",vector spaces
"6.1 Minima, Maxima, and Saddle PointsDeﬁnite versus Indeﬁnite: Bowl versus SaddleThe problem comes down to this: For a function of two variables x and y, what is thecorrect replacement for the condition ∂ 2F/∂x2 > 0? With only one variable, the sign ofthe second derivative decides between a minimum or a maximum. Now we have threesecond derivatives: Fxx, Fxy = Fyx, and Fyy. These three numbers (like 4, 4, 2) mustdetermine whether or not F (as well as f) has a minimum.What conditions on a, b, and c ensure that the quadratic f(x,y) = ax2 +2bxy+cy2is positive deﬁnite? One necessary condition is easy:(i) If ax2 +2bxy+cy2 is positive deﬁnite, then necessarily a > 0.We look at x = 1, y = 0, where ax2 + 2bxy + cy2 is equal to a. This must be positive.Translating back to F, that means that ∂ 2F/∂x2 > 0. The graph must go up in the xdirection. Similarly, ﬁx x = 0 and look in the y direction where f(0,y) = cy2:(ii) If f(x,y) is positive deﬁnite, then necessarily c > 0.Do these conditions a > 0 and c > 0 guarantee that f(x,y) is always positive? Theanswer is no. A large cross term 2bxy can pull the graph below zero.Example 1. f(x,y) = x2 −10xy+y2. Here a = 1 and c = 1 are both positive. But f isnot positive deﬁnite, because f(1,1) = −8. The conditions a > 0 and c > 0 ensure thatf(x,y) is positive on the x and y axes. But this function is negative on the line x = y,because b = −10 overwhelms a and c.Example 2. In our original f the coefﬁcient 2b = 4 was positive. Does this ensure aminimum? Again the answer is no; the sign of b is of no importance! Even though itssecond derivatives are positive, 2x2 +4xy+y2 is not positive deﬁnite. Neither F nor fhas a minimum at (0,0) because f(1,−1) = 2−4+1 = −1.It is the size of b, compared to a and c, that must be controlled. We now want anecessary and sufﬁcient condition for positive deﬁniteness. The simplest technique is tof = ax2 +2bxy+cy2 = aThe ﬁrst term on the right is never negative, when the square is multiplied by a > 0.But this square can be zero, and the second term must then be positive. That termhas coefﬁcient (ac − b2)/a. The last requirement for positive deﬁniteness is that thiscoefﬁcient must be positive:(iii) If ax2 +2bxy+cy2 stays positive, then necessarily ac > b2.Test for a minimum:The conditions a > 0 and ac > b2 are just right. They guaranteec > 0. The right side of (2) is positive, and we have found a minimum:",pos_def_matrices
"Chapter 7 Computations with Matricesellipse of all Axcircle ∥x∥ = 1∥A∥ = 1 +∥A∥2 = λmax(ATA) ≈ 2.618∥A−1∥2 = λmin(ATA) ≈ 0.382c(A) = ∥A∥∥A−1∥ ≈ (1.618)2Figure 7.1: The norms of A and A−1 come from the longest and shortest Ax.Note 4. Roundoff error also enters Ax = λx. What is the condition number of the eigen-value problem? The condition number of the diagonalizing S measures the sensitivityof the eigenvalues. If µ is an eigenvalue of A + E, then its distance from one of theeigenvalues of A is|µ −λ| ≤ ∥S∥∥S−1∥∥E∥ = c(S)∥E∥.With orthonormal eigenvectors and S = Q, the eigenvalue problem is perfectly condi-tioned: c(Q) = 1. The change δλ in the eigenvalues is no greater than the change δA.Therefore the best case is when A is symmetric, or more generally when AAT = ATA.Then A is a normal matrix; its diagonalizing S is an orthogonal Q (Section 5.6).If xk is the kth column of S and yk is the kth row of S−1, then λk changes byδλk = ykExk +terms of order ∥E∥2.In practice, ykExk is a realistic estimate of δλ. The idea in every good algorithm is tokeep the error matrix E as small as possible—usually by insisting, as in the next section,on orthogonal matrices at every step of the computation of λ.1. For an orthogonal matrix Q, show that ∥Q∥ = 1 and also c(Q) = 1. Orthogonalmatrices (and their multiples αQ) are the only perfectly conditioned matrices.2. Which “famous” inequality gives ∥(A+B)x∥ ≤ ∥Ax∥+∥Bx∥, and why does it followfrom equation (5) that ∥A+B∥ ≤ ∥A∥+∥B∥?3. Explain why ∥ABx∥ ≤ ∥A∥∥B∥∥x∥, and deduce from equation (5) that ∥AB∥ ≤ ∥A∥∥B∥.Show that this also implies c(AB) ≤ c(A)c(B).",computations
"3.3 Projections and Least SquaresThe optimal �x is the average. The same conclusion comes from ATA�x = ATb. In factATA is a 1 by 1 matrix, and the normal equation is 2�x = b1 +b2.Now suppose the two observations are not trusted to the same degree. The valuex = b1 may be obtained from a more accurate scale—or, in a statistical problem, from alarger sample—than x = b2. Nevertheless, if b2 contains some information, we are notwilling to rely totally on b1. The simplest compromise is to attach different weights w22, and choose the �xW that minimizes the weighted sum of squares:If w1 > w2, more importance is attached to b1. The minimizing process (derivative = 0)tries harder to make (x−b1)2 small:Instead of the average of b1 and b2 (for w1 = w2 = 1), �xW is a weighted average of thedata. This average is closer to b1 than to b2.The ordinary least-squares problem leading to �xW comes from changing Ax = b tothe new system WAx = Wb. This changes the solution from �x to �xW. The matrix W TWturns up on both sides of the weighted normal equations:The least squares solution to WAx = Wb is �xW:(ATW TWA)�xW = ATW TWb.What happens to the picture of b projected to A�x? The projection A�xW is still thepoint in the column space that is closest to b. But the word “closest” has a new meaningwhen the length involves W. The weighted length of x equals the ordinary length of Wx.Perpendicularity no longer means yTx = 0; in the new system the test is (Wy)T(Wx) = 0.The matrix W TW appears in the middle. In this new sense, the projection A�xW and theerror b−A�xW are again perpendicular.That last paragraph describes all inner products: They come from invertible matricesW. They involve only the symmetric combination C = W TW. The inner product of xand y is yTCx. For an orthogonal matrix W = Q, when this combination is C = QTQ = I,the inner product is not new or different. Rotating the space leaves the inner productunchanged. Every other W changes the length and inner product.For any invertible matrix W, these rules deﬁne a new inner product and length:Since W is invertible, no vector is assigned length zero (except the zero vector). Allpossible inner products—which depend linearly on x and y and are positive when x =y ̸= 0—are found in this way, from some matrix C = W TW.",orthogonality
"The product of the ﬁrst k pivots is the determinant of Ak. This is the same rule thatwe know already for the whole matrix. Since the determinant of Ak−1 will be given byd1d2···dk−1, we can isolate each pivot dk as a ratio of determinants:In our example above, the second pivot was exactly this ratio (ad − bc)/a. It is thedeterminant of A2 divided by the determinant of A1. (By convention detA0 = 1, so thatthe ﬁrst pivot is a/1 = a.) Multiplying together all the individual pivots, we recoverFrom equation (5) we can ﬁnally read off the answer to our original question: Thepivot entries are all nonzero whenever the numbers detAk are all nonzero:Elimination can be completed without row exchanges (so P = I and A =LU), if and only if the leading submatrices A1,A2,...,An are all nonsingular.That does it for determinants, except for an optional remark on property 2—the signreversal on row exchanges. The determinant of a permutation matrix P was the onlyquestionable point in the big formula. Independent of the particular row exchanges link-ing P to I, is the number of exchanges always even or always odd? If so, its determinantis well deﬁned by rule 2 as either +1 or −1.Starting from (3,2,1), a single exchange of 3 and 1 would achieve the natural order(1,2,3). So would an exchange of 3 and 2, then 3 and 1, and then 2 and 1. In bothsequences, the number of exchanges is odd. The assertion is that an even number ofexchanges can never produce the natural order beginning with (3,2,1).Here is a proof. Look at each pair of numbers in the permutation, and let N countthe pairs in which the larger number comes ﬁrst. Certainly N = 0 for the natural order(1,2,3). The order (3,2,1) has N = 3 since all pairs (3,2), (3,1), and (2,1) are wrong.We will show that every exchange alters N by an odd number. Then to arrive at N = 0(the natural order) takes a number of exchanges having the same evenness or oddness asWhen neighbors are exchanged, N changes by +1 or −1. Any exchange can beachieved by an odd number of exchanges of neighbors. This will complete the proof;an odd number of odd numbers is odd. To exchange the ﬁrst and fourth entries below,which happen to be 2 and 3, we use ﬁve exchanges (an odd number) of neighbors:(2,1,4,3) → (1,2,4,3) → (1,4,2,3) → (1,4,3,2) → (1,3,4,2) → (3,1,4,2).We need ℓ − k exchanges of neighbors to move the entry in place k to place ℓ. Thenℓ − k − 1 exchanges move the one originally in place ℓ (and now found in place ℓ − 1)back down to place k. Since (ℓ − k) + (ℓ − k − 1) is odd, the proof is complete. Thedeterminant not only has all the properties found earlier, it even exists.",determinants
"����� = λ 2 −(trace)λ +determinantThe eigenvalues are λ = trace±Those two λ’s add up to the trace; Exercise 9 gives ∑λi = trace for all matrices.There is a MATLAB demo (just type eigshow), displaying the eigenvalue problem for a2 by 2 matrix. It starts with the unit vector x = (1,0). The mouse makes this vector movearound the unit circle. At the same time the screen shows Ax, in color and also moving.Possibly Ax is ahead of x. Possibly Ax is behind x. Sometimes Ax is parallel to x. At thatparallel moment, Ax = λx (twice in the second ﬁgure).y = (0, 1)x = (1, 0)Ay = (0.3, 0.7)Ax = (0.8, 0.2)The eigenvalue λ is the length of Ax, when the unit eigenvector x is parallel. Thebuilt-in choices for A illustrate three possibilities: 0, 1, or 2 real eigenvectors.1. There are no real eigenvectors. Ax stays behind or ahead of x. This means theeigenvalues and eigenvectors are complex, as they are for the rotation Q.2. There is only one line of eigenvectors (unusual). The moving directions Ax and xmeet but don’t cross. This happens for the last 2 by 2 matrix below.3. There are eigenvectors in two independent directions. This is typical! Ax crosses xat the ﬁrst eigenvector x1, and it crosses back at the second eigenvector x2.Suppose A is singular (rank 1). Its column space is a line. The vector Ax has to stay onthat line while x circles around. One eigenvector x is along the line. Another eigenvectorappears when Ax2 = 0. Zero is an eigenvalue of a singular matrix.You can mentally follow x and Ax for these six matrices. How many eigenvectors andwhere? When does Ax go clockwise, instead of counterclockwise with x?",eigenvec_val
"1.5 Triangular Factors and Row ExchangesIf d = 0, the problem is incurable and this matrix is singular. There is no hope for aunique solution to Ax = b. If d is not zero, an exchange P13 of rows 1 and 3 will moved into the pivot. However the next pivot position also contains a zero. The number a isnow below it (the e above it is useless). If a is not zero then another row exchange P23 isOne more point: The permutation P23P13 will do both row exchanges at once:If we had known, we could have multiplied A by P in the ﬁrst place. With the rows inthe right order PA, any nonsingular matrix is ready for elimination.Elimination in a Nutshell: PA = LUThe main point is this: If elimination can be completed with the help of row exchanges,then we can imagine that those exchanges are done ﬁrst (by P). The matrix PA will notneed row exchanges. In other words, PA allows the standard factorization into L timesU. The theory of Gaussian elimination can be summarized in a few lines:In the nonsingular case, there is a permutation matrix P that reordersthe rows of A to avoid zeros in the pivot positions. Then Ax = b has a uniqueWith the rows reordered in advance, PA can be factored into LU.In the singular case, no P can produce a full set of pivots: elimination fails.In practice, we also consider a row exchange when the original pivot is near zero—even if it is not exactly zero. Choosing a larger pivot reduces the roundoff error.You have to be careful with L. Suppose elimination subtracts row 1 from row 2,creating ℓ21 = 1. Then suppose it exchanges rows 2 and 3. If that exchange is done inadvance, the multiplier will change to ℓ31 = 1 in PA = LU.",gauss elim
"1.7 Special Matrices and ApplicationsFigure 1.8: A band matrix A and its factors L and U.symmetric A) is P = 13w(w−1)(3n−2w+1). For a full matrix with w = n, we recover3n(n−1)(n+1). This is a whole number, since n−1, n, and n+1 are consecutiveintegers, and one of them is divisible by 3.That is our last operation count, and we emphasize the main point. A ﬁnite-differencematrix like A has a full inverse. In solving Ax = b, we are actually much worse offknowing A−1 than knowing L and U. Multiplying A−1 by b takes n2 steps, whereas 4nare sufﬁcient for the forward elimination and back-substitution that produce x =U−1c =We hope this example reinforced the reader’s understanding of elimination (whichwe now assume to be perfectly understood!). It is a genuine example of the large linearsystems that are actually met in practice. The next chapter turns to the existence and theuniqueness of x, for m equations in n unknowns.In theory the nonsingular case is completed. There is a full set of pivots (with row ex-changes). In practice, more row exchanges may be equally necessary—or the computedsolution can easily become worthless. We will devote two pages (entirely optional inclass) to making elimination more stable—why it is needed and how it is done.For a system of moderate size, say 100 by 100, elimination involves a third of a mil-3n3). With each operation we must expect a roundoff error. Normally,we keep a ﬁxed number of signiﬁcant digits (say three, for an extremely weak computer).Then adding two numbers of different sizes gives an error:loses the digits 2 and 3.How do all these individual errors contribute to the ﬁnal error in Ax = b?This is not an easy problem. It was attacked by John von Neumann, who was theleading mathematician at the time when computers suddenly made a million operationspossible. In fact the combination of Gauss and von Neumann gives the simple elimina-tion algorithm a remarkably distinguished history, although even von Neumann overes-",gauss elim
"Example 2. Integration from 0 to t is also linear (it takes Pn to Pn+1):0 (a0 +···+antn)dt = a0t +···+This time there is no nullspace (except for the zero vector, as always!) but integrationdoes not produce all polynomials in Pn+1. The right side of equation (3) has no constantterm. Probably the constant polynomials will be the left nullspace.Example 3. Multiplication by a ﬁxed polynomial like 2+3t is linear:Ap(t) = (2+3t)(a0 +···+antn) = 2a0 +···+3antn+1.Again this transforms Pn to Pn+1, with no nullspace except p = 0.In these examples (and in almost all examples), linearity is not difﬁcult to verify. Ithardly even seems interesting. If it is there, it is practically impossible to miss. Nev-ertheless, it is the most important property a transformation can have1. Of course mosttransformations are not linear—for example, to square the polynomial (Ap = p2), or toadd 1 (Ap = p+1), or to keep the positive coefﬁcients (A(t −t2) = t). It will be lineartransformations, and only those, that lead us back to matrices.Transformations Represented by MatricesLinearity has a crucial consequence: If we know Ax for each vector in a basis, then weknow Ax for each vector in the entire space. Suppose the basis consists of the n vectorsx1,...,xn. Every other vector x is a combination of those particular vectors (they spanthe space). Then linearity determines Ax:x = c1x1 +···+cnxnThe transformation T(x) = Ax has no freedom left, after it has decided what to do withthe basis vectors. The rest is determined by linearity. The requirement (1) for two vectorsx and y leads to condition (4) for n vectors x1,...,xn. The transformation does have afree hand with the vectors in the basis (they are independent). When those are settled,the transformation of every vector is settled.Example 4. What linear transformation takes x1 and x2 to Ax1 and Ax2?It must be multiplication T(x) = Ax by the matrix1Invertibility is perhaps in second place as an important property.",vector spaces
"Chapter 2 Vector SpacesH = 2P − I =Image + original = 2 × projectionHx + x = 2PxFigure 2.11: Reﬂection through the θ-line: the geometry and the matrix.Of course c2 +s2 = cos2θ +sin2 θ = 1. A projection matrix equals its own square.3. Reﬂection Figure 2.11 shows the reﬂection of (1,0) in the θ-line. The length of thereﬂection equals the length of the original, as it did after rotation—but here the θ-line stays where it is. The perpendicular line reverses direction; all points go straightthrough the mirror, Linearity decides the rest.This matrix H has the remarkable property H2 = I. Two reﬂections bring backthe original. A reﬂection is its own inverse, H = H−1, which is clear from thegeometry but less clear from the matrix. One approach is through the relationship ofreﬂections to projections: H = 2P − I. This means that Hx + x = 2Px—the imageplus the original equals twice the projection. It also conﬁrms that H2 = I:H2 = (2P−I)2 = 4P2 −4P+I = I,Other transformations Ax can increase the length of x; stretching and shearing are inthe exercises. Each example has a matrix to represent it—which is the main point of thissection. But there is also the question of choosing a basis, and we emphasize that thematrix depends on the choice of basis. Suppose the ﬁrst basis vector is on the θ-line andthe second basis vector is perpendicular:(i) The projection matrix is back to P =. This matrix is constructed as always:its ﬁrst column comes from the ﬁrst basis vector (projected to itself). The secondcolumn comes from the basis vector that is projected to zero.",vector spaces
"Chapter 7 Computations with MatricesOften we can just divide each uk by its ﬁrst component αk before taking the next step.With this simple scaling, the power method uk+1 = Auk/αk converges to a multiple ofxn. The scaling factors αk will approach λn.Example 1. The uk approach the eigenvectormatrix of population shifts in Section 1.3:If r = |λn−1|/|λn| is close to 1, then convergence is very slow. In many applicationsr > .9, which means that more than 20 iterations are needed to achieve one more digit.(The example had r = .7, and it was still slow.) If r = 1, which means |λn−1| = |λn|, thenconvergence will probably not occur at all. That happens (in the applet with sound) for acomplex conjugate pair λn−1 = λ n. There are several ways to get around this limitation,and we shall describe three of them:1. The block power method works with several vectors at once, in place of uk. If wemultiply p orthonormal vectors by A, and then apply Gram-Schmidt to orthogonal-ize them again—that is a single step of the method—the convergence ratio becomesr′ = |λn−p|/|λn|. We will obtain approximations to p different eigenvalues and their2. The inverse power method operates with A−1 instead of A. A single step is vk+1 =A−1vk, which means that we solve the linear system Avk+1 = vk (and save the factorsL and U!). Now we converge to the smallest eigenvalue λ1 and its eigenvector x1,provided |λ1| < |λ2|. Often it is λ1 that is wanted in the applications, and theninverse iteration is an automatic choice.3. The shifted inverse power method is best of all. Replace A by A−αI. Each eigen-value is shifted by α, and the convergence factor for the inverse method will changeto r′′ = |λ1 −α|/|λ2 −α|. If α is a good approximation to λ1, r′′ will be very smalland the convergence is enormously accelerated. Each step of the method solvesWhen α is close to λ1, the ﬁrst term dominates after only one or two steps. Ifλ1 has already been computed by another algorithm (such as QR), then α is thiscomputed value. One standard procedure is to factor A − αI into LU and to solveUx1 = (1,1,...,1) by back-substitution.If λ1 is not already approximated, the shifted inverse power method has to generate itsown choice of α. We can vary α = αk at every step if we want to, so (A−αkI)wk+1 = wk.",computations
"3.4 Orthogonal Bases and Gram-SchmidtQ rotates every vector through the angle θ, and QT rotates it back through −θ. Thecolumns are clearly orthogonal, and they are orthonormal because sin2θ + cos2θ = 1.The matrix QT is just as much an orthogonal matrix as Q.Example 2. Any permutation matrix P is an orthogonal matrix. The columns are cer-tainly unit vectors and certainly orthogonal—because the 1 appears in a different placein each column: The transpose is the inverse.P−1 = PT =An anti-diagonal P, with P13 = P22 = P31 = I, takes the x-y-z axes into the z-y-x axes—a “right-handed” system into a “left-handed” system. So we were wrong if we suggestedthat every orthogonal Q represents a rotation. A reﬂection is also allowed. P =reﬂects every point (x,y) into (y,x), its mirror image across the 45° line. Geometrically,an orthogonal Q is the product of a rotation and a reﬂection.There does remain one property that is shared by rotations and reﬂections, and in factby every orthogonal matrix. It is not shared by projections, which are not orthogonal oreven invertible. Projections reduce the length of a vector, whereas orthogonal matriceshave a property that is the most important and most characteristic of all:Multiplication by any Q preserves lengths:for every vector x.It also preserves inner products and angles, since (Qx)T(Qy) = xTQTQy = xTy.The preservation of lengths comes directly from QTQ = I:(Qx)T(Qx) = xTQTQx = xTx.All inner products and lengths are preserved, when the space is rotated or reﬂected.We come now to the calculation that uses the special property QT = Q−1. If we have abasis, then any vector is a combination of the basis vectors. This is exceptionally simplefor an orthonormal basis, which will be a key idea behind Fourier series. The problemis to ﬁnd the coefﬁcients of the basis vectors:Write b as a combination b = x1q1 +x2q2 +···+xnqn.To compute x1 there is a neat trick. Multiply both sides of the equation by qTleft-hand side is qT1b. On the right-hand side all terms disappear (because qT1q j = 0)except the ﬁrst term. We are left with",orthogonality
"The measurements b1,...,bm are given at distinct points t1,...,tm. Thenthe straight line �C + �Dt which minimizes E2 comes from least squares:Remark. The mathematics of least squares is not limited to ﬁtting the data by straightlines. In many experiments there is no reason to expect a linear relationship, and itwould be crazy to look for one. Suppose we are handed some radioactive material, Theoutput b will be the reading on a Geiger counter at various times t. We may know thatwe are holding a mixture of two chemicals, and we may know their half-lives (or ratesof decay), but we do not know how much of each is in our hands. If these two unknownamounts are C and D, then the Geiger counter readings would behave like the sum oftwo exponentials (and not like a straight line):b = Ce−λt +De−µt.In practice, the Geiger counter is not exact. Instead, we make readings b1,...,bm attimes t1,...,tm, and equation (8) is approximately satisﬁed:If there are more than two readings, m > 2, then in all likelihood we cannot solve forC and D. But the least-squares principle will give optimal values �C and �D.The situation would be completely different if we knew the amounts C and D, andwere trying to discover the decay rates λ and µ. This is a problem in nonlinear leastsquares, and it is harder. We would still form E2, the sum of the squares of the errors,and minimize it. But setting its derivatives to zero will not give linear equations for theoptimal λ and µ. In the exercises, we stay with linear least squares.A simple least-squares problem is the estimate �x of a patient’s weight from two obser-vations x = b1 and x = b2. Unless b1 = b2, we are faced with an inconsistent system oftwo equations in one unknown:Up to now, we accepted b1 and b2 as equally reliable. We looked for the value �x thatminimized E2 = (x−b1)2 +(x−b2)2:�x = b1 +b2",orthogonality
"2.5 Graphs and Networksright-hand side accounts for the battery of strength b3 in edge 3. The block form hasC−1y+Ax = b above ATy = f:The system is 8 by 8, with ﬁve currents and three potentials. Elimination of y’s reducesto the 3 by 3 system ATCAx = ATCb − f. The matrix ATCA contains the reciprocalsci = 1/Ri (because in elimination you divide by the pivots). We also show the fourthrow and column, from the grounded node, outside the 3 by 3 matrix:The ﬁrst entry is 1 + 1 + 1, or c1 + c3 + c5 when C is included, because edges 1, 3, 5touch node 1. The next diagonal entry is 1+1 or c1 +c2, from the edges touching node2. Off the diagonal the c’s appear with minus signs. The edges to the grounded node4 belong in the fourth row and column, which are deleted when column 4 is removedfrom A (making ATCA invertible). The 4 by 4 matrix would have all rows and columnsadding to zero, and (1,1,1,1) would be in its nullspace.Notice that ATCA is symmetric. It has positive pivots and it comes from the basicframework of applied mathematics illustrated in Figure 2.8.e = b − AxFigure 2.8: The framework for equilibrium: sources b and f, three steps to ATCA.In mechanics, x and y become displacements and stresses. In ﬂuids, the unknownsare pressure and ﬂow rate. In statistics, e is the error and x is the best least-squares ﬁt to",vector spaces
"7.4 Iterative Methods for Ax = b11. Why is the norm of Bk never larger than ∥B∥k? Then ∥B∥ < 1 guarantees that thepowers Bk approach zero (convergence). This is no surprise, since |λ|max is below12. If A is singular, then all splittings A = S − T must fail. From Ax = 0, show thatS−1Tx = x. So this matrix B = S−1T has λ = 1 and fails.13. Change the 2s to 3s and ﬁnd the eigenvalues of S−1T for both methods:Does |λ|max for Gauss-Seidel equal |λ|214. Write a computer code (MATLAB or other) for Gauss-Seidel. You can deﬁne S andT from A, or set up the iteration loop directly from the entries aij. Test it on the −1,2, −1 matrices A of order 10, 20, 50, with b = (1,0,...,0).15. The SOR splitting matrix S is the same as for Gauss-Seidel except that the diagonalis divided by ω. Write a program for SOR on an n by n matrix. Apply it with ω = 1,1.4, 1.8, 2.2 when A is the −1, 2, −1 matrix of order 10.16. When A = AT, the Arnoldi-Lanczos method ﬁnds orthonormal q’s so that Aq j =b j−1q j−1 +a jq j +b jq j+1 (with q0 = 0). Multiply by qTj to ﬁnd a formula for a j. Theequation says that AQ = QT where T is a17. What bound on |λ|max does Gershgorin give For these matrices (see Problem 4)?What are the three Gershgorin circles that contain all the eigenvalues?The key point for large matrices is that matrix-vector multiplication is muchfaster than matrix-matrix multiplication. A crucial construction starts with a vec-tor b and computes Ab,A2b,... (but never A2!). The ﬁrst N vectors span the NthKrylov subspace. They are the columns of the Krylov matrix KN:b Ab A2b ···The Arnoldi-Lanczos iteration orthogonalizes the columns of KN, and the conjugategradient iteration solves Ax = b when A is symmetric positive deﬁnite.",computations
"Chapter 5 Eigenvalues and EigenvectorsRemark 3. Other matrices S will not produce a diagonal Λ. Suppose the ﬁrst columnof S is y. Then the ﬁrst column of SΛ is λ1y. If this is to agree with the ﬁrst column ofAS, which by matrix multiplication is Ay, then y must be an eigenvector: Ay = λ1y. Theorder of the eigenvectors in S and the eigenvalues in Λ is automatically the same.Remark 4. Not all matrices possess n linearly independent eigenvectors, so not all ma-trices are diagonalizable. The standard example of a “defective matrix” isIts eigenvalues are λ1 = λ2 = 0, since it is triangular with zeros on the diagonal:All eigenvectors of this A are multiples of the vector (1,0):λ = 0 is a double eigenvalue—its algebraic multiplicity is 2. But the geometric multi-plicity is 1—there is only one independent eigenvector. We can’t construct S.Here is a more direct proof that this A is not diagonalizable. Since λ1 = λ2 = 0, Λwould have to be the zero matrix, But if Λ = S−1AS = 0, then we premultiply by S andpostmultiply by S−1, to deduce falsely that A = 0. There is no invertible S.That failure of diagonalization was not a result of λ = 0. It came from λ1 = λ2:Their eigenvalues are 3, 3 and 1, 1. They are not singular! The problem is the shortageof eigenvectors—which are needed for S. That needs to be emphasized:Diagonalizability of A depends on enough eigenvectors.Invertibility of A depends on nonzero eigenvalues.There is no connection between diagonalizability (n independent eigenvector) and in-vertibility (no zero eigenvalues). The only indication given by the eigenvalues is this:Diagonalization can fail only if there are repeated eigenvalues. Even then, it does notalways fail. A = I has repeated eigenvalues 1,1,...,1 but it is already diagonal! Thereis no shortage of eigenvectors in that case.The test is to check, for an eigenvalue that is repeated p times, whether there are pindependent eigenvectors—in other words, whether A−λI has rank n− p. To completethat circle of ideas, we have to show that distinct eigenvalues present no problem.",eigenvec_val
"Chapter 5 Eigenvalues and EigenvectorsNow we have the fundamental equation of this chapter. It involves two unknownsλ and x. It is an algebra problem, and differential equations can be forgotten! Thenumber λ (lambda) is an eigenvalue of the matrix A, and the vector x is the associatedeigenvector. Our goal is to ﬁnd the eigenvalues and eigenvectors, λ’s and x’s, and to useThe Solution of Ax = λxNotice that Ax = λx is a nonlinear equation; λ multiplies x. If we could discover λ, thenthe equation for x would be linear. In fact we could write λIx in place of λx, and bringthis term over to the left side:The identity matrix keeps matrices and vectors straight; the equation (A − λ)x = 0 isshorter, but mixed up. This is the key to the problem:The vector x is in the nullspace of A−λI.The number λ is chosen so that A−λI has a nullspace.Of course every matrix has a nullspace. It was ridiculous to suggest otherwise, but yousee the point. We want a nonzero eigenvector x, The vector x = 0 always satisﬁesAx = λx, but it is useless in solving differential equations. The goal is to build u(t) outof exponentials eλtx, and we are interested only in those particular values λ for whichthere is a nonzero eigenvector x. To be of any use, the nullspace of A−λI must containvectors other than zero. In short, A−λI must be singular.For this, the determinant gives a conclusive test.The number λ is an eigenvalue of A if and only if A−λI is singular:This is the characteristic equation. Each λ is associated with eigenvectors x:In our example, we shift A by λI to make it singular:Note that λ is subtracted only from the main diagonal (because it multiplies I).λ 2 −λ −2.This is the characteristic polynomial. Its roots, where the determinant is zero, are theeigenvalues. They come from the general formula for the roots of a quadratic, or from",eigenvec_val
"Chapter 8 Linear Programming and Game TheorySome linear problems have a structure that makes their solution very quick. Band ma-trices have all nonzeros close to the main diagonal, and Ax = b is easy to solve. In linearprogramming, we are interested in the special class for which A is an incidence matrix.Its entries are −1 or +1 or (mostly) zero, and pivot steps involve only additions andsubtractions. Much larger problems than usual can be solved.Networks enter all kinds of applications. Trafﬁc through an intersection satisﬁesKirchhoff’s current law: ﬂow in equals ﬂow out. For gas and oil, network programminghas designed pipeline systems that are millions of dollars cheaper than the intuitive (notoptimized) designs. Scheduling pilots and crews and airplanes has become a signiﬁcantproblem in applied mathematics! We even solve the marriage problem—to maximizethe number of marriages when brides have a veto. That may not be the real problem, butit is the one that network programming solves.The problem in Figure 8.5 is to maximize the ﬂow from the source to the sink. Theﬂows cannot exceed the capacities marked on the edges, and the directions given bythe arrows cannot be reversed. The ﬂow on the two edges into the sink cannot exceed6+1 = 7. Is this total of 7 achievable? What is the maximal ﬂow from left to right?The unknowns are the ﬂows xij from node i to node j. The capacity constraints arexij ≤ cij. The ﬂows are nonnegative: xij ≥ 0 going with the arrows. By maximizing thereturn ﬂow x61 (dotted line), we maximize the total ﬂow into the sink.Figure 8.5: A 6-node network with edge capacities: the maximal ﬂow problem.Another constraint is still to be heard from. It is the “conservation law,” that the ﬂowinto each node equals the ﬂow out. That is Kirchhoff’s current law:x jk = 0The ﬂows xij enter node j from earlier nodes i. The ﬂows x jk leave node j to laternodes k. The balance in equation (1) can be written as Ax = 0, where A is a node-edgeincidence matrix (the transpose of Section 2.5). A has a row for every node and a +1,",linear_prog
"38. If v1,...,vn is an orthonormal basis for Cn, the matrix with those columns is amatrix. Show that any vector z equals (vH39. The functions e−ix and e−ix are orthogonal on the interval 0 ≤ x ≤ 2π because theircomplex inner product is40. The vectors v = (1,i,1), w = (i,1,0) and z =are an orthogonal basis for41. If A = R+iS is a Hermitian matrix, are the real matrices R and S symmetric?42. The (complex) dimension of Cn is. Find a nonreal basis for Cn.43. Describe all 1 by 1 matrices that are Hermitian and also unitary. Do the same for 244. How are the eigenvalues of AH (square matrix) related to the eigenvalues of A?45. If uHu = 1, show that I −2uuH is Hermitian and also unitary. The rank-1 matrix uuHis the projection onto what line in Cn?46. If A+iB is a unitary matrix (A and B are real), show that Q =47. If A+iB is a Hermitian matrix (A and B are real), show that48. Prove that the inverse of a Hermitian matrix is again a Hermitian matrix.49. Diagonalize this matrix by constructing its eigenvalue matrix Λ and its eigenvector50. A matrix with orthonormal eigenvectors has the form A = UΛU−1 = UΛUH. Provethat AAH = AHA. These are exactly the normal matrices.Virtually every step in this chapter has involved the combination S−1AS. The eigenvec-tors of A went into the columns of S, and that made S−1AS a diagonal matrix (calledΛ). When A was symmetric, we wrote Q instead of S, choosing the eigenvectors to beorthonormal. In the complex case, when A is Hermitian we write U—it is still the matrixof eigenvectors. Now we look at all combinations M−1AM—formed with any invertibleM on the right and its inverse on the left. The invertible eigenvector matrix S may fail toexist (the defective case), or we may not know it, or we may not want to use it.First a new word: The matrices A and M−1AM are “similar”. Going from one tothe other is a similarity transformation. It is the natural step for differential equations",eigenvec_val
"Linear Programming and Game TheoryAlgebra is about equations, and analysis is often about inequalities. The line betweenthem has always seemed clear. But I have realized that this chapter is a counterexam-ple: linear programming is about inequalities, but it is unquestionably a part of linearalgebra. It is also extremely useful—business decisions are more likely to involve linearprogramming than determinants or eigenvalues.There are three ways to approach the underlying mathematics: intuitively throughthe geometry, computationally through the simplex method, or algebraically throughduality. These approaches are developed in Sections 8.1, 8.2, and 8.3. Then Section8.4 is about problems (like marriage) in which the solution is an integer. Section 8.5discusses poker and other matrix games. The MIT students in Bringing Down the Housecounted high cards to win at blackjack (Las Vegas follows ﬁxed rules, and a true matrixgame involves random strategies).Section 8.3 has something new in this fourth edition. The simplex method is nowin a lively competition with a completely different way to do the computations, calledan interior point method. The excitement began when Karmarkar claimed that hisversion was 50 times faster than the simplex method. (His algorithm, outlined in 8.2,was one of the ﬁrst to be patented—something we then believed impossible, and notreally desirable.) That claim brought a burst of research into methods that approachthe solution from the “interior” where all inequalities are strict: x ≥ 0 becomes x > 0.The result is now a great way to get help from the dual problem in solving the primalOne key to this chapter is to see the geometric meaning of linear inequalities. Aninequality divides n-dimensional space into a halfspace in which the inequality is satis-ﬁed, and a halfspace in which it is not. A typical example is x +2y ≥ 4. The boundarybetween the two halfspaces is the line x+2y = 4, where the inequality is “tight.” Figure8.1 would look almost the same in three dimensions. The boundary becomes a planelike x + 2y + z = 4, and above it is the halfspace x + 2y + z ≥ 4. In n dimensions, the",linear_prog
"2.1 Vector Spaces and Subspacessince the sum 0 + 0 is in this one-point space, and so are all multiples c0. This is thesmallest possible vector space: the empty set is not allowed. At the other extreme. thelargest subspace is the whole of the original space. If the original space is R3, then thepossible subspaces are easy to describe: R3 itself, any plane through the origin, any linethrough the origin, or the origin (the zero vector) alone.The distinction between a subset and a subspace is made clear by examples. In eachcase, can you add vectors and multiply by scalars, without leaving the space?Example 1. Consider all vectors in R2 whose components are positive or zero. Thissubset is the ﬁrst quadrant of the x-y plane; the coordinates satisfy x ≥ 0 and y ≥ 0. Itis not a subspace, even though it contains zero and addition does leave us within thesubset. Rule (ii) is violated, since if the scalar is −1 and the vector is [1 1], the multiplecx = [−1 −1] is in the third quadrant instead of the ﬁrst.If we include the third quadrant along with the ﬁrst, scalar multiplication is all right.Every multiple cx will stay in this subset. However, rule (i) is now violated, since adding[1 2]+ [−2 − 1] gives [−1 1], which is not in either quadrant. The smallest subspacecontaining the ﬁrst quadrant is the whole space R2.Example 2. Start from the vector space of 3 by 3 matrices. One possible subspace isthe set of lower triangular matrices. Another is the set of symmetric matrices. A + Band cA are lower triangular if A and B are lower triangular, and they are symmetric if Aand B are symmetric. Of course, the zero matrix is in both subspaces.The Column Space of AWe now come to the key examples, the column space and the nullspace of a matrixA. The column space contains all linear combinations of the columns of A. It is asubspace of Rm. We illustrate by a system of m = 3 equations in n = 2 unknowns:Combination of columns equals bWith m > n we have more equations than unknowns—and usually there will be no solu-tion. The system will be solvable only for a very “thin” subset of all possible b’s. Oneway of describing this thin subset is so simple that it is easy to overlook.2A The system Ax = b is solvable if and only if the vector b can be expressedas a combination of the columns of A. Then b is in the column space.This description involves nothing more than a restatement of Ax = b, by columns:",vector spaces
"Chapter 2 Vector Spaces(e) the nullspace of A.(f) the column space of A.9. Show that the set of nonsingular 2 by 2 matrices is not a vector space. Show also thatthe set of singular 2 by 2 matrices is not a vector space.10. The matrix A =is a “vector” in the space M of all 2 by 2 matrices. Write thezero vector in this space, the vector 12A, and the vector −A. What matrices are in thesmallest subspace containing A?11. (a) Describe a subspace of M that contains A =but not B =(b) If a subspace of M contains A and B, must it contain I?(c) Describe a subspace of M that contains no nonzero diagonal matrices.12. The functions f(x) = x2 and g(x) = 5x are “vectors” in the vector space F of all realfunctions. The combination 3 f(x)−4g(x) is the function h(x) =is broken if multiplying f(x) by c gives the function f(cx)?13. If the sum of the “vectors” f(x) and g(x) in F is deﬁned to be f(g(x)), then the “zerovector” is g(x) = x. Keep the usual scalar multiplication cf(x), and ﬁnd two rules14. Describe the smallest subspace of the 2 by 2 matrix space M that contains15. Let P be the plane in R3 with equation x + y − 2z = 4. The origin (0,0,0) is not inP! Find two vectors in P and check that their sum is not in P.16. P0 is the plane through (0,0,0) parallel to the plane P in Problem 15. What is theequation for P0? Find two vectors in P0 and check that their sum is in P0.17. The four types of subspaces of R3 are planes, lines, R3 itself, or Z containing only(a) Describe the three types of subspaces of R2.(b) Describe the ﬁve types of subspaces of R4.18. (a) The intersection of two planes through (0,0,0) is probably a. It can’t be the zero vector Z!(b) The intersection of a plane through (0,0,0) with a line through (0,0,0) is prob-but it could be a",vector spaces
"Chapter 1 Matrices and Gaussian EliminationThat row exchange recovers LU—but now ℓ31 = 1 and ℓ21 = 2:In MATLAB, A([r k] :) exchanges row k with row r below it (where the kth pivot hasbeen found). We update the matrices L and P the same way. At the start, P = I and signA([r k], :) = A([k r], :);L([r k], 1:k-1) = L([k r], 1:k-1);P([r k], :) = P([k r], :);The “sign” of P tells whether the number of row exchanges is even (sign = +1) or odd(sign = −1). A row exchange reverses sign. The ﬁnal value of sign is the determinantof P and it does not depend on the order of the row exchanges.To summarize: A good elimination code saves L and U and P. Those matrices carrythe information that originally came in A—and they carry it in a more usable form. Ax =b reduces to two triangular systems. This is the practical equivalent of the calculationwe do next—to ﬁnd the inverse matrix A−1 and the solution x = A−1b.1. When is an upper triangular matrix nonsingular (a full set of pivots)?2. What multiple ℓ32 of row 2 of A will elimination subtract from row 3 of A? Use theWhat will be the pivots? Will a row exchange be required?3. Multiply the matrix L = E−1F−1G−1 in equation (6) by GFE in equation (3):Multiply also in the opposite order. Why are the answers what they are?",gauss elim
"3.2 Cosines and Projections onto Linesnotice that ours came directly from the calculation of ∥b− p∥2. This stays nonnegativewhen we introduce new possibilities for the lengths and inner products. The name ofCauchy is also attached to this inequality |aTb| ≤ ∥a∥∥b∥, and the Russians refer to it asthe Cauchy-Schwarz-Buniakowsky inequality! Mathematical historians seem to agreethat Buniakowsky’s claim is genuine.One ﬁnal observation about |aTb| ≤ ∥a∥∥b∥. Equality holds if and only if b is amultiple of a. The angle is θ = 0° or θ = 180° and the cosine is 1 or −1. In this case bis identical with its projection p, and the distance between b and the line is zero.Example 1. Project b = (1,2,3) onto the line through a = (1,1,1) to get �x and p:The projection is p = �xa = (2,2,2). The angle between a and b hasThe Schwarz inequality |aTb| ≤ ∥a∥∥b∥ is 6 ≤14. If we write 6 as36, that is the42. The cosine is less than 1, because b is not parallel to a.Projection Matrix of Rank 1The projection of b onto the line through a lies at p = a(aTb/aTa). That is our formulap = �xa, but it is written with a slight twist: The vector a is put before the number�x = aTb/aTa. There is a reason behind that apparently trivial change. Projection ontoa line is carried out by a projection matrix P, and written in this new order we can seewhat it is. P is the matrix that multiplies b and produces p:so the projection matrix isThat is a column times a row—a square matrix—divided by the number aTa.Example 2. The matrix that projects onto the line through a = (1,1,1) isThis matrix has two properties that we will see as typical of projections:1. P is a symmetric matrix.2. Its square is itself: P2 = P.P2b is the projection of Pb—and Pb is already on the line! So P2b = Pb. This matrix Palso gives a great example of the four fundamental subspaces:",orthogonality
"1.4 Matrix Notation and Matrix Multiplication1. Compute the productsFor the third one, draw the column vectors (2,1) and (0,3). Multiplying by (1,1)just adds the vectors (do it graphically).2. Working a column at a time, compute the products3. Find two inner products and a matrix product:The ﬁrst gives the length of the vector (squared).4. If an m by n matrix A multiplies an n-dimensional vector x, how many separatemultiplications are involved? What if A multiplies an n by p matrix B?5. Multiply Ax to ﬁnd a solution vector x to the system Ax = zero vector. Can you ﬁndmore solutions to Ax = 0?6. Write down the 2 by 2 matrices A and B that have entries aij = i+ j and bij = (−1)i+j.Multiply them to ﬁnd AB and BA.7. Give 3 by 3 examples (not just the zero matrix) of(a) a diagonal matrix: aij = 0 if i ̸= j.(b) a symmetric matrix: ai j = a ji for all i and j.(c) an upper triangular matrix: aij = 0 if i > j.(d) a skew-symmetric matrix: aij = −a ji for all i and j.8. Do these subroutines multiply Ax by rows or columns? Start with B(I) = 0:",gauss elim
"Chapter 5 Eigenvalues and Eigenvectors44. Why is each of these statements true?(a) If A is similar to B, then A2 is similar to B2.(b) A2 and B2 can be similar when A and B are not similar (try λ = 0,0).is not similar to(e) If we exchange rows 1 and 2 of A, and then exchange columns 1 and 2, theeigenvalues stay the same.Properties of Eigenvalues and EigenvectorsHow are the properties of a matrix reﬂected in its eigenvalues and eigenvectors? Thisquestion is fundamental throughout Chapter 5. A table that organizes the key facts maybe helpful. For each class of matrices, here are the special properties of the eigenvaluesλi and eigenvectors xi.Symmetric: AT = Ai x j = 0Orthogonal: QT = Q−1all |λ| = 1i x j = 0Skew-symmetric: AT = −Ai x j = 0Complex Hermitian: AT = Ai x j = 0Positive deﬁnite: xTAx > 0all λ > 0Similar matrix: B = M−1AMProjection: P = P2 = PTStable powers: An → 0all |λ| < 1Stable exponential: eAt → 0all Reλ < 0Markov: mij > 0, ∑nsteady state x > 0Cyclic permutation: Pn = Ixk = (1,λk,...,λ n−1columns of S are independentdiagonal of Λ (real)columns of Q are orthonormalJordan: J = M−1AMeach block gives 1 eigenvectorEvery matrix: A = UΣV Teigenvectors of ATA, AAT in V, U",eigenvec_val
"2.4 The Four Fundamental SubspacesIn this example all four subspaces are lines. That is an accident, coming from r = 1 andn−r = 1 and m−r = 1. Figure 2.5 shows that two pairs of lines are perpendicular. ThatFigure 2.5: The four fundamental subspaces (lines) for the singular matrix A.If you change the last entry of A from 6 to 7, all the dimensions are different. Thecolumn space and row space have dimension r = 2. The nullspace and left nullspacecontain only the vectors x = 0 and y = 0. The matrix is invertible.We know that if A has a left-inverse (BA = I) and a right-inverse (AC = I), then the twoinverses are equal: B = B(AC)(BA)C = C. Now, from the rank of a matrix, it is easy todecide which matrices actually have these inverses. Roughly speaking, an inverse existsonly when the rank is as large as possible.The rank always satisﬁes r ≤ m and also r ≤ n. An m by n matrix cannot have morethan m independent rows or n independent columns. There is not space for more than mpivots, or more than n. We want to prove that when r = m there is a right-inverse, andAx = b always has a solution. When r = n there is a left-inverse, and the solution (if itOnly a square matrix can have both r = m and r = n, and therefore only a squarematrix can achieve both existence and uniqueness. Only a square matrix has a two-sidedEXISTENCE: Full row rank r = m. Ax = b has at least one solution xfor every b if and only if the columns span Rm. Then A has a right-inverse Csuch that AC = Im (m by m). This is possible only if m ≤ n.UNIQUENESS: Full column rank r = n. Ax = b has at most one solution xfor every b if and only if the columns are linearly independent. Then A has ann by m left-inverse B such that BA = In. This is possible only if m ≥ n.",vector spaces
"3.4 Orthogonal Bases and Gram-Schmidtdividing by those lengths. The example above would have the same B and C, withoutusing square roots. Notice the 12 from aTb/aTa instead ofThe Factorization A = QRWe started with a matrix A, whose columns were a, b, c. We ended with a matrix Q,whose columns are q1, q2, q3. What is the relation between those matrices? The matricesA and Q are m by n when the n vectors are in m-dimensional space, and there has to bea third matrix that connects them.The idea is to write the a’s as combinations of the q’s. The vector b in Figure 3.10 isa combination of the orthonormal q1 and q2, and we know what combination it is:Every vector in the plane is the sum of its q1 and q2 components. Similarly c is the sumof its q1, q2, q3 components: c = (qT3c)q3. If we express that inmatrix form we have the new factorization A = QR:Notice the zeros in the last matrix! R is upper triangular because of the way Gram-Schmidt was done. The ﬁrst vectors a and q1 fell on the same line. Then q1, q2 were inthe same plane as a, b. The third vectors c and q3 were not involved until step 3.The QR factorization is like A = LU, except that the ﬁrst factor Q has orthonormalcolumns. The second factor is called R, because the nonzeros are to the right of the di-agonal (and the letter U is already taken). The off-diagonal entries of R are the numbers2, found above. The whole factorization isYou see the lengths of a, B, C on the diagonal of R. The orthonormal vectors q1, q2, q3,which are the whole object of orthogonalization, are in the ﬁrst factor Q.Maybe QR is not as beautiful as LU (because of the square roots). Both factoriza-tions are vitally important to the theory of linear algebra, and absolutely central to thecalculations. If LU is Hertz, then QR is Avis.",orthogonality
"2.1 Vector Spaces and Subspacesonly combination of the columns is b = 0. At the other extreme, suppose A is the 5 by5 identity matrix. Then C(I) is the whole of R5; the ﬁve columns of I can combine toproduce any ﬁve-dimensional vector b. This is not at all special to the identity matrix.Any 5 by 5 matrix that is nonsingular will have the whole of R5 as its column space.For such a matrix we can solve Ax = b by Gaussian elimination; there are ﬁve pivots.Therefore every b is in C(A) for a nonsingular matrix.You can see how Chapter 1 is contained in this chapter. There we studied n by nmatrices whose column space is Rn. Now we allow singular matrices, and rectangu-lar matrices of any shape. Then C(A) can be somewhere between the zero space andthe whole space Rm. Together with its perpendicular space, it gives one of our twoapproaches to understanding Ax = b.The Nullspace of AThe second approach to Ax = b is “dual” to the ﬁrst. We are concerned not only withattainable right-hand sides b, but also with the solutions x that attain them. The right-hand side b = 0 always allows the solution x = 0, but there may be inﬁnitely many othersolutions. (There always are, if there are more unknowns than equations, n > m.) Thesolutions to Ax = 0 form a vector space—the nullspace of A.The nullspace of a matrix consists of all vectors x such that Ax = 0. It isdenoted by N(A). It is a subspace of Rn, just as the column space was aRequirement (i) holds: If Ax = 0 and Ax′ = 0, then A(x+x′) = 0. Requirement (ii) alsoholds: If Ax = 0 then A(cx) = 0. Both requirements fail if the right-hand side is not zero!Only the solutions to a homogeneous equation (b = 0) form a subspace. The nullspaceis easy to ﬁnd for the example given above; it is as small as possible:The ﬁrst equation gives u = 0, and the second equation then forces v = 0. The nullspacecontains only the vector (0,0). This matrix has “independent columns”—a key idea thatThe situation is changed when a third column is a combination of the ﬁrst two:B has the same column space as A. The new column lies in the plane of Figure 2.1; it isthe sum of the two column vectors we started with. But the nullspace of B contains the",vector spaces
"5.4 Differential Equations and eAtThis decays for a < 0, it is constant for a = 0, and it explodes for a > 0. The imaginarypart is producing oscillations, but the amplitude comes from the real part.The differential equation du/dt = Au isstable and eAt → 0 whenever all Reλi < 0,neutrally stable when all Reλi ≤ 0 and Reλ1 = 0, andunstable and eAt is unbounded if any eigenvalue has Reλi > 0.In some texts the condition Reλ < 0 is called asymptotic stability, because it guaranteesdecay for large times t. Our argument depended on having n pure exponential solutions,but even if A is not diagonalizable (and there are terms like teλt) the result is still true:All solutions approach zero if and only if all eigenvalues have Reλ < 0.Stability is especially easy to decide for a 2 by 2 system (which is very common inapplications). The equation isand we need to know when both eigenvalues of that matrix have negative real parts.(Note again that the eigenvalues can be complex numbers.) The stability tests areThe trace a+d must be negative.The determinant ad −bc must be positive.When the eigenvalues are real, those tests guarantee them to be negative. Their productis the determinant; it is positive when the eigenvalues have the same sign. Their sum isthe trace; it is negative when both eigenvalues are negative.When the eigenvalues are a complex pair x ± iy, the tests still succeed. The traceis their sum 2x (which is < 0) and the determinant is (x + iy)(x − iy) = x2 + y2 > 0.Figure 5.2 shows the one stable quadrant, trace < 0 and determinant > 0. It also showsthe parabolic boundary line between real and complex eigenvalues. The reason for theparabola is in the quadratic equation for the eigenvalues:= λ 2 −(trace)λ +(det) = 0.The quadratic formula for λ leads to the parabola (trace)2 = 4(det):λ1 and λ2 = 1Above the parabola, the number under the square root is negative—so λ is not real. Onthe parabola, the square root is zero and λ is repeated. Below the parabola the squareroots are real. Every symmetric matrix has real eigenvalues, since if b = c, then(trace)2 −4(det) = (a+d)2 −4(ad −b2) = (a−d)2 +4b2 ≥ 0.",eigenvec_val
"5.3 Difference Equations and Powers Akλ1 and λ2 = .7 :A = SΛS−1 =To ﬁnd Ak, and the distribution after k years, change SΛS−1 to SΛkS−1:Those two terms are c1λ k1x1 + c2λ k2x2. The factor λ k1 = 1 is hidden in the ﬁrst term. Inthe long run, the other factor (.7)k becomes extremely small. The solution approachesa limiting state u∞ = (y∞,z∞):The total population is still y0 +z0, but in the limit 23 of this population is outside Cali-3 is inside. This is true no matter what the initial distribution may have been!If the year starts with 23 outside and 13 inside, then it ends the same way:The steady state is the eigenvector of A corresponding to λ = 1. Multiplication by A,from one time step to the next, leaves u∞ unchanged.The theory of Markov processes is illustrated by that California example:A Markov matrix A has all aij ≥ 0, with each column adding to 1.(a) λ1 = 1 is an eigenvalue of A.(b) Its eigenvector x1 is nonnegative—and it is a steady state, since Ax1 = x1.(c) The other eigenvalues satisfy ∥λi∥ ≤ 1.(d) If A or any power of A has all positive entries, these other |λi| are below 1.The solution Aku0 approaches a multiple of x1—which is the steady stateTo ﬁnd the right multiple of x1, use the fact that the total population stays the same. IfCalifornia started with all 90 million people out, it ended with 60 million out and 30million in. It ends the same way if all 90 million were originally inside.We note that many authors transpose the matrix so its rows add to 1.Remark. Our description of a Markov process was deterministic: populations moved inﬁxed proportions. But if we look at a single individual, the fractions that move become",eigenvec_val
"Chapter 6 Positive Deﬁnite Matricesa number eiθ on the unit circle: z = reiθ. That expresses z in “polar coordinates.” Ifwe think of z as a 1 by 1 matrix, r corresponds to a positive deﬁnite matrix and eiθcorresponds to an orthogonal matrix. More exactly, since eiθ is complex and satisﬁese−iθeiθ = 1, it forms a 1 by 1 unitary matrix: UHU = I. We take the complex conjugateas well as the transpose, for UH.The SVD extends this “polar factorization” to matrices of any size:Every real square matrix can be factored into A = QS, where Q is orthogonaland S is symmetric positive semideﬁnite. If A is invertible then S is positiveFor proof we just insert V TV = I into the middle of the SVD:A = UΣV T = (UV T)(VΣV T).The factor S =VΣV T is symmetric and semideﬁnite (because Σ is). The factor Q =UV Tis an orthogonal matrix (because QTQ =VUTUV T = I). In the complex case, S becomesHermitian instead of symmetric and Q becomes unitary instead of orthogonal. In theinvertible case Σ is deﬁnite and so is S.Example 3. Polar decomposition:Example 4. Reverse polar decomposition:The exercises show how, in the reverse order. S changes but Q remains the same. BothS and S′ are symmetric positive deﬁnite because this A is invertible.Application of A = QS:A major use of the polar decomposition is in continuummechanics (and recently in robotics). In any deformation, it is important to separatestretching from rotation, and that is exactly what QS achieves. The orthogonal matrixQ is a rotation, and possibly a reﬂection. The material feels no strain. The symmetricmatrix S has eigenvalues σ1,...,σr, which are the stretching factors (or compressionfactors). The diagonalization that displays those eigenvalues is the natural choice ofaxes—called principal axes: as in the ellipses of Section 6.2. It is S that requires workon the material, and stores up elastic energy.We note that S2 is ATA, which is symmetric positive deﬁnite when A is invertible. Sis the symmetric positive deﬁnite square root of ATA, and Q is AS−1. In fact, A could berectangular, as long as ATA is positive deﬁnite. (That is the condition we keep meeting,",pos_def_matrices
"(c) A matrix whose entries are 0s and 1s has determinant 1, 0, or −1.4. (a) Find the LU factorization, the pivots, and the determinant of the 4 by 4 matrixwhose entries are aij = smaller of i and j. (Write out the matrix.)(b) Find the determinant if aij = smaller of ni and n j, where n1 = 2, n2 = 6, n3 = 8,n4 = 10. Can you give a general rule for any n1 ≤ n2 ≤ n3 ≤ n4?5. Let Fn be the determinant of the 1, 1, −1 tridiagonal matrix (n by n):By expanding in cofactors along row 1, show that Fn = Fn−1 +Fn−2. This yields theFibonacci sequence 1,2,3,5,8,13,... for the determinants.6. Suppose An is the n by n tridiagonal matrix with is on the three diagonals:Let Dn be the determinant of An; we want to ﬁnd it.(a) Expand in cofactors along the ﬁrst row to show that Dn = Dn−1 −Dn−2.(b) Starting from D1 = 1 and D2 = 0, ﬁnd D3,D4,...,D8. By noticing how thesenumbers cycle around (with what period?) ﬁnd D1000.7. (a) Evaluate this determinant by cofactors of row 1:4 4 4 41 2 0 12 0 1 21 1 0 2(b) Check by subtracting column 1 from the other columns and recomputing.8. Compute the determinants of A2, A3, A4. Can you predict An?0 1 1 11 0 1 11 1 0 11 1 1 0Use row operations to produce zeros, or use cofactors of row 1.",determinants
"Chapter 8 Linear Programming and Game TheoryThe step ∆x is a multiple of the projection −Pc. The longer the step, the more thecost is reduced—but we cannot go out of the feasible set. The multiple of −Pc is chosenso that x1 is close to, but a little inside, the boundary at which a component of x reachesThat completes the ﬁrst idea—the projection that gives the steepest feasible descent.The second step needs a new idea. since to continue in the same direction is useless.Karmarkar’s suggestion is to transform x1 back to (1,1,...,1) at the center. Hischange of variables was nonlinear, but the simplest transformation is just a rescaling bya diagonal matrix D. Then we have room to move. The rescaling from x to X = D−1xchanges the constraint and the cost:Therefore the matrix AD takes the place of A, and the vector cTD takes the place of cT.The second step projects the new c onto the nullspace of the new A. All the work is inthis projection, to solve the weighted normal equations:The normal way to compute y is by elimination. Gram-Schmidt will orthogonalize thecolumns of DAT, which can be expensive (although it makes the rest of the calculationeasy). The favorite for large sparse problems is the conjugate gradient method, whichgives the exact answer y more slowly than elimination, but you can go part way and thenstop. In the middle of elimination you cannot stop.Like other new ideas in scientiﬁc computing, Karmarkar’s method succeeded on someproblems and not on others. The underlying idea was analyzed and improved. Newerinterior point methods (staying inside the feasible set) are a major success—mentionedin the next section. And the simplex method remains tremendously valuable. like thewhole subject of linear programming—which was discovered centuries after Ax = b, butshares the fundamental ideas of linear algebra. The most far-reaching of those ideas isduality, which comes next.1. Minimize x1 +x2 −x3, subject to2x1 −4x2 +x3 +x4Which of x1, x2, x3 should enter the basis, and which of x4, x5 should leave? Computethe new pair of basic variables, and ﬁnd the cost at the new corner.2. After the preceding simplex step, prepare for and decide on the next step.",linear_prog
"Chapter 5 Eigenvalues and EigenvectorsFigure 5.3: The slow and fast modes of oscillation.steady state for both is the eigenvector for λmax. It is multiplied by 1k = 1 in differenceequations and by e0t = 1 in differential equations, and it doesn’t move.In the example, the steady state has v = w.Example 6. In nuclear engineering, a reactor is called critical when it is neutrallystable; the ﬁssion balances the decay. Slower ﬁssion makes it stable, or subcritical, andeventually it runs down. Unstable ﬁssion is a bomb.The laws of diffusion led to a ﬁrst-order system du/dt = Au. So do a lot of other appli-cations, in chemistry, in biology, and elsewhere, but the most important law of physicsdoes not. It is Newton’s law F = ma, and the acceleration a is a second derivative. In-ertial terms produce second-order equations (we have to solve d2u/dt2 = Au instead ofdu/dt = Au), and the goal is to understand how this switch to second derivatives altersthe solution5. It is optional in linear algebra, but not in physics.The comparison will be perfect if we keep the same A:dt2 = Au =Two initial conditions get the system started—the “displacement” u(0) and the “veloc-ity” u′(0). To match these conditions, there will be 2n pure exponential solutions.Suppose we use ω rather than λ, and write these special solutions as u = eiωtx. Sub-stituting this exponential into the differential equation, it must satisfyThe vector x must be an eigenvector of A, exactly as before. The corresponding eigen-value is now −ω2, so the frequency ω is connected to the decay rate λ by the law5Fourth derivatives are also possible, in the bending of beams, but nature seems to resist going higher than four.",eigenvec_val
"4.4 Applications of Determinants35. An n-dimensional cube has how many corners? How many edges? How many (n−1)-dimensional faces? The n-cube whose edges are the rows of 2I has volumeA hypercube computer has parallel processors at the corners with connections along36. The triangle with corners (0,0), (1,0), (0,1) has area 12. The pyramid with fourcorners (0,0,0), (1,0,0), (0,1,0), (0,0,1) has volume. The pyramid in R4with ﬁve corners at (0,0,0,0) and the rows of I has what volume?Problems 37–40 are about areas dA and volumes dV in calculus.37. Polar coordinates satisfy x = rcosθ and y = rsinθ. Polar area J dr dθ includes J:The two columns are orthogonal. Their lengths are. Thus J =38. Spherical coordinates ρ, φ, θ give x = ρ sinφ cosθ, y = ρ sinφ sinθ, z = ρ cosφ.Find the Jacobian matrix of 9 partial derivatives: ∂x/∂ρ, ∂x/∂φ, ∂x/∂θ are in row1. Simplify its determinant to J = ρ2sinφ. Then dV = ρ2sinφ dρ dφ dθ.39. The matrix that connects r, θ to x, y is in Problem 37. Invert that matrix:It is surprising that ∂r/∂x = ∂x/∂r. The product JJ−1 = I gives the chain rule40. The triangle with corners (0,0), (6,0), and (1,4) has area. When you rotate itby θ = 60° the area is. The rotation matrix has41. Let P = (1,0,−1), Q = (1,1,1), and R = (2,2,1). Choose S so that PQRS is aparallelogram, and compute its area. Choose T, U, V so that OPQRSTUV is a tiltedbox, and compute its volume.42. Suppose (x,y,z), (1,1,0), and (1,2,1) lie on a plane through the origin. What deter-minant is zero? What equation does this give for the plane?43. Suppose (x,y,z) is a linear combination of (2,3,1) and (1,2,3). What determinantis zero? What equation does this give for the plane of all combinations?",determinants
"3.5 The Fast Fourier TransformThe speed of the FFT, in the standard form presented here, depends on working withhighly composite numbers like 210 = 1024. Without the fast transform, it takes (1024)2multiplications to produce F times c (which we want to do often). By contrast, a fasttransform can do each multiplication in only 5·1024 steps. It is 200 times faster, becauseit replaces one factor of 1024 by 5. In general it replaces n2 multiplications by 1when n is 2ℓ. By connecting Fn to two copies of Fn/2, and then to four copies of Fn/4,and eventually to a very small F, the usual n2 steps are reduced to 1We need to see how y = Fnc (a vector with n components) can be recovered from twovectors that are only half as long. The ﬁrst step is to divide c itself, by separating itseven-numbered components from its odd-numbered components:The coefﬁcients just go alternately into c′ and c′′. From those vectors, the half-sizetransform gives y′ = Fmc′ and y′′ = Fmc′′. Those are the two multiplications by thesmaller matrix Fm. The central problem is to recover y from the half-size vectors y′ andy′′, and Cooley and Tukey noticed how it could be done:The ﬁrst m and the last m components of the vector y = Fnc arey j = y′y j+m = y′Thus the three steps are: split c into c′ and c′′, transform them by Fm into y′and y′′, and reconstruct y from equation (13).We verify in a moment that this gives the correct y. (You may prefer the ﬂow graphto the algebra.) This idea can be repeated. We go from F1024 to F512 to F256. The ﬁnal2nℓ, when starting with the power n = 2ℓ and going all the way to n = 1—whereno multiplication is needed. This number 14nℓ satisﬁes the rule given above: twice thecount for m, plus m extra multiplications, produces the count for n:Another way to count: There are ℓ steps from n = 2ℓ to n = 1. Each step needs n/2multiplications by Dn/2 in equation (13), which is really a factorization of Fn:The cost is only slightly more than linear. Fourier analysis has been completely trans-formed by the FFT. To verify equation (13), split y j into even and odd:",orthogonality
"Chapter 2 Vector SpacesAll we can do is to go on to the next column, where the pivot entry is 3. Subtracting twicethe second row from the third, we arrive at U:1 3 3 20 0 3 30 0 0 0Strictly speaking, we proceed to the fourth column. A zero is in the third pivot position,and nothing can be done. U is upper triangular, but its pivots are not on the main diago-nal. The nonzero entries of U have a “staircase pattern,” or echelon form. For the 5 by8 case in Figure 2.3, the starred entries may or may not be zero.Figure 2.3: The entries of a 5 by 8 echelon matrix U and its reduced form R.We can always reach this echelon form U, with zeros below the pivots:1. The pivots are the ﬁrst nonzero entries in their rows.2. Below each pivot is a column of zeros, obtained by elimination.3. Each pivot lies to the right of the pivot in the row above. This produces the staircasepattern, and zero rows come last.Since we started with A and ended with U, the reader is certain to ask: Do we haveA = LU as before? There is no reason why not, since the elimination steps have notchanged. Each step still subtracts a multiple of one row from a row beneath it. Theinverse of each step adds back the multiple that was subtracted. These inverses come inthe right order to put the multipliers directly into L:Note that L is square. It has the same number of rows as A and U.The only operation not required by our example, but needed in general, is row ex-change by a permutation matrix P. Since we keep going to the next column when nopivots are available, there is no need to assume that A is nonsingular. Here is PA = LU",vector spaces
"2.2 Solving Ax = 0 and Ax = bFor any m by n matrix A there is a permutation P, a lower triangular Lwith unit diagonal, and an m by n echelon matrix U, such that PA = LU.Now comes R. We can go further than U, to make the matrix even simpler. Dividethe second row by its pivot 3, so that all pivots are 1. Then use the pivot row to producezero above the pivot. This time we subtract a row from a higher row. The ﬁnal result(the best form we can get) is the reduced row echelon form R:1 3 3 20 0 3 30 0 0 01 3 3 20 0 1 10 0 0 01 3 0 -1This matrix R is the ﬁnal result of elimination on A. MATLAB would use the commandR = rref(A). Of course rref(R) would give R again!What is the row reduced form of a square invertible matrix? In that case R is theidentity matrix. There is a full set of pivots, all equal to 1, with zeros above and below.So rref(A) = I, when A is invertible.For a 5 by 8 matrix with four pivots, Figure 2.3 shows the reduced form R. It stillcontains an identity matrix, in the four pivot rows and four pivot columns. From Rwe will quickly ﬁnd the nullspace of A. Rx = 0 has the same solutions as Ux = 0 andPivot Variables and Free VariablesOur goal is to read off all the solutions to Rx = 0. The pivots are crucial:1 3 0 −1The unknowns u, v, w, y go into two groups. One group contains the pivot variables,those that correspond to columns with pivots. The ﬁrst and third columns contain thepivots, so u and w are the pivot variables. The other group is made up of the freevariables, corresponding to columns without pivots. These are the second and fourthcolumns, so v and y are free variables.To ﬁnd the most general solution to Rx = 0 (or, equivalently, to Ax = 0) we may assignarbitrary values to the free variables. Suppose we call these values simply v and y. Thepivot variables are completely determined in terms of v and y:w +y = 0",vector spaces
"Chapter 1 Matrices and Gaussian Eliminationtimated the ﬁnal roundoff error. It was Wilkinson who found the right way to answer thequestion, and his books are now classics.Two simple examples will illustrate three important points about roundoff error. TheA is nearly singular whereas B is far from singular. If we slightly change the last entryof A to a22 = 1, it is singular. Consider two very close right-hand sides b:u + 1.0001v = 2u + 1.0001v = 2.0001The solution to the ﬁrst is u = 2, v = 0. The solution to the second is u = v = 1. Achange in the ﬁfth digit of b was ampliﬁed to a change in the ﬁrst digit of the solution. Nonumerical method can avoid this sensitivity to small perturbations. The ill-conditioningcan be shifted from one place to another, but it cannot be removed. The true solution isvery sensitive, and the computed solution cannot be less so.The second point is as follows.1O Even a well-conditioned matrix like B can be ruined by a poor algorithm.We regret to say that for the matrix B, direct Gaussian elimination is a poor algorithm.Suppose .0001 is accepted as the ﬁrst pivot. Then 10,000 times the ﬁrst row is subtractedfrom the second. The lower right entry becomes −9999, but roundoff to three placeswould give −10,000. Every trace of the entry 1 would disappear:u+v = 2 −→ .0001u+v = 1Roundoff will produce −10,000v = −10,000, or v = 1. This is correct to three decimalplaces. Back-substitution with the right v = .9999 would leave u = 1:Instead, accepting v = 1, which is wrong only in the fourth place, we obtain u = 0:The computed u is completely mistaken. B is well-conditioned but elimination is vio-lently unstable. L, D, and U are completely out of scale with B:The small pivot .0001 brought instability, and the remedy is clear—exchange rows.",gauss elim
"8.3 The Dual Problem8. Verify that the vectors in the previous exercise satisfy the complementary slacknessconditions in equation (2), and ﬁnd the one slack inequality in both the primal and9. Suppose that A =, and c =. Find the optimal x and y, and verifythe complementary slackness conditions (as well as yb = cx).10. If the primal problem is constrained by equations instead of inequalities—Minimizecx subject to Ax = b and x ≥ 0—then the requirement y ≥ 0 is left out of the dual:Maximize yb subject to yA ≤ c. Show that the one-sided inequality yb ≤ cx stillholds. Why was y ≥ 0 needed in equation (1) but not here? This weak duality can becompleted to full duality.11. (a) Without the simplex method, minimize the cost 5x1 +3x2 +4x3, subject to x1 +x2 +x3 ≥ 1, x1 ≥ 0, x2 ≥ 0, x3 ≥ 0.(b) What is the shape of the feasible set?(c) What is the dual problem, and what is its solution y?12. If the primal has a unique optimal solution x∗, and then c is changed a little, explainwhy x∗ still remains the optimal solution.13. Write the dual of the following problem: Maximize x1+x2+x3 subject to 2x1+x2 ≤4, x3 ≤ 6. What are the optimal x∗ and y∗ (if they exist!)?14. If A =, describe the cone of nonnegative combinations of the columns. If b liesinside that cone, say b = (3,2), what is the feasible vector x? If b lies outside, sayb = (0,1), what vector y will satisfy the alternative?15. In three dimensions, can you ﬁnd a set of six vectors whose cone of nonnegativecombinations ﬁlls the whole space? What about four vectors?16. Use 8H to show that the following equation has no solution, because the alternative17. Use 8I to show that there is no solution x ≥ 0 (the alternative holds):18. Show that the alternatives in 8J (Ax ≥ b, x ≥ 0, yA ≥ 0, yb < 0, y ≤ 0) cannot both",linear_prog
"Chapter 5 Eigenvalues and Eigenvectors12. Find the eigenvalues and eigenvectors fordt = Au =Why do you know, without computing, that eAt will be an orthogonal matrix and3 will be constant?13. For the skew-symmetric equationdt = Au =(a) write out u′3 and conﬁrm that u′(b) deduce that the length u23 is a constant.(c) ﬁnd the eigenvalues of A.The solution will rotate around the axis w = (a,b,c), because Au is the “cross prod-uct” u×w—which is perpendicular to u and w.14. What are the eigenvalues λ and frequencies ω, and the general solution, of the fol-15. Solve the second-order equation16. In most applications the second-order equation looks like Mu′′+Ku = 0, with a massmatrix multiplying the second derivatives. Substitute the pure exponential u = eiωtxand ﬁnd the “generalized eigenvalue problem” that must be solved for the frequencyω and the vector x.17. With a friction matrix F in the equation u′′ + Fu′ − Au = 0, substitute a pure expo-nential u = eλtx and ﬁnd a quadratic eigenvalue problem for λ.18. For equation (16) in the text, with ω = 1 and3, ﬁnd the motion if the ﬁrst mass ishit at t = 0; u(0) = (0,0) and u′(0) = (1,0).19. Every 2 by 2 matrix with trace zero can be written asShow that its eigenvalues are real exactly when a2 +b2 ≥ c2.",eigenvec_val
"8.2 The Simplex Methodcolumns 1 and 3 to put basic variables before free variables:Then, elimination multiplies the ﬁrst row by −1, to give a unit pivot, and uses the secondrow to produce zeros in the second column:Fully reduced at PLook ﬁrst at r = [−1 1] in the bottom row. It has a negative entry in column 3, so thethird variable will enter the basis. The current corner P and its cost +6 are not optimal.The column above that negative entry is B−1u = (3,2); its ratios with the last column2. Since the ﬁrst ratio is smaller, the ﬁrst unknown w (and the ﬁrst column ofthe tableau) is pushed out of the basis. We move along the feasible set from corner P tocorner Q in Figure 8.3.The new tableau exchanges columns 1 and 3, and pivoting by elimination givesIn that new tableau at Q, r = [13] is positive. The stopping test is passed. The cornerx = y = 2 and its cost +4 are optimal.The Organization of a Simplex StepThe geometry of the simplex method is now expressed in algebra—“corners” are “basicfeasible solutions.” The vector r and the ratio α are decisive. Their calculation is theheart of the simplex method, and it can be organized in three different ways:1. In a tableau, as above.2. By updating B−1 when column u taken from N replaces column k of B.3. By computing B = LU, and updating these LU factors instead of B−1.This list is really a brief history of the simplex method, In some ways, the mostfascinating stage was the ﬁrst—the tableau—which dominated the subject for so manyyears. For most of us it brought an aura of mystery to linear programming, chieﬂybecause it managed to avoid matrix notation almost completely (by the skillful device of",linear_prog
"1.5 Triangular Factors and Row ExchangesStart with A and b;Apply steps 1, 2, 3 in that order;End with U and c.Ux = c is solved by back-substitution. Here we concentrate on connecting A to U.The matrices E for step 1, F for step 2, and G for step 3 were introduced in theprevious section. They are called elementary matrices, and it is easy to see how theywork. To subtract a multiple ℓ of equation j from equation i, put the number −ℓ intothe (i, j) position. Otherwise keep the identity matrix, with 1s on the diagonal and 0selsewhere. Then matrix multiplication executes the row operation.The result of all three steps is GFEA = U. Note that E is the ﬁrst to multiply A,then F, then G. We could multiply GFE together to ﬁnd the single matrix that takes Ato U (and also takes b to c). It is lower triangular (zeros are omitted):From A to UThis is good, but the most important question is exactly the opposite: How would weget from U back to A? How can we undo the steps of Gaussian elimination?To undo step 1 is not hard. Instead of subtracting, we add twice the ﬁrst row to thesecond. (Not twice the second row to the ﬁrst!) The result of doing both the subtractionand the addition is to bring back the identity matrix:One operation cancels the other. In matrix terms, one matrix is the inverse of the other.If the elementary matrix E has the number −ℓ in the (i, j) position, then its inverse E−1has +ℓ in that position. Thus E−1E = I, which is equation (4).We can invert each step of elimination, by using E−1 and F−1 and G−1. I think it’snot bad to see these inverses now, before the next section. The ﬁnal problem is to undothe whole process at once, and see what matrix takes U back to A.Since step 3 was last in going from A to U, its matrix G must be the ﬁrst to beinverted in the reverse direction. Inverses come in the opposite order! The secondreverse step is F−1 and the last is E−1:From U back to AE−1F−1G−1U = A is LU = A.You can substitute GFEA for U, to see how the inverses knock out the original steps.Now we recognize the matrix L that takes U back to A. It is called L, because it islower triangular. And it has a special property that can be seen only by multiplying the",gauss elim
"3.3 Projections and Least Squares3K The least-squares solution to a problem ax = b in one unknown is �x = aTbYou see that we keep coming back to the geometrical interpretation of a least-squaresproblem—to minimize a distance. By setting the derivative of E2 to zero, calculus con-ﬁrms the geometry of the previous section. The error vector e connecting b to p must beOrthogonality of a and eaT(b− �xa) = aTb− aTbAs a side remark, notice the degenerate case a = 0. All multiples of a are zero, andthe line is only a point. Therefore p = 0 is the only candidate for the projection. Butthe formula for �x becomes a meaningless 0/0, and correctly reﬂects the fact that �x iscompletely undetermined. All values of x give the same error E = ∥0x − b∥, so E2 isa horizontal line instead of a parabola. The “pseudoinverse” assigns the deﬁnite value�x = 0, which is a more “symmetric” choice than any other number.Least Squares Problems with Several VariablesNow we are ready for the serious step, to project b onto a subspace—rather than justonto a line. This problem arises from Ax = b when A is an m by n matrix. Insteadof one column and one unknown x, the matrix now has n columns. The number m ofobservations is still larger than the number n of unknowns, so it must be expected thatAx = b will be inconsistent. Probably, there will not exist a choice of x that perfectlyﬁts the data b. In other words, the vector b probably will not be a combination of thecolumns of A; it will be outside the column space.Again the problem is to choose �x so as to minimize the error, and again this mini-mization will be done in the least-squares sense. The error is E = ∥Ax − b∥, and thisis exactly the distance from b to the point Ax in the column space. Searching for theleast-squares solution �x, which minimizes E, is the same as locating the point p = A�xthat is closer to b than any other point in the column space.We may use geometry or calculus to determine �x. In n dimensions, we prefer theappeal of geometry; p must be the “projection of b onto the column space.” The errorvector e = b − A�x must be perpendicular to that space (Figure 3.8). Finding �x and theprojection p = A�x is so fundamental that we do it in two ways:1. All vectors perpendicular to the column space lie in the left nullspace. Thus theerror vector e = b−A�x must be in the nullspace of AT:",orthogonality
"1.3 An Example of Gaussian Elimination1. What multiple ℓ of equation 1 should be subtracted from equation 2?10x + 9y = 11.After this elimination step, write down the upper triangular system and circle the twopivots. The numbers 1 and 11 have no inﬂuence on those pivots.2. Solve the triangular system of Problem 1 by back-substitution, y before x. Verifythat x times (2,10) plus y times (3,9) equals (1,11). If the right-hand side changesto (4,44), what is the new solution?3. What multiple of equation 2 should be subtracted from equation 3?−x + 5y = 0.After this elimination step, solve the triangular system. If the right-hand side changesto (−6,0), what is the new solution?4. What multiple ℓ of equation 1 should be subtracted from equation 2?ax + by =+ dy = g.The ﬁrst pivot is a (assumed nonzero). Elimination produces what formula for thesecond pivot? What is y? The second pivot is missing when ad = bc.5. Choose a right-hand side which gives no solution and another right-hand side whichgives inﬁnitely many solutions. What are two of those solutions?3x + 2y =6x + 4y =6. Choose a coefﬁcient b that makes this system singular. Then choose a right-handside g that makes it solvable. Find two solutions in that singular case.2x + by = 164x + 8y =7. For which numbers a does elimination break down (a) permanently, and (b) tem-ax + 3y = −34x + 6y =Solve for x and y after ﬁxing the second breakdown by a row exchange.",gauss elim
"4.3 Formulas for the Determinant(1,3,2) requires one exchange and (3,1,2) requires two exchanges to recover (1,2,3).These are two of the six ± signs. For n = 2, we only have (1,2) and (2,1):No one can claim that the big formula (6) is particularly simple. Nevertheless, it ispossible to see why it has properties 1–3. For A = I, every product of the aij will bezero, except for the column sequence (1,2,...,n). This term gives detI = 1. Property 2will be checked in the next section, because here we are most interested in property 3:The determinant should depend linearly on the ﬁrst row a11,a12,...,a1n.Look at all the terms a1αa2β ···anv involving a11. The ﬁrst column is α = 1. Thisleaves some permutation (β,...,v) of the remaining columns (2,...,n). We collect allthese terms together as a11C11, where the coefﬁcient of a11 is a smaller determinant—with row 1 and column 1 removed:C11 = ∑(a2β ···anv)detP = det(submatrix of A).Similarly, the entry a12 is multiplied by some smaller determinant C12. Grouping all theterms that start with the same a1j, formula (6) becomesCofactors along row 1detA = a11C11 +a12C12 +···+a1nC1n.This shows that detA depends linearly on the entries a11,...,a1n of the ﬁrst row.Example 2. For a 3 by 3 matrix, this way of collecting terms givesdetA = a11(a22a33 − a23a32)+a12(a23a31 − a21a33)+a13(a21a32 − a22a31). (9)The cofactors C11, C12, C13 are the 2 by 2 determinants in parentheses.Expansion of detA in CofactorsWe want one more formula for the determinant. If this meant starting again from scratch,it would be too much, But the formula is already discovered—it is (8), and the only pointis to identify the cofactors C1 j that multiply a1 j.We know that C1 j depends on rows 2,...,n. Row 1 is already accounted for bya1j. Furthermore, a1j also accounts for the jth column, so its cofactor C1 j must depend",determinants
"(e) If eigenvectors x and y correspond to distinct eigenvalues, then xHy = 0.5.19 If K is a skew-symmetric matrix, show that Q = (I −K)(I +K)−1 is an orthogonalmatrix. Find Q if K =5.20 If KH = −K (skew-Hermitian), the eigenvalues are imaginary and the eigenvectors(a) How do you know that K −I is invertible?(b) How do you know that K = UΛUH for a unitary U?(c) Why is eΛt unitary?(d) Why is eKt unitary?5.21 If M is the diagonal matrix with entries d, d2, d3, what is M−1AM? What are itseigenvalues in the following case?5.22 If A2 = −I, what are the eigenvalues of A? If A is a real n by n matrix show that nmust be even, and give an example.5.23 If Ax = λ1x and ATy = λ2y (all real), show that xTy = 0.5.24 A variation on the Fourier matrix is the “sine matrix”:Verify that ST = S−1. (The columns are the eigenvectors of the tridiagonal −1, 2,5.25 (a) Find a nonzero matrix N such that N3 = 0.(b) If Nx = λx, show that λ must be zero.(c) Prove that N (called a “nilpotent” matrix) cannot be symmetric.5.26 (a) Find the matrix P = aaT/aTa that projects any vector onto the line through(b) What is the only nonzero eigenvalue of P, and what is the corresponding eigen-(c) Solve uk+1 = Puk, starting from u0 = (9,9,0).5.27 Suppose the ﬁrst row of A is 7, 6 and its eigenvalues are i, −i. Find A.",eigenvec_val
"Chapter 5 Eigenvalues and Eigenvectorsstarting conditions can lead to “superdecay” at the rate e−3t, In fact, those conditionsmust come from the eigenvector (1,−1). If the experiment admits only nonnegativeconcentrations, superdecay is impossible and the limiting rate must be e−t. The solutionthat decays at this slower rate corresponds to the eigenvector (1,1). Therefore the twoconcentrations will become nearly equal (typical for diffusion) as t → ∞.One more comment on this example: It is a discrete approximation, with only twounknowns, to the continuous diffusion described by this partial differential equation:∂t = ∂ 2uThat heat equation is approached by dividing the pipe into smaller and smaller segments,of length 1/N. The discrete system with N unknowns is governed byThis is the ﬁnite difference matrix with the 1, −2, 1 pattern. The right side Au approachesthe second derivative d2u/dx2, after a scaling factor N2 comes from the ﬂow problem.In the limit as N → ∞, we reach the heat equation ∂u/∂t = ∂ 2u/∂x2. Its solutionsare still combinations of pure exponentials, but now there are inﬁnitely many. Insteadof eigenvectors from Ax = λx, we have eigenfunctions from d2u/dx2 = λu. Those areu(x) = sinnπx with λ = −n2π2. Then the solution to the heat equation isThe constants cn are determined by the initial condition. The novelty is that the eigen-vectors are functions u(x), because the problem is continuous and not discrete.stability of differential equationsJust as for difference equations. the eigenvalues decide how u(t) behaves as t → ∞.As long as A can be diagonalized, there will be n pure exponential solutions to thedifferential equation, and any speciﬁc solution u(t) is some combinationu(t) = SeΛtS−1u0 = c1egl1tx1 +···+cneglntxn.Stability is governed by those factors eglit. If they all approach zero, then u(t) approacheszero: if they all stay bounded, then u(t) stays bounded; if one of them blows up, thenexcept for very special starting conditions the solution will blow up. Furthermore, thesize of eλt depends only on the real part of λ. It is only the real parts of the eigenvaluesthat govern stability: If λ = a+ib, theneλt = eateibt = eat(cosbt +isinbt)and the magnitude is",eigenvec_val
"1.7 Special Matrices and Applications(b) Compute the products AB and BA and A2.1.2 For the matricescompute AB and BA and A−1 and B−1 and (AB)−1.1.3 Find examp1es of 2 by 2 matrices with a12 = 12 for which (a) A2 = I.(c) A2 = A.1.4 Solve by elimination and back-substitution:+ w = 4u + v + w = 6v + w =1.5 Factor the preceding matrices into A = LU or PA = LU.1.6 (a) There are sixteen 2 by 2 matrices whose entries are 1s and 0s. How many are(b) (Much harder!) If you put 1s and 0s at random into the entries of a 10 by 10matrix, is it more likely to be invertible or singular?1.7 There are sixteen 2 by 2 matrices whose entries are 1s and −1s. How many are1.8 How are the rows of EA related to the rows of A in the following cases?1.9 Write down a 2 by 2 system with inﬁnitely many solutions.1.10 Find inverses if they exist, by inspection or by Gauss-Jordan:1.11 If E is 2 by 2 and it adds the ﬁrst equation to the second, what are E2 and E8 and1.12 True or false, with reason if true or counterexample if false:(1) If A is invertible and its rows are in reverse order in B, then B is invertible.",gauss elim
"5.2 Diagonalization of a Matrix5. Which of these matrices cannot be diagonalized?6. (a) If A2 = I, what are the possible eigenvalues of A?(b) If this A is 2 by 2, and not I or −I, ﬁnd its trace and determinant.(c) If the ﬁrst row is (3,−1), what is the second row?7. If A =, ﬁnd A100 by diagonalizing A.8. Suppose A = uvT is a column times a row (a rank-1 matrix).(a) By multiplying A times u, show that u is an eigenvector. What is λ?(b) What are the other eigenvalues of A (and why)?(c) Compute trace(A) from the sum on the diagonal and the sum of λ’s.9. Show by direct calculation that AB and BA have the same trace whenDeduce that AB−BA = I is impossible (except in inﬁnite dimensions).10. Suppose A has eigenvalues 1, 2, 4. What is the trace of A2? What is the determinant11. If the eigenvalues of A are 1, 1, 2, which of the following are certain to be true? Givea reason if true or a counterexample if false:(a) A is invertible.(b) A is diagonalizable.(c) A is not diagonalizable.12. Suppose the only eigenvectors of A are multiples of x = (1,0,0). True or false:(a) A is not invertible.(b) A has a repeated eigenvalue.(c) A is not diagonalizable.13. Diagonalize the matrix A =and ﬁnd one of its square roots—a matrix such thatR2 = A. How many square roots will there be?14. Suppose the eigenvector matrix S has ST = S−1. Show that A = SΛS−1 is symmetricand has orthogonal eigenvectors.Problems 15–24 are about the eigenvalue and eigenvector matrices.",eigenvec_val
"Chapter 1 Matrices and Gaussian Elimination(b) Construct a matrix that has column 1 + 2(column 3) = 0. Check that A issingular (fewer than 3 pivots) and explain why that must be the case.1.27 True or false, with reason if true and counterexample if false:(1) If L1U1 = L2U2 (upper triangular U’s with nonzero diagonal, lower triangularL’s with unit diagonal), then L1 = L2 and U1 = U2. The LU factorization is(2) If A2 +A = I then A−1 = A+I.(3) If all diagonal entries of A are zero, then A is singular.1.28 By experiment or the Gauss-Jordan method compute1.29 Write down the 2 by 2 matrices that(a) reverse the direction of every vector.(b) project every vector onto the x2 axis.(c) turn every vector counterclockwise through 90°.(d) reﬂect every vector through the 45° line x1 = x2.",gauss elim
"Chapter 6 Positive Deﬁnite MatricesProblems 1–2 compute the SVD of a square singular matrix A.1. Compute ATA and its eigenvalues σ21, 0 and unit eigenvectors v1, v2:2. (a) Compute AAT and its eigenvalues σ21, 0 and unit eigenvectors u1, u2.(b) Choose signs so that Av1 = σ1u1 and verify the SVD:(c) Which four vectors give orthonormal bases for C(A), N(A), C(AT), N(AT)?Problems 3–5 ask for the SVD of matrices of rank 2.3. Find the SVD from the eigenvectors v1, v2 of ATA and Avi = σiui:4. Use the SVD part of the MATLAB demo eigshow (or Java on the course pageweb.mit.edu/18.06) to ﬁnd the same vectors v1 and v2 graphically.5. Compute ATA and AAT, and their eigenvalues and unit eigenvectors, forMultiply the three matrices UΣV T to recover A.Problems 6–13 bring out the underlying ideas of the SVD.6. Suppose u1,...,un and v1,...,vn are orthonormal bases for Rn. Construct the matrixA that transforms each vj into u j to give Av1 = u1,...,Avn = un.7. Construct the matrix with rank 1 that has Av = 12u for v = 12(1,1,1,1) and u =3(2,2,1). Its only singular value is σ1 =8. Find UΣV T if A has orthogonal columns w1,...,wn of lengths σ1,...,σn.9. Explain how UΣV T expresses A as a sum of r rank-1 matrices in equation (3):",pos_def_matrices
"The key is to notice that those terms are the powers of W = w jw−k:1+W +W 2 +···+W n−1 = 0.This number W is still a root of unity: W n = wnjw−nk is equal to 1 j1−k = 1. Since jis different from k, W is different from 1. It is one of the other roots on the unit circle.Those roots all satisfy 1+W +···+W n−1 = 0. Another proof comes from1−W n = (1−W)(1+W +W 2 +···+W n−1).Since W n = 1, the left side is zero. But W is not 1, so the last factor must be zero. Thecolumns of F are orthogonal.The Fast Fourier TransformFourier analysis is a beautiful theory, and it is also very practical. To analyze a waveforminto its frequencies is the best way to take a signal apart. The reverse process brings itback. For physical and mathematical reasons the exponentials are special, and we canpinpoint one central cause: If you differentiate eikx, or integrate it, or translate x tox+h, the result is still a multiple of eikx. Exponentials are exactly suited to differentialequations, integral equations, and difference equations. Each frequency component goesits own way, as an eigenvector, and then they recombine into the solution. The analysisand synthesis of signals—computing c from y and y from c—is a central part of scientiﬁcWe want to show that Fc and F−1y can be done quickly. The key is in the relation ofF4 to F2—or rather to two copies of F2, which go into a matrix F∗F4 contains the powers of w4 = i, the fourth root of 1. F∗2 contains the powers of w2 = −1,the square root of 1. Note especially that half the entries in F∗2 are zero. The 2 by 2transform, done twice, requires only half as much work as a direct 4 by 4 transform. If64 by 64 transform could be replaced by two 32 by 32 transforms, the work would becut in half (plus the cost of reassembling the results). What makes this true, and possiblein practice, is the simple connection between w64 and w32:The 32nd root is twice as far around the circle as the 64th root. If w64 = 1, then (w2)32 =1. The mth root is the square of the nth root, if m is half of n:",orthogonality
"e = b − pp = �xa = aTbFigure 3.7: The projection p of b onto a, with cosθ = Opthe coefﬁcient �x. All we need is the geometrical fact that the line from b to the closestpoint p = �xa is perpendicular to the vector a:aT(b− �a) = 0,That gives the formula for the number �x and the projection p:3H The projection of the vector b onto the line in the direction of a is p = �xa:Projection onto a linep = �xa = aTbThis allows us to redraw Figure 3.5 with a correct formula for p (Figure 3.7).This leads to the Schwarz inequality in equation (6), which is the most importantinequality in mathematics. A special case is the fact that arithmetic means 1larger than geometric means √xy. (It is also equivalent—see Problem 1 at the end ofthis section—to the triangle inequality for vectors.) The Schwarz inequality seems tocome almost accidentally from the statement that ∥e∥2 = ∥b− p∥2 in Figure 3.7 cannotThis tells us that (bTb)(aTa) ≥ (aTb)2—and then we take square roots:3I All vectors a and b satisfy the Schwarz inequality, which is |cosθ| ≤ 1 inAccording to formula (2), the ratio between aTb and ∥a∥∥b∥ is exactly |cosθ|. Sinceall cosines lie in the interval −1 ≤ cosθ ≤ 1, this gives another proof of equation (6):the Schwarz inequality is the same as |cosθ| ≤ 1. In some ways that is a more easilyunderstood proof, because cosines are so familiar. Either proof is all right in Rn, but",orthogonality
"Chapter 6 Positive Deﬁnite Matricesinstead of 0, F(x) and all derivatives are computed at x0. Then x changes to x − x0 onThe next section contains the tests to decide whether xTAx is positive (the bowl goesup from x = 0). Equivalently, the tests decide whether the matrix A is positive deﬁ-nite—which is the main goal of the chapter.1. The quadratic f = x2 +4xy+2y2 has a saddle point at the origin, despite the fact thatits coefﬁcients are positive. Write f as a difference of two squares.2. Decide for or against the positive deﬁniteness of these matrices, and write out thecorresponding f = xTAx:The determinant in (b) is zero; along what line is f(x,y) = 0?3. If a 2 by 2 symmetric matrix passes the tests a > 0, ac > b2, solve the quadraticequation det(A−λI) = 0 and show that both eigenvalues are positive.4. Decide between a minimum, maximum, or saddle point for the following functions.(a) F = −1+4(ex −x)−5xsiny+6y2 at the point x = y = 0.(b) F = (x2 −2x)cosy, with stationary point at x = 1, y = π.5. (a) For which numbers b is the matrix A =(b) Factor A = LDLT when b is in the range for positive deﬁniteness.(c) Find the minimum value of 12(x2 +2bxy+9y2)−y for b in this range.(d) What is the minimum if b = 3?6. Suppose the positive coefﬁcients a and c dominate b in the sense that a + c > 2b.Find an example that has ac < b2, so the matrix is not positive deﬁnite.7. (a) What 3 by 3 symmetric matrices A1 and A2 correspond to f1 and f2?3 −2x1x2 −2x1x3 +2x2x33 −2x1x2 −2x1x3 −4x2x3.(b) Show that f1 is a single perfect square and not positive deﬁnite. Where is f1(c) Factor A2 into LLT, Write f2 = xTA2x as a sum of three squares.8. If A =is positive deﬁnite, test A−1 = [ p qq r ] for positive deﬁniteness.",pos_def_matrices
"Chapter 5 Eigenvalues and Eigenvectors5.28 (a) For which numbers c and d does A have real eigenvalues and orthogonal eigen-(b) For which c and d can we ﬁnd three orthonormal vectors that are combinationsof the columns (don’t do it!)?5.29 If the vectors x1 and x2 are in the columns of S, what are the eigenvalues and eigen-5.30 What is the limit as k → ∞ (the Markov steady state) of",eigenvec_val
"Chapter 5 Eigenvalues and Eigenvectors1. Find the eigenvalues and eigenvectors of the matrix A =. Verify that the traceequals the sum of the eigenvalues, and the determinant equals their product.2. With the same matrix A, solve the differential equation du/dt = Au, u(0) =What are the two pure exponential solutions?3. If we shift to A − 7I, what are the eigenvalues and eigenvectors and how are theyrelated to those of A?B = A−7I =4. Solve du/dt = Pu, when P is a projection:Part of u(0) increases exponentially while the nullspace part stays ﬁxed.5. Find the eigenvalues and eigenvectors ofCheck that λ1 +λ2 +λ3 equals the trace and λ1λ2λ3 equals the determinant.6. Give an example to show that the eigenvalues can be changed when a multiple of onerow is subtracted from another. Why is a zero eigenvalue not changed by the steps7. Suppose that λ is an eigenvalue of A, and x is its eigenvector: Ax = λx.(a) Show that this same x is an eigenvector of B = A − 7I, and ﬁnd the eigenvalue.This should conﬁrm Exercise 3.(b) Assuming λ ̸= 0, show that x is also an eigenvector of A−1—and ﬁnd the eigen-8. Show that the determinant equals the product of the eigenvalues by imagining thatthe characteristic polynomial is factored intodet(A−λI) = (λ1 −λ)(λ2 −λ)···(λn −λ),and making a clever choice of λ.",eigenvec_val
"the numbers 1,2,...,n. The 3 by 3 case produces 3! = 6 determinants:All but these n! determinants are zero, because a column is repeated. (There aren choices for the ﬁrst column α, n − 1 remaining choices for β, and ﬁnally only onechoice for the last column v. All but one column will be used by that time, when we“snake” down the rows of the matrix). In other words, there are n! ways to permute thenumbers 1,2,...,n. The column numbers give the permutations:(α,β,v) = (1,2,3), (2,3,1), (3,1,2), (1,3,2), (2,1,3), (3,2,1).Those are the 3! = 6 permutations of (1,2,3); the ﬁrst one is the identity.The determinant of A is now reduced to six separate and much simpler determinants.Factoring out the aij, there is a term for every one of the six permutations:Every term is a product of n = 3 entries aij, with each row and column represented once.If the columns come in the order (α,...,v), that term is the product a1α ···anv times thedeterminant of a permutation matrix P. The determinant of the whole matrix is the sumof these n! terms, and that sum is the explicit formula we are after:For an n by n matrix, this sum is taken over all n! permutations (α,...,v) of the numbers(1,...,n). The permutation gives the column numbers as we go down the matrix. The isappear in P at the same places where the a’s appeared in A.It remains to ﬁnd the determinant of P. Row exchanges transform it to the identitymatrix, and each exchange reverses the sign of the determinant:detP = +1 or −1for an even or odd number of row exchanges.",determinants
"4.2 Properties of the Determinant(e) the “reverse-triangular” matrix that results from row exchanges,0 0 0 20 0 2 60 1 2 24 4 8 88. Show how rule 6 (det = 0 if a row is zero) comes directly from rules 2 and 3.9. Suppose you do two row operations at once, going fromFind the determinant of the new matrix, by rule 3 or by direct calculation.10. If Q is an orthogonal matrix, so that QTQ = I, prove that detQ equals +1 or −1.What kind of box is formed from the rows (or columns) of Q?11. Prove again that detQ = 1 or −1 using only the Product rule. If |detQ| > 1 thendetQn blows up. How do you know this can’t happen to Qn?12. Use row operations to verify that the 3 by 3 “Vandermonde determinant” is13. (a) A skew-symmetric matrix satisﬁes KT = −K, as inIn the 3 by 3 case, why is det(−K) = (−1)3detK? On the other hand detKT =detK (always). Deduce that the determinant must be zero.(b) Write down a 4 by 4 skew-symmetric matrix with detK not zero.14. True or false, with reason if true and counterexample if false:(a) If A and B are identical except that b11 = 2a11, then detB = 2detA.(b) The determinant is the product of the pivots.(c) If A is invertible and B is singular, then A+B is invertible.(d) If A is invertible and B is singular, then AB is singular.(e) The determinant of AB−BA is zero.",determinants
"Chapter 1 Matrices and Gaussian EliminationThat could seem a little mysterious, unless you already know about 2 by 2 determi-nants. They gave the same answer y = 2, coming from the same ratio of −6 to −3.If we stay with determinants (which we don’t plan to do), there will be a similarformula to compute the other unknown, x:Let me compare those two approaches, looking ahead to real problems when n ismuch larger (n = 1000 is a very moderate size in scientiﬁc computing). The truth is thatdirect use of the determinant formula for 1000 equations would be a total disaster. Itwould use the million numbers on the left sides correctly, but not efﬁciently. We willﬁnd that formula (Cramer’s Rule) in Chapter 4, but we want a good method to solve1000 equations in Chapter 1.That good method is Gaussian Elimination. This is the algorithm that is constantlyused to solve large systems of equations. From the examples in a textbook (n = 3 isclose to the upper limit on the patience of the author and reader) too might not see muchdifference. Equations (2) and (4) used essentially the same steps to ﬁnd y = 2. Certainlyx came faster by the back-substitution in equation (3) than the ratio in (5). For largern there is absolutely no question. Elimination wins (and this is even the best way toThe idea of elimination is deceptively simple—you will master it after a few exam-ples. It will become the basis for half of this book, simplifying a matrix so that we canunderstand it. Together with the mechanics of the algorithm, we want to explain fourdeeper aspects in this chapter. They are:1. Linear equations lead to geometry of planes. It is not easy to visualize a nine-dimensional plane in ten-dimensional space. It is harder to see ten of those planes,intersecting at the solution to ten equations—but somehow this is almost possible.Our example has two lines in Figure 1.1, meeting at the point (x,y) = (−1,2).Linear algebra moves that picture into ten dimensions, where the intuition has toimagine the geometry (and gets it right)2. We move to matrix notation, writing the n unknowns as a vector x and the n equa-tions as Ax = b. We multiply A by “elimination matrices” to reach an upper trian-gular matrix U. Those steps factor A into L times U, where L is lower triangular.I will write down A and its factors for our example, and explain them at the right= L times U.",gauss elim
"1.5 Triangular Factors and Row Exchanges4. Apply elimination to produce the factors L and U for5. Factor A into LU, and write down the upper triangular system Ux = c which appears6. Find E2 and E8 and E−1 if7. Find the products FGH and HGF if (with upper triangular zeros omitted)0 0 0 10 0 0 10 0 2 18. (Second proof of A = LU) The third row of U comes from the third row of A bysubtracting multiples of rows 1 and 2 (of U!):row 3 of U = row 3 of A−ℓ31(row 1 of U)−ℓ32(row 2 of U).(a) Why are rows of U subtracted off and not rows of A? Answer: Because by thetime a pivot row is used,(b) The equation above is the same asrow 3 of A = ℓ31(row 1 of U)+ℓ32(row 2 of U)+1(row 3 of U).Which rule for matrix multiplication makes this row 3 of L times U?The other rows of LU agree similarly with the rows of A.9. (a) Under what conditions is the following product nonsingular?(b) Solve the system Ax = b starting with Lc = b:",gauss elim
"5.1 Find the eigenvalues and eigenvectors, and the diagonalizing matrix S, for5.2 Find the determinants of A and A−1 if5.3 If A has eigenvalues 0 and 1, corresponding to the eigenvectorshow can you tell in advance that A is symmetric? What are its trace and determi-nant? What is A?5.4 In the previous problem, what will be the eigenvalues and eigenvectors of A2? Whatis the relation of A2 to A?5.5 Does there exist a matrix A such that the entire family A + cI is invertible for allcomplex numbers c? Find a real matrix with A+rI invertible for all real r.5.6 Solve for both initial values and then ﬁnd eAt:5.7 Would you prefer to have interest compounded quarterly at 40% per year, or annu-5.8 True or false (with counterexample if false):(a) If B is formed from A by exchanging two rows, then B is similar to A.(b) If a triangular matrix is similar to a diagonal matrix, it is already diagonal.(c) Any two of these statements imply the third: A is Hermitian, A is unitary, A2 = I.(d) If A and B are diagonalizable, so is AB.5.9 What happens to the Fibonacci sequence if we go backward in time, and how is F−krelated to Fk? The law Fk+2 = Fk+1 +Fk is still in force, so F−1 = 1.5.10 Find the general solution to du/dt = Au if",eigenvec_val
"Chapter 5 Eigenvalues and Eigenvectors29. The powers Ak approach zero if all |λi| < 1, and they blow up if any |λi| > 1. PeterLax gives four striking examples in his book Linear Algebra.Find the eigenvalues λ = eiθ of B and C to show that B4 = I and C3 = −I.Differential Equations and eAtWherever you ﬁnd a system of equations, rather than a single equation, matrix theoryhas a part to play. For difference equations, the solution uk = Aku0 depended on the owenof A. For differential equations, the solution u(t) = eAtu(0) depends on the exponentialof A. To deﬁne this exponential. and to understand it, we turn right away to an example:dt = Au =The ﬁrst step is always to ﬁnd the eigenvalues (ł1 and −3) and the eigenvectors:Then several approaches lead to u(t). Probably the best is to match the general solutionto the initial vector u(0) at t = 0.The general solution is a combination of pure exponential solutions. These are so-lutions of the special form ceλtx, where λ is an eigenvalue of A and x is its eigenvec-tor. These pure solutions satisfy the differential equation, since d/dt(ceλtx) = A(ceλtx).(They were our introduction to eigenvalues at the start of the chapter.) In this 2 by 2example, there are two pure exponentials to be combined:u(t) = c1eλ1tx1 +c2eλ2tx2At time zero, when the exponentials are e0 = 1, u(0) determines c1 and c2:u(0) = c1x1 +c2x2 =You recognize S, the matrix of eigenvectors. The constants c = S−1u(0) are the same asthey were for difference equations. Substituting them back into equation (2), the solution",eigenvec_val
"1.22 (a) Ax = b has a solution under what conditions on b, for the following A and b?1 2 0 30 0 0 02 4 0 1(b) Find a basis for the nullspace of A.(c) Find the general solution to Ax = b, when a solution exists.(d) Find a basis for the column space of A.(e) What is the rank of AT?1.23 How can you construct a matrix that transforms the coordinate vectors e1,e2,e3 intothree given vectors v1,v2,v3? When will that matrix be invertible?1.24 If e1,e2,e3 are in the column space of a 3 by 5 matrix, does it have a left-inverse?Does it have a right-inverse?1.25 Suppose T is the linear transformation on R3 that takes each point (u,v,w) to (u+v+w,u+v,u), Describe what T −1 does to the point (x,y,z).1.26 True or false?(a) Every subspace of R4 is the nullspace of some matrix.(b) If A has the same nullspace as AT, the matrix must be square.(c) The transformation that takes x to mx+b is linear (from R1 to R1).1.27 Find bases for the four fundamental subspaces of1 2 0 30 2 2 20 0 0 00 0 0 41.28 (a) If the rows of A are linearly independent (A is m by n) then the rank is, and the left nullspace is(b) If A is 8 by 10 with a two-dimensional nullspace, show that Ax = b can be solved1.29 Describe the linear transformations of the x-y plane that are represented with stan-dard basis (1,0) and (0,1) by the matrices1.30 (a) If A is square, show that the nullspace of A2 contains the nullspace of A.",vector spaces
"Chapter 6 Positive Deﬁnite Matrices21. A positive deﬁnite matrix cannot have a zero (or even worse, a negative number) onits diagonal. Show that this matrix fails to have xTAx > 0:is not positive when22. A diagonal entry a j j of a symmetric matrix cannot be smaller than all λ’s. If itwere, then A−a j jI would haveeigenvalues and would be positive deﬁnite. ButA−a j jI has aon the main diagonal.23. Give a quick reason why each of these statements is true:(a) Every positive deﬁnite matrix is invertible.(b) The only positive deﬁnite projection matrix is P = I.(c) A diagonal matrix with positive diagonal entries is positive deﬁnite.(d) A symmetric matrix with a positive determinant might not be positive deﬁnite!24. For which s and t do A and B have all λ > 0 (and are therefore positive deﬁnite)?25. You may have seen the equation for an ellipse as (xa)2 + ( yb)2 = 1. What are a andb when the equation is written as λ1x2 + λ2y2 = 1? The ellipse 9x2 + 16y2 = 1 hashalf-axes with lengths a =, and b =26. Draw the tilted ellipse x2 +xy+y2 = 1 and ﬁnd the half-lengths of its axes from theeigenvalues of the corresponding A.27. With positive pivots in D, the factorization A = LDLT becomes Lroots of the pivots give D =D.) Then C = LD yields the Cholesky factor-ization A = CCT, which is “symmetrized LU”:28. In the Cholesky factorization A =CCT, with C = LD, the square roots of the pivotsare on the diagonal of C. Find C (lower triangular) for",pos_def_matrices
"5.4 Differential Equations and eAt−ω2 = λ. Every special solution eλtx of the ﬁrst-order equation leads to two specialsolutions eiωtx of the second-order equation. and the two exponents are ω = ±This breaks down only when λ = 0, which has just one square root; if the eigenvector isx, the two special solutions are x and tx.For a genuine diffusion matrix, the eigenvalues λ are all negative and the frequenciesω are all real: Pure diffusion is converted into pure oscillation. The factors eiωt produceneutral stability, the solution neither grows or decays, and the total energy stays preciselyconstant. It just keeps passing around the system. The general solution to d2u/dt2 = Au,if A has negative eigenvalues λ1,...,λn and if ω j =As always, the constants are found from the initial conditions. This is easier to do (at theexpense of one extra formula) by switching from oscillating exponentials to the morefamiliar sine and cosine:u(t) = (a1cosω1t +b1sinω1t)x1 +···+(ancosωnt +bnsinωnt)xn.The initial displacement u(0) is easy to keep separate: t = 0 means that sinωt = 0 andcosωt = 1, leaving onlyu(0) = a1x1 +···+anxn,Then differentiating u(t) and setting t = 0. the b’s are determined by the initial velocity:u′(0) = b1ω1x1 +···+bnωnxn. Substituting the a’s and b’s into the formula for u(t), theThe matrix A =has λ1 = −1 and λ2 = −3. The frequencies are ω1 = 1 and3. If the system starts from rest, u′(0) = 0, the terms in bsinωt will disappear:Solution from u(0) =Physically, two masses are connected to each other and to stationary wails by threeidentical springs (Figure 5.3). The ﬁrst mass is held at v(0) = 1, the second mass is heldat w(0) = 0, and at t = 0 we let go. Their motion u(t) becomes an average of two pureoscillations, corresponding to the two eigenvectors. In the ﬁrst mode x1 = (1,1), themasses move together and the spring in the middle is never stretched (Figure 5.3a). Thefrequency ω1 = 1 is the same as for a single spring and a single mass. In the faster modex2 = (1,−1) with frequency3, the masses move oppositely but with equal speeds. Thegeneral solution is a combination of these two normal modes. Our particular solution isAs time goes on, the motion is “almost periodic.” If the ratio ω1/ω2 had been afraction like 2/3, the masses would eventually return to u(0) = (1,0) and begin again.A combination of sin2t and sin3t would have a period of 2π. But3 is irrational. The",eigenvec_val
"Chapter 5 Eigenvalues and Eigenvectors17. Choose the third row of the “companion matrix”so that its characteristic polynomial |A−λI| is −λ 3 +4λ 2 +5λ +6.18. Suppose A has eigenvalues 0, 3, 5 with independent eigenvectors u, v, w.(a) Give a basis for the nullspace and a basis for the column space.(b) Find a particular solution to Ax = v+w. Find all solutions.(c) Show that Ax = u has no solution. (If it had a solution, then19. The powers Ak of this matrix A approaches a limit as k → ∞:The matrix A2 is halfway between A and A∞. Explain why A2 = 1eigenvalues and eigenvectors of these three matrices.20. Find the eigenvalues and the eigenvectors of these two matrices:eigenvectors as A. Its eigenvalues are21. Compute the eigenvalues and eigenvectors of A and A−1:eigenvectors as A. When A has eigenvalues λ1 and λ2, its inverse22. Compute the eigenvalues and eigenvectors of A and A2:A2 has the sameas A. When A has eigenvalues λ1 and λ2, A2 has eigenvalues23. (a) If you know x is an eigenvector, the way to ﬁnd λ is to",eigenvec_val
"Chapter 6 Positive Deﬁnite Matricesand x+ for any diagonal matrix Σ:The matrix Σ is m by n, with r nonzero entries σi. Its pseudoinverse Σ+ is n by m, withr nonzero entries 1/σi. All the blank spaces are zeros. Notice that (Σ+)+ is Σ again.That is like (A−1)−1 = A, but here A is not invertible.Now we ﬁnd x+ in the general case. We claim that the shortest solution x+ is alwaysin the row space of A. Remember that any vector �x can be split into a row space compo-nent xr and a nullspace component: �x = xr +xn. There are three important points about1. The row space component also solves ATA�xr = ATb, because Axn = 0.2. The components are orthogonal, and they obey Pythagoras’s law:∥�x∥2 = ∥xr∥2 +∥xn∥2,so �x is shortest when xn = 0.3. All solutions of ATA�x = ATb have the same xr. That vector is x+.The fundamental theorem of linear algebra was in Figure 3.4. Every p in the columnspace comes from one and only one vector xr in the row space. All we are doing is tochoose that vector, x+ = xr, as the best solution to Ax = b.The pseudoinverse in Figure 6.3 starts with b and comes back to x+. It inverts A whereA is invertible—between row space and column space. The pseudoinverse knocks outthe left nullspace by sending it to zero, and it knocks out the nullspace by choosing xr asWe have not yet shown that there is a matrix A+ that always gives x+—but there is.It will be n by m, because it takes b and p in Rm back to x+ in Rn. We look at one moreexample before ﬁnding A+ in general.Example 6. Ax = b is −x1 +2x2 +2x3 = 18, with a whole plane of solutions.According to our theory, the shortest solution should be in the row space of A =[−1 2 2]. The multiple of that row that satisﬁes the equation is x+ = (−2,4,4). Thereare longer solutions like (−2,5,3), (−2,7,1), or (−6,3,3), but they all have nonzerocomponents from the nullspace. The matrix that produces x+ from b = [18] is the pseu-doinverse A+. Whereas A was 1 by 3, this A+ is 3 by 1:",pos_def_matrices
"1.5 Triangular Factors and Row Exchangespivots. This is easy to correct. Divide out of U a diagonal pivot matrix D:In the last example all pivots were di = 1. In that case D = I. But that was very excep-tional, and normally LU is different from LDU (also written LDV).The triangular factorization can be written A = LDU, where L and U have 1s onthe diagonal and D is the diagonal matrix of pivots.Whenever you see LDU or LDV, it is understood that U or V has is on the diagonal—each row was divided by the pivot in D. Then L and U are treated evenly. An exampleof LU splitting into LDU isThat has the 1s on the diagonals of L and U, and the pivots 1 and −2 in D.Remark 2. We may have given the impression in describing each elimination step, thatthe calculations must be done in that order. This is wrong. There is some freedom, andthere is a “Crout algorithm” that arranges the calculations in a slightly different way.There is no freedom in the ﬁnal L, D, and U. That is our main point:If A = L1D1U1 and also A = L2D2U2, where the L’s are lower triangularwith unit diagonal, the U’s are upper triangular with unit diagonal, and theD’s are diagonal matrices with no zeros on the diagonal, then L1 = L2, D1 =D2, U1 = U2. The LDU factorization and the LU factorization are uniquelyThe proof is a good exercise with inverse matrices in the next section.Row Exchanges and Permutation MatricesWe now have to face a problem that has so far been avoided: The number we expect touse as a pivot might be zero. This could occur in the middle of a calculation. It willhappen at the very beginning if a11 = 0. A simple example isZero in the pivot positionThe difﬁculty is clear; no multiple of the ﬁrst equation will remove the coefﬁcient 3.",gauss elim
"Figure 6.5: Minimizing 12∥x∥2 for all x on the constraint line 2x1 −x2 = 5.In minimization, our big application is least squares. The best �x is the vector that mini-mizes the squared error E2 = ∥Ax−b∥2. This is a quadratic and it ﬁts our framework! Iwill highlight the parts that look new:E2 = (Ax−b)T(Ax−b) = xTATAx−2xTATb+bTb.2xTAx−xTb at the start of the section, which led to Ax = b:A changes to ATAb changes to ATbThe constant bTb raises the whole graph—this has no effect on the best �x. The othertwo changes, A to ATA and b to ATb, give a new way to reach the least-squares equation(normal equation). The minimizing equation Ax = b changes into theOptimization needs a whole book. We stop while it is pure linear algebra.Our second goal is to ﬁnd a minimization problem equivalent to Ax = λx. That is not soeasy. The function to minimize cannot be a quadratic, or its derivative would be linear—and the eigenvalue problem is nonlinear (λ times x). The trick that succeeds is to divideone quadratic by another one:6I Rayleigh’s Principle: The minimum value of the Rayleigh quotient isthe smallest eigenvalue λ1. R(x) reaches that minimum at the ﬁrst eigenvectorMinimum where Ax1 = λx1",pos_def_matrices
"Chapter 1 Matrices and Gaussian Eliminationin row i, column j of AT comes from row j, column i of A:(AT)ij = A ji.The transpose of a lower triangular matrix is upper triangular. The transpose of AT bringsus back to A.If we add two matrices and then transpose, the result is the same as ﬁrst transposingand then adding: (A+B)T is the same as AT +BT. But what is the transpose of a productAB or an inverse A−1? Those are the essential formulas of this section:(i) The transpose of AB is (AB)T = BTAT,(ii) The transpose of A−1 is (A−1)T = (AT)−1.Notice how the formula for (AB)T resembles the one for (AB)−1. In both cases wereverse the order, giving BTAT and B−1A−1. The proof for the inverse was easy, but thisone requires an unnatural patience with matrix multiplication. The ﬁrst row of (AB)T isthe ﬁrst column of AB. So the columns of A are weighted by the ﬁrst column of B. Thisamounts to the rows of AT weighted by the ﬁrst row of BT. That is exactly the ﬁrst rowof BTAT. The other rows of (AB)T and BTAT also agree.To establish the formula for (A−1)T, start from AA−1 = I and A−1A = I and take trans-poses. On one side, IT = I. On the other side, we know from part (i) the transpose of aproduct. You see how (A−1)T is the inverse of AT, proving (ii):Inverse of AT = Transpose of A−1With these rules established, we can introduce a special class of matrices, probablythe most important class of all. A symmetric matrix is a matrix that equals its owntranspose: AT = A. The matrix is necessarily square. Each entry on one side of thediagonal equals its “mirror image” on the other side: aij = a ji. Two simple examples areA and D (and also A−1):",gauss elim
"8.3 The Dual ProblemSimilarly, feasibility gives yAx ≤ cx. We get equality only when the second slacknesscondition is fulﬁlled. If there is an overpricing (y∗A)j < c j, it must be canceled throughj = 0. This leaves us with y∗b = cx∗ in equation (3). This equalityguarantees the optimality of x∗ and y∗.The Proof of DualityThe one-sided inequality yb ≤ cx was easy to prove; it gave a quick test for optimalvectors (they turn it into an equality); and now it has given the slackness conditions inequation (2). The only thing it has not done is to show that y∗b = cx∗ is really possible.Until those optimal vectors are actually produced, the duality theorem is not complete.To produce y∗ we return to the simplex method—which has already computed x∗. Ourproblem is to show that the method stopped in the right place for the dual problem (eventhough it was constructed to solve the primal). Recall that the m inequalities Ax ≥ bwere changed to equations by introducing the slack variables w = Ax−b:Every simplex step picked m columns of the long matrix [A −I] to be basic, and shiftedthem (theoretically) to the front. This produced [B N]. The same shift reordered thelong cost vector [c 0] into [cB cN]. The stopping condition, which brought the simplexmethod to an end, was r = cN −cBB−1N ≥ 0.This condition r ≥ 0 was ﬁnally met, since the number of corners is ﬁnite. At thatmoment the cost was as low as possible:If we can choose y∗ = cBB−1 in the dual, we certainly have y∗b = cx∗. The minimumand maximum will be equal. We have to show that this y∗ satisﬁes the dual constraintsyA ≤ c and y ≥ 0:When the simplex method reshufﬂes the long matrix and vector to put the basic variablesﬁrst, this rearranges the constraints in equation (6) intoFor y∗ = cBB−1, the ﬁrst half is an equality and the second half is cBB−1N ≤ cN. This isthe stopping condition r ≥ 0 that we know to be satisﬁed! Therefore our y∗ is feasible,and the duality theorem is proved. By locating the critical m by m matrix B, which isnonsingular as long as degeneracy is forbidden, the simplex method has produced theoptimal y∗ as well as x∗.",linear_prog
"1.4 Matrix Notation and Matrix MultiplicationThe second component of the product Ax is 4u−6v+0w, from the second row of A. Thematrix equation Ax = b is equivalent to the three simultaneous equations in equation (1).Row times column is fundamental to all matrix multiplications. From two vectors itproduces a single number. This number is called the inner product of the two vectors.In other words, the product of a 1 by n matrix (a row vector) and an n by 1 matrix (acolumn vector) is a 1 by 1 matrix:This conﬁrms that the proposed solution x = (1,1,2) does satisfy the ﬁrst equation.There are two ways to multiply a matrix A and a vector x. One way is a row at atime, Each row of A combines with x to give a component of Ax. There are three innerproducts when A has three rows:That is how Ax is usually explained, but the second way is equally important. In fact it ismore important! It does the multiplication a column at a time. The product Ax is foundall at once, as a combination of the three columns of A:The answer is twice column 1 plus 5 times column 2. It corresponds to the “columnpicture” of linear equations. If the right-hand side b has components 7, 6, 7, then thesolution has components 2, 5, 0. Of course the row picture agrees with that (and weeventually have to do the same multiplications).The column rule will be used over and over, and we repeat it for emphasis:Every product Ax can be found using whole columns as in equation (5).Therefore Ax is a combination of the columns of A. The coefﬁcients are theTo multiply A times x in n dimensions, we need a notation for the individual entries inA. The entry in the ith row and jth column is always denoted by aij. The ﬁrst subscriptgives the row number, and the second subscript indicates the column. (In equation (4),a21 is 3 and a13 is 6.) If A is an m by n matrix, then the index i goes from 1 to m—thereare m rows—and the index j goes from 1 to n. Altogether the matrix has mn entries, andamn is in the lower right corner.",gauss elim
"Chapter 5 Eigenvalues and Eigenvectorsprobabilities. With probability 110, an individual outside California moves in. If inside,the probability of moving out is 210. The movement becomes a random process, and A iscalled a transition matrix.The components of uk = Aku0 specify the probability that the individual is outsideor inside the state. These probabilities are never negative and add to 1—everybody hasto be somewhere. That brings us back to the two fundamental properties of a Markovmatrix: Each column adds to 1, and no entry is negative.Why is λ = 1 always an eigenvalue? Each column of A − I adds up to 1 − 1 = 0.Therefore the rows of A − I add up to the zero row, they are linearly dependent, andExcept for very special cases, uk will approach the corresponding eigenvector4. Inthe formula uk = c1λ knxn, no eigenvalue can be larger than 1. (Otherwisethe probabilities uk would blow up.) If all other eigenvalues are strictly smaller thanλ1 = 1, then the ﬁrst term in the formula will be dominant. The other λ ki go to zero, anduk → c1x1 = u∞ = steady state.This is an example of one of the central themes of this chapter: Given informationabout A, ﬁnd information about its eigenvalues. Here we found λmax = 1.Stability of uk+1 = AukThere is an obvious difference between Fibonacci numbers and Markov processes. Thenumbers Fk become larger and larger, while by deﬁnition any “probability” is between 0and 1. The Fibonacci equation is unstable. So is the compound interest equation Pk+1 =1.06Pk; the principal keeps growing forever. If the Markov probabilities decreased tozero, that equation would be stable; but they do not, since at every stage they must addto 1. Therefore a Markov process is neutrally stable.We want to study the behavior of uk+1 = Auk as k → ∞. Assuming that A can bediagonalized, uk will be a combination of pure solutions:Solution at time kuk = SΛkS−1u0 = c1λ kThe growth of uk is governed by the λ ki . Stability depends on the eigenvalues:The difference equation uk+1 = Auk isstable if all eigenvalues satisfy |λi| < 1;neutrally stable if some |λi| = 1 and all the other |λi| < 1; andunstable if at least one eigenvalue has |λi| > 1.In the stable case, the powers Ak approach zero and so does uk = Aku0.4If everybody outside moves in and everybody inside moves out, then the populations are reversed every yearand there is no steady state. The transition matrix is A =and −1 is an eigenvalue as well as +1—whichcannot happen if all ai j > 0.",eigenvec_val
"Chapter 5 Eigenvalues and EigenvectorsIf A can be diagonalized, A = SΛS−1, then du/dt = Au has the solutionu(t) = eAtu(0) = SeΛtS−1u(0).The columns of S are the eigenvectors x1,...,xn of A. Multiplying gives= c1eλ1tx1 +···+cneλntxn = combination of eλtx.The constants ci that match the initial conditions u(0) are c = S−1u(0).This gives a complete analogy with difference equations and SΛS−1u0. In both caseswe assumed that A could be diagonalized. since otherwise it has fewer than n eigenvec-tors and we have not found enough special solutions. The missing Solutions do exist,but they are more complicated than pure exponentials eλtx. They involve “generalizedeigenvectors” and factors like teλt. (To compute this defective case we can use the Jor-dan form in Appendix B, and ﬁnd eJt.) The formula u(t) = eAtu(0) remains completelyThe matrix eAt is never singular. One proof is to look at its eigenvalues; if λ is aneigenvalue of A, then eλt is the corresponding eigenvalue of eAt—and eλt can never bezero. Another approach is to compute the determinant of the exponential:deteAt = eλ1teλ2t ···eλnt = etrace(At).Quick proof that eAt is invertible: Just recognize e−At as its inverse.This invertibility is fundamental for differential equations. If n solutions are linearlyindependent at t = 0, they remain linearly independent forever. If the initial vectors arev1,...,vn, we can put the solutions eAtv into a matrix:The determinant of the left-hand side is the Wronskian. It never becomes zero, becauseit is the product of two nonzero determinants. Both matrices on the right-hand side areRemark. Not all differential equations come to us as a ﬁrst-order system du/dt = Au.We may start from a single equation of higher order, like y′′′ −3y′′ +2y′ = 0. To convertto a 3 by 3 system, introduce v = y′ and w = v′ as additional unknowns along with yitself. Then these two equations combine with the original one to give u′ = Au:",eigenvec_val
"1.4 Matrix Notation and Matrix Multiplication32. Write these ancient problems in a 2 by 2 matrix form Ax = b and solve them:(a) X is twice as old as Y and their ages add to 39,(b) (x,y) = (2,5) and (3,7) lie on the line y = mx+c. Find m and c.33. The parabola y = a + bx + cx2 goes through the points (x,y) = (1,4) and (2,8) and(3,14). Find and solve a matrix equation for the unknowns (a,b,c).34. Multiply these matrices in the orders EF and FE and E2:35. (a) Suppose all columns of B are the same. Then all columns of EB are the same,because each one is E times(b) Suppose all rows of B are [1 2 4]. Show by example that all rows of EB are not[1 2 4]. It is true that those rows are36. If E adds row 1 to row 2 and F adds row 2 to row 1, does EF equal FE?37. The ﬁrst component of Ax is ∑a1 jx j = a11x1 + ··· + a1nxn. Write formulas for thethird component of Ax and the (1,1) entry of A2.38. If AB = I and BC = I, use the associative law to prove A = C.39. A is 3 by 5, B is 5 by 3, C is 5 by 1, and D is 3 by 1. All entries are 1. Which of thesematrix operations are allowed, and what are the results?40. What rows or columns or matrices do you multiply to ﬁnd(a) the third column of AB?(b) the ﬁrst row of AB?(c) the entry in row 3, column 4 of AB?(d) the entry in row 1, column 1 of CDE?41. (3 by 3 matrices) Choose the only B so that for every matrix A,(a) BA = 4A.(b) BA = 4B.(c) BA has rows 1 and 3 of A reversed and row 2 unchanged.(d) All rows of BA are the same as row 1 of A.42. True or false?",gauss elim
"Chapter 1 Matrices and Gaussian Elimination(2) If A and B are symmetric then AB is symmetric.(3) If A and B are invertible then BA is invertible.(4) Every nonsingular matrix can be factored into the product A = LU of a lowertriangular L and an upper triangular U.1.13 Solve Ax = b by solving the triangular systems Lc = b and Ux = c:A = LU =What part of A−1 have you found, with this particular b?1.14 If possible, ﬁnd 3 by 3 matrices B such that(1) BA = 2A for every A.(2) BA = 2B for every A.(3) BA has the ﬁrst and last rows of A reversed.(4) BA has the ﬁrst and last columns of A reversed.1.15 Find the value for c in the following n by n inverse:1 1 1 c1.16 For which values of k doesx + ky = 1have no solution, one solution, or inﬁnitely many solutions?1.17 Find the symmetric factorization A = LDLT of1.18 Suppose A is the 4 by 4 identity matrix except for a vector v in column 2:",gauss elim
"2.5 Graphs and Networksloops. Now it has a linear algebra proof for any connected graph:(# of nodes)−(# of edges)+(# of loops) = (n)−(m)+(m−n+1) = 1.For a single loop of 10 nodes and 10 edges, the Euler number is 10−10+1. If those 10nodes are each connected to an eleventh node in the center, then 11−20+10 is still 1.Every vector f in the row space has xT f = f1+···+ fn = 0—the currents from outsideadd to zero. Every vector b in the column space has yTb = 0—the potential differencesadd to zero around all loops. In a moment we link x to y by a third law (Ohm’s law foreach resistor). First we stay with the matrix A for an application that seems frivolousThe Ranking of Football TeamsAt the end of the season, the polls rank college football teams. The ranking is mostly anaverage of opinions, and it sometimes becomes vague after the top dozen colleges. Wewant to rank all teams on a more mathematical basis.The ﬁrst step is to recognize the graph. If team j played team k, there is an edgebetween them. The teams are the nodes, and the games are the edges. There are a fewhundred nodes and a few thousand edges—which will be given a direction by an arrowfrom the visiting team to the home team. Figure 2.7 shows part of the Ivy League,and some serious teams, and also a college that is not famous for big time football.Fortunately for that college (from which I am writing these words) the graph is notconnected. Mathematically speaking, we cannot prove that MIT is not number 1 (unlessit happens to play a game against somebody).Figure 2.7: Part of the graph for college football.If football were perfectly consistent, we could assign a “potential” x j to every team.Then if visiting team v played home team h, the one with higher potential would win. Inthe ideal case, the difference b in the score would exactly equal the difference xh −xv intheir potentials. They wouldn’t even have to play the game! There would be completeagreement that the team with highest potential is the best.This method has two difﬁculties (at least). We are trying to ﬁnd a number x for everyteam, and we want xh −xv = bi, for every game. That means a few thousand equations",vector spaces
"3.4 Orthogonal Bases and Gram-SchmidtSuppose you are given three independent vectors a, b, c. If they are orthonormal, life iseasy. To project a vector v onto the ﬁrst one, you compute (aTv)a. To project the samevector v onto the plane of the ﬁrst two, you just add (aTv)a + (bTv)b. To project ontothe span of a, b, c, you add three projections. All calculations require only the innerproducts aTv, bTv, and cTv. But to make this true, we are forced to say, “If they areorthonormal.” Now we propose to ﬁnd a way to make them orthonormal.The method is simple. We are given a, b, c and we want q1, q2, q3. There is noproblem with q1: it can go in the direction of a. We divide by the length, so that q1 =a/∥a∥ is a unit vector. The real problem begins with q2—which has to be orthogonalto q1. If the second vector b has any component in the direction of q1 (which is thedirection of a), that component has to be subtracted:B is orthogonal to q1. It is the part of b that goes in a new direction, and not in the a. InFigure 3.10, B is perpendicular to q1. It sets the direction for q2.Figure 3.10: The qi component of b is removed; a and B normalized to q1 and q2.At this point q1 and q2 are set. The third orthogonal direction starts with c. It willnot be in the plane of q1 and q2, which is the plane of a and b. However, it may have acomponent in that plane, and that has to be subtracted. (If the result is C = 0, this signalsthat a, b, c were not independent in the ﬁrst place) What is left is the component C wewant, the part that is in a new direction perpendicular to the plane:This is the one idea of the whole Gram-Schmidt process, to subtract from every newvector its components in the directions that are already settled. That idea is used overand over again.3 When there is a fourth vector, we subtract away its components in thedirections of q1, q2, q3.3If Gram thought of it ﬁrst, what was left for Schmidt?",orthogonality
"Chapter 1 Matrices and Gaussian EliminationRemark. One good way to write down the forward elimination steps is to include theright-hand side as an extra column. There is no need to copy u and v and w and = atevery step, so we are left with the bare minimum:0 −8 −2 −120 −8 −2 −12At the end is the triangular system, ready for back-substitution. You may prefer thisarrangement, which guarantees that operations on the left-hand side of the equations arealso done on the right-hand side—because both sides are there together.In a larger problem, forward elimination takes most of the effort. We use multiplesof the ﬁrst equation to produce zeros below the ﬁrst pivot. Then the second column iscleared out below the second pivot. The forward step is ﬁnished when the system istriangular; equation n contains only the last unknown multiplied by the last pivot. Back-substitution yields the complete solution in the opposite order—beginning with the lastunknown, then solving for the next to last, and eventually for the ﬁrst.By deﬁnition, pivots cannot be zero. We need to divide by them.The Breakdown of EliminationUnder what circumstances could the process break down? Something must go wrongin the singular case, and something might go wrong in the nonsingular case. This mayseem a little premature—after all, we have barely got the algorithm working. But thepossibility of breakdown sheds light on the method itself.The answer is: With a full set of n pivots, there is only one solution. The system isnon singular, and it is solved by forward elimination and back-substitution. But if a zeroappears in a pivot position, elimination has to stop—either temporarily or permanently.The system might or might not be singular.If the ﬁrst coefﬁcient is zero, in the upper left corner, the elimination of u from theother equations will be impossible. The same is true at every intermediate stage. Noticethat a zero can appear in a pivot position, even if the original coefﬁcient in that placewas not zero. Roughly speaking, we do not know whether a zero will appear until wetry, by actually going through the elimination process.In many cases this problem can be cured, and elimination can proceed. Such a systemstill counts as nonsingular; it is only the algorithm that needs repair. In other cases abreakdown is unavoidable. Those incurable systems are singular, they have no solutionor else inﬁnitely many, and a full set of pivots cannot be found.",gauss elim
"8.2 The Simplex MethodA newer approach uses the ordinary methods of numerical linear algebra, regardingequation (4) as three equations sharing the same matrix B:The usual factorization B = LU (or PB = LU, with row exchanges for stability) leads tothe three solutions. L and U can be updated instead of recomputed.One question remains: How many simplex steps do we have to take? This is impos-sible to answer in advance. Experience shows that the method touches only about 3m/2different corners, which means an operation count of about m2n. That is comparable toordinary elimination for Ax = b, and is the reason for the simplex method’s success. Butmathematics shows that the path length cannot always be bounded by any ﬁxed multipleor power of m. The worst feasible sets (Klee and Minty invented a lopsided cube) canforce the simplex method to try every corner—at exponential cost.It was Khachian’s method that showed that linear programming could be solved inpolynomial time.1 His algorithm stayed inside the feasible set, and captured x∗ in a seriesof shrinking ellipsoids. Linear programming is in the nice class P, not in the dreadedclass NP (like the traveling salesman problem). For NP problems it is believed (but notproved) that all deterministic algorithms must take exponentially long to ﬁnish, in theAll this time, the simplex method was doing the job—in an average time that is nowproved (for variants of the usual method) to be polynomial. For some reason, hidden inthe geometry of many-dimensional polyhedra, bad feasible sets are rare and the simplexWe come now to the most sensational event in the recent history of linear programming.Karmarkar proposed a method based on two simple ideas, and in his experiments itdefeated the simplex method. The choice of problem and the details of the code are bothcrucial, and the debate is still going on. But Karmarkar’s ideas were so natural, and ﬁtso perfectly into the framework of applied linear algebra, that they can be explained in aThe ﬁrst idea is to start from a point inside the feasible set—we will suppose it isx0 = (1,1,...,1). Since the cost is cx, the best cost-reducing direction is toward −c.Normally that takes us off the feasible set; moving in that direction does not maintainAx = b. If Ax0 = b and Ax1 = b, then ∆x = x1 −x0 has to satisfy A∆x = 0. The step ∆xmust lie in the nullspace of A. Therefore we project −c onto the nullspace, to ﬁnd thefeasible direction closest to the best direction. This is the natural but expensive step in1The number of operations is bounded by powers of m and n, as in elimination. For integer programming andfactoring into primes, all known algorithms can take exponentially long. The celebrated conjecture “P ̸= NP” saysthat such problems cannot have polynomial algorithms.",linear_prog
"Chapter 5 Eigenvalues and EigenvectorsProperty 1 If A = AH, then for all complex vectors x, the number xHAx is real.Every entry of A contributes to xHAx. Try the 2 by 2 case with x = (u,v):= real+real+(sum of complex conjugates).For a proof in general. (xHAx)H is the conjugate of the 1 by 1 matrix xHAx, but weactually get the same number back again: (xHAx)H = xHAHxHH = xHAx. So that numberProperty 2 If A = AH, every eigenvalue is real.Proof. Suppose Ax = λx. The trick is to multiply by xH: xHAx = λxHx. The left-handside is real by Property 1, and the right-hand side xHx = ∥x∥2 is real and positive, becausex ̸= 0. Therefore λ = xHAx/xHx must be real. Our example has λ = 8 and λ = −1:����� = λ 2 −7λ +10−|3−3i|2= λ 2 −7λ −8 = (λ −8)(λ +1).Note. This proof of real eigenvalues looks correct for any real matrix:There must be a catch: The eigenvector x might be complex. It is when A = AT thatwe can be sure λ and x stay real. More than that, the eigenvectors are perpendicular:xTy = 0 in the real symmetric case and xHy = 0 in the complex Hermitian case.Property 3 Two eigenvectors of a real symmetric matrix or a Hermitian ma-trix, if they come from different eigenvalues, are orthogonal to one another.The proof starts with Ax = λ1x, Ay = λ1y, and A = AH:(λ1x)Hy = (Ax)Hy = xHAy = xH(λ2y).The outside numbers are λ1xHy = λ2xHy, since the λ’s are real. Now wc use the assump-tion λ1 ̸= λ2, which forces the conclusion that xHy = 0. In our example,",eigenvec_val
"Chapter 1 Matrices and Gaussian Elimination37. Use Gauss-Jordan elimination on [A I] to solve AA−1 = I:38. Invert these matrices A by the Gauss-Jordan method starting with [A I]:39. Exchange rows and continue with Gauss-Jordan to ﬁnd A−1:0 2 1 02 2 0 140. True or false (with a counterexample if false and a reason if true):(a) A 4 by 4 matrix with a row of zeros is not invertible.(b) A matrix with Is down the main diagonal is invertible.(c) If A is invertible then A−1 is invertible.(d) If AT is invertible then A is invertible.41. For which three numbers c is this matrix not invertible, and why not?42. Prove that A is invertible if a ̸= 0 and a ̸= b (ﬁnd the pivots and A−1):43. This matrix has a remarkable inverse. Find A−1 by elimination on [A I]. Extend to a5 by 5 “alternating matrix” and guess its inverse:",gauss elim
"6.3 Singular Value DecompositionA great matrix factorization has been saved for the end of the basic course. UΣV T joinswith LU from elimination and QR from orthogonalization (Gauss and Gram-Schmidt).Nobody’s name is attached; A = UΣV T is known as the “SVD” or the singular valuedecomposition. We want to describe it, to prove it, and to discuss its applications—which are many and growing.The SVD is closely associated with the eigenvalue-eigenvector factorization QΛQT ofa positive deﬁnite matrix. The eigenvalues are in the diagonal matrix Λ. The eigenvectormatrix Q is orthogonal (QTQ = I) because eigenvectors of a symmetric matrix can bechosen to be orthonormal. For most matrices that is not true, and for rectangular matricesit is ridiculous (eigenvalues undeﬁned). But now we allow the Q on the left and the QTon the right to be any two orthogonal matrices U and V T—not necessarily transposes ofeach other. Then every matrix will split into A = UΣV T.The diagonal (but rectangular) matrix Σ has eigenvalues from ATA, not from A! Thosepositive entries (also called sigma) will be σ1,...,σr. They are the singular values of A.They ﬁll the ﬁrst r places on the main diagonal of Σ—when A has rank r. The rest of ΣWith rectangular matrices, the key is almost always to consider ATA and AAT.Any m by n matrix A can be factoredA = UΣV T = (orthogonal)(diagonal)(orthogonal).The columns of U (m by m) are eigenvectors of AAT, and the columns of V (nby n) are eigenvectors of ATA. The r singular values on the diagonal of Σ (mby n) are the square roots of the nonzero eigenvalues of both AAT and ATA.Remark 1. For positive deﬁnite matrices, Σ is Λ and UΣV T is identical to QΛQT. Forother symmetric matrices, any negative eigenvalues in Λ become positive in Σ. Forcomplex matrices, Σ remains real but U and V become unitary (the complex version oforthogonal). We take complex conjugates in UHU = I and V HV = I and A = UΣV H.Remark 2. U and V give orthonormal bases for all four fundamental subspaces:columns of U: column space of Am−r columns of U: left nullspace of Arow space of ARemark 3. The SVD chooses those bases in an extremely special way. They are morethan just orthonormal. When A multiplies a column vj of V, it produces σ j times acolumn of U. That comes directly from AV = UΣ, looked at a column at a time.",pos_def_matrices
"Chapter 2 Vector Spacesreﬂected across the 45° line. It was split into (2,2) + (2,−2) and the two parts werereﬂected separately. The same could be done for projections: split, project separately,and add the projections. These rules apply to any transformation that comes from aTheir importance has earned them a name: Transformations that obey rules (i)–(iii)are called linear transformations. The rules can be combined into one requirement:For all numbers c and d and all vectors x and y, matrix multiplicationsatisﬁes the rule of linearity:Every transformation T(x) that meets this requirement is a linear transforma-Any matrix leads immediately to a linear transformation. The more interesting questionis in the opposite direction: Does every linear transformation lead to a matrix? Theobject of this section is to ﬁnd the answer, yes. This is the foundation of an approachto linear algebra—starting with property (1) and developing its consequences—that ismuch more abstract than the main approach in this book. We preferred to begin directlywith matrices, and now we see how they represent linear transformations.A transformation need not go from Rn to the same space Rn. It is absolutely permittedto transform vectors in Rn to vectors in a different space Rm. That is exactly what is doneby an m by n matrix! The original vector x has n components, and the transformed vectorAx has m components. The rule of linearity is equally satisﬁed by rectangular matrices,so they also produce linear transformations.Having gone that far, there is no reason to stop. The operations in the linearity con-dition (1) are addition and scalar multiplication, but x and y need not be column vectorsin Rn. Those are not the only spaces. By deﬁnition, any vector space allows the com-binations cx + dy—the “vectors” are x and y, but they may actually be polynomials ormatrices or functions x(t) and y(t). As long as the transformation satisﬁes equation (1),We take as examples the spaces Pn, in which the vectors are polynomials p(t) ofdegree n. They look like p = a0 +a1t +···+antn, and the dimension of the vector spaceis n+1 (because with the constant term, there are n+1 coefﬁcients).Example 1. The operation of differentiation, A = d/dt, is linear:dt (a0 +a1t +···+antn) = a1 +···+nantn−1.The nullspace of this A is the one-dimensional space of constants: da0/dt = 0. Thecolumn space is the n-dimensional space Pn−1; the right-hand side of equation (2) isalways in that space. The sum of nullity (= 1) and rank (= n) is the dimension of the",vector spaces
"they are unit vectors—each has length ∥ei∥ = 1. They point along the coordinate axes. Ifthese axes are rotated, the result is a new orthonormal basis: a new system of mutuallyorthogonal unit vectors. In R2 we have cos2 θ +sin2θ = 1:Orthonormal vectors in R2We come to the orthogonality of two subspaces. Every vector in one subspace must beorthogonal to every vector in the other subspace. Subspaces of R3 can have dimension0, 1, 2, or 3. The subspaces are represented by lines or planes through the origin—and in the extreme cases, by the origin alone or the whole space. The subspace {0}is orthogonal to all subspaces. A line can be orthogonal to another line, or it can beorthogonal to a plane, but a plane cannot be orthogonal to a plane.I have to admit that the front wall and side wall of a room look like perpendicularplanes in R3. But by our deﬁnition, that is not so! There are lines v and w in the frontand side walls that do not meet at a right angle. The line along the corner is in bothwalls, and it is certainly not orthogonal to itself.Two subspaces V and W of the same space Rn are orthogonal if everyvector v in V is orthogonal to every vector w in W: vTw = 0 for all v and w.Example 2. Suppose V is the plane spanned by v1 = (1,0,0,0) and v2 = (1,1,0,0). IfW is the line spanned by w = (0,0,4,5), then w is orthogonal to both v’s. The line Wwill be orthogonal to the whole plane V.In this case, with subspaces of dimension 2 and 1 in R4, there is room for a thirdsubspace. The line L through z = (0,0,5,−4) is perpendicular to V and W. Then thedimensions add to 2+1+1 = 4. What space is perpendicular to all of V, W, and L?The important orthogonal subspaces don’t come by accident, and they come two ata time. In fact orthogonal subspaces are unavoidable: They are the fundamental sub-spaces! The ﬁrst pair is the nullspace and row space. Those are subspaces of Rn—therows have n components and so does the vector x in Ax = 0. We have to show, usingAx = 0, that the rows of A are orthogonal to the nullspace vector x.Fundamental theorem of orthogonality The row space is orthogonalto the nullspace (in Rn). The column space is orthogonal to the left nullspaceFirst Proof. Suppose x is a vector in the nullspace. Then Ax = 0, and this system of m",orthogonality
"6.2 Tests for Positive DeﬁnitenessThe Law of InertiaFor elimination and eigenvalues, matrices become simpler by elementary operationsThe essential thing is to know which properties of the matrix stay unchanged. Whena multiple of one row is subtracted from another, the row space, nullspace. rant anddeterminant all remain the same. For eigenvalues, the basic operation was a similaritytransformation A → S−1AS (or A → M−1AM). The eigenvalues are unchanged (and alsothe Jordan form). Now we ask the same question for symmetric matrices: What are theelementary operations and their invariants for xTAx?The basic operation on a quadratic form is to change variables. A new vector y isrelated to x by some nonsingular matrix, x =Cy. The quadratic form becomes yTCTACy.This shows the fundamental operation on A:for some nonsingular C.The symmetry of A is preserved, since CTAC remains symmetric. The real question is,What other properties are shared by A and CTAC? The answer is given by Sylvester’s6F CTAC has the same number of positive eigenvalues, negative eigenvalues,and zero eigenvalues as A.The signs of the eigenvalues (and not the eigenvalues themselves) are preserved by acongruence transformation. In the proof, we will suppose that A is nonsingular. ThenCTAC is also nonsingular, and there are no zero eigenvalues to worry about. (Otherwisewe can work with the nonsingular A+ εI and A−εI, and at the end let ε → 0.)Proof. We want to borrow a trick from topology. Suppose C is linked to an orthogonalmatrix Q by a continuous chain of nonsingular matrices C(t). At t = 0 and t = 1, C(0) =C and C(1) = Q. Then the eigenvalues of C(t)TAC(t) will change gradually, as t goesfrom 0 to 1, from the eigenvalues of CTAC to the eigenvalues of QTAQ. Because C(t) isnever singular, none of these eigenvalues can touch zero (not to mention cross over it!).Therefore the number of eigenvalues to the right of zero, and the number to the left, isthe same for CTAC as for QTAQ. And A has exactly the same eigenvalues as the similarmatrix Q−1AQ = QTAQ.One good choice for Q is to apply Gram-Schmidt to the columns of C. Then C = QR,and the chain of matrices is C(t) = tQ+(1−t)QR. The family C(t) goes slowly throughGram-Schmidt, from QR to Q. It is invertible, because Q is invertible and the triangularfactor tI +(1−t)R has positive diagonal. That ends the proof.Example 4. Suppose A = I. Then CTAC = CTC is positive deﬁnite. Both I and CTChave n positive eigenvalues, conﬁrming the law of inertia.Example 5. If A =, then CTAC has a negative determinant:detCTAC = (detCT)(detA)(detC) = −(detC)2 < 0.",pos_def_matrices
"1.6 Inverses and Transposes(a) Find the total currents ATy out of the three cities.(b) Verify that (Ax)Ty agrees with xT(ATy)—six terms in both.62. Producing x1 trucks and x2 planes requires x1 + 50x2 tons of steel, 40x1 + 1000x2pounds of rubber, and 2x1 +50x2 months of labor. If the unit costs y1, y2, y3 are $700per ton, $3 per pound, and $3000 per month, what are the values of one truck andone plane? Those are the components of ATy.63. Ax gives the amounts of steel, rubber, and labor to produce x in Problem 62. Find A.Then (Ax)Ty is theof inputs while xT(ATy) is the value of64. Here is a new factorization of A into triangular times symmetric:Start from A = LDU. Then A equals L(UT)−1 times UTDU.Why is L(UT)−1 triangular? Its diagonal is all 1s. Why is UTDU symmetric?65. A group of matrices includes AB and A−1 if it includes A and B. “Products andinverses stay in the group.” Which of these sets are groups? Lower triangularmatri-ces L with is on the diagonal, symmetric matrices S, positive matrices M, diagonalinvertible matrices D, permutation matrices P. Invent two more matrix groups.66. If every row of a 4 by 4 matrix contains the numbers 0, 1, 2, 3 in some order, can thematrix be symmetric? Can it be invertible?67. Prove that no reordering of rows and reordering of columns can transpose a typical68. A square northwest matrix B is zero in the southeast corner, below the antidiagonalthat connects (1,n) to (n,1). Will BT and B2 be northwest matrices? Will B−1 benorthwest or southeast? What is the shape of BC = northwest times southeast?You are allowed to combine permutations with the usual L and U (southwest and69. Compare tic; inv(A); toc for A = rand(500) and A = rand(1000). The n3 countsays that computing time (measured by tic; toc) should multiply by 8 when n isdoubled. Do you expect these random A to be invertible?70. I = eye(1000); A = rand(1000); B = triu(A); produces a random triangular matrixB. Compare the times for inv(B) and B\I. Backslash is engineered to use the zerosin B, while inv uses the zeros in I when reducing [B I] by Gauss-Jordan. (Comparealso with inv(A) and A\I for the full matrix A.)71. Show that L−1 has entries j/i for i ≤ j (the −1, 2, −1 matrix has this L):",gauss elim
"7.4 Iterative Methods for Ax = bThe optimal ω makes the largest eigenvalue of L (its spectral radius) as small as possible.The whole point of overrelaxation is to discover this optimal ω. The product of theeigenvalues equals detL = detT/detS:λ1λ2 = detL = (1−ω)2.Always detS = detD because L lies below the diagonal, and detT = det(1 − ω)D be-cause U lies above the diagonal. Their product is detL = (1− ω)n. (This explains whywe never go as far as ω = 2. The product of the eigenvalues would be too large, andthe iteration could not converge.) We also get a clue to the behavior of the eigenvalues:At the optimal ω the two eigenvalues are equal. They must both equal ω − 1 so theirproduct will match detL. This value of ω is easy to compute, because the sum of theeigenvalues always agrees with the sum of the diagonal entries (the trace of L):λ1 +λ2 = (ωopt −1)+(ωopt −1) = 2−2ωopt + 1This quadratic equation gives ωopt = 4(2−3) ≈ 1.07. The two equal eigenvalues areapproximately ω − 1 = 1.07, which is a major reduction from the Gauss-Seidel value4 at ω = 1. In this example, the right choice of ω has again doubled the rate of4)2 ≈ .07. If ω is further increased, the eigenvalues become acomplex conjugate pair—both have |λ| = ω −1, which is now increasing with ω.The discovery that such an improvement could be produced so easily, almost as if bymagic, was the starting point for 20 years of enormous activity in numerical analysis.The ﬁrst problem was solved in Young’s 1950 thesis—a simple formula for the optimalω. The key step was to connect the eigenvalues λ of L to the eigenvalues µ of theoriginal Jacobi matrix D−1(−L−U). That connection is expressed by(λ +ω −1)2 = λω2µ2.This is valid for a wide class of ﬁnite difference matrices, and if we take ω = 1 (Gauss-Seidel) it yields λ 2 = λµ2. Therefore λ = 0 and λ = µ2 as in Example 2, where µ = ±1and λ = 0, λ = 14. All the matrices in Young’s class have eigenvalues µ that occur inplus-minus pairs, and the corresponding λ are 0 and µ2. So Gauss-Seidel doubles theJacobi rate of convergence.The important problem is to choose ω so that λmax will be minimized. Fortunately,Young’s equation (7) is exactly our 2 by 2 example! The best ω makes the two roots λboth equal to ω −1:(ω −1)+(ω −1) = 2−2ω + µ2ω2,For a large matrix, this pattern will be repeated for a number of different pairs ±µi—andwe can only make a single choice of ω. The largest µ gives the largest value of ω and",computations
"2.3 Linear Independence, Basis, and DimensionLook for a combination of the columns that makes zero:Solve Ac = 0We have to show that c1, c2, c3 are all forced to be zero. The last equation givesc3 = 0. Then the next equation gives c2 = 0, and substituting into the ﬁrst equation forcesc1 = 0. The only combination to produce the zero vector is the trivial combination. Thenullspace of A contains only the zero vector c1 = c2 = c3 = 0.The columns of A are independent exactly when N(A) = {zero vector}.A similar reasoning applies to the rows of A, which are also independent. SupposeFrom the ﬁrst components we ﬁnd 3c1 = 0 or c1 = 0. Then the second components givec2 = 0, and ﬁnally c3 = 0.The nonzero rows of any echelon matrix U must be independent. Furthermore, if wepick out the columns that contain the pivots, they also are linearly independent. In our1 3 3 20 0 3 10 0 0 0the pivot columns 1 and 3 are independent. No set of three columns is independent, andcertainly not all four. It is true that columns 1 and 4 are also independent, but if thatlast 1 were changed to 0 they would be dependent. It is the columns with pivots that areguaranteed to be independent. The general rule is this:The r nonzero rows of an echelon matrix U and a reduced matrix R arelinearly independent. So are the r columns that contain pivots.Example 4. The columns of the n by n identity matrix are independent:0 0 0 1These columns e1,...,en represent unit vectors in the coordinate directions; in R4,",vector spaces
"Chapter 2 Vector SpacesThe full picture uses elimination and pivot columns to ﬁnd the column space, nullspace,and rank. The 3 by 4 matrix A has rank 2:1. Reduce [A b] to [U c], to reach a triangular system Ux = c.2. Find the condition on b1, b2, b3 to have a solution.3. Describe the column space of A: Which plane in R3?4. Describe the nullspace of A: Which special solutions in R4?5. Find a particular solution to Ax = (0,6,−6) and the complete xp +xn.6. Reduce [U c] to [R d]: Special solutions from R and xp from d.Solution. (Notice how the right-hand side is included as an extra column!)1. The multipliers in elimination are 2 and 3 and −1, taking [A b] to [U c].2 4 8 123 6 7 130 0 −2 −21 2 3 50 0 2 20 0 0 0b3 + b2 − 5b12. The last equation shows the solvability condition b3 +b2 −5b1 = 0. Then 0 = 0.3. The column space of A is the plane containing all combinations of the pivot columnsSecond description: The column space contains all vectors with b3+b2−5b1 = 0.That makes Ax = b solvable, so b is in the column space. All columns of A pass thistest b3 +b2 −5b1 = 0. This is the equation for the plane (in the ﬁrst description of4. The special solutions in N have free variables x2 = 1, x4 = 0 and x2 = 0, x4 = 1:Special solutions to Ax = 0Back-substitution in Ux = 0Just switch signs in Rx = 0",vector spaces
"Chapter 2 Vector Spacesto show how it can be broken into simple pieces. For linear algebra, the simple piecesare matrices of rank 1:Every row is a multiple of the ﬁrst row, so the row space is one-dimensional. In fact, wecan write the whole matrix as the product of a column vector and a row vector:The product of a 4 by 1 matrix and a 1 by 3 matrix is a 4 by 3 matrix. This product hasrank 1. At the same time, the columns are all multiples of the same column vector; thecolumn space shares the dimension r = 1 and reduces to a line.Every matrix of rank 1 has the simple form A = uvT = column times row.The rows are all multiples of the same vector vT, and the columns are all multiples of u.The row space and column space are lines—the easiest case.1. True or false: If m = n, then the row space of A equals the column space. If m < n,then the nullspace has a larger dimension than2. Find the dimension and construct a basis for the four subspaces associated with each0 1 4 00 2 8 00 1 4 00 0 0 03. Find the dimension and a basis for the four fundamental subspaces for1 2 0 10 1 1 01 2 0 11 2 0 10 1 1 00 0 0 0",vector spaces
"Chapter 6 Positive Deﬁnite Matrices3. Solve Ay = b to ﬁnd U(x) = y1V1(x)+···+ynVn(x).Everything depends on step 1. Unless the functions Vj(x) are extremely simple, theother steps will be virtually impossible. And unless some combination of the Vj is closeto the true solution u(x), those steps will be useless. To combine both computabilityand accuracy, the key idea that makes ﬁnite elements successful is the use of piecewisepolynomials as the trial functions V(x).The simplest and most widely used ﬁnite element is piecewise linear. Place nodes atthe interior points x1 = h,x2 = 2h,...,xn = nh, just as for ﬁnite differences. Then Vj isthe “hat function” that equals 1 at the node x j, and zero at all the other nodes (Figure6.7a). It is concentrated in a small interval around its node, and it is zero everywhereelse (including x = 0 and x = 1). Any combination y1V1 +···+ynVn must have the valuey j at node j (the other V’s are zero there), so its graph is easy to draw (Figure 6.7b).V (x) = y1V1 + · · · + y5V5Figure 6.7: Hat functions and their linear combinations.Step 2 computes the coefﬁcients Aij =jdx in the “stiffness matrix” A. The slopej equals 1/h in the small interval to the left of x j, and −1/h in the interval to the right.If these “double intervals” do not overlap, the product V ′j is zero and Aij = 0. Eachhat function overlaps itself and only two neighbors:i = j ±1Then the stiffness matrix is actually tridiagonal:",pos_def_matrices
"8.3 The Dual Problemcost = (cN −cBB−1N)xN +cBB−1b = rxN +cBB−1b.If egg is the ﬁrst free variable, then increasing the ﬁrst component of xN to δ will increasethe cost by r1δ. The real cost of egg is r1. This is the change in diet cost as the zero lowerbound (nonnegativity constraint) moves upwards. We know that r ≥ 0, and economicstells us the same thing: The reduced cost of eggs cannot be negative or they would haveThe simplex method moves along edges of the feasible set, eventually reaching the opti-mal corner x∗. Interior point methods start inside the feasible set (where the constraintsare all inequalities). These methods hope to move more directly to x∗ (and also ﬁnd y∗).When they are very close to the answer, they stop.One way to stay inside is to put a barrier at the boundary. Add an extra cost in theform of a logarithm that blows up when any variable x or any slack variable w = Ax−btouches zero. The number θ is a small parameter to be chosen:This cost is nonlinear (but linear programming is already nonlinear, from inequalities).The notation is simpler if the long vector (x,w) is renamed x and [A −I] is renamed A.The primal constraints are now x ≥ 0 and Ax = b. The sum of lnxi in the barrier nowThe dual constraints are yA ≤ c. (We don’t need y ≥ 0 when we have Ax = b inthe primal.) The slack variable is s = c − yA, with s ≥ 0. What are the Kuhn-Tuckerconditions for x and y to be the optimal x∗ and y∗? Along with the constraints we requireduality: cx∗ = y∗b.Including the barrier gives an approximate problem P(θ). For its Kuhn-Tucker op-timality conditions, the derivative of lnxi gives 1/xi. If we create a diagonal matrix Xfrom those positive numbers xi, and use e = [1 ··· 1] for the row vector of n+m ones,then optimality in P(θ) is as follows:As θ → 0, we expect those optimal x and y to approach x∗ and y∗ for the original no-barrier problem, and θeX−1 will stay nonnegative. The plan is to solve equations (9a–9b) with smaller and smaller barriers, given by the size of θ.In reality, those nonlinear equations are approximately solved by Newton’s method(which means they are linearized). The nonlinear term is s = θeX−1. To avoid 1/xi,",linear_prog
"Chapter 1 Matrices and Gaussian Eliminationcolumns b1, b2, b3, the columns of AB should be Ab1, Ab2, Ab3!Our ﬁrst requirement had to do with rows, and this one is concerned with columns. Athird approach is to describe each individual entry in AB and hope for the best. In fact,there is only one possible rule, and I am not sure who discovered it. It makes everythingwork. It does not allow us to multiply every pair of matrices. If they are square, theymust have the same size. If they are rectangular, they must not have the same shape;the number of columns in A has to equal the number of rows in B. Then A can bemultiplied into each column of B.If A is m by n, and B is n by p, then multiplication is possible. The product AB willbe m by p. We now ﬁnd the entry in row i and column j of AB.The i, j entry of AB is the inner product of the ith row of A and the jthcolumn of B. In Figure 1.7, the 3, 2 entry of AB comes from row 3 and column(AB)32 = a31b12 +a32b22 +a33b32 +a34b42.Figure 1.7: A 3 by 4 matrix A times a 4 by 2 matrix B is a 3 by 2 matrix AB.Note. We write AB when the matrices have nothing special to do with elimination. Ourearlier example was EA, because of the elementary matrix E. Later we have PA, or LU,or even LDU. The rule for matrix multiplication stays the same.The entry 17 is (2)(1)+(3)(5), the inner product of the ﬁrst row of A and ﬁrst columnof B. The entry 8 is (4)(2)+(0)(−1), from the second row and second column.The third column is zero in B, so it is zero in AB. B consists of three columns side byside, and A multiplies each column separately. Every column of AB is a combinationof the columns of A. Just as in a matrix-vector multiplication, the columns of A aremultiplied by the entries in B.",gauss elim
"Suppose the vectors x1,...,xn are a basis for the space V, and vectorsy1,...,ym are a basis for W. Each linear transformation T from V to W isrepresented by a matrix A. The jth column is found by applying T to the jthbasis vector x j, and writing T(x j) as a combination of the y’s:Column j of AT(x j) = Ax j = a1 jy1 +a2 jy2 +···+amjym.For the differentiation matrix, column 1 came from the ﬁrst basis vector p1 = 1. Itsderivative is zero, so column 1 is zero. The last column came from (d/dt)t3 = 3t2. Since3t2 = 0p1+0p2+3p3+0p4, the last column contained 0, 0, 3. 0. The rule (6) constructsthe matrix, a column at a time.We do the same for integration. That goes from cubics to quartics, transformingV = P3 into W = P4, so we need a basis for W. The natural choice is y1 = 1, y2 = t,y3 = t2, y4 = t3, y5 = t4, spanning the polynomials of degree 4. The matrix A will be mby n, or 5 by 4. It comes from applying integration to each basis vector of V:0 1dt = t0 t3dt = 1Differentiation and integration are inverse operations. Or at least integration followedby differentiation brings back the original function. To make that happen for matrices,we need the differentiation matrix from quartics down to cubics, which is 4 by 5:0 1 0 0 00 0 2 0 00 0 0 3 00 0 0 0 4Differentiation is a left-inverse of integration. Rectangular matrices cannot have two-sided inverses! In the opposite order, AintAdiff = I cannot be true. The 5 by 5 product haszeros in column 1. The derivative of a constant is zero. In the other columns AintAdiff isthe identity and the integral of the derivative of tn is tn.",vector spaces
"Chapter 1 Matrices and Gaussian EliminationWe return to the fact that A is tridiagonal. What effect does this have on elimination?The ﬁrst stage of the elimination process produces zeros below the ﬁrst pivot:on A: Step 1Compared with a general 5 by 5 matrix, that step displays two major simpliﬁcations:1. There was only one nonzero entry below the pivot.2. The pivot row was very short.The multiplier ℓ21 = −12 came from one division. The new pivot 32 came from a singlemultiplication-subtraction. Furthermore, the tridiagonal pattern is preserved: Everystage of elimination admits the simpliﬁcations (a) and (b).The ﬁnal result is the LDU = LDLT factorization of A. Notice the pivots!The L and U factors of a tridiagonal matrix are bidiagonal. The three factors togetherhave the same band structure of three essential diagonals (3n−2 parameters) as A. Notetoo that L and U are transposes of one another, as expected from the symmetry. Thepivots 2/1, 3/2, 4/3, 5/4, 6/5 are all positive. Their product is the determinant of A:detA = 6. The pivots are obviously converging to 1, as n gets large. Such matrices makea computer very happy.These sparse factors L and U completely change the usual operation count. Elimina-tion on each column needs only two operations, as above, and there are n columns. Inplace of n3/3 operations we need only 2n. Tridiagonal systems Ax = b can be solvedalmost instantly. The cost of solving a tridiagonal system is proportional to n.A band matrix has aij = 0 except in the band |i − j| < w (Figure 1.8). The “halfbandwidth” is w = 1 for a diagonal matrix, w = 2 for a tridiagonal matrix, and w = nfor a full matrix. For each column, elimination requires w(w − 1) operations: a rowof length w acts on w − 1 rows below. Elimination on the n columns of a band matrixrequires about w2n operations.As w approaches n, the matrix becomes full, and the count is roughly n3. For an exactcount, the lower right-hand corner has no room for bandwidth w. The precise number ofdivisions and multiplication-subtractions that produce L, D, and U (without assuming a",gauss elim
"Chapter 5 Eigenvalues and Eigenvectorsλ1 = λ2 andboth Reλ > 0T 2 = 4Dboth λ > 0both Reλ < 0both λ < 0det < 0 gives λ1 < 0 and λ2 > 0: real and unstableFigure 5.2: Stability and instability regions for a 2 by 2 matrix.For complex eigenvalues, b and c have opposite signs and are sufﬁciently large.Example 2. One from each quadrant: only #2 is stable:On the boundaries of the second quadrant, the equation is neutrally stable. On the hori-zontal axis, one eigenvalue is zero (because the determinant is λ1λ2 = 0). On the verticalaxis above the origin, both eigenvalues are purely imaginary (because the trace is Zero).Crossing those axes are the two ways that stability is lost.The n by n case is more difﬁcult. A test for Reλi < 0 came from Routh and Hurwitz,who found a series of inequalities on the entries aij. I do not think this approach ismuch good for a large matrix; the computer can probably ﬁnd the eigenvalues with morecertainty than it can test these inequalities. Lyapunov’s idea was to ﬁnd a weightingmatrix W so that the weighted length ∥Wu(t)∥ is always decreasing. If there existssuch a W, then ∥Wu∥ will decrease steadily to zero, and after a few ups and downs umust get there too (stability). The real value of Lyapunov’s method is for a nonlinearequation—then stability can be proved without knowing a formula for u(t).Example 3. du/dt =u sends u(t) around a circle, starting from u(0) = (1,0).Since trace = 0 and det = 1, we have purely imaginary eigenvalues:= λ 2 +1 = 0λ = +i and −i.The eigenvectors are (1,−i) and (1,i). and the solution is",eigenvec_val
"6.5 The Finite Element MethodThis looks just like ﬁnite differences! It has led to a thousand discussions about therelation between these two methods. More complicated ﬁnite elements—polynomials ofhigher degree. deﬁned on triangles or quadrilaterals for partial differential equations—also produce sparse matrices A. You could think of ﬁnite elements as a systematic wayto construct accurate difference equations on irregular meshes. The essential thing is thesimplicity of these piecewise polynomials. Inside every element, their slopes arc easy toﬁnd and to integrate.The components b j on the right side are new. Instead of just the value of f at x j,as for ﬁnite differences, they are now an average of f around that point: b j =Then, in step 3, we solve the tridiagonal system Ay = b, which gives the coefﬁcients inthe minimizing trial function U = y1V1 +···+ynVn. Connecting all these heights y j bya broken line, we have the approximate solution U(x).Example 1. u′′ = 2 with u(0) = u(1) = 0, and solution u(x) = x−x2.The approximation will use three intervals and two hat functions, with h = 1matrix A is 2 by 2. The right side requires integration of the hat function times f(x) = 2.That produces twice the area 13 under the hat:The solution to Ay = b is y = (29). The best U(x) is 29V2, which equals 2mesh points. This agrees with the exact solution u(x) = x−x2 = 1In a more complicated example, the approximation will not be exact at the nodes.But it is remarkably close. The underlying theory is explained in the author’s book AnAnalysis of the Finite Element Method (see www.wellesleycambridge.com) writtenjointly with George Fix. Other books give more detailed applications, and the subjectof ﬁnite elements has become an important part of engineering education. It is treatedin Introduction to Applied Mathematics, and also in my new book Applied Mathematicsand Scientiﬁc Computing. There we discuss partial differential equations, where themethod really comes into its own.The Rayleigh-Ritz idea—to minimize over a ﬁnite-dimensional family of V’s in placeof all admissible v’s—is also useful for eigenvalue problems. The true minimum of theRayleigh quotient is the fundamental frequency λ1. Its approximate minimum Λ1 willbe larger—because the class of trial functions is restricted to the V’s. This step wascompletely natural and inevitable: to apply the new ﬁnite element ideas to this long-established variational form of the eigenvalue problem.The best example of an eigenvalue problem has u(x) = sinπx and λ1 = π2:u(0) = u(1) = 0.",pos_def_matrices
"We want to obtain the same ℓ1ℓ2···ℓn from detA, when the edges of that box are therows of A. With right angles, these rows are orthogonal and AAT is diagonal:The ℓi are the lengths of the rows (the edges). and the zeros off the diagonal comebecause the rows are orthogonal. Using the product and transposing rules,n = det(AAT) = (detA)(detAT) = (detA)2.The square root of this equation says that the determinant equals the volume. The signof detA will indicate whether the edges form a “right-handed” set of coordinates, as inthe usual x-y-z system, or a left-handed system like y-x-z.If the angles are not 90°, the volume is not the product of the lengths. In the plane(Figure 4.2), the “volume” of a parallelogram equals the base ℓ times the height h, Thevector b− p of length h is the second row b = (a21,a22), minus its projection p onto theﬁrst row. The key point is this: By rule 5, detA is unchanged when a multiple of row 1is subtracted from row 2. We can change the parallelogram to a rectangle, where it isalready proved that volume = determinant.In n dimensions, it takes longer to make each box rectangular, but the idea is thesame. The volume and determinant are unchanged if we subtract from each row its pro-jection onto the space spanned by the preceding rows—leaving a perpendicular “heightvector” like pb. This Gram-Schmidt process produces orthogonal rows, with volume =determinant. So the same equality must have held for the original rows.h = |b − p|length ℓ = |a|b = (a21, a22)a = (a11, a12)Figure 4.2: Volume (area) of the parallelogram = ℓ times h = |detA|.This completes the link between volumes and determinants, but it is worth comingback one more time to the simplest case. We know that",determinants
"4. By applying row operations to produce an upper triangular U, computeExchange rows 3 and 4 of the second matrix and recompute the pivots and determi-Note. Some readers will already know a formula for 3 by 3 determinants. It has sixterms (equation (2) of the next section), three going parallel to the main diagonal andthree others going the opposite way with minus signs. There is a similar formula for4 by 4 determinants, but it contains 4! = 24 terms (not just eight). You cannot evenbe sure that a minus sign goes with the reverse diagonal, as the next exercises show.5. Count row exchanges to ﬁnd these determinants:0 0 0 10 0 1 00 1 0 01 0 0 00 1 0 00 0 1 00 0 0 11 0 0 06. For each n, how many exchanges will put (row n, row n − 1,..., row 1) into thenormal order (row 1, ... , row n − 1, row n)? Find detP for the n by n permutationwith 1s on the reverse diagonal. Problem 5 had n = 4.7. Find the determinants of:(a) a rank one matrix(b) the upper triangular matrix4 4 8 80 1 2 20 0 2 60 0 0 2(c) the lower triangular matrix UT.(d) the inverse matrix U−1.",determinants
"11. Suppose P is the projection matrix onto the subspace S and Q is the projection ontothe orthogonal complement S⊥. What are P+Q and PQ? Show that P−Q is its own12. If V is the subspace spanned by (1,1,0,1) and (0,0,1,0), ﬁnd(a) a basis for the orthogonal complement V⊥.(b) the projection matrix P onto V.(c) the vector in V closest to the vector b = (0,1,0,−1) in V⊥.13. Find the best straight-line ﬁt (least squares) to the measurementsThen ﬁnd the projection of b = (4,3,1,0) onto the column space of14. The vectors a1 = (1,1,0) and a2 = (1,1,1) span a plane in R3. Find the projectionmatrix P onto the plane, and ﬁnd a nonzero vector b that is projected to zero.15. If P is the projection matrix onto a line in the x-y plane, draw a ﬁgure to describethe effect of the “reﬂection matrix” H = I − 2P. Explain both geometrically andalgebraically why H2 = I.16. Show that if u has unit length, then the rank-1 matrix P = uuT is a projection matrix:It has properties (i) and (ii) in 3N. By choosing u = a/∥a∥, P becomes the projectiononto the line through a, and Pb is the point p = �xa. Rank-1 projections correspondexactly to least-squares problems in one unknown.17. What 2 by 2 matrix projects the x-y plane onto the −45° line x+y = 0?18. We want to ﬁt a plane y = C +Dt +Ez to the four pointst = 1,z = 1t = 0,z = 3t = 2,z = 1t = 0,z = 0.(a) Find 4 equations in 3 unknowns to pass a plane through the points (if there is(b) Find 3 equations in 3 unknowns for the best least-squares solution.19. If PC = A(ATA)−1AT is the projection onto the column space of A, what is the pro-jection PR onto the row space? (It is not PT",orthogonality
"3.4 Orthogonal Bases and Gram-Schmidtup; approximation by polynomials has to be possible. The right idea is to switch toorthogonal axes (by Gram-Schmidt). We look for combinations of 1, x, and x2 that areIt is convenient to work with a symmetrically placed interval like −1 ≤ x ≤ 1, becausethis makes all the odd powers of x orthogonal to all the even powers:Therefore the Gram-Schmidt process can begin by accepting v1 = 1 and v2 = x as theﬁrst two perpendicular axes. Since (x,x2) = 0, it only has to correct the angle between 1and x2. By formula (10), the third orthogonal polynomial isv3 = x2 − (1,x2)(x,x) x = x2 −= x2 − 1The polynomials constructed in this way are called the Legendre polynomials and theyare orthogonal to each other over the interval −1 ≤ x ≤ 1.The closest polynomial of degree ten is now computable, without disaster, by projectingonto each of the ﬁrst 10 (or 11) Legendre polynomials.5. Best Straight Line.Suppose we want to approximate y = x5 by a straight lineC +Dx between x = 0 and x = 1. There are at least three ways of ﬁnding that line, andif you compare them the whole chapter might become clear!1. Solve [1 x]= x5 by least squares. The equation ATA�x = ATb is2. Minimize E2 =0 (x5 −C−Dx)2dx = 1tives with respect to C and D, after dividing by 2, bring back the normal equationsof method 1 (and the solution is �C = 114, �D = 56 +C + 13. Apply Gram-Schmidt to replace x by x − (1,x)/(1,1). That is x − 12, which is or-thogonal to 1. Now the one-dimensional projections add to the best line:C +Dx = (x5,1)",orthogonality
"7.2 Matrix Norm and Condition NumberWe must expect a violent change in the solution from ordinary changes in the data.Chapter 1 compared the equations Ax = b and Ax′ = b′:u + 1.0001v = 2u + 1.0001v = 2.0001.The right-hand sides are changed only by ∥δb∥ = .0001 = 10−4. At the same time, thesolution goes from u = 2, v = 0 to u = v = 1. This is a relative error ofWithout having made any special choice of the perturbation, there was a relatively largechange in the solution. Our x and δb make 45° angles with the worst cases, whichaccounts for the missing 2 between 2·104 and the extreme possibility c = 4·104.If A = I or even if A = I/10, its condition number is c = λmax/λmin = 1. By compari-son, the determinant is a terrible measure of ill-conditioning. It depends not only on thescaling but also on the order n; if A = I/10, then the determinant of A is 10−n. In fact,this “nearly singular” matrix is as well-conditioned as possible.Example 2. The n by n ﬁnite difference matrix A has λmax ≈ 4 and λmin ≈ π2/n2:The condition number is approximately c(A) = 12n2, and this time the dependence on theorder n is genuine. The better we approximate −u′′ = f, by increasing the number ofunknowns, the harder it is to compute the approximation. At a certain crossover point,an increase in n will actually produce a poorer answer.Fortunately for the engineer, this crossover occurs where the accuracy is alreadypretty good. Working in single precision, a typical computer might make roundoff errorsof order 10−9. With n = 100 unknowns and c = 5000, the error is ampliﬁed at most tobe of order 10−5—which is still more accurate than any ordinary measurements. Butthere will be trouble with 10,000 unknowns, or with a 1, −4, 6, −4, 1 approximation tod4u/dx4 = f(x)—for which the condition number grows as n4.1Our analysis so far has applied to symmetric matrices with positive eigenvalues. Wecould easily drop the positivity assumption, and use absolute values |λ|. But to go1The usual rule of thumb, experimentally veriﬁed, is that the computer can lose logc decimal places to theroundoff errors in Gaussian elimination.",computations
"5 = 12 + 2214 = 12 + 22 + 32(1, 2, 3) has length(1, 2, 0) has lengthFigure 3.1: The length of vectors (x1,x2) and (x1,x2,x3).is the length ∥x∥ we want:∥x∥2 = 12 +22 +32The extension to x = (x1,...,xn) in n dimensions is immediate. By Pythagoras n−1times, the length ∥x∥ in Rn is the positive square root of xTx:The sum of squares matches xTx—and the length of x = (1,2,−3) is�� = 12 +22 +(−3)2 = 14.How can we decide whether two vectors x and y are perpendicular? What is the testfor orthogonality in Figure 3.2? In the plane spanned by x and y, those vectors areorthogonal provided they form a right triangle. We go back to a2 +b2 = c2:Sides of a right triangle∥x∥2 +∥y∥2 = ∥x−y∥2.Applying the length formula (1), this test for orthogonality in Rn becomes= (x1 −y1)2 +···+(xn −yn)2.The right-hand side has an extra −2xiyi from each (xi −yi)2:",orthogonality
"Chapter 5 Eigenvalues and EigenvectorsRemark. If A is real and its eigenvalues happen to be real, then its eigenvectors are alsoreal. They solve (A −λI)x = 0 and can be computed by elimination. But they will notbe orthogonal unless A is symmetric: A = QΛQT leads to AT = A.If A is real, all complex eigenvalues come in conjugate pairs: Ax = λx and Ax = λx.If a+ib is an eigenvalue of a real matrix, so is a−ib. (If A = AT then b = 0.)Strictly speaking, the spectral theorem A = QΛQT has been proved only when theeigenvalues of A are distinct. Then there are certainly n independent eigenvectors, andA can be safely diagonalized. Nevertheless it is true (see Section 5.6) that even withrepeated eigenvalues, a symmetric matrix still has a complete set of orthonormal eigen-vectors. The extreme case is the identity matrix, which has λ = 1 repeated n times—andno shortage of eigenvectors.To ﬁnish the complex case we need the analogue of a real orthogonal matrix—and youcan guess what happens to the requirement QTQ = I. The transpose will be replaced bythe conjugate transpose. The condition will become UHU = I. The new letter U reﬂectsthe new name: A complex matrix with orthonormal columns is called a unitary matrix.May we propose two analogies? A Hermitian (or symmetric) matrix can be comparedto a real number. A unitary (or orthogonal) matrix can be compared to a number onthe unit circle—a complex number of absolute value 1. The λ’s are real if AH = A, andthey are on the unit circle if UHU = I. The eigenvectors can be scaled to unit length andThose statements are not yet proved for unitary (including orthogonal) matrices.Therefore we go directly to the three properties of U that correspond to the earlier Prop-erties 1–3 of A. Remember that U has orthonormal columns:This leads directly to Property 1′, that multiplication by U has no effect on inner prod-ucts, angles, or lengths. The proof is on one line, just as it was for Q:Property 1′ (Ux)H(Uy) = xHUHUy = xHy and lengths are preserved by U:∥Ux∥2 = xHUHUx = ∥x∥2.Property 2′ Every eigenvalue of U has absolute value |λ| = 1.This follows directly from Ux = λx, by comparing the lengths of the two sides:∥Ux∥ = ∥x∥ by Property 1′, and always ∥λx∥ = |λ|∥x∥. Therefore |λ| = 1.6Later we compare “skew-Hermitian” matrices with pure imaginary numbers, and “normal” matrices with allcomplex numbers a + ib. A nonnormal matrix without orthogonal eigenvectors belongs to none of these classes,and is outside the whole analogy.",eigenvec_val
"Chapter 1 Matrices and Gaussian Elimination15. For four linear equations in two unknowns x and y, the row picture shows four. The column picture is in-dimensional space. The equations have nosolution unless the vector on the right-hand side is a combination of16. Find a point with z = 2 on the intersection line of the planes x + y + 3z = 6 andx−y+z = 4. Find the point with z = 0 and a third point halfway between.17. The ﬁrst of these equations plus the second equals the third:2x + 3y + 2z = 5.The ﬁrst two planes meet along a line. The third plane contains that line, becauseif x, y, z satisfy the ﬁrst two equations then they also. The equations haveinﬁnitely many solutions (the whole line L). Find three solutions.18. Move the third plane in Problem 17 to a parallel plane 2x + 3y + 2z = 9. Now thethree equations have no solution—why not? The ﬁrst two planes meet along the lineL, but the third plane doesn’t19. In Problem 17 the columns are (1,1,2) and (1,2,3) and (1,1,2). This is a “singularcase” because the third column is. Find two combinations of the columnsthat give b = (2,3,5). This is only possible for b = (4,6,c) if c =20. Normally 4 “planes” in four-dimensional space meet at a. Normally 4 col-umn vectors in four-dimensional space can combine to produce b. What combina-tion of (1,0,0,0), (1,1,0,0), (1,1,1,0), (1,1,1,1) produces b = (3,3,3,2)? What 4equations for x, y, z, t are you solving?21. When equation 1 is added to equation 2, which of these are changed: the planes inthe row picture, the column picture, the coefﬁcient matrix, the solution?22. If (a,b) is a multiple of (c,d) with abcd ̸= 0, show that (a,c) is a multiple of (b,d).This is surprisingly important: call it a challenge question. You could use numbersﬁrst to see how a, b, c, and d are related. The question will lead to:has dependent rows then it has dependent columns.23. In these equations, the third column (multiplying w) is the same as the right side b.The column form of the equations immediately gives what solution for (u,v,w)?6u + 7v + 8w =4u + 5v + 9w =2u − 2v + 7w = 7.",gauss elim
"Then ﬁnd a second pair of orthonormal eigenvectors x1, x2 for λ = 0.(b) Verify that P = x1xT2 is the same for both pairs.17. Prove that every unitary matrix A is diagonalizable, in two steps:(i) If A is unitary, and U is too, then so is T = U−1AU.(ii) An upper triangular T that is unitary must be diagonal. Thus T = Λ.Any unitary matrix A (distinct eigenvalues or not) has a complete set of orthonormaleigenvectors. All eigenvalues satisfy |λ| = 1.18. Find a normal matrix (NNH = NHN) that is not Hermitian, skew-Hermitian, unitary,or diagonal. Show that all permutation matrices are normal.19. Suppose T is a 3 by 3 upper triangular matrix, with entries tij. Compare the entries ofTT H and T HT, and show that if they are equal, then T must be diagonal. All normaltriangular matrices are diagonal.20. If N is normal, show that ∥Nx∥ = ∥NHx∥ for every vector x. Deduce that the ith rowof N has the same length as the ith column. Note: If N is also upper triangular, thisleads again to the conclusion that it must be diagonal.21. Prove that a matrix with orthonormal eigenvectors must be normal, as claimed in 5T:If U−1NU = A, or N = UΛUH, then NNH = NHN.22. Find a unitary U and triangular T so that U−1AU = T, for23. If A has eigenvalues 0, 1, 2, what are the eigenvalues of A(A−I)(A−2I)?24. (a) Show by direct multiplication that every triangular matrix T, say 3 by 3, satisﬁesits own characteristic equation: (T −λ1I)(T −λ2I)(T −λ3I) = 0.(b) SubstitutingU−1AU for T, deduce the famous Cayley-Hamilton theorem: Everymatrix satisﬁes its own characteristic equation. For 3 by 3 this is (A−λ1I)(A−25. The characteristic polynomial of A =is λ 2 −(a+d)λ +(ad −bc). By directsubstitution, verify Cayley-Hamilton: A2 −(a+d)A+(ad −bc)I = 0.26. If aij = 1 above the main diagonal and aij = 0 elsewhere, ﬁnd the Jordan form (say4 by 4) by ﬁnding all the eigenvectors.27. Show, by trying for an M and failing, that no two of the three Jordan forms in equa-tion (8) are similar: J1 ̸= M−1J2M, J1 ̸= M−1J3M, and J2 ̸= M−1J3M.",eigenvec_val
"2.2 Solving Ax = 0 and Ax = bSimple, I admit. If you move up to 2 by 2, it’s more interesting. The matrixinvertible: y+z = b1 and 2y+2z = b2 usually have no solution.There is no solution unless b2 = 2b1. The column space of A contains onlythose b’s, the multiples of (1,2).When b2 = 2b1 there are inﬁnitely many solutions. A particular solution toy + z = 2 and 2y + 2z = 4 is xp = (1,1). The nullspace of A in Figure 2.2contains (−1,1) and all its multiples xn = (−c,c):2y + 2z = 4= shortest particular solution xp= MATLAB’s particular solution A\bline of all solutions x = xp + xnnullspace Axn = 0Figure 2.2: The parallel lines of solutions to Axn = 0 andEchelon Form U and Row Reduced Form RWe start by simplifying this 3 by 4 matrix, ﬁrst to U and then further to R:−1 −3 3 4The pivot a11 = 1 is nonzero. The usual elementary operations will produce zeros in theﬁrst column below this pivot. The bad news appears in column 2:No pivot in column 21 3 3 20 0 3 30 0 6 6The candidate for the second pivot has become zero: unacceptable. We look below thatzero for a nonzero entry—intending to carry out a row exchange. In this case the entrybelow it is also zero. If A were square, this would signal that the matrix was singular.With a rectangular matrix, we must expect trouble anyway, and there is no reason to stop.",vector spaces
"6.3 Singular Value DecompositionOf course Σ could multiply by a large σ or (more commonly) divide by a small σ,and overﬂow the computer. But still Σ is as good as possible. It reveals exactly what islarge and what is small. The ratio σmax/σmin is the condition number of an invertible nby n matrix. The availability of that information is another reason for the popularity ofthe SVD. We come back to this in the second application.1. Image processing Suppose a satellite takes a picture, and wants to send it to Earth.The picture may contain 1000 by 1000 “pixels”—a million little squares, each with adeﬁnite color. We can code the colors, and send back 1,000,000 numbers. It is better toﬁnd the essential information inside the 1000 by 1000 matrix, and send only that.Suppose we know the SVD. The key is in the singular values (in Σ). Typically, someσ’s are signiﬁcant and others are extremely small. If we keep 20 and throw away 980,then we send only the corresponding 20 columns of U and V. The other 980 columnsare multiplied in UΣV T by the small σ’s that are being ignored. We can do the matrixmultiplication as columns times rows:A = UΣV T = u1σ1vTAny matrix is the sum of r matrices of rank 1. If only 20 terms are kept, we send 20times 2000 numbers instead of a million (25 to 1 compression).The pictures are really striking, as more and more singular values are included. Atﬁrst you see nothing, and suddenly you recognize everything. The cost is in computingthe SVD—this has become much more efﬁcient, but it is expensive for a big matrix.2. The effective rank The rank of a matrix is the number of independent rows, andthe number of independent columns. That can be hard to decide in computations! Inexact arithmetic, counting the pivots is correct. Real arithmetic can be misleading—butdiscarding small pivots is not the answer. Consider the following:The ﬁrst has rank 1, although roundoff error will probably produce a second pivot. Bothpivots will be small; how many do we ignore? The second has one small pivot, but wecannot pretend that its row is insigniﬁcant. The third has two pivots and its rank is 2, butits “effective rank” ought to be 1.We go to a more stable measure of rank. The ﬁrst step is to use ATA or AAT, whichare symmetric but share the same rank as A. Their eigenvalues—the singular valuessquared—are not misleading. Based on the accuracy of the data, we decide on a toler-ance like 10−6 and count the singular values above it—that is the effective rank. Theexamples above have effective rank 1 (when ε is very small).3. Polar decomposition Every nonzero complex number z is a positive number r times",pos_def_matrices
"Chapter 5 Eigenvalues and Eigenvectorsmultiplied by i or −i:The eigenvalues are distinct, even if imaginary, and the eigenvectors are independent.They go into the columns of S:We are faced with an inescapable fact, that complex numbers are needed even forreal matrices. If there are too few real eigenvalues, there are always n complex eigen-values. (Complex includes real, when the imaginary part is zero.) If there are too feweigenvectors in the real world R3, or in Rn, we look in C3 or Cn. The space Cn containsall column vectors with complex components, and it has new deﬁnitions of length andinner product and orthogonality. But it is not more difﬁcult than Rn, and in Section 5.5we make an easy conversion to the complex case.Powers and Products: Ak and ABThere is one more situation in which the calculations are easy. The eigenvalue of A2 aren , and every eigenvector of A is also an eigenvector of A2. We startfrom Ax = λx, and multiply again by A:A2x = Aλx = λAx = λ 2x.Thus λ 2 is an eigenvalue of A2, with the same eigenvector x. If the ﬁrst multiplicationby A leaves the direction of x unchanged, then so does the second.The same result comes from diagonalization, by squaring S−1AS = Λ:The matrix A2 is diagonalized by the same S, so the eigenvectors are unchanged. Theeigenvalues are squared. This continues to hold for any power of A:5E The eigenvalues of Ak are λ kn, and each eigenvector of A is still aneigenvector of Ak. When S diagonalizes A, it also diagonalizes Ak:Λk = (S−1AS)(S−1AS)···(S−1AS) = S−1AkS.Each S−1 cancels an S, except for the ﬁrst S−1 and the last S.",eigenvec_val
"Chapter 1 Matrices and Gaussian Elimination(a) If A2 is deﬁned then A is necessarily square.(b) If AB and BA are deﬁned then A and B are square.(c) If AB and BA are deﬁned then AB and BA are square.(d) If AB = B then A = I.43. If A is m by n, how many separate multiplications are involved when(a) A multiplies a vector x with n components?(b) A multiplies an n by p matrix B? Then AB is m by p.(c) A multiplies itself to produce A2? Here m = n.44. To prove that (AB)C = A(BC), use the column vectors b1,...,bn of B. First supposethat C has only one column c with entries c1,...,cn:AB has columns Ab1,...,Abn, and Bc has one column c1b1 +···+cnbn.Then (AB)c = c1Ab1 +···+cnAbn, equals A(c1b1 +···+cnbn) = A(Bc).Linearity gives equality of those two sums, and (AB)c = A(Bc). The same is true forof C. Therefore (AB)C = A(BC).Problems 45–49 use column-row multiplication and block multiplication.45. Multiply AB using columns times rows:46. Block multiplication separates matrices into blocks (submatrices). If their shapesmake block multiplication possible, then it is allowed. Replace these x’s by numbersand conﬁrm that block multiplication succeeds.47. Draw the cuts in A and B and AB to show how each of the four multiplication rulesis really a block multiplication to ﬁnd AB:(a) Matrix A times columns of B.(b) Rows of A times matrix B.(c) Rows of A times columns of B.(d) Columns of A times rows of B.",gauss elim
"Chapter 5 Eigenvalues and Eigenvectorsbest we can say is that the masses will come arbitrarily close to (1,0) and also (0,1).Like a billiard ball bouncing forever on a perfectly smooth table, the total energy is ﬁxed.Sooner or later the masses come near any state with this energy.Again we cannot leave the problem without drawing a parallel to the continuous case.As the discrete masses and springs merge into a solid rod, the “second differences” givenby the 1, −2, 1 matrix A turn into second derivatives. This limit is described by thecelebrated wave equation ∂ 2u/∂t2 = ∂ 2u/∂x2.1. Following the ﬁrst example in this section, ﬁnd the eigenvalues and eigenvectors,and the exponential eAt, for2. For the previous matrix, write the general solution to du/dt = Au, and the speciﬁcsolution that matches u(0) = (3,1). What is the steady state as t → ∞? (This is acontinuous Markov process; λ = 0 in a differential equation corresponds to λ = 1 ina difference equation, since e0t = 1.)3. Suppose the time direction is reversed to give the matrix −A:Find u(t) and show that it blows up instead of decaying as t → ∞. (Diffusion isirreversible, and the heat equation cannot run backward.)4. If P is a projection matrix, show from the inﬁnite series thateP ≈ I +1.718P.5. A diagonal matrix like Λ =satisﬁes the usual rule eΛ(t+T) = eΛteΛT, becausethe rule holds for each diagonal entry.(a) Explain why eA(t+T) = eAteAT, using the formula eAt = SeΛtS−1.(b) Show that eA+B = eAeB is not true for matrices, from the example(use series for eA and eB).",eigenvec_val
"Chapter 2 Vector SpacesNullspace of A: Is there a combination of the columns that gives Ax = 0? Normallythe answer comes from elimination, but here it comes at a glance. The columns add upto the zero column. The nullspace contains x = (1,1,1,1), since Ax = 0. The equationAx = b does not have a unique solution (if it has a solution at all). Any “constant vector”x = (c,c,c,c) can be added to any particular solution of Ax = b. The complete solutionhas this arbitrary constant c (like the +C when we integrate in calculus).This has a meaning if we think of x1, x2, x3, x4 as the potentials (the voltages) at thenodes. The ﬁve components of Ax give the differences in potential across the ﬁve edges.The difference across edge 1 is x2 −x1, from the ±1 in the ﬁrst row.The equation Ax = b asks: Given the differences b1,...,b5, ﬁnd the actual potentialsx1,...,x4. But that is impossible to do! We can raise or lower all the potentials by thesame constant c, and the differences will not change—conﬁrming that x = (c,c,c,c) is inthe nullspace of A. Those are the only vectors in the nullspace, since Ax = 0 means equalpotentials across every edge. The nullspace of this incidence matrix is one-dimensional.The rank is 4− 1 = 3.For which differences b1,...,b5 can we solve Ax = b? To ﬁnd adirect test, look back at the matrix. Row 1 plus row 3 equals row 2. On the right-handside we need b1 +b3 = b2, or no solution is possible. Similarly, row 3 plus row 5 is row4. The right-hand side must satisfy b3 + b5 = b4, for elimination to arrive at 0 = 0. Torepeat, if b is in the column space, thenb1 −b2 +b3 = 0b3 −b4 +b5 = 0.Continuing the search, we also ﬁnd that rows 1+4 equal rows 2+5. But this is nothingnew; subtracting the equations in (1) already produces b1 + b4 = b2 + b5. There aretwo conditions on the ﬁve components, because the column space has dimension 5−2.Those conditions would come from elimination, but here they have a meaning on theLoops: Kirchhoff’s Voltage Law says that potential differences around a loop mustadd to zero, Around the upper loop in Figure 2.6, the differences satisfy (x2−x1)+(x3−x2) = (x3 −x1). Those differences are b1 +b3 = b2. To circle the lower loop and arriveback at the same potential, we need b3 +b5 = b4.The test for b to be in the column space is Kirchhoff’s Voltage Law:The sum of potential differences around a loop must be zero.Left Nullspace: To solve ATy = 0, we ﬁnd its meaning on the graph. The vector y hasﬁve components, one for each edge. These numbers represent currents ﬂowing alongthe ﬁve edges. Since AT is 4 by 5, the equations ATy = 0 give four conditions on those",vector spaces
"3.35 To solve a rectangular system Ax = b, we replace A−1 (which doesn’t exist) by(ATA)−1AT (which exists if A has independent columns). Show that this is a left-inverse of A but not a right-inverse. On the left of A it gives the identity; on the rightit gives the projection P.3.36 Find the straight line C + Dt that best ﬁts the measurements b = 0,1,2,5 at times3.37 Find the curve y = C + D2t which gives the best least-squares ﬁt to the measure-ments y = 6 at t = 0, y = 4 at t = 1, y = 0 at t = 2. Write the three equations thatare solved if the curve goes through the three points, and ﬁnd the best C and D.3.38 If the columns of A are orthogonal to each other what can you say about the formof ATA? If the columns are orthonormal, what can you say then?3.39 Under what condition on the columns of A (which may be rectangular) is ATA in-",orthogonality
"3.2 Cosines and Projections onto Linesu · i = cos θb = (b1, b2)a = (a1, a2)Figure 3.6: The cosine of the angle θ = β −α using inner products.For the angle β, the sine is b2/∥b∥ and the cosine is b1/∥b∥ . The cosine of θ = β −αcomes from an identity that no one could forget:cosθ = cosβ cosα +sinβ sinα = a1b1 +a2b2The numerator in this formula is exactly the inner product of a and b. It gives therelationship between aTb and cosθ:The cosine of the angle between any nonzero vectors a and b isThis formula is dimensionally correct; if we double the length of b, then both numeratorand denominator are doubled, and the cosine is unchanged. Reversing the sign of b, onthe other hand, reverses the sign of cosθ—and changes the angle by 180°.There is another law of trigonometry that leads directly to the same result. It is not sounforgettable as the formula in equation (1), but it relates the lengths of the sides of any∥b−a∥2 = ∥b∥2 +∥a∥2 −2∥b∥∥a∥cosθ.When θ is a right angle, we are back to Pythagoras: ∥b − a∥2 = ∥b∥2 + ∥a∥2. For anyangle θ, the expression ∥b−a∥2 is (b−a)T(b−a), and equation (3) becomesCanceling bTb and aTa on both sides of this equation, you recognize formula (2) for thecosine: aTb = ∥a∥∥b∥cosθ. In fact, this proves the cosine formula in n dimensions,since we only have to worry about the plane triangle Oab.Projection onto a LineNow we want to ﬁnd the projection point p. This point must be some multiple p = �xa ofthe given vector a—every point on the line is a multiple of a. The problem is to compute",orthogonality
"1.4 Matrix Notation and Matrix Multiplicationrow j from row i. This Ei j includes −ℓ in row i, column j.�� has Ib = b�� has E31b =Ib = b is the matrix analogue of multiplying by 1. A typical elimination stepmultiplies by E31. The important question is: What happens to A on the left-To maintain equality, we must apply the same operation to both sides of Ax = b. Inother words, we must also multiply the vector Ax by the matrix E. Our original matrixE subtracts 2 times the ﬁrst component from the second, After this step the new andsimpler system (equivalent to the old) is just E(Ax) = Eb. It is simpler because of thezero that was created below the ﬁrst pivot. It is equivalent because we can recover theoriginal system (by adding 2 times the ﬁrst equation back to the second). So the twosystems have exactly the same solution x.Now we come to the most important question: How do we multiply two matrices? Thereis a partial clue from Gaussian elimination: We know the original coefﬁcient matrix A,we know the elimination matrix E, and we know the result EA after the elimination step.We hope and expect that�� times A =Twice the ﬁrst row of A has been subtracted from the second row. Matrix multiplicationis consistent with the row operations of elimination. We can write the result either asE(Ax) = Eb, applying E to both sides of our equation, or as (EA)x = Eb. The matrixEA is constructed exactly so that these equations agree, and we don’t need parentheses:(EA times x) equals (E times Ax). We just write EAx.This is the whole point of an “associative law” like 2 × (3 × 4) = (2 × 3) × 4. The lawseems so obvious that it is hard to imagine it could be false. But the same could be saidof the “commutative law” 2×3 = 3×2—and for matrices EA is not AE.There is another requirement on matrix multiplication. We know how to multiply Ax,a matrix and a vector. The new deﬁnition should be consistent with that one. Whena matrix B contains only a single column x, the matrix-matrix product AB should beidentical with the matrix-vector product Ax. More than that: When B contains several",gauss elim
"Chapter 8 Linear Programming and Game Theoryrewrite that as sX = θe. Creating the diagonal matrix S from s, this is eSX = θe. If wechange e, y, c, and s to column vectors, and transpose, optimality now has three parts:Newton’s method takes a step ∆x, ∆y, ∆s from the current x, y, s. (Those solve equa-tions (10a) and (10b), but not (10c).) By ignoring the second-order term ∆X∆Se, thecorrections come from linear equations!Robert Freund’s notes for his MIT class pin down the (quadratic) convergence rate andthe computational complexity of this algorithm. Regardless of the dimensions m and n,the duality gap sx is generally below 10−8 after 20–80 Newton steps. This algorithmis used almost “as is” in commercial interior-point software, and for a large class ofnonlinear optimization problems as well.The Theory of InequalitiesThere is more than one way to study duality. We quickly proved yb ≤ cx, and thenused the simplex method to get equality. This was a constructive proof; x∗ and y∗ wereactually computed. Now we look brieﬂy at a different approach, which omits the simplexalgorithm and looks more directly at the geometry. I think the key ideas will be just asclear (in fact, probably clearer) if we omit some of the details.The best illustration of this approach came in the Fundamental Theorem of LinearAlgebra. The problem in Chapter 2 was to ﬁnd b in the column space of A. After elim-ination and the four subspaces, this solvability question was answered in a completelydifferent way by Problem 11 in Section 3.1:Ax = b has a solutionthere is a y such that yA = 0 and yb ̸= 0.This is the theorem of the alternative, because to ﬁnd both x and y is impossible: If Ax =b then yAx = yb ̸= 0, and this contradicts yAx = 0x = 0. In the language of subspaces,either b is in the column space, or it has a component sticking into the left nullspace.That component is the required y.For inequalities, we want to ﬁnd a theorem of exactly the same kind. Start with thesame system Ax = b, but add the constraint x ≥ 0. When does there exist a nonnegativesolution to Ax = b?In Chapter 2, b was anywhere in the column space. Now we allow only nonnegativecombinations, and the b’s no longer ﬁll out a subspace. Instead, they ﬁll a cone-shaped",linear_prog
"Chapter 5 Eigenvalues and EigenvectorsNote. This “zeroing” is not so easy to continue, because the rotations that producezero in place of d and h will spoil the new zero in the corner. We have to leave onediagonal below the main one, and ﬁnish the eigenvalue calculation in a different way.Otherwise, if we could make A diagonal and see its eigenvalues, we would be ﬁndingthe roots of the polynomial det(A−λI) by using only the square roots that determinecosθ—and that is impossible.8. What matrix M changes the basis V1 = (1,1), V2 = (1,4) to the basis v1 = (2,5),v2 = (1,4)? The columns of M come from expressing V1 and V2 as combinations∑mijvi of the v’s.9. For the same two bases, express the vector (3,9) as a combination c1V1 + c2V2 andalso as d1v1 +d2v2. Check numerically that M connects c to d: Mc = d.10. Conﬁrm the last exercise: If V1 = m11v1 + m21v2 and V2 = m12v1 + m22v2, andm11c1 +m12c2 = d1 and m21c1 +m22c2 = d2, the vectors c1V1 +c2V2 and d1v1 +d2v2are the same. This is the “change of basis formula” Mc = d.11. If the transformation T is a reﬂection across the 45° line in the plane, ﬁnd its matrixwith respect to the standard basis v1 = (1,0), v2 = (0,1), and also with respect toV1 = (1,1), V2 = (1,−1). Show that those matrices are similar.12. The identity transformation takes every vector to itself: Tx = x. Find the corre-sponding matrix, if the ﬁrst basis is v1 = (1,2), v2 = (3,4) and the second basis isw1 = (1,0), w2 = (0,1). (It is not the identity matrix!)13. The derivative of a+bx+cx2 is b+2cx+0x2.(a) Write the 3 by 3 matrix D such that(b) Compute D3 and interpret the results in terms of derivatives.(c) What are the eigenvalues and eigenvectors of D?14. Show that every number is an eigenvalue for T f(x) = d f/dx, but the transformation0 f(t)dt has no eigenvalues (here −∞ < x < ∞).15. On the space of 2 by 2 matrices, let T be the transformation that transposes everymatrix. Find the eigenvalues and “eigenmatrices” for AT = λA.16. (a) Find an orthogonal Q so that Q−1AQ = Λ if",eigenvec_val
"Which previous problem justiﬁes the middle step?7. By choosing the correct vector b in the Schwarz inequality, prove that(a1 +···+an)2 ≤ n(a2When does equality hold?8. The methane molecule CH4 is arranged as if the carbon atom were at the center of aregular tetrahedron with four hydrogen atoms at the vertices. If vertices are placedat (0,0,0), (1,1,0), (1,0,1), and (0,1,1)—note that all six edges have lengthso the tetrahedron is regular—what is the cosine of the angle between the rays goingfrom the center (12) to the vertices? (The bond angle itself is about 109.5°, anold friend of chemists.)9. Square the matrix P = aaT/aTa, which projects onto a line, and show that P2 = P.(Note the number aTa in the middle of the matrix aaTaaT!)10. Is the projection matrix P invertible? Why or why not?11. (a) Find the projection matrix P1 onto the line through a = [13] and also the matrix P2that projects onto the line perpendicular to a.(b) Compute P1 +P2 and P1P2 and explain.12. Find the matrix that projects every point in the plane onto the line x+2y = 0.13. Prove that the trace of P = aaT/aTa—which is the sum of its diagonal entries—14. What matrix P projects every point in R3 onto the line of intersection of the planesx+y+t = 0 and x−t = 0?15. Show that the length of Ax equals the length of ATx if AAT = ATA.16. Suppose P is the projection matrix onto the line through a.(a) Why is the inner product of x with Py equal to the inner product of Px with y?(b) Are the two angles the same? Find their cosines if a = (1,1,−1), x = (2,0,1),(c) Why is the inner product of Px with Py again the same? What is the angleProblems 17–26 ask for projections onto lines. Also errors e = b− p and matri-17. Project the vector b onto the line through a. Check that e is perpendicular to a:",orthogonality
"Chapter 8 Linear Programming and Game TheoryFor linear programming, the important alternatives come when the constraints areinequalities. When is the feasible set empty (no x)?8J Ax ≥ b has a solution x ≥ 0there is a y ≤ 0 with yA ≥ 0 and yb < 0.Proof. The slack variables w = Ax−b change Ax ≥ b into an equation. Use 8I:for some y withIt is this result that leads to a “nonconstructive proof” of the duality theorem.1. What is the dual of the following problem: Minimize x1 + x2, subject to x1 ≥ 0,x2 ≥ 0, 2x1 ≥ 4, x1 +3x2 ≥ 11? Find the solution to both this problem and its dual,and verify that minimum equals maximum.2. What is the dual of the following problem: Maximize y2 subject to y1 ≥ 0, y2 ≥ 0,y1 +y2 ≤ 3? Solve both this problem and its dual.3. Suppose A is the identity matrix (so that m = n), and the vectors b and c are nonnega-tive. Explain why x∗ = b is optimal in the minimum problem, ﬁnd y∗ in the maximumproblem, and verify that the two values are the same. If the ﬁrst component of b isnegative, what are x∗ and y∗?4. Construct a 1 by 1 example in which Ax ≥ b, x ≥ 0 is unfeasible, and the dual problem5. Starting with the 2 by 2 matrix A =, choose b and c so that both of the feasiblesets Ax ≥ b, x ≥ 0 and yA ≤ c, y ≥ 0 are empty.6. If all entries of A, b, and c are positive, show that both the primal and the dual are7. Show that x = (1,1,1,0) and y = (1,1,0,1) are feasible in the primal and dual, with0 0 1 00 1 0 01 1 1 11 0 0 1Then, after computing cx and yb, explain how you know they are optimal.",linear_prog
"If we take the inner product of x = (1+3i,3i) with itself, we are back to ∥x∥2:xTx = (1+i)(1+i)+(3i)(3i) = 2+9Note that yTx is different from xTy; we have to watch the order of the vectors.This leaves only one more change in notation, condensing two symbols into one.Instead of a bar for the conjugate and a T for the transpose, those are combined into theconjugate transpose. For vectors and matrices, a superscript H (or a star) combines bothoperations. This matrix AT = AH = A∗ is called “A Hermitian”:(AH)i j = A ji.You have to listen closely to distinguish that name from the phrase “A is Hermitian,”which means that A equals AH. If A is an m by n matrix, then AH is n by m:This symbol AH gives ofﬁcial recognition to the fact that, with complex entries, it isvery seldom that we want only the transpose of A. It is the conjugate transpose AH thatbecomes appropriate, and xH is the row vector [x1 ··· xn].1. The inner product of x and y is xHy. Orthogonal vectors have xHy = 0.2. The squared length of x is ∥x∥2 = xHx = |x1|2 +···+|xn|2.3. Conjugating (AB)T = BTAT produces (AB)H = BHAH.We spoke in earlier chapters about symmetric matrices: A = AT. With complex entries,this idea of symmetry has to be extended. The right generalization is not to matrices thatequal their transpose, but to matrices that equal their conjugate transpose. These arethe Hermitian matrices, and a typical example is A:The diagonal entries must be real; they are unchanged by conjugation. Each off-diagonalentry is matched with its mirror image across the main diagonal, and 3−3i is the conju-gate of 3+3i. In every case, aij = a ji.Our main goal is to establish three basic properties of Hermitian matrices. Theseproperties apply equally well to symmetric matrices. A real symmetric matrix is cer-tainly Hermitian. (For real matrices there is no difference between AT and AH.) Theeigenvalues of A are real—as we now prove.",eigenvec_val
"functions of mathematics should come together in such a graceful way. Our best answerwas to look at the power series for the exponential:eiθ = 1+iθ + (iθ)2The real part 1−θ 2/2+··· is cosθ. The imaginary part θ −θ 3/6+··· is the sine, Theformula is correct, and I wish we had sent a more beautiful proof.With this formula, we can solve wn = 1. It becomes einθ = 1, so that nθ must carryus around the unit circle and back to the start. The solution is to choose θ = 2π/n: The“primitive” nth root of unity iswn = e2πi/n = cos 2πIts nth power is e2πi, which equals 1. For n = 8, this root is (1+i)/w4 = cos πw8 = cos πThe fourth root is at θ = 90°, which is 14(360°). The other fourth roots are the powersi2 = −1, i3 = −i, and i4 = 1. The other eighth roots are the powers w2roots are equally spaced around the unit circle, at intervals of 2π/n. Note again that thesquare of w8 is w4, which will be essential in the Fast Fourier Transform. The roots addup to zero. First 1+i−1−i = 0, and thenSum of eighth rootsOne proof is to multiply the left side by w8, which leaves it unchanged. (It yields w8 +8 equals 1.) The eight points each move through 45°, but they remainthe same eight points. Since zero is the only number that is unchanged when multipliedby w8, the sum must be zero. When n is even the roots cancel in pairs (like 1 + i2 = 0and i+i3 = 0). But the three cube roots of 1 also add to zero.The Fourier Matrix and Its InverseIn the continuous case, the Fourier series can reproduce f(x) over a whole interval. Ituses inﬁnitely many sines and cosines (or exponentials). In the discrete case, with onlyn coefﬁcients c0,...,cn−1 to choose, we only ask for equality at n points. That gives nequations. We reproduce the four values y = 2,4,6,8 when Fc = y:",orthogonality
"4.2 Properties of the Determinant23. By applying row operations to produce an upper triangular U, compute−1 0 0 32 1 1 11 2 1 11 1 2 11 1 1 224. Use row operations to simplify and compute these determinants:25. Elimination reduces A to U. Then A = LU:Find the determinants of L, U, A, U−1L−1, and U−1L−1A.26. If aij is i times j, show that detA = 0. (Exception when A = [1].)27. If aij is i+ j, show that detA = 0. (Exception when n = 1 or 2.)28. Compute the determinants of these matrices by row operations:0 a 0 00 0 b 00 0 0 c29. What is wrong with this proof that projection matrices have detP = 1?30. (Calculus question) Show that the partial derivatives of ln(detA) give A−1:f(a,b,c,d) = ln(ad −bc)∂ f/∂b ∂ f/∂d31. (MATLAB) The Hilbert matrix hilb(n) has i, j entry equal to 1/(i + j − 1). Printti determinants of hilb(1),hilb(2),...,hilb(10). Hilbert matrices are hard to workwith! What are the pivots?32. (MATLAB) What is a typical determinant (experimentally) of rand(n) and randn(n)for n = 50,100,200,400? (And what does “Inf” mean in MATLAB?)",determinants
"5.3 Difference Equations and Powers Ak7. Lucas started with L0 = 2 and L1 = 1. The rule Lk+2 = Lk+1 +Lk is the same, so Ais still Fibonacci’s matrix. Add its eigenvectors x1 +x2:Multiplying by Ak, the second component is Lk = λ k1 + λ k2. Compute the Lucasnumber L10 slowly by Lk+2 = Lk+1 +Lk, and compute approximately by λ 108. Suppose there is an epidemic in which every month half of those who are well be-come sick, and a quarter of those who are sick become dead. Find the steady statefor the corresponding Markov process9. Write the 3 by 3 transition matrix for a chemistry course that is taught in two sections,if every week 14 of those in Section A and 13 of those in Section B drop the course,6 of each section transfer to the other section.10. Find the limiting values of yk and k (k → ∞) ifyk+1 = .8yk +.3zkzk+1 = .2yk +.7zkAlso ﬁnd formulas for yk and zk from Ak = SΛkS−1.11. (a) From the fact that column 1 + column 2 = 2(column 3), so the columns arelinearly dependent ﬁnd one eigenvalue and one eigenvector of A:(b) Find the other eigenvalues of A (it is Markov).(c) If u0 = (0,10,0), ﬁnd the limit of Aku0 as k → ∞.12. Suppose there are three major centers for Move-It-Yourself trucks. Every month halfof those in Boston and in Los Angeles go to Chicago, the other half stay here theyare, and the trucks in Chicago are split equally between Boston and Los Angeles Setup the 3 by 3 transition matrix A, and ﬁnd the steady state u∞ corresponding to theeigenvalue λ = 1.13. (a) In what range of a and b is the following equation a Markov process?uk+1 = Auk =",eigenvec_val
"Chapter 5 Eigenvalues and EigenvectorsIt is no longer possible to work only with real vectors and real matrices In the ﬁrst half ofthis book, when the basic problem was Ax−b, the solution was real when A and b werereal. Complex numbers could have been permitted. but would have contributed nothingnew. Now we cannot avoid them. A real matrix has real coefﬁcients in det(A−λI), butthe eigenvalues (as in rotations) may be complex.We now introduce the space Cn of vectors with n complex components. Addition andmatrix multiplication follow the same rules as before. Length is computed differently.The old way, the vector in C2 with components (1,i) would have zero length: 12+i2 = 0,not good. The correct length squared is 12 +|i|2 = 2.This change to ∥x∥2 = |x1|2 +···+|xn|2 forces a whole series of other changes. Theinner product, the transpose, the deﬁnitions of symmetric and orthogonal matrices, allneed to be modiﬁed for complex numbers. The new deﬁnitions coincide with the oldwhen the vectors and matrices are real. We have listed these changes in a table at theend of the section. and we explain them as we go.That table virtually amounts to a dictionary for translating real into complex. Wehope it will be useful to the reader. We particularly want to ﬁnd out about symmetricmatrices and Hermitian matrices: Where are their eigenvalues, and what is specialabout their eigenvectors? For practical purposes, those are the most important questionsin the theory of eigenvalues. We call attention in advance to the answers:1. Every symmetric matrix (and Hermitian matrix) has real eigenvalues.2. Its eigenvectors can be chosen to be orthonormal.Strangely, to prove that the eigenvalues are real we begin with the opposite possibility—and that takes us to complex numbers, complex vectors, and complex matrices.Complex Numbers and Their ConjugatesProbably the reader has already met complex numbers; a review is easy to give. Theimportant ideas are the complex conjugate ¯x and the absolute value |x|. Everyone knowsthat whatever i is, it satisﬁes the equation i2 = −1. It is a pure imaginary number, andso are its multiples ib; b is real. The sum a+ib is a complex number, and it is plotted ina natural way on the complex plane (Figure 5.4).The real numbers a and the imaginary numbers ib are special cases of complex num-bers; they lie on the axes. Two complex numbers are easy to add:",eigenvec_val
"Chapter 7 Computations with MatricesThus H = HT = H−1. Householder’s plan was to produce zeros with these matrices, andits success depends on the following identity Hx = −σz:Suppose z is the column vector (1,0,...,0), σ = ∥x∥, and v = x + σz.Then Hx = −σz = (−σ,0,...,0). The vector Hx ends in zeros as desired.The proof is to compute Hx and reach −σz:Hx = x− 2vvTx(because xTx = σ2)This identity can be used right away, on the ﬁrst column of A. The ﬁnal Q−1AQ isallowed one nonzero diagonal below the main diagonal (Hessenberg form). Thereforeonly the entries strictly below the diagonal will be involved:At this point Householder’s matrix H is only of order n − 1, so it is embedded into thelower right-hand corner of a full-size matrix U1:∗ ∗ ∗ ∗∗ ∗ ∗ ∗∗ ∗ ∗ ∗∗ ∗ ∗ ∗∗ ∗ ∗ ∗The ﬁrst stage is complete, and U−11 AU1 has the required ﬁrst column. At the secondstage, x consists of the last n − 2 entries in the second column (three bold stars). ThenH2 is of order n−2. When it is embedded in U2, it produces∗ ∗ ∗ ∗ ∗∗ ∗ ∗ ∗ ∗0 ∗ ∗ ∗ ∗0 0 ∗ ∗ ∗0 0 ∗ ∗ ∗U3 will take care of the third column. For a 5 by 5 matrix, the Hessenberg form isachieved (it has six zeros). In general Q is the product of all the matrices U1U2···Un−2,and the number of operations required to compute it is of order n3.",computations
"Chapter 2 Vector SpacesThere is a “double inﬁnity” of solutions, with v and y free and independent. The com-plete solution is a combination of two special solutions:Please look again at this complete solution to Rx = 0 and Ax = 0. The special solution(−3,1,0,0) has free variables v = 1, y = 0. The other special solution (1,0,−1,1) hasv = 0 and y = 1. All solutions are linear combinations of these two. The best way to ﬁndall solutions to Ax = 0 is from the special solutions:1. After reaching Rx = 0, identify the pivot variables and free variables.2. Give one free variable the value 1, set the other free variables to 0, and solve Rx = 0for the pivot variables. This x is a special solution.3. Every free variable produces its own “special solution” by step 2. The combinationsof special solutions form the nullspace—all solutions to Ax = 0.Within the four-dimensional space of all possible vectors x, the solutions to Ax = 0form a two-dimensional subspace—the nullspace of A, In the example, N(A) is gener-ated by the special vectors (−3,1,0,0) and (1,0,−1,1). The combinations of these twovectors produce the whole nullspace.Here is a little trick. The special solutions are especially easy from R. The numbers 3and 0 and −1 and 1 lie in the “nonpivot columns” of R. Reverse their signs to ﬁnd thepivot variables (not free) in the special solutions. I will put the two special solutionsfrom equation (2) into a nullspace matrix N, so you see this neat pattern:The free variables have values 1 and 0. When the free columns moved to the right-hand side of equation (2), their coefﬁcients 3 and 0 and −1 and 1 switched sign. Thatdetermined the pivot variables in the special solutions (the columns of N).This is the place to recognize one extremely important theorem. Suppose a matrix hasmore columns than rows, n > m. Since m rows can hold at most m pivots, there must beat least n−m free variables. There will be even more free variables if some rows of Rreduce to zero; but no matter what, at least one variable must be free. This free variablecan be assigned any value, leading to the following conclusion:If Ax = 0 has more unknowns than equations (n > m), it has at least onespecial solution: There are more solutions than the trivial x = 0.",vector spaces
"6.5 The Finite Element Methodintegrate the left side by parts to reach Ay = f, proving that Galerkin gives the sameA and f as Rayleigh-Ritz for symmetric problems.6. A basic identity for quadratics shows y = A−1b as minimizing:The minimum over a subspace of trial functions is at the y nearest to A−1b. (Thatmakes the ﬁrst term on the right as small as possible; it is the key to convergence ofU to u.) If A = I and b = (1,0,0), which multiple of V = (1,1,1) gives the smallestvalue of P(y) = 17. For a single hat function V(x) centered at x = 12, compute A =� (V ′)2dx and M =� V 2dx. In the 1 by 1 eigenvalue problem, is λ = A/M larger or smaller than the trueeigenvalue λ = π2?8. For the hat functions V1 and V2 centered at x = h = 13 and x = 2h = 23, compute the 2by 2 mass matrix Mi j =� ViVjdx, and solve the eigenvalue problem Ax = λMx.9. What is the mass matrix Mi j =� ViVjdx for n hat functions with h =",pos_def_matrices
"Chapter 1 Matrices and Gaussian Eliminationﬁnal factors L and U—is an essential foundation for the theory. I hope you will enjoythis book and this course.The Geometry of Linear EquationsThe way to understand this subject is by example. We begin with two extremely humbleequations, recognizing that you could solve them without a course in linear algebra.Nevertheless I hope you will give Gauss a chance:2x − y =x + y = 5.We can look at that system by rows or by columns. We want to see them both.The ﬁrst approach concentrates on the separate equations (the rows). That is themost familiar, and in two dimensions we can do it quickly. The equation 2x − y = 1 isrepresented by a straight line in the x-y plane. The line goes through the points x = 1,y = 1 and x = 12, y = 0 (and also through (2,3) and all intermediate points). The secondequation x+y = 5 produces a second line (Figure 1.2a). Its slope is dy/dx = −1 and itcrosses the ﬁrst line at the solution.The point of intersection lies on both lines. It is the only solution to both equations.That point x = 2 and y = 3 will soon be found by “elimination.”x + y = 52x − y = 1(x, y) = (2, 3)(a) Lines meet at x = 2, y = 3(2, 1) = column 1(b) Columns combine with 2 and 3Figure 1.2: Row picture (two lines) and column picture (combine columns).The second approach looks at the columns of the linear system. The two separateequations are really one vector equation:",gauss elim
"gives a family of parallel lines. The minimum cost comes when the ﬁrst line intersectsthe feasible set. That intersection occurs at B, where x∗ = 0 and y∗ = 2; the minimumcost is 2x∗ +3y∗ = 6. The vector (0,2) is feasible because it lies in the feasible set, it isoptimal because it minimizes the cost function, and the minimum cost 6 is the value ofthe program. We denote optimal vectors by an asterisk.x + 2y ≥ 42x + 3y = 62x + 3y = 0Figure 8.2: The feasible set with ﬂat sides, and the costs 2x+3y, touching at B.The optimal vector occurs at a corner of the feasible set. This is guaranteed by thegeometry, because the lines that give the cost function (or the planes, when we get tomore unknowns) move steadily up until they intersect the feasible set. The ﬁrst contactmust occur along its boundary! The “simplex method” will go from one corner of thefeasible set to the next until it ﬁnds the corner with lowest cost. In contrast, “interiorpoint methods” approach that optimal solution from inside the feasible set.Note. With a different cost function, the intersection might not be just a single point. Ifthe cost happened to be x+2y, the whole edge between B and A would be optimal. Theminimum cost is x∗ +2y∗, which equals 4 for all these optimal vectors. On our feasibleset, the maximum problem would have no solution! The cost can go arbitrarily high andthe maximum cost is inﬁnite.Every linear programming problem falls into one of three possible categories:1. The feasible set is empty.2. The cost function is unbounded on the feasible set.3. The cost reaches its minimum (or maximum) on the feasible set: the good case.The empty and unbounded cases should be very uncommon for a genuine problem ineconomics or engineering. We expect a solution.",linear_prog
"Chapter 5 Eigenvalues and Eigenvectors15. Factor these two matrices into A = SΛS−1:16. If A = SΛS−1 then A3 = () and A−1 = (17. If A has λ1 = 2 with eigenvector x1 =and λ2 = 5 with x2 =, use SΛS−1 toﬁnd A. No other matrix has the same λ’s and x’s.18. Suppose A = SΛS−1. What is the eigenvalue matrix for A + 2I? What is the eigen-vector matrix? Check that A+2I = (19. True or false: If the n columns of S (eigenvectors of A) are independent, then(a) A is invertible.(b) A is diagonalizable.(c) S is invertible.(d) S is diagonalizable.20. If the eigenvectors of A are the columns of I, then A is amatrix. If the eigen-vector matrix S is triangular, then S−1 is triangular and A is triangular.21. Describe all matrices S that diagonalize this matrix A:Then describe all matrices that diagonalize A−1.22. Write the most general matrix that has eigenvectors23. Find the eigenvalues of A and B and A+B:Eigenvalues of A+B (are equal to)(are not equal to) eigenvalues of A plus eigenval-24. Find the eigenvalues of A, B, AB, and BA:Eigenvalues of AB (are equal to)(are not equal to) eigenvalues of A times eigenvaluesof B. Eigenvalues of AB (are)(are not) equal to eigenvalues of BA.",eigenvec_val
"1.5 Triangular Factors and Row Exchanges19. Which numbers a, b, c lead to row exchanges? Which make the matrix singular?Problems 20–31 compute the factorization A = LU (and also A = LDU).20. Forward elimination changesx = b to a triangularx + 2y = 7 → x + y = 5That step subtracted ℓ21 =times row 1 from row 2. The reverse step adds ℓ21times row 1 to row 2. The matrix for that reverse step is L =. Multiply this Ltimes the triangular system. In letters, L multipliesUx = c to give21. (Move to 3 by 3) Forward elimination changes Ax = b to a triangular Ux = c:The equation z = 2 in Ux = c comes from the original x+3y+6z = 11 in Ax = b bytimes equation 1 and ℓ32 =times the ﬁnal equation 2.Reverse that to recover [1 3 6 11] in [A b] from the ﬁnal [1 1 1 5] and [0 1 2 2]and [0 0 1 2] in [U c]:= (ℓ31 Row 1 +ℓ32 Row 2+1 Row 3) ofIn matrix notation this is multiplication by L. So A = LU and b = Lc.22. What are the 3 by 3 triangular systems Lc = b and Ux = c from Problem 21? Checkthat c = (5,2,2) solves the ﬁrst one. Which x solves the second one?23. What two elimination matrices E21 and E32 put A into upper triangular form E32E21A =U? Multiply by E−121 to factor A into LU = E−124. What three elimination matrices E21, E31, E32 put A into upper triangular formE32E31E21A = U? Multiply by E−121 to factor A into LU where L =32 . Find L and U:",gauss elim
"Chapter 6 Positive Deﬁnite Matrices6A ax2 +2bxy+cy2 is positive deﬁnite if and only if a > 0 and ac > b2. Anyf(x,y) has a minimum at a point where ∂F/∂x = ∂F/∂y = 0 withTest for a maximum:Since f has a maximum whenever −f has a minimum, we justreverse the signs of a, b, and c. This actually leaves ac > b2 unchanged: The quadraticform is negative deﬁnite if and only if a < 0 and ac > b2. The same change applies fora maximum of F(x,y).Singular case ac = b2:The second term in equation (2) disappears to leave onlythe ﬁrst square—which is either positive semideﬁnite, when a > 0, or negative semidef-inite, when a < 0. The preﬁx semi allows the possibility that f can equal zero, as it willat the point x = b, y = −a. The surface z = f(x,y) degenerates from a bowl into a valley.For f = (x+y)2, the valley runs along the line x+y = 0.Saddle Point ac < b2:In one dimension, F(x) has a minimum or a maximum, orF′′ = 0. In two dimensions, a very important possibility still remains: The combinationac−b2 may be negative. This occurred in both examples, when b dominated a and c. Italso occurs if a and c have opposite signs. Then two directions give opposite results—inone direction f increases, in the other it decreases. It is useful to consider two specialSaddle points at (0,0)f2 = x2 −y2In the ﬁrst, b = 1 dominates a = c = 0. In the second, a = 1 and c = −1 have oppositesign. The saddles 2xy and x2 − y2 are practically the same; if we turn one through 45°we get the other. They are also hard to draw.These quadratic forms are indeﬁnite, because they can take either sign. So we havea stationary point that is neither a maximum or a minimum. It is called a saddle point.The surface z = x2 −y2 goes down in the direction of the y axis, where the legs ﬁt (if youstill ride a horse). In case you switched to a car, think of a road going over a mountainpass. The top of the pass is a minimum as you look along the range of mountains, but itis a maximum as you go along the road.Higher Dimensions: Linear AlgebraCalculus would be enough to ﬁnd our conditions Fxx > 0 and FxxFyy > F2xy for a minimum.But linear algebra is ready to do more, because the second derivatives ﬁt into a symmetricmatrix A. The terms ax2 and cy2 appear on the diagonal. The cross derivative 2bxy is",pos_def_matrices
"1.6 Inverses and TransposesA symmetric matrix need not be invertible; it could even be a matrix of zeros. But ifA−1 exists it is also symmetric. From formula (ii) above, the transpose of A−1 alwaysequals (AT)−1; for a symmetric matrix this is just A−1. A−1 equals its own transpose; itis symmetric whenever A is. Now we show that multiplying any matrix R by RT gives aSymmetric Products RTR, RRT, and LDLTChoose any matrix R, probably rectangular. Multiply RT times R. Then the product RTRis automatically a square symmetric matrix:That is a quick proof of symmetry for RTR. Its i, j entry is the inner product of row iof RT (column i of R) with column j of R. The (j,i) entry is the same inner product,column j with column i. So RTR is symmetric.RRT is also symmetric, but it is different from RTR. In my experience, most scientiﬁcproblems that start with a rectangular matrix R end up with RTR or RRT or both.Example 2. R = [1 2] and RT = [12] produce RTR =and RRT = [5].The product RTR is n by n. In the opposite order, RRT is m by m. Even if m = n, it is notvery likely that RTR = RRT. Equality can happen, but it’s not normal.Symmetric matrices appear in every subject whose laws are fair. “Each action has anequal and opposite reaction.” The entry aij that gives the action of i onto j is matchedby a ji. We will see this symmetry in the next section, for differential equations. Here,LU misses the symmetry but LDLT captures it perfectly.Suppose A = AT can be factored into A = LDU without row exchanges.ThenU is the transpose of L. The symmetric factorization becomes A = LDLT.The transpose of A = LDU gives AT = UTDTLT. Since A = AT, we now have twofactorizations of A into lower triangular times diagonal times upper triangular. (LT isupper triangular with ones on the diagonal, exactly like U.) Since the factorization isunique (see Problem 17), LT must be identical to U.LT = U and A = LDLTWhen elimination is applied to a symmetric matrix, AT = A is an advantage. The smallermatrices stay symmetric as elimination proceeds, and we can work with half the matrix!The lower right-hand corner remains symmetric:0 d − b2",gauss elim
"(b) If you know λ is an eigenvalue, the way to ﬁnd x is to24. What do you do to Ax = λx, in order to prove (a), (b), and (c)?(a) λ 2 is an eigenvalue of A2, as in Problem 22.(b) λ −1 is an eigenvalue of A−1, as in Problem 21.(c) λ +1 is an eigenvalue of A+I, as in Problem 20.25. From the unit vector u =, construct the rank-1 projection matrix P = uuT.(a) Show that Pu = u. Then u is an eigenvector with λ = 1.(b) If v is perpendicular to u show that Pv = zero vector. Then λ = 0.(c) Find three independent eigenvectors of P all with eigenvalue λ = 0.26. Solve det(Q−λI) = 0 by the quadratic formula, to reach λ = cosθ ±isinθ:rotates the xy-plane by the angle θ.Find the eigenvectors of Q by solving (Q−λI)x = 0. Use i2 = −1.27. Every permutation matrix leaves x = (1,1,...,1) unchanged. Then λ = 1. Find twomore λ’s for these permutations:28. If A has λ1 = 4 and λ2 = 5, then det(A−λI) = (λ −4)(λ −5) = λ 2 −9λ +20. Findthree matrices that have trace a+d = 9, determinant 20, and λ = 4,5.29. A 3 by 3 matrix B is known to have eigenvalues 0, 1, 2, This information is enoughto ﬁnd three of these:(a) the rank of B,(b) the determinant of BTB,(c) the eigenvalues of BTB, and(d) the eigenvalues of (B+I)−1.30. Choose the second row of A = [0 1∗ ∗] so that A has eigenvalues 4 and 7.31. Choose a, b, c, so that det(A−λI) = 9λ −λ 3. Then the eigenvalues are −3, 0, 3:",eigenvec_val
"7.4 Iterative Methods for Ax = b8. Show that starting from A0 =, the unshifted QR algorithm produces only themodest improvement A1 = 19. Apply to the following matrix A a single QR step with the shift α = a22—which inthis case means without shift, since a22 = 0. Show that the off-diagonal entries gofrom sinθ to −sin3θ, which is cubic convergence.10. Check that the tridiagonal A =is left unchanged by the QR algorithm. It is oneof the (rare) counterexamples to convergence (so we shift).11. Show by induction that, without shifts, (Q0Q1···Qk)(Rk ···R1R0) is exactly the QRfactorization of Ak+1. This identity connects QR to the power method and leads toan explanation of its convergence. If |λ1| > |λ2| > ··· > |λn|, these eigenvalues willgradually appear on the main diagonal.12. Choose sinθ and cosθ in the rotation P to triangularize A, and ﬁnd R:13. Choose sinθ and cosθ to make P21AP−121 triangular (same A). What are the eigen-14. When A is multiplied by Pi j (plane rotation), which entries are changed? When Pi jAis multiplied on the right by P−1i j , which entries are changed now?15. How many multiplications and how many additions are used to compute PA? (Acareful organization of all the rotations gives 23n3 multiplications and additions, thesame as for QR by reﬂectors and twice as many as for LU.)16. (Turning a robot hand) A robot produces any 3 by 3 rotation A from plane rotationsaround the x, y, and z axes. If P32P31P21A = I, the three robot turns are in A =32 . The three angles are Euler angles. Choose the ﬁrst θ so thatis zero in the (2,1) position.Iterative Methods for Ax = bIn contrast to eigenvalues, for which there was no choice, we do not absolutely needan iterative method to solve Ax = b. Gaussian elimination will reach the solution x in",computations
"In practice, the important question is the choice of C. The best answer comes fromstatisticians, and originally from Gauss. We may know that the average error is zero.That is the “expected value” of the error in b—although the error is not really expectedto be zero! We may also know the average of the square of the error; that is the variance.If the errors in the bi are independent of each other, and their variances are σ2i , then theright weights are wi = 1/σi. A more accurate measurement, which means a smallervariance, gets a heavier weight.In addition to unequal reliability, the observations may not be independent. If theerrors are coupled—the polls for President are not independent of those for Senator,and certainly not of those for Vice-President—then W has off-diagonal terms. The bestunbiased matrix C = W TW is the inverse of the covariance matrix—whose i, j entry isthe expected value of (error in bi) times (error in b j). Then the main diagonal of C−1contains the variances σ2i , which are the average of (error in bi)2.Example 3. Suppose two bridge partners both guess (after the bidding) the total num-ber of spades they hold. For each guess, the errors −1, 0, 1 might have equal probability3. Then the expected error is zero and the variance is 2The two guesses are dependent, because they are based on the same bidding—but notidentical, because they are looking at different hands. Say the chance that they areboth too high or both too low is zero, but the chance of opposite errors is 13(−1), and the inverse of the covariance matrix is W TW:= C = W TW.This matrix goes into the middle of the weighted normal equations.1. Find the best least-squares solution �x to 3x = 10, 4x = 5. What error E2 is minimized?Check that the error vector (10−3�x,5−4�x) is perpendicular to the column (3,4).2. Suppose the values b1 = 1 and b2 = 7 at times t1 = 1 and t2 = 2 are ﬁtted by a lineb = Dt through the origin. Solve D = 1 and 2D = 7 by least squares, and sketch the",orthogonality
"Remark 2. A is the limit of symmetric matrices with distinct eigenvalues. As the limitapproaches, the eigenvectors stay perpendicular. This can fail if A ̸= AT:As θ → 0, the only eigenvector of the nondiagonalizable matrixExample 3. The spectral theorem says that this A = AT can be diagonalized:λ1 = λ2 = 1 and λ3 = −1.λ = 1 has a plane of eigenvectors, and we pick an orthonormal pair x1 and x2:for λ3 = −1.These are the columns of Q. Splitting A = QΛQT into 3 columns times 3 rows givesSince λ1 = λ2, those ﬁrst two projections x1xT2 (each of rank 1) combine to givea projection P1 of rank 2 (onto the plane of eigenvectors). Then A is�� = λ1P1 +λ3P3 = (+1)Every Hermitian matrix with k different eigenvalues has a spectral decomposition intoA = λ1P1+···+λkPk, where Pi is the projection onto the eigenspace for λi. Since there isa full set of eigenvectors, the projections add up to the identity. And since the eigenspaceare orthogonal, two projections produce zero: PjPi = 0.We are very close to answering an important question, so we keep going: For whichmatrices is T = Λ? Symmetric, skew-symmetric, and orthogonal T’s are all diagonal!Hermitian, skew-Hermitian, and unitary matrices are also in this class. They correspondto numbers on the real axis, the imaginary axis, and the unit circle. Now we want thewhole class, corresponding to all complex numbers. The matrices are called “normal”.The matrix N is normal if it commutes with NH: NNH = NHN. Forsuch matrices, and no others, the triangular T = U−1NU is the diagonal Λ.Normal matrices are exactly those that have a complete set of orthonormal",eigenvec_val
"Figure 4.1: The box formed from the rows of A: volume = |determinant|.logue of the stretching factor dx/du:The value of this determinant is J = r. It is the r in the cylindrical volume elementr drdθ dz; this element is our little box. (It looks curved if we try to draw it, but proba-bly it gets straighter as the edges become inﬁnitesimal.)3. The determinant gives a formula for each pivot. Theoretically, we could predictwhen a pivot entry will be zero, requiring a row exchange. From the formula determi-nant = ± (product of the pivots), it follows that regardless of the order of elimination,the product of the pivots remains the same apart from sign.Years ago, this led to the belief that it was useless to escape a very small pivot byexchanging rows, since eventually the small pivot would catch up with us. But whatusually happens in practice, if an abnormally small pivot is not avoided, is that it is verysoon followed by an abnormally large one. This brings the product back to normal butit leaves the numerical solution in ruins.4. The determinant measures the dependence of A−1b on each element of b. If oneparameter is changed in an experiment, or one observation is corrected, the “inﬂuencecoefﬁcient” in A−1 is a ratio of determinants.There is one more problem about the determinant. It is difﬁcult not only to decideon its importance, and its proper place in the theory of linear algebra, but also to choose",determinants
"Chapter 7 Computations with MatricesThe (2,1) entry in this product is a11sinθ + a21cosθ, and we choose the angle θ thatmakes this combination zero. The next rotation P32 is chosen in a similar way, to removethe (3,2) entry of P32P21Ak. After n−1 rotations, we have R0:Rk = Pn n−1···P32P21Ak.Books on numerical linear algebra give more information about this remarkable algo-rithm in scientiﬁc computing. We mention one more method—Arnoldi in ARPACK—for large sparse matrices. It orthogonalizes the Krylov sequence x,Ax,A2x,... by Gram-Schmidt. If you need the eigenvalues of a large matrix, don’t use det(A−λI)!1. For the matrix A =with eigenvalues λ1 = 1 and λ2 = 3, apply the powermethod uk+1 = Auk three times to the initial guess u0 =. What is the limiting2. For the same A and the initial guess u0 =, compare three inverse power steps toone shifted step with α = uTuk+1 = A−1uk = 1The limiting vector u∞ is now a multiple of the other eigenvector (1,1).3. Explain why |λn/λn−1| controls the convergence of the usual power method. Con-struct a matrix A for which this method does not converge.4. The Markov matrix A =has λ = 1 and .6, and the power method uk = Aku0. Find the eigenvectors of A−1. What does the inverse powermethod u−k = A−ku0 converge to (after you multiply by .6k)?5. Show that for any two different vectors of the same length, ∥x∥ = ∥y∥, the House-holder transformation with v = x−y gives Hx = y and Hy = x.6. Compute σ = ∥x∥, v = x+σz, and H = I −2vvT/vTv, Verify Hx = −σz:7. Using Problem 6, ﬁnd the tridiagonal HAH−1 that is similar to",computations
"2.2 Solving Ax = 0 and Ax = b29. Suppose A is an m by n matrix of rank r. Its reduced echelon form is R. Describeexactly the reduced row echelon form of RT (not AT).30. (Recommended) Execute the six steps following equation (6) to ﬁnd the columnspace and nullspace of A and the solution to Ax = b:2 4 6 42 5 7 62 3 5 231. For every c, ﬁnd R and the special solutions to Ax = 0:1 1 2 22 2 4 41 c 2 232. What is the nullspace matrix N (of special solutions) for A, B, C?Problems 33–36 are about the solution of Ax = b. Follow the steps in the text toxp and xn. Reduce the augmented matrix [A b].33. Find the complete solutions of1 3 1 22 6 4 80 0 2 434. Under what condition on b1, b2, b3 is the following system solvable? Include b as afourth column in [A b]. Find all solutions when that condition holds:35. What conditions on b1, b2, b3, b4 make each system solvable? Solve for x:",vector spaces
"Chapter 1 Matrices and Gaussian EliminationWhen the elimination is down to k equations, only k2 − k operations are needed toclear out the column below the pivot—by the same reasoning that applied to the ﬁrststage, when k equaled n. Altogether, the total number of operations is the sum of k2 −kover all values of k from 1 to n:(12 +···+n2)−(1+···+n) = n(n+1)(2n+1)Those are standard formulas for the sums of the ﬁrst n numbers and the ﬁrst n squares.Substituting n = 1 and n = 2 and n = 100 into the formula 1can take no steps or two steps or about a third of a million steps:If n is at all large, a good estimate for the number of operations is 1If the size is doubled, and few of the coefﬁcients are zero, the cost is multiplied by 8.Back-substitution is considerably faster. The last unknown is found in only one oper-ation (a division by the last pivot). The second to last unknown requires two operations,and so on. Then the total for back-substitution is 1+2+···+n.Forward elimination also acts on the right-hand side (subtracting the same multiplesas on the left to maintain correct equations). This starts with n − 1 subtractions of theﬁrst equation. Altogether the right-hand side is responsible for n2 operations—muchless than the n3/3 on the left. The total for forward and back isThirty years ago, almost every mathematician would have guessed that a general sys-tem of order n could not be solved with much fewer than n3/3 multiplications. (Therewere even theorems to demonstrate it, but they did not allow for all possible methods.)Astonishingly, that guess has been proved wrong. There now exists a method that re-quires only Cnlog2 7 multiplications! It depends on a simple fact: Two combinations oftwo vectors in two-dimensional space would seem to take 8 multiplications, but they canbe done in 7. That lowered the exponent from log28, which is 3, to log27 ≈ 2.8. Thisdiscovery produced tremendous activity to ﬁnd the smallest possible power of n. Theexponent ﬁnally fell (at IBM) below 2.376. Fortunately for elimination, the constant Cis so large and the coding is so awkward that the new method is largely (or entirely) oftheoretical interest. The newest problem is the cost with many processors in parallel.Problems 1–9 are about elimination on 2 by 2 systems.",gauss elim
"Chapter 6 Positive Deﬁnite MatricesThat function sinπx minimizes the Rayleigh quotient vTAv/vTv:This is a ratio of potential to kinetic energy, and they are in balance at the eigenvector.Normally this eigenvector would be unknown, and to approximate it we admit only thetrial candidates V = y1V1 +···+ynVn:Now we face a matrix problem: Minimize yTAy/yTMy. With M = I, this leads to thestandard eigenvalue problem Ay = λy. But our matrix M will be tridiagonal, becauseneighboring hat functions overlap. It is exactly this situation that brings in the general-ized eigenvalue problem. The minimum value Λ1 will be the smallest eigenvalue ofAy = λMy. That Λ1 will be close to (and above) π2. The eigenvector y will give theapproximation U = y1V1 +···+ynVn to the eigenfunction.As in the static problem. The method can be summarized in three steps: (1) choosethe Vj, (2) compute A and M, and (3) solve Ay = λMy. I don’t know why that costs a1. Use three hat functions, with h = 14, to solve −u′′ = 2 with u(0) = u(1) = 0. Verifythat the approximation U matches u = x−x2 at the nodes.2. Solve −u′′ = x with u(0) = u(1) = 0. Then solve approximately with two hat func-tions and h = 13. Where is the largest error?3. Suppose −u′′ = 2, with the boundary condition u(1) = 0 changed to u′(1) = 0. This“natural” condition on u′ need not be imposed on the trial functions V. With h = 1there is an extra half-hat V3, which goes from 0 to 1 between x = 23 and x = 1.3)2dx and f3 =� 2V3dx. Solve Ay = f for the ﬁnite elementsolution y1V1 +y2V2 +y3V3.4. Solve −u′′ = 2 with a single hat function, but place its node at x = 14 instead of x = 1(Sketch this function V1.) With boundary conditions u(0) = u(1) = 0, compare theﬁnite element approximation with the true u = x−x2.5. Galerkin’s method starts with the differential equation (say −u′′ = f(x)) instead ofthe energy P. The trial solution is still u = y1V1 + y2V2 + ··· + ynVn, and the y’s arechosen to make the difference between −u′′ and f orthogonal to every Vj:",pos_def_matrices
"Chapter 1 Matrices and Gaussian EliminationThe work of elimination is reduced from n3/3 to n3/6. There is no need to store entriesfrom both sides of the diagonal, or to store both L and U.1. Find the inverses (no special system required) of2. (a) Find the inverses of the permutation matrices(b) Explain for permutations why P−1 is always the same as PT. Show that the 1sare in the right places to give PPT = I.3. From AB = C ﬁnd a formula for A−1. Also ﬁnd A−1 from PA = LU.4. (a) If A is invertible and AB = AC, prove quickly that B = C.(b) If A = [1 00 0], ﬁnd an example with AB = AC but B ̸= C.5. If the inverse of A2 is B, show that the inverse of A is AB. (Thus A is invertiblewhenever A2 is invertible.)6. Use the Gauss-Jordan method to invert7. Find three 2 by 2 matrices, other than A = I and A = −I, that are their own inverses:8. Show that A = [1 13 3] has no inverse by solving Ax = 0, and by failing to solve9. Suppose elimination fails because there is no pivot in column 3:2 1 4 60 3 8 50 0 0 70 0 0 9",gauss elim
"29. Second assumption behind least squares: The m errors ei are independent withvariance σ2, so the average of (b − Ax)(b − Ax)T is σ2I. Multiply on the left by(ATA)−1AT and on the right by A(ATA)−1 to show that the average of (�x−x)(�x−x)Tis σ2(ATA)−1. This is the all-important covariance matrix for the error in �x.30. A doctor takes four readings of your heart rate. The best solution to x = b1,...,x = b4is the average �x of b1,...,b4. The matrix A is a column of 1s. Problem 29 gives theexpected error (�x−x)2 as σ2(ATA)−1 =. By averaging, the variance drops from31. If you know the average �x9 of 9 numbers b1,...,b9, how can you quickly ﬁnd theaverage �x10 with one more number b10? The idea of recursive least squares is toavoid adding 10 numbers. What coefﬁcient of �x9 correctly gives �x10?Problems 32–37 use four points b = (0,8,8,20) to bring out more ideas.32. With b = 0,8,8,20 at t = 0,1,3,4, set up and solve the normal equations ATA�x = ATb.For the best straight line as in Figure 3.9a, ﬁnd its four heights pi and four errors ei.What is the minimum value E2 = e233. (Line C + Dt does go through p’s) With b = 0,8,8,20 at times t = 0,1,3,4, writethe four equations Ax = b (unsolvable). Change the measurements to p = 1,5,13,17and ﬁnd an exact solution to A�x = p.34. Check that e = b − p = (−1,3,−5,3) is perpendicular to both columns of A. Whatis the shortest distance ∥e∥ from b to the column space of A?35. For the closest parabola b = C +Dt +Et2 to the same four points, write the unsolv-able equations Ax = b in three unknowns x = (C,D,E). Set up the three normalequations ATA�x = ATb (solution not required). You are now ﬁtting a parabola to fourpoints—what is happening in Figure 3.9b?36. For the closest cubic b = C +Dt +Et2 +Ft3 to the same four points, write the fourequations Ax = b. Solve them by elimination, This cubic now goes exactly throughthe points. What are p and e?37. The average of the four times is �t = 14(0+1+3+4) = 2. The average of the four b’sis �b = 1(a) Verify that the best line goes through the center point (�t,�b) = (2,9).(b) Explain why C +D�t = �b comes from the ﬁrst equation in ATA�x = ATb.38. What happens to the weighted average �xW = (w22) if the ﬁrstweight w1 approaches zero? The measurement b1 is totally unreliable.",orthogonality
"8.2 The Simplex MethodExample 1. The problem in Figure 8.3 has constraints x+2y ≥ 6, 2x+y ≥ 6, and costx+y. The new system has four unknowns (x, y, and two slack variables):1 1 0 0With equality constraints, the simplex method can begin. A corner is now a point wheren components of the new vector x (the old x and w) are zero. These n components of xare the free variables in Ax = b. The remaining m components are the basic variables orpivot variables. Setting the n free variables to zero, the m equations Ax = b determinethe m basic variables. This “basic solution” x will be a genuine corner if its m nonzerocomponents are positive. Then x belongs to the feasible set.8A The corners of the feasible set are the basic feasible solutions of Ax = b.A solution is basic when n of its m+n components are zero, and it is feasiblewhen it satisﬁes x ≥ 0. Phase I of the simplex method ﬁnds one basic feasiblesolution. Phase II moves step by step to the optimal x∗.The corner point P in Figure 8.3 is the intersection of x = 0 with 2x+y−6 = 0.Which corner do we go to next? We want to move along an edge to an adjacentcorner. Since the two corners are neighbors, m − 1 basic variables will remain basic.Only one of the 6s will become free (zero). At the same time, one variable will move upfrom zero to become basic. The other m−1 basic components (in this case, the other 6)will change but stay positive. The choice of edge (see Example 2 below) decides whichvariable leaves the basis and which one enters. The basic variables are computed bysolving Ax = b. The free components of x are set to zero.Example 2. An entering variable and a leaving variable move us to a new corner.+x3 +6x4 +2x5 = 8Start from the corner at which x1 = 8 and x2 = 9 are the basic variables. At that cornerx3 = x4 = x5 = 0. This is feasible, but the zero cost may not be minimal. It wouldbe foolish to make x3 positive, because its cost coefﬁcient is +7 and we are trying tolower the cost. We choose x5 because it has the most negative cost coefﬁcient −3. Theentering variable will be x5.",linear_prog
"Chapter 2 Vector Spaces36. Which vectors (b1,b2,b3) are in the column space of A? Which combinations of therows of A give zero?37. Why can’t a 1 by 3 system have xp = (2,4,0) and xn = any multiple of (1,1,1)?38. (a) If Ax = b has two solutions x1 and x2, ﬁnd two solutions to Ax = 0.(b) Then ﬁnd another solution to Ax = b.39. Explain why all these statements are false:(a) The complete solution is any linear combination of xp and xn.(b) A system Ax = b has at most one particular solution.(c) The solution xp with all free variables zero is the shortest solution (minimumlength ∥x∥). (Find a 2 by 2 counterexample.)(d) If A is invertible there is no solution xn in the nullspace.40. Suppose column 5 of U has no pivot. Then x5 is avariable. The zero vector(is) (is not) the only solution to Ax = 0. If Ax = b has a solution, then it has41. If you know xp (free variables = 0) and all special solutions for Ax = b, ﬁnd xp andall special solutions for these systems:42. If Ax = b has inﬁnitely many solutions, why is it impossible for Ax = B (new right-hand side) to have only one solution? Could Ax = B have no solution?43. Choose the number q so that (if possible) the ranks are (a) 1, (b) 2, (c) 3:44. Give examples of matrices A for which the number of solutions to Ax = b is(a) 0 or 1, depending on b.(b) ∞, regardless of b.(c) 0 or ∞, depending on b.(d) 1, regardless of b.",vector spaces
"entirely on the other columns. No row or column can be used twice in the same term.What we are really doing is splitting the determinant into the following sum:For a determinant of order n, this splitting gives n smaller determinants (minors) of ordern − 1; you see the three 2 by 2 submatrices. The submatrix M1j is formed by throwingaway row 1 and column j. Its determinant is multiplied by a1 j—and by a plus or minussign. These signs alternate as in detM11, −detM12, detM13:Cofactors of row 1C1 j = (−1)1+j detM1 j.The second cofactor C12 is a23a31 −a21a33, which is detM12 times −1. This same tech-nique works on every n by n matrix. The splitting above conﬁrms that C11 is the deter-minant of the lower right corner M11.There is a similar expansion on any other row, say row i. It could be proved byexchanging row i with row 1. Remember to delete row i and column j of A for Mij:The determinant of A is a combination of any row i times its cofactors:detA = ai1Ci1 +ai2Ci2 +···+ainCin.The cofactor C1j is the determinant of Mij with the correct sign:delete row i and column jCij = (−1)i+j detMij.These formulas express detA as a combination of determinants of order n − 1. Wecould have deﬁned the determinant by induction on n. A 1 by 1 matrix has detA = a11,and then equation (10) deﬁnes the determinants of 2 by 2 matrices, 3 by 3 matrices,and n by n matrices. We preferred to deﬁne the determinant by its properties, whichare much simpler to explain. The explicit formula (6) and the cofactor formula (10)followed directly from these properties.There is one more consequence of detA = detAT. We can expand in cofactors of acolumn of A, which is a row of AT. Down column j of A,detA = a1 jC1 j +a2 jC2 j +···+anjCnj.Example 3. The 4 by 4 second difference matrix A4 has only two nonzeros in row 1:",determinants
"(and several other sets of three marriages), but there is no way to reach four. The minimalcut on the right separates the two women at the bottom from the three men at the top.The two women have only one man left to choose—not enough. The capacity across thecut is only 3.Whenever there is a subset of k women who among them like fewer than k men, acomplete matching is impossible.That test is decisive. The same impossibility can be expressed in different ways:1. (For Chess) It is impossible to put four rooks on squares with 1s in A, so that norook can take any other rook.2. (For Marriage Matrices) The 1s in the matrix can be covered by three horizontalor vertical lines. That equals the maximum number of marriages.3. (For Linear Algebra) Every matrix with the same zeros as A is singular.Remember that the determinant is a sum of 4! = 24 terms. Each term uses all four rowsand columns. The zeros in A make all 24 terms zero.A block of zeros is preventing a complete matching! The 2 by 3 submatrix in rows 3,4 and columns 1, 2, 3 of A is entirely zero. The general rule for an n by n matrix is thata p by q block of zeros prevents a matching if p+q > n. Here women 3, 4 could marryonly the man 4. If p women can marry only n−q men and p > n−q (which is the sameas a zero block with p+q > n), then a complete matching is impossible.The mathematical problem is to prove the following: If every set of p women doeslike at least p men, a complete matching is possible. That is Hall’s condition. No blockof zeros is too large. Each woman must like at least one man, each two women mustbetween them like at least two men, and so on, to p = n.A complete matching is possible if (and only if) Hall’s condition holds.The proof is simplest if the capacities are n, instead of 1, on all edges across themiddle. The capacities out of the source and into the sink are still 1. If the maximal ﬂowis n, all those edges from the source and into the sink are ﬁlled—and the ﬂow producesn marriages. When a complete matching is impossible, and the maximal ﬂow is belown, some cut must be responsible.That cut will have capacity below n, so no middle edges cross it. Suppose p nodes onthe left and r nodes on the right are in the set S with the source. The capacity across thatcut is n− p from the source to the remaining women, and r from these men to the sink.Since the cut capacity is below n, the p women like only the r men and no others. Butthe capacity n− p+r is below n exactly when p > r, and Hall’s condition fails.",linear_prog
"1.2 The Geometry of Linear Equations6. When b = (2,5,7), ﬁnd a solution (u,v,w) to equation (4) different from the solution(1,0,1) mentioned in the text.7. Give two more right-hand sides in addition to b = (2,5,7) for which equation (4)can be solved. Give two more right-hand sides in addition to b = (2,5,6) for whichit cannot be solved.8. Explain why the systemu + 2v + 3w = 1+ 2w = 0is singular by ﬁnding a combination of the three equations that adds up to 0 = 1.What value should replace the last zero on the right side to allow the equations tohave solutions—and what is one of the solutions?9. The column picture for the previous exercise (singular system) isShow that the three columns on the left lie in the same plane by expressing the thirdcolumn as a combination of the ﬁrst two. What are all the solutions (u,v,w) if b isthe zero vector (0,0,0)?10. (Recommended) Under what condition on y1, y2, y3 do the points (0,y1), (1,y2),(2,y3) lie on a straight line?11. These equations are certain to have the solution x = y = 0. For which values of a isthere a whole line of solutions?ax + 2y = 02x + ay = 012. Starting with x+4y = 7, ﬁnd the equation for the parallel line through x = 0, y = 0.Find the equation of another line that meets the ﬁrst at x = 3, y = 1.Problems 13–15 are a review of the row and column pictures.13. Draw the two pictures in two planes for the equations x−2y = 0, x+y = 6.14. For two linear equations in three unknowns x, y, z, the row picture will show (2 or 3)(lines or planes) in (two or three)-dimensional space. The column picture is in (twoor three)-dimensional space. The solutions normally lie on a",gauss elim
"2.2 Solving Ax = 0 and Ax = bFind a 3 by 3 system with these solutions exactly when b1 +b2 = b3.11. Write a 2 by 2 system Ax = b with many solutions xn but no solution xp. (Thereforethe system has no solution.) Which b’s allow an xp?12. Which of these rules give a correct deﬁnition of the rank of A?(a) The number of nonzero rows in R.(b) The number of columns minus the total number of rows.(c) The number of columns minus the number of free columns.(d) The number of 1s in R.13. Find the reduced row echelon forms R and the rank of these matrices:(a) The 3 by 4 matrix of all 1s.(b) The 4 by 4 matrix with aij = (−1)ij.(c) The 3 by 4 matrix with aij = (−1)j.14. Find R for each of these (block) matrices, and the special solutions:15. If the r pivot variables come ﬁrst, the reduced R must look likeI is r by rF is r by n−rWhat is the nullspace matrix N containing the special solutions?16. Suppose all r pivot variables come last. Describe the four blocks in the m by nreduced echelon form (the block B should be r by r):What is the nullspace matrix N of special solutions? What is its shape?17. (Silly problem) Describe all 2 by 3 matrices A1 and A2 with row echelon forms R1and R2, such that R1 +R2 is the row echelon form of A1 +A2. Is it true that R1 = A1and R2 = A2 in this case?18. If A has r pivot columns, then AT has r pivot columns. Give a 3 by 3 example forwhich the column numbers are different for A and AT.",vector spaces
"Chapter 2 Vector SpacesIn the existence case, one possible solution is x = Cb, since then Ax = ACb = b. Butthere will be other solutions if there are other right-inverses. The number of solutionswhen the columns span Rm is 1 or ∞.In the uniqueness case, if there is a solution to Ax = b, it has to be x = BAx = Bb. Butthere may be no solution. The number of solutions is 0 or 1.There are simple formulas for the best left and right inverses, if they exist:Certainly BA = I and AC = I. What is not so certain is that ATA and AAT are actuallyinvertible. We show in Chapter 3 that ATA does have an inverse if the rank is n, and AAThas an inverse when the rank is m. Thus the formulas make sense exactly when the rankis as large as possible, and the one-sided inverses are found.Example 2. Consider a simple 2 by 3 matrix of rank 2:Since r = m = 2, the theorem guarantees a right-inverse C:There are many right-inverses because the last row of C is completely arbitrary. This isa case of existence but not uniqueness. The matrix A has no left-inverse because the lastcolumn of BA is certain to be zero. The speciﬁc right-inverse C = AT(AAT)−1 choosesc31 and c32 to be zero:This is the pseudoinverse—a way of choosing the best C in Section 6.3. The transposeof A yields an example with inﬁnitely many left-inverses:Now it is the last column of B that is completely arbitrary. The best left-inverse (also thepseudoinverse) has b13 = b23 = 0. This is a “uniqueness case,” when the rank is r = n.There are no free variables, since n−r = 0. If there is a solution it will be the only one.You can see when this example has one solution or no solution:is solvable exactly when",vector spaces
"Chapter 1 Matrices and Gaussian EliminationThe second plane is 4u − 6v = −2. It is drawn vertically, because w can take any value. The coefﬁcient of w is zero, but this remains a plane in 3 -space. (The equation 4u = 3, or even the extreme case u = 0, would still describe a plane.) The ﬁgure shows the intersection of the second plane with the ﬁrst. That intersection is a l ine. In three dimensions a line requires two equations; in n dimensions it will require n − 1.Finally the third plane intersects this line in a point. The plane (not drawn) represents the third equation −2u+7v+2w = 9, and it crosses the line at u = 1, v = 1, w = 2. That triple intersection point (1,1,2) solves the linear system.How does this row picture extend into n dimensions? The n equations will con-tain n unknowns. The ﬁrst equation still determines a “ plane.” It is no longer a two-dimensional plane in 3-space; somehow it has “dimension” n − 1. It must be ﬂat and extremely thin within n-dimensional space, although it would look solid to us.If time is the fourth dimension, then the plane t = 0 cuts through four-dimensional space and produces the three-dimensional universe we live in (or rather, the universe as it was at t = 0). Another plane is z = 0, which is also three-dimensional; it is the ordinary x-y plane taken over all time. Those three-dimensional planes will intersect! They share the ordinary x-y plane at t = 0. We are down to two dimensions, and the next plane leaves a line. Finally a fourth plane leaves a single point. It is the intersection point of 4 planes in 4 dimensions, and it solves the 4 underlying equations.I will be in trouble if that example from relativity goes any further. The point is that linear algebra can operate with any number of equations. The ﬁrst equation produces an (n − 1)-dimensional plane in n dimensions, The second plane intersects it (we hope) in a smaller set of “dimension n − 2.” Assuming all goes well, every new plane (every new equation) reduces the dimension by one. At the end, when all n planes are accounted for, the intersection has dimension zero. It is a point, it lies on all the planes, and its coordinates satisfy all n equations. It is the solution!Column Vectors and Linear CombinationsWe turn to the columns. This time the vector equation (the same equation as (1)) isThose are three-dimensional column vectors. The vector b is identiﬁed with the pointwhose coordinates are 5, −2, 9. Every point in three-dimensional space is matched to avector, and vice versa. That was the idea of Descartes, who turned geometry into algebraby working with the coordinates of the point. We can write the vector in a column, orwe can list its components as b = (5,−2,9), or we can represent it geometrically by anarrow from the origin. You can choose the arrow, or the point, or the three numbers. Insix dimensions it is probably easiest to choose the six numbers.",gauss elim
"Chapter 2 Vector Spaces28. Find the range and kernel (those are new words for the column space and nullspace)29. A linear transformation from V to W has an inverse from W to V when the rangeis all of W and the kernel contains only v = 0. Why are these transformations not(a) T(v1,v2) = (v2,v2)(b) T(v1,v2) = (v1,v2,v1 +v2)(c) T(v1,v2) = v130. Suppose a linear T transforms (1,1) to (2,2) and (2,0) to (0,0). Find T(v) when(a) v = (2,2).(b) v = (3,1).(c) v = (−1,1).(d) v = (a,b).Problems 31–35 may be harder. The input space V contains all 2 by 2 matrices31. M is any 2 by 2 matrix and A =. The linear transformation T is deﬁned byT(M) = AM. What rules of matrix multiplication show that T is linear?32. Suppose A =. Show that the identity matrix I is not in the range of T. Find anonzero matrix M such that T(M) = AM is zero.33. Suppose T transposes every matrix M. Try to ﬁnd a matrix A that gives AM =MT for every M. Show that no matrix A will do it. To professors: Is this a lineartransformation that doesn’t come from a matrix?34. The transformation T that transposes every matrix is deﬁnitely linear. Which of theseextra properties are true?(a) T 2 = identity transformation.(b) The kernel of T is the zero matrix.(c) Every matrix is in the range of T.(d) T(M) = −M is impossible.35. Suppose T(M) =. Find a matrix with T(M) ̸= 0. Describe all ma-trices with T(M) = 0 (the kernel of T) and all output matrices T(M) (the range ofProblems 36–40 are about changing the basis36. (a) What matrix transforms (1,0) into (2,5) and transforms (0,1) to (1,3)?(b) What matrix transforms (2,5) to (1,0) and (1,3) to (0,1)?",vector spaces
"2.1 Vector Spaces and Subspaces1. x+y = y+x.2. x+(y+z) = (x+y)+z.3. There is a unique “zero vector” such that x+0 = x for all x.4. For each x there is a unique vector −x such that x+(−x) = 0.5. 1x = x.6. (c1c2)x = c1(c2x).7. c(x+y) = cx+cy.8. (c1 +c2)x = c1x+c2x.(a) Suppose addition in R2 adds an extra 1 to each component, so that (3,1)+(5,0)equals (9,2) instead of (8,1). With scalar multiplication unchanged, which rules(b) Show that the set of all positive real numbers, with x+y and cx redeﬁned to equalthe usual xy and xc, is a vector space. What is the “zero vector”?(c) Suppose (x1,x2) + (y1,y2) is deﬁned to be (x1 + y2,x2 + y1). With the usualcx = (cx1,cx2), which of the eight conditions are not satisﬁed?6. Let P be the plane in 3-space with equation x +2y+z = 6. What is the equation ofthe plane P0 through the origin parallel to P? Are P and P0 subspaces of R3?7. Which of the following are subspaces of R∞?(a) All sequences like (1,0,1,0,...) that include inﬁnitely many zeros.(b) All sequences (x1,x2,...) with x j = 0 from some point onward.(c) All decreasing sequences: x j+1 ≤ x j for each j.(d) All convergent sequences: the x j have a limit as j → ∞.(e) All arithmetic progressions: x j+1 −x j is the same for all j.(f) All geometric progressions (x1,kx1,k2x1,...) allowing all k and x1.8. Which of the following descriptions are correct? The solutions x of",vector spaces
"If A is singular, elimination leads to a zero row in U. Then detA = detU = 0. If Ais nonsingular, elimination puts the pivots d1,...,dn on the main diagonal. We have a“product of pivots” formula for detA! The sign depends on whether the number of rowexchanges is even or odd:detA = ±detU = ±d1d2···dn.The ninth property is the product rule. I would say it is the most surprising.9. The determinant of AB is the product of detA times detB.Product rule |A||B| = |AB|ae+bg a f +bhce+dg c f +dhA particular case of this rule gives the determinant of A−1. It must be 1/detA:(detA)(detA−1) = detAA−1 = detI = 1.In the 2 by 2 case, the product rule could be patiently checked:(ad −bc)(eh− fg) = (ae+bg)(cf +dh)−(a f +bh)(ce+dg).In the n by n case we suggest two possible proofs—since this is the least obvious rule.Both proofs assume that A and B are nonsingular; otherwise AB is singular, and theequation detAB = (detA)(detB) is easily veriﬁed. By rule 8, it becomes 0 = 0.(i) We prove that the ratio d(A) = detAB/detB has properties 1–3. Then d(A) mustequal detA. For example, d(I) = detB/detB = 1; rule 1 is satisﬁed. If two rowsof A are exchanged, so are the same two rows of AB, and the sign of d changesas required by rule 2. A linear combination in the ﬁrst row of A gives the samelinear combination in the ﬁrst row of AB. Then rule 3 for the determinant of AB,divided by the ﬁxed quantity detB, leads to rule 3 for the ratio d(A). Thus d(A) =detAB/detB coincides with detA, which is our product formula.(ii) This second proof is less elegant. For a diagonal matrix, detDB = (detD)(detB)follows by factoring each di from its row. Reduce a general matrix A to D byelimination—from A to U as usual, and from U to D by upward elimination. Thedeterminant does not change, except for a sign reversal when rows are exchanged.The same steps reduce AB to DB, with precisely the same effect on the determinant.But for DB it is already conﬁrmed that rule 9 is correct.10. The transpose of A has the same determinant as A itself: detAT = detA.",determinants
"Chapter 6 Positive Deﬁnite Matrices19. Find the 3 by 3 matrix A and its pivots, rank, eigenvalues, and determinant:�� = 4(x1 −x2 +2x3)2.20. For F1(x,y) = 14x4 + x2y + y2 and F2(x,y) = x3 + xy − x, ﬁnd the second derivativematrices A1 and A2:A1 is positive deﬁnite, so F1 is concave up (= convex). Find the minimum point ofF1 and the saddle point of F2 (look where ﬁrst derivatives are zero).21. The graph of z = x2 + y2 is a bowl opening upward. The graph of z = x2 − y2 is asaddle. The graph of z = −x2 − y2 is a bowl opening downward. What is a test onF(x,y) to have a saddle at (0,0)?22. Which values of c give a bowl and which give a saddle point for the graph of z =4x2 +12xy+cy2? Describe this graph at the borderline value of c.Tests for Positive DeﬁnitenessWhich symmetric matrices have the property that xTAx > 0 for all nonzero vectors x?There are four or ﬁve different ways to answer this question, and we hope to ﬁnd all ofthem. The previous section began with some hints about the signs of eigenvalues. butthat gave place to the tests on a, b, c:is positive deﬁnite whenFrom those conditions, both eigenvalues are positive. Their product λ1λ2 is determinantac − b2 > 0, so the eigenvalues are either both positive or both negative. They must bepositive because their sum is the trace a+c > 0.Looking at a and ac−b2, it is even possible to spot the appearance of the pivots. Theyturned up when we decomposed xTAx into a sum of squares:ax2 +2bxy+cy2 = aThose coefﬁcients a and (ac − b2)/a are the pivots for a 2 by 2 matrix. For largermatrices the pivots still give a simple test for positive deﬁniteness: xTAx stays positivewhen n independent squares are multiplied by positive pivots.",pos_def_matrices
"Chapter 2 Vector Spaces4. Carry out the same steps as in the previous problem to ﬁnd the complete solution of5. Write the complete solutions x = xp +xn to these systems, as in equation (4):6. Describe the set of attainable right-hand sides b (in the column space) forby ﬁnding the constraints on b that turn the third equation into 0 = 0 (after elimina-tion). What is the rank, and a particular solution?7. Find the value of c that makes it possible to solve Ax = b, and solve it:v + 2w =2u + 3v −3u + 4v +8. Under what conditions on b1 and b2 (if any) does Ax = b have a solution?1 2 0 32 4 0 7Find two vectors in the nullspace of A, and the complete solution to Ax = b.9. (a) Find the special solutions to Ux = 0. Reduce U to R and repeat:1 2 3 40 0 1 20 0 0 0(b) If the right-hand side is changed from (0,0,0) to (a,b,0), what are all solutions?10. Find a 2 by 3 system Ax = b whose complete solution is",vector spaces
"Chapter 2 Vector SpacesNormally our vectors belong to one of the spaces Rn; they are ordinary column vec-tors. If x = (1,0,0,3), then 2x (and also x + x) has components 2, 0, 0, 6. The formaldeﬁnition allows other things to be “vectors”-provided that addition and scalar multipli-cation are all right. We give three examples:1. The inﬁnite-dimensional space R∞. Its vectors have inﬁnitely many components, asin x = (1,2,1,2,...). The laws for x+y and cx stay unchanged.2. The space of 3 by 2 matrices. In this case the “vectors” are matrices! We can addtwo matrices, and A+B = B+A, and there is a zero matrix, and so on. This spaceis almost the same as R6. (The six components are arranged in a rectangle insteadof a column.) Any choice of m and n would give, as a similar example, the vectorspace of all m by n matrices.3. The space of functions f(x). Here we admit all functions f that are deﬁned ona ﬁxed interval, say 0 ≤ x ≤ 1. The space includes f(x) = x2, g(x) = sinx, theirsum (f +g)(x) = x2 +sinx, and all multiples like 3x2 and −sinx. The vectors arefunctions, and the dimension is somehow a larger inﬁnity than for R∞.Other examples are given in the exercises, but the vector spaces we need most aresomewhere else—they are inside the standard spaces Rn. We want to describe themand explain why they are important. Geometrically, think of the usual three-dimensionalR3 and choose any plane through the origin. That plane is a vector space in its ownright. If we multiply a vector in the plane by 3, or −3, or any other scalar, we get avector in the same plane. If we add two vectors in the plane, their sum stays in theplane. This plane through (0,0,0) illustrates one of the most fundamental ideas in linearalgebra; it is a subspace of the original space R3.Deﬁnition. A subspace of a vector space is a nonempty subset that satisﬁes the require-ments for a vector space: Linear combinations stay in the subspace.(i) If we add any vectors x and y in the subspace, x+y is in the subspace.(ii) If we multiply any vector x in the subspace by any scalar c, cx is in the subspace.Notice our emphasis on the word space. A subspace is a subset that is “closed” underaddition and scalar multiplication. Those operations follow the rules of the host space,keeping us inside the subspace. The eight required properties are satisﬁed in the largerspace and will automatically be satisﬁed in every subspace. Notice in particular that thezero vector will belong to every subspace. That comes from rule (ii): Choose the scalarto be c = 0.The smallest subspace Z contains only one vector, the zero vector. It is a “zero-dimensional space,” containing only the point at the origin. Rules (i) and (ii) are satisﬁed,",vector spaces
"4.4 Applications of Determinants15. Cramer’s Rule breaks down when detA = 0. Example (a) has no solution, whereas(b) has inﬁnitely many. What are the ratios x j = detB j/detA?2x1 +3x2 = 14x1 +6x2 = 1.2x1 +3x2 = 14x1 +6x2 = 2.16. Quick proof of Cramer’s rule. The determinant is a linear function of column 1. It iszero if two columns are equal. When b = Ax = x1a1+x2a2+x3a3 goes into column1 to produce B1, the determinant is(a) What formula for x1 comes from left side = right side?(b) What steps lead to the middle equation?17. If the right side b is the last column of A, solve the 3 by 3 system Ax = b. Explainhow each determinant in Cramer’s Rule leads to your solution x.Problems 18–26 are about A−1 = CT/detA. Remember to transpose C.18. Find A−1 from the cofactor formula CT/detA. Use symmetry in part (b):19. If all the cofactors are zero, how do you know that A has no inverse? If none of thecofactors are zero, is A sure to be invertible?20. Find the cofactors of A and multiply ACT to ﬁnd detA:If you change that corner entry from 4 to 100, why is detA unchanged?21. Suppose detA = 1 and you know all the cofactors. How can you ﬁnd A?22. From the formula ACT = (detA)I show that detC = (detA)n−1.23. (For professors only) If you know all 16 cofactors of a 4 by 4 invertible matrix A,how would you ﬁnd A?24. If all entries of A are integers, and detA = 1 or −1, prove that all entries of A−1 areintegers. Give a 2 by 2 example.",determinants
"Chapter 8 Linear Programming and Game TheorySince no feasible y can make yb larger than cx, our y that achieves this value is opti-mal. Similarly, any x that achieves the cost cx = yb must be an optimal x∗.We give an example with two foods and two vitamins. Note how AT appears whenwe write out the dual, since yA ≤ c for row vectors means ATyT ≤ cT for columns.x1 ≥ 0, x2 ≥ 0y1 ≥ 0, y2 ≥ 02x1 +x2 ≥ 62y1 +5y2 ≤ 15x1 +3x2 ≥ 7.y1 +3x2 ≤ 4.Solution x1 = 3 and x2 = 0 are feasible, with cost x1 +4x2 = 3. In the dual, y1 = 1y2 = 0 give the same value 6y1 +7y2 = 3. These vectors must be optimal.Please look closely to see what actually happens at the moment when yb = cx. Someof the inequality constraints are tight, meaning that equality holds. Other constraints areloose, and the key rule makes economic sense:(i) The diet has x∗j = 0 when food j is priced above its vitamin equivalent.(ii) The price is y∗i = 0 when vitamin i is oversupplied in the diet x∗.In the example, x2 = 0 because the second food is too expensive. Its price exceeds thedruggist’s price, since y1 + 3y2 ≤ 4 is a strict inequality 12 + 0 < 4. Similarly, the dietrequired seven units of the second vitamin, but actually supplied 5x1 +3x2 = 15. So wefound y2 = 0, and that vitamin is a free good. You can see how the duality has becomeThese optimality conditions are easy to understand in matrix terms. From equation(1) we want y∗Ax∗ = y∗b at the optimum. Feasibility requires Ax∗ ≥ b, and we look forany components in which equality fails. This corresponds to a vitamin that is oversup-plied, so its price is y∗At the same time, we have y∗A ≤ c. All strict inequalities (expensive foods) corre-j = 0 (omission from the diet). That is the key to y∗Ax∗ = cx∗, which weneed. These are the complementary slackness conditions of linear programming, andthe Kuhn-Tucker conditions of nonlinear programming:The optimal vectors x∗ and y∗ satisfy complementary slackness:(y∗A)j > c jLet me repeat the proof. Any feasible vectors x and y satisfy weak duality:yb ≤ y(Ax) = (yA)x ≤ cx.We need equality, and there is only one way in which y∗b can equal y∗(Ax∗). Any timebi < (Ax∗)i, the factor y∗i that multiplies these components must be zero.",linear_prog
"3. The Fourier series of a function is an expansion into sines and cosines:f(x) = a0 +a1cosx+b1sinx+a2cos2x+b2sin2x+··· .To compute a coefﬁcient like b1, multiply both sides by the corresponding function sinxand integrate from 0 to 2π. (The function f(x) is given on that interval.) In other words,take the inner product of both sides with sinx:On the right-hand side, every integral is zero except one—the one in which sinx multi-plies itself. The sines and cosines are mutually orthogonal as in equation (18) Thereforeb1 is the left-hand side divided by that one nonzero integral:The Fourier coefﬁcient a1 would have cosx in place of sinx, and a2 would use cos2x.The whole point is to see the analogy with projections. The component of the vectorb along the line spanned by a is bTa/aTa. A Fourier series is projecting f(x) onto sinx.Its component p in this direction is exactly b1sinx.The coefﬁcient b1 is the least squares solution of the inconsistent equation b1sinx =f(x). This brings b1sinx as close as possible to f(x). All the terms in the series areprojections onto a sine or cosine. Since the sines and cosines are orthogonal, the Fourierseries gives the coordinates of the “vector” f (x) with respect to a set of (inﬁnitely many)4. Gram-Schmidt for Functions.There are plenty of useful functions other thansines and cosines, and they are not always orthogonal. The simplest are the powers of x,and unfortunately there is no interval on which even 1 and x2 are perpendicular. (Theirinner product is always positive, because it is the integral of x2.) Therefore the closestparabola to f(x) is not the sum of its projections onto 1, x, and x2. There will be a matrixlike (ATA)−1, and this coupling is given by the ill-conditioned Hilbert matrix. On theinterval 0 ≤ x ≤ 1,This matrix has a large inverse, because the axes 1, x, x2 are far from perpendicular. Thesituation becomes impossible if we add a few more axes. It is virtually hopeless to solveATA�x = ATb for the closest polynomial of degree ten.More precisely, it is hopeless to solve this by Gaussian elimination; every roundofferror would be ampliﬁed by more than 1013. On the other hand, we cannot just give",orthogonality
"3.5 The Fast Fourier Transform3.26 Find an orthonormal basis for the plane x − y + z = 0, and ﬁnd the matrix P thatprojects onto the plane. What is the nullspace of P?3.27 Let A = [3 1 1], and let V be the nullspace of A.(a) Find a basis for V and a basis for V⊥.(b) Write an orthonormal basis for V⊥, and ﬁnd the projection matrix P1 that projectsvectors in R3 onto V⊥.(c) Find the projection matrix P2 that projects vectors in R3 onto V.3.28 Use Gram-Schmidt to construct an orthonormal pair q1, q2 from a1 = (4,5,2,2)and a2 = (1,2,0,0), Express a1 and a2 as combinations of q1 and q2, and ﬁnd thetriangular R in A = QR.3.29 For any A, b, x, and y, show that(a) if Ax = b and yTA = 0, then yTb = 0.(b) if Ax = 0 and ATy = b, then xTb = 0.What theorem does this prove about the fundamental subspaces?3.30 Is there a matrix whose row space contains (1,1,0) and whose nullspace contains3.31 The distance from a plane aTx = c (in m-dimensional space) to the origin is |c|/∥a∥.How far is the plane x1 + x2 − x3 − x4 = 8 from the origin, and what point on it is3.32 In the parallelogram with corners at 0, v, w, and v + w, show that the sum of thesquared lengths of the four sides equals the sum of the squared lengths of the two3.33 (a) Find an orthonormal basis for the column space of A.(b) Write A as QR, where Q has orthonormal columns and R is upper triangular.(c) Find the least-squares solution to Ax = b, if b = (−3,7,1,0,4).3.34 With weighting matrix W =, what is the W-inner product of (1,0) with (0,1)?",orthogonality
"2.2 Solving Ax = 0 and Ax = bThere must be inﬁnitely many solutions, since any multiple cx will also satisfy A(cx) =0. The nullspace contains the line through x. And if there are additional free variables,the nullspace becomes more than just a line in n-dimensional space. The nullspace hasthe same “dimension” as the number of free variables and special solutions.This central idea—the dimension of a subspace—is made precise in the next section.We count the free variables for the nullspace. We count the pivot variables for the columnSolving Ax = b, Ux = c, and Rx = dThe case b ̸= 0 is quite different from b = 0. The row operations on A must act alsoon the right-hand side (on b). We begin with letters (b1,b2,b3) to ﬁnd the solvabilitycondition—for b to lie in the column space. Then we choose b = (1,5,5) and ﬁnd allFor the original example Ax = b = (b1,b2,b3), apply to both sides the operations thatled from A to U. The result is an upper triangular system Ux = c:1 3 3 20 0 3 30 0 0 0The vector c on the right-hand side, which appeared after the forward elimination steps,is just L−1b as in the previous chapter. Start now with Ux = c.It is not clear that these equations have a solution. The third equation is very muchin doubt, because its left-hand side is zero. The equations are inconsistent unless b3 −2b2 +5b1 = 0. Even though there are more unknowns than equations, there may be nosolution. We know another way of answering the same question: Ax = b can be solved ifand only if b lies in the column space of A. This subspace comes from the four columnsof A (not of U!):Even though there are four vectors, their combinations only ﬁll out a plane in three-dimensional space. Column 2 is three times column 1. The fourth column equals thethird minus the ﬁrst. These dependent columns, the second and fourth, are exactly theThe column space C(A) can be described in two different ways. On the one hand,it is the plane generated by columns 1 and 3. The other columns lie in that plane,and contribute nothing new. Equivalently, it is the plane of all vectors b that satisfyb3 −2b2 +5b1 = 0; this is the constraint if the system is to be solvable. Every column",vector spaces
"Chapter 2 Vector Spaces15. If the columns of A are linearly independent (A is m by n), then the rank is, the row space is, and there exists a16. (A paradox) Suppose A has a right-inverse B. Then AB = I leads to ATAB = AT orB(ATA)−1AT. But that satisﬁes BA = I; it is a left-inverse. Which step is not justiﬁed?17. Find a matrix A that has V as its row space, and a matrix B that has V as its nullspace,if V is the subspace spanned by18. Find a basis for each of the four subspaces of0 1 2 3 40 1 2 4 60 0 0 1 20 1 2 3 40 0 0 1 20 0 0 0 019. If A has the same four fundamental subspaces as B, does A = cB?20. (a) If a 7 by 9 matrix has rank 5, what are the dimensions of the four subspaces?What is the sum of all four dimensions?(b) If a 3 by 4 matrix has rank 3, what are its column space and left nullspace?21. Construct a matrix with the required property, or explain why you can’t.(a) Column space contains, row space contains(b) Column space has basis, nullspace has basis(c) Dimension of nullspace = 1+ dimension of left nullspace.(d) Left nullspace contains, row space contains(e) Row space = column space, nullspace ̸= left nullspace.22. Without elimination, ﬁnd dimensions and bases for the four subspaces for0 3 3 30 0 0 00 1 0 123. Suppose the 3 by 3 matrix A is invertible. Write bases for the four subspaces for A,and also for the 3 by 6 matrix B = [A A].24. What are the dimensions of the four subspaces for A, B, and C, if I is the 3 by 3identity matrix and 0 is the 3 by 2 zero matrix?",vector spaces
"1. (a) Write the four equations for ﬁtting y = C +Dt to the dataShow that the columns are orthogonal.(b) Find the optimal straight line, draw its graph, and write E2.(c) Interpret the zero error in terms of the original system of four equations in twounknowns: The right-hand side (−4,−3,−1,0) is in the2. Project b = (0,3,0) onto each of the orthonormal vectors a1 = (23) and a2 =3), and then ﬁnd its projection p onto the plane of a1 and a2.3. Find also the projection of b = (0,3,0) onto a3 = (23), and add the three pro-jections. Why is P = a1aT3 equal to I?4. If Q1 and Q2 are orthogonal matrices, so that QTQ = I, show that Q1Q2 is alsoorthogonal. If Q1 is rotation through θ, and Q2 is rotation through φ, what is Q1Q2?Can you ﬁnd the trigonometric identities for sin(θ +φ) and cos(θ +φ) in the matrix5. If u is a unit vector, show that Q = I − 2uuT is a symmetric orthogonal matrix. (Itis a reﬂection, also known as a Householder transformation.) Compute Q when6. Find a third column so that the matrixis orthogonal. It must be a unit vector that is orthogonal to the other columns; howmuch freedom does this leave? Verify that the rows automatically become orthonor-mal at the same time.7. Show, by forming bTb directly, that Pythagoras’s law holds for any combinationb = x1q1 +···+xnqn of orthonormal vectors: ∥b∥2 = x2n. In matrix terms,b = Qx, so this again proves that lengths are preserved: ∥Qx∥2 = ∥x∥2.8. Project the vector b = (1,2) onto two vectors that are not orthogonal, a1 = (1,0)and a2 = (1,1). Show that, unlike the orthogonal case, the sum of the two one-dimensional projections does not equal b.9. If the vectors q1, q2, q3 are orthonormal, what combination of q1 and q2 is closest to",orthogonality
"3.2 Cosines and Projections onto LinesThe transpose AT can be deﬁned by the following property: The innerproduct of Ax with y equals the inner product of x with ATy. Formally, this(Ax)Ty = xTATy = xT(ATy).This deﬁnition gives us another (better) way to verify the formula (AB)T = BTAT, UseMove A then move B(ABx)Ty = (Bx)T(ATY) = xT(BTATy).The transposes turn up in reverse order on the right side, just as the inverses do in theformula (AB)−1 = B−1A−1. We mention again that these two formulas meet to give theremarkable combination (A−1)T = (AT)−1.1. (a) Given any two positive numbers x and y, choose the vector b equal to (√x,√y),and choose a = (√y,√x). Apply the Schwarz inequality to compare the arith-2(x+y) with the geometric mean √xy.(b) Suppose we start with a vector from the origin to the point x, and then add avector of length ∥y∥ connecting x to x + y. The third side of the triangle goesfrom the origin to x+y. The triangle inequality asserts that this distance cannotbe greater than the sum of the ﬁrst two:After squaring both sides, and expanding (x + y)T(x + y), reduce this to the2. Verify that the length of the projection in Figure 3.7 is ∥p∥ = ∥b∥cosθ, using formula3. What multiple of a = (1,1,1) is closest to the point b = (2,4,4)? Find also the pointclosest to a on the line through b.4. Explain why the Schwarz inequality becomes an equality in the case that a and blie on the same line through the origin, and only in that case. What if they lie onopposite sides of the origin?5. In n dimensions, what angle does the vector (1,1,...,1) make with the coordinateaxes? What is the projection matrix P onto that vector?6. The Schwarz inequality has a one-line proof if a and b are normalized ahead of timeto be unit vectors:�� ≤ ∑|a j||b j| ≤ ∑|a j|2 +|b j|2",orthogonality
"(a) A real symmetric matrix.(b) A stable matrix: all solutions to du/dt = Au approach zero.(c) An orthogonal matrix.(d) A Markov matrix.(e) A defective matrix (nondiagonalizable).(f) A singular matrix.17. Show that if U and V are unitary, so is UV. Use the criterion UHU = I.18. Show that a unitary matrix has |detU| = 1, but possibly detU is different fromdetUH. Describe all 2 by 2 matrices that are unitary.19. Find a third column so that U is unitary. How much freedom in column 3?20. Diagonalize the 2 by 2 skew-Hermitian matrix K =, whose entries are all √−1.Compute eKt = SeΛtS−1, and verify that eKt is unitary. What is the derivative of eKtat t = 0?21. Describe all 3 by 3 matrices that are simultaneously Hermitian, unitary, and diagonal.How many are there?22. Every matrix Z can be split into a Hermitian and a skew-Hermitian part, Z = A+K,just as a complex number z is split into a+ib, The real part of z is half of z+ z, andthe “real part” of Z is half of Z +ZH. Find a similar formula for the “imaginary part”K, and split these matrices into A+K:23. Show that the columns of the 4 by 4 Fourier matrix F in Example 5 are eigenvectorsof the permutation matrix P in Example 6.24. For the permutation of Example 6, write out the circulant matrix C = c0I + c1P +c2P2 + c3P3. (Its eigenvector matrix is again the Fourier matrix.) Write out alsothe four components of the matrix-vector product Cx, which is the convolution ofc = (c0,c1,c2,c3) and x = (x0,x1,x2,x3).25. For a circulant C = FΛF−1, why is it faster to multiply by F−1, then Λ, then F (theconvolution rule), than to multiply directly by C?26. Find the lengths of u = (1+i,1−i,1+2i) and v = (i,i,i). Also ﬁnd uHv and vHu.",eigenvec_val
"Chapter 2 Vector SpacesThe net current into every node is zero. Flow in = Flow out.This law can only be satisﬁed if the total current from outside is f1 + f2 + f3 +f4 = 0. With f = 0, the law ATy = 0 is satisﬁed by a current that goes aroundSpanning Trees and Independent RowsEvery component of y1 and y2 in the left nullspace is 1 or −1 or 0 (from loop ﬂows).The same is true of x = (1,1,1,1) in the nullspace, and all the entries in PA = LDU! Thekey point is that every elimination step has a meaning for the graph.You can see it in the ﬁrst step for our matrix A: subtract row 1 from row 2. Thisreplaces edge 2 by a new edge “1 minus 2”: That elimination step destroys an edge andcreates a new edge. Here the new edge “1 − 2” is just the old edge 3 in the oppositedirection. The next elimination step will produce zeros in row 3 of the matrix. Thisshows that rows 1, 2, 3 are dependent. Rows are dependent if the corresponding edgesAt the end of elimination we have a full set of r independent rows. Those r edgesform a tree—a graph with no loops. Our graph has r = 3, and edges 1, 2, 4 form onepossible tree. The full name is spanning tree because the tree “spans” all nodes of thegraph. A spanning tree has n−1 edges if the graph is connected, and including one moreedge will produce a loop.In the language of linear algebra, n−1 is the rank of the incidence matrix A. The rowspace has dimension n−1. The spanning tree from elimination gives a basis for that rowspace—each edge in the tree corresponds to a row in the basis.The fundamental theorem of linear algebra connects the dimensions of the subspaces:Nullspace: dimension 1, contains x = (1,...,1).Column space: dimension r = n−1, any n−1 columns are independent.Row space: dimension r = n−1, independent rows from any spanning tree.Left nullspace: dimension m−r = m−n+1, contains y’s from the loops.Those four lines give Euler’s formula, which in some way is the ﬁrst theorem in topol-ogy. It counts zero-dimensional nodes minus one-dimensional edges plus two-dimensional",vector spaces
"Chapter 6 Positive Deﬁnite MatricesRemark 4. Eigenvectors of AAT and ATA must go into the columns of U and V:AAT = (UΣV T)(VΣTUT) = UΣΣTUTATA = VΣTΣV T.U must be the eigenvector matrix for AAT. The eigenvalue matrix in the middle is ΣΣT—which is m by m with σ2r on the diagonal.From the ATA = VΣTΣV T, the V matrix must be the eigenvector matrix for ATA. Thediagonal matrix ΣTΣ has the same σ2r , but it is n by n.Remark 5. Here is the reason that Avj = σ ju j. Start with ATAvj = σ2AATAv j = σ 2This says that Avj is an eigenvector of AAT! We just moved parentheses to (AAT)(Avj).The length of this eigenvector Avj is σ j, becausevTATAv j = σ2So the unit eigenvector is Avj/σj = u j. In other words, AV = UΣ.Example 1. This A has only one column: rank r = 1. Then Σ has only σ1 = 3:ATA is 1 by 1, whereas AAT is 3 by 3. They both have eigenvalue 9 (whose square rootis the 3 in Σ). The two zero eigenvalues of AAT leave some freedom for the eigenvectorsin columns 2 and 3 of U. We kept that matrix orthogonal.Example 2. Now A has rank 2, and AAT =with λ = 3 and 1:= UΣV T = 11. The columns of U are left singular vectors (unit eigenvectors ofAAT). The columns of V are right singular vectors (unit eigenvectors of ATA).Application of the SVDWe will pick a few important applications, after emphasizing one key point. The SVD isterriﬁc for numerically stable computations. because U and V are orthogonal matrices.They never change the length of a vector. Since ∥Ux∥2 = xTUTUx = ∥x∥2, multiplicationby U cannot destroy the scaling.",pos_def_matrices
"Chapter 6 Positive Deﬁnite Matrices16. (Recommended) From the zero submatrix decide the signs of the n eigenvalues:17. (Constrained minimum) Suppose the unconstrained minimum x = A−1b happens tosatisfy the constraint Cx = d. Verify that equation (5) correctly gives PC/min = Pmin;the correction term is zero.The Finite Element MethodThere were two main ideas in the preceding section on minimum principles:(i) Solving Ax = b is equivalent to minimizing P(x) = 1(ii) Solving Ax = λ1x is equivalent to minimizing R(x) = xTAx/xTx.Now we try to explain how these ideas can be applied.The story is a long one, because these principles have been known for more than acentury. In engineering problems like plate bending, or physics problems like the groundstate (eigenfunction) of an atom, minimization was used to get a rough approximationto the true solution. The approximations had to be rough; the computers were human.The principles (i) and (ii) were there, but they could not be implemented.Obviously the computer was going to bring about a revolution. It was the methodof ﬁnite differences that jumped ahead, because it is easy to “discretize” a differentialequation. Already in Section 1.7, derivatives were replaced by differences. The physicalregion is covered by a mesh, and u′′ = f(x) became u j+1 − 2u j + u j−1 = h2 f j. The1950s brought new ways to solve systems Au = f that are very large and very sparse—algorithms and hardware are both much faster now.What we did not fully recognize was that even ﬁnite differences become incrediblycomplicated for real engineering problems, like the stresses on an airplane. The realdifﬁculty is not to solve the equations, but to set them up. For an irregular region wepiece the mesh together from triangles or quadrilaterals or tetrahedra. Then we need asystematic way to approximate the underlying physical laws. The computer has to helpnot only in the solution of Au = f and Ax = λx, but in its formulation.You can guess what happened. The old methods came back, with a new idea and anew name. The new name is the ﬁnite element method. The new ides uses more ofthe power of the computer—in constructing a discrete approximation, solving it, anddisplaying the results—than any other technique in scientiﬁc computation2. If the basic2Please forgive this enthusiasm: I know the method may not be immortal.",pos_def_matrices
"1. For the complex numbers 3+4i and 1−i,(a) ﬁnd their positions in the complex plane.(b) ﬁnd their sum and product.(c) ﬁnd their conjugates and their absolute values.Do the original numbers lie inside or outside the unit circle?2. What can you say about(a) the sum of a complex number and its conjugate?(b) the conjugate of a number on the unit circle?(c) the product of two numbers on the unit circle?(d) the sum of two numbers on the unit circle?3. If x = 2+i and y = 1+3i, ﬁnd x, xx, 1/x, and x/y. Check that the absolute value |xy|equals |x| times |y|, and the absolute value |1/x| equals 1 divided by |x|.4. Find a and b for the complex numbers a + ib at the angles θ = 30°,60°,90° on theunit circle. Verify by direct multiplication that the square of the ﬁrst is the second,and the cube of the ﬁrst is the third.5. (a) If x = reiθ what are x2, x−1, and x in polar coordinates? Where are the complexnumbers that have x−1 = x?(b) At t = 0, the complex number e(−1+i)t equals one. Sketch its path in the complexplane as t increases from 0 to 2π.6. Find the lengths and the inner product of7. Write out the matrix AH and compute C = AHA ifWhat is the relation between C and CH? Does it hold whenever C is constructed from8. (a) With the preceding A, use elimination to solve Ax = 0.(b) Show that the nullspace you just computed is orthogonal to C(AH) and not tothe usual row space C(AT). The four fundamental spaces in the complex caseare N(A) and C(A) as before, and then N(AH) and C(AH).",eigenvec_val
"6.2 Tests for Positive DeﬁnitenessOne more preliminary remark. The two parts of this hook were linked by the chapteron determinants. Therefore we ask what part determinants play. It is not enough torequire that the determinant of A is positive. If a = c = −1 and b = 0. then detA = 1but A = −I = negative deﬁnite. The determinant test is applied not only to A itself,giving ac−b2 > 0, but also to the 1 by 1 submatrix a in the upper left-hand corner.The natural generalization will involve all n of the upper left submatrices of A:Here is the main theorem on positive deﬁniteness, and a reasonably detailed proof:Each of the following tests is a necessary and sufﬁcient condition for thereal symmetric matrix A to be positive deﬁnite:(I) xTkx > 0 for all nonzero real vectors x.(II) All the eigenvalues of A satisfy λi > 0.(III) All the upper left submatrices Ak have positive determinants.(IV) All the pivots (without row exchanges) satisfy dk > 0.Proof. Condition I deﬁnes a positive deﬁnite matrix. Our ﬁrst step shows that eacheigenvalue will be positive:xTAx = xTλx = λ∥x∥2.A positive deﬁnite matrix has positive eigenvalues, since xTAx > 0.Now we go in the other direction. If all λi > 0, we have to prove xTAx > 0 forevery vector x (not just the eigenvectors). Since symmetric matrices have a full set oforthonormal eigenvectors, any x is a combination c1x1 +···+cnxn. ThenAx = c1Ax1 +···+cnAxn = c1λ1x1 +···+cnλnxn.Because of the orthogonality xTi xi = 0, and the normalization xTi xi = 1,If every λi > 0, then equation (2) shows that xTAx > 0. Thus condition II implies condi-If condition I holds, so does condition III: The determinant of A is the product ofthe eigenvalues. And if condition I holds, we already know that these eigenvalues arepositive. But we also have to deal with every upper left submatrix Ak. The trick is tolook at all nonzero vectors whose last n−k components are zero:k Akxk > 0.",pos_def_matrices
"Chapter 1 Matrices and Gaussian Eliminationthree inverse matrices in the right order:The special thing is that the entries below the diagonal are the multipliers ℓ = 2, −1,and −1. When matrices are multiplied, there is usually no direct way to read off theanswer. Here the matrices come in just the right order so that their product can bewritten down immediately. If the computer stores each multiplier ℓij—the number thatmultiplies the pivot row j when it is subtracted from row i, and produces a zero in the i,j position—then these multipliers give a complete record of elimination.The numbers ℓij ﬁt right into the matrix L that takes U back to A.Triangular factorization A = LU with no exchanges of rows. L is lowertriangular, with 1s on the diagonal. The multipliers ℓij (taken from elimination)are below the diagonal. U is the upper triangular matrix which appears afterforward elimination, The diagonal entries of U are the pivots.goes to U =Then LU = A.Example 2. (which needs a row exchange)cannot be factored into A = LU.Example 3. (with all pivots and multipliers equal to 1)From A to U there are subtractions of rows. From U to A there are additions of rows.Example 4. (when U is the identity and L is the same as A)The elimination steps on this A are easy: (i) E subtracts ℓ21 times row 1 from row 2, (ii)F subtracts ℓ31 times row 1 from row 3, and (iii) G subtracts ℓ32 times row 2 from row 3.The result is the identity matrix U = I. The inverses of E, F, and G will bring back A:",gauss elim
"4.2 Properties of the DeterminantAgain the singular case is separate; A is singular if and only if AT is singular, and wehave 0 = 0. If A is nonsingular, then it allows the factorization PA = LDU, and we applyrule 9 for the determinant of a product:Transposing PA = LDU gives ATPT = UTDTLT, and again by rule 9,This is simpler than it looks, because L, U, LT, and UT are triangular with unit diagonal.By rule 7, their determinants all equal 1. Also, any diagonal matrix is the same as itstranspose: D = DT. We only have to show that detP = detPT.Certainly detP is 1 or −1, because P comes from I by row exchanges. Observe alsothat PPT = I. (The 1 in the ﬁrst row of P matches the 1 in the ﬁrst column of PT, andmisses the 1s in the other columns.) Therefore detPdetPT = detI = 1, and P and PTmust have the same determinant: both 1 or both −1.We conclude that the products (3) and (4) are the same, and detA = detAT. Thisfact practically doubles our list of properties, because every rule that applied to the rowscan now be applied to the columns: The determinant changes sign when two columnsare exchanged, two equal columns (or a column of zeros) produce a zero determinant,and the determinant depends linearly on each individual column. The proof is just totranspose the matrix and work with the rows.I think it is time to stop and call the list complete. It only remains to ﬁnd a deﬁniteformula for the determinant, and to put that formula to use.1. If a 4 by 4 matrix has detA = 12, ﬁnd det(2A), det(−A), det(A2), and det(A−1).2. If a 3 by 3 matrix has detA = −1, ﬁnd det(12A), det(−A), det(A2), and det(A−1).3. Row exchange: Add row 1 of A to row 2, then subtract row 2 from row 1. Thenadd row 1 to row 2 and multiply row 1 by −1 to reach B. Which rules show theThose rules could replace Rule 2 in the deﬁnition of the determinant.",determinants
"Chapter 7 Computations with MatricesWe begin with a change in the right-hand side, from b to b +δb. This error mightcome from experimental data or from roundoff. We may suppose that δb is small, butits direction is outside our control. The solution is changed from x to x+δx:An error δb leads to δx = A−1δb. There will be a large change in the solution x whenA−1 is large—A is nearly singular. The change in x is especially large when δb points inthe direction that is ampliﬁed most by A−1.Suppose A is symmetric and its eigenvalues are positive: 0 < λ1 ≤ ··· ≤ λn. Anyvector δb is a combination of the corresponding unit eigenvectors x1,...,xn. The worsterror δx, coming from A−1, is in the direction of the ﬁrst eigenvector x1:The error ∥δb∥ is ampliﬁed by 1/λ1, which is the largest eigenvalue of A−1. Thisampliﬁcation is greatest when λ1 is near zero, and A is nearly singular.Measuring sensitivity entirely by λ1 has a serious drawback. Suppose we multiply allthe entries of A by 1000; then λ1 will be multiplied by 1000 and the matrix will lookmuch less singular. This offends our sense of fair play; such a simple rescaling cannotmake an ill-conditioned matrix well. It is true that δx will be 1000 times smaller, but sowill the solution x = A−1b. The relative error ∥δx∥/∥x∥ will be the same. Dividing by∥x∥ normalizes the problem against a trivial change of scale. At the same time there isa normalization for δb; our problem is to compare the relative change ∥δb∥/∥b∥ withthe relative error ∥δx∥/∥x∥.The worst case is when ∥δx∥ is large—with δb in the direction of the eigenvectorx1—and when ∥x∥ is small. The true solution x should be as small as possible comparedto the true b. This means that the original problem Ax = b should be at the other extreme,in the direction of the last eigenvector xn: if b = xn, then x = A−1b = b/λn.It is this combination, b = xn and δb = εx1, that makes the relative error as large aspossible. These are the extreme cases in the following inequalities:For a positive deﬁnite matrix, the solution x = A−1b and the error δx =The ratio c = λmax/λmin is the condition number of a positive deﬁnite matrixExample 1. The eigenvalues of A are approximately λ1 = 10−4/2 and λ2 = 2:has condition number about",computations
"3.5 The Fast Fourier TransformThe input sequence is y = 2,4,6,8. The output sequence is c0,c1,c2,c3. The four equa-tions (6) look for a four-term Fourier series that matches the inputs at four equally spacedpoints x on the interval from 0 to 2π:c0 +c1eix +c2e2ix +c3e3ix =Those are the four equations in system (6). At x = 2π the series returns y0 = 2 andcontinues periodically. The Discrete Fourier Series is best written in this complex form,as a combination of exponentials eikx rather than sinkx and coskx.For every n, the matrix connecting y to c can be inverted. It represents n equations,requiring the ﬁnite series c0 +c1eix +··· (n terms) to agree with y (at n points). The ﬁrstagreement is at x = 0, where c0 +···+cn−1 = y0. The remaining points bring powers ofw, and the full problem is Fc = y:There stands the Fourier matrix F with entries Fjk = w jk. It is natural to number therows and columns from 0 to n − 1, instead of 1 to n. The ﬁrst row has j = 0, the ﬁrstcolumn has k = 0, and all their entries are w0 = 1.To ﬁnd the c’s we have to invert F. In the 4 by 4 case, F−1 was built from 1/i = −i.That is the general rule, that F−1 comes from the complex number w−1 = w. It lies atthe angle −2π/n, where w was at the angle +2π/n:The inverse matrix is built from the powers of w−1 = 1/w = w:Row j of F times column j of F−1 is always (1+1+···+1)/n = 1. The harder part isoff the diagonal, to show that row j of F times column k of F−1 gives zero:1·1+w jw−k +w2jw−2k +···+w(n−1)jw−(n−1)k = 0",orthogonality
"Chapter 1 Matrices and Gaussian Elimination10. (a) Why does it take approximately n2/2 multiplication-subtraction steps to solveeach of Lc = b and Ux = c?(b) How many steps does elimination use in solving 10 systems with the same 60 by60 coefﬁcient matrix A?11. Solve as two triangular systems, without multiplying LU to ﬁnd A:12. How could you factor A into a product UL, upper triangular times lower triangular?Would they be the same factors as in A = LU?13. Solve by elimination, exchanging rows when necessary:+ 4v + 2w = −2−2u − 8v + 3w =v + w =u + v + w = 1.Which permutation matrices are required?14. Write down all six of the 3 by 3 permutation matrices, including P = I. Identify theirinverses, which are also permutation matrices. The inverses satisfy PP−1 = I and areon the same list.15. Find the PA = LDU factorizations (and check them) for16. Find a 4 by 4 permutation matrix that requires three row exchanges to reach the endof elimination (which is U = I).17. The less familiar form A = LPU exchanges rows only at the end:�� → L−1A =�� = PU =What is L is this case? Comparing with PA = LU in Box 1J, the multipliers now stayin place (ℓ21 is 1 and ℓ31 is 2 when A = LPU).18. Decide whether the following systems are singular or nonsingular, and whether theyhave no solution, one solution, or inﬁnitely many solutions:v − w = 2− w = 2v − w = 0− w = 0v + w =+ w = 1.",gauss elim
"9. Show that the trace equals the sum of the eigenvalues, in two steps. First, ﬁnd thecoefﬁcient of (−λ)n−1 on the right side of equation (16). Next, ﬁnd all the terms inthat involve (−λ)n−1. They all come from the main diagonal! Find that coefﬁcientof (−λ)n−1 and compare.10. (a) Construct 2 by 2 matrices such that the eigenvalues of AB are not the products ofthe eigenvalues of A and B, and the eigenvalues of A+B are not the sums of the(b) Verify, however, that the sum of the eigenvalues of A + B equals the sum of allthe individual eigenvalues of A and B, and similarly for products. Why is this11. The eigenvalues of A equal the eigenvalues of AT. This is because det(A − λI)equals det(AT −λI). That is true because. Show by an example that the eigen-vectors of A and AT are not the same.12. Find the eigenvalues and eigenvectors of13. If B has eigenvalues 1, 2, 3, C has eigenvalues 4, 5, 6, and D has eigenvalues 7, 8, 9,what are the eigenvalues of the 6 by 6 matrix A =14. Find the rank and all four eigenvalues for both the matrix of ones and the checker1 1 1 11 1 1 11 1 1 11 1 1 10 1 0 11 0 1 00 1 0 11 0 1 0Which eigenvectors correspond to nonzero eigenvalues?15. What are the rank and eigenvalues when A and C in the previous exercise are n by n?Remember that the eigenvalue λ = 0 is repeated n−r times.16. If A is the 4 by 4 matrix of ones, ﬁnd the eigenvalues and the determinant of A−I.",eigenvec_val
"Chapter 1 Matrices and Gaussian EliminationAB which is the key formula in matrix computations. Ordinary numbers are the same:(a+b)−1 is hard to simplify, while 1/ab splits into 1/a times 1/b. But for matrices theorder of multiplication must be correct—if ABx = y then Bx = A−1y and x = B−1A−1y.The inverses come in reverse order.A product AB of invertible matrices is inverted by B−1A−1:Proof. To show that B−1A−1 is the inverse of AB, we multiply them and use the associa-tive law to remove parentheses. Notice how B sits next to B−1:(AB)(B−1A−1) = ABB−1A−1 = AIA−1 = AA−1 = I(B−1A−1)(AB) = B−1A−1AB = B−1IB = B−1B = I.A similar rule holds with three or more matrices:We saw this change of order when the elimination matrices E, F, G were inverted tocome back from U to A. In the forward direction, GFEA was U. In the backwarddirection, L = E−1F−1G−1 was the product of the inverses. Since G came last, G−1comes ﬁrst. Please check that A−1 would be U−1GFE.The Calculation of A−1: The Gauss-Jordan MethodConsider the equation AA−1 = I. If it is taken a column at a time, that equation de-termines each column of A−1. The ﬁrst column of A−1 is multiplied by A, to yield theﬁrst column of the identity: Ax1 = e1. Similarly Ax2 = e2 and Ax3 = e3 the e’s are thecolumns of I. In a 3 by 3 example, A times A−1 is I:Thus we have three systems of equations (or n systems). They all have the same coefﬁ-cient matrix A. The right-hand sides e1, e2, e3 are different, but elimination is possibleon all systems simultaneously. This is the Gauss-Jordan method. Instead of stoppingat U and switching to back-substitution, it continues by subtracting multiples of a rowfrom the rows above. This produces zeros above the diagonal as well as below. When itreaches the identity matrix we have found A−1.The example keeps all three columns e1, e2, e3, and operates on rows of length six:",gauss elim
"Chapter 2 Vector SpacesStarting with a different basis (1,1) and (2,−1), this same A is also the only linearNext we ﬁnd matrices that represent differentiation and integration. First we mustdecide on a basis. For the polynomials of degree 3 there is a natural choice for the fourThat basis is not unique (it never is), but some choice is necessary and this is the mostconvenient. The derivatives of those four basis vectors are 0, 1, 2t, 3t2:“d/dt” is acting exactly like a matrix, but which matrix? Suppose we were in the usualfour-dimensional space with the usual basis—the coordinate vectors p1 = (1,0,0,0),p2 = (0,1,0,0), p3 = (0,0,1,0), p4 = (0,0,0,1). The matrix is decided by equation (5):0 1 0 00 0 2 00 0 0 30 0 0 0Ap1 is its ﬁrst column, which is zero. Ap2 is the second column, which is p1. Ap3 is2p2 and Ap4 is 3p3. The nullspace contains p1 (the derivative of a constant is zero).The column space contains p1, p2, p3 (the derivative of a cubic is a quadratic). Thederivative of a combination like p = 2 +t −t2 −t3 is decided by linearity, and there isnothing new about that—it is the way we all differentiate. It would be crazy to memorizethe derivative of every polynomial.The matrix can differentiate that p(t), because matrices build in linearity!dt = Ap −→0 1 0 00 0 2 00 0 0 30 0 0 0���� −→ 1−2t −3t2.In short, the matrix carries all the essential information. If the basis is known, and thematrix is known, then the transformation of every vector is known.The coding of the information is simple. To transform a space to itself, one basis isenough. A transformation from one space to another requires a basis for each.",vector spaces
"The entries rij = qTi a j appear in formula (11), when ∥A j∥q j is substituted for Aj:a j = (qTj−1a j)q j−1 +∥A j∥q j = Q times column j of R.Every m by n matrix with independent columns can be factored intoA = QR. The columns of Q are orthonormal, and R is upper triangular andinvertible. When m = n and all matrices are square, Q becomes an orthogonalI must not forget the main point of orthogonalization. It simpliﬁes the least-squaresproblem Ax = b. The normal equations are still correct, but ATA becomes easier:ATA = RTQTQR = RTR.The fundamental equation ATA�x = ATb simpliﬁes to a triangular system:Instead of solving QRx = b, which can’t be done, we solve R�x = QTb which is justback-substitution because R is triangular. The real cost is the mn2 operations of Gram-Schmidt, which are needed to ﬁnd Q and R in the ﬁrst place.The same idea of orthogonality applies to functions, The sines and cosines are or-thogonal; the powers 1, x, x2 are not. When f(x) is written as a combination of sines andcosines, that is a Fourier series. Each term is a projection onto a line—the line in func-tion space containing multiples of cosnx or sinnx. It is completely parallel to the vectorcase, and very important. And ﬁnally we have a job for Schmidt: To orthogonalize thepowers of x and produce the Legendre polynomials.Function Spaces and Fourier SeriesThis is a brief and optional section, but it has a number of good intentions:1. to introduce the most famous inﬁnite-dimensional vector space (Hilbert space);2. to extend the ideas of length and inner product from vectors v to functions f(x):3. to recognize the Fourier series as a sum of one-dimensional projections (the orthog-onal “columns” are the sines and cosines);4. to apply Gram-Schmidt orthogonalization to the polynomials 1,x,x2,...; and5. to ﬁnd the best approximation to f(x) by a straight line.We will try to follow this outline, which opens up a range of new applications forlinear algebra, in a systematic way.After studying Rn, it is natural to think of the space R∞. It con-tains all vectors v = (v1,v2,v3,...) with an inﬁnite sequence of components. This space",orthogonality
"3.1 Orthogonal Vectors and SubspacesThe direct approach was “b must be a combination of the columns.” The indirect ap-proach is “b must be orthogonal to every vector that is orthogonal to the columns.” Thatdoesn’t sound like an improvement (to put it mildly). But if only one or two vectorsare orthogonal to the columns. it is much easier to check those one or two conditionsyTb = 0. A good example is Kirchhoff’s Voltage Law in Section 2.5. Testing for zeroaround loops is much easier than recognizing combinations of the columns.When the left-hand sides of Ax = b add to zero, the right-hand sides must, too:x1 −x2 = b1x2 −x3 = b2x3 −x1 = b3is solvable if and only if b1 +b2 +b3 = 0.This test b1 + b2 + b3 = 0 makes b orthogonal to y = (1,1,1) in the left nullspace. Bythe Fundamental Theorem, b is a combination of the columns!The Matrix and the SubspacesWe emphasize that V and W can be orthogonal without being complements. Theirdimensions can be too small. The line V spanned by (0,1,0) is orthogonal to the lineW spanned by (0,0,1), but V is not W⊥. The orthogonal complement of W is a two-dimensional plane, and the line is only part of W⊥. When the dimensions are right,orthogonal subspaces are necessarily orthogonal complements:In other words V⊥⊥ = V. The dimensions of V and W are right, and the whole spaceRn is being decomposed into two perpendicular parts (Figure 3.3).Two orthogonal axes in R3Line W perpendicular to plane VOrthogonal complements V = W⊥Figure 3.3: Orthogonal complements in R3: a plane and a line (not two lines).Splitting Rn into orthogonal parts will split every vector into x = v+w. The vector vis the projection onto the subspace V. The orthogonal component w is the projection ofx onto W. The next sections show how to ﬁnd those projections of x. They lead to whatis probably the most important ﬁgure in the book (Figure 3.4).Figure 3.4 summarizes the fundamental theorem of linear algebra. It illustrates thetrue effect of a matrix—what is happening inside the multiplication Ax. The nullspace",orthogonality
"factoring into λ 2 − λ − 2 = (λ + 1)(λ − 2). That is zero if λ = −1 or λ = 2, as the= −1 and 2.There are two eigenvalues, because a quadratic has two roots. Every 2 by 2 matrixA−λI has λ 2 (and no higher power of λ) in its determinant.The values λ = −1 and λ = 2 lead to a solution of Ax = λx or (A−λI)x = 0. A matrixwith zero determinant is singular, so there must be nonzero vectors x in its nullspace. Infact the nullspace contains a whole line of eigenvectors; it is a subspace!λ1 = −1 :The solution (the ﬁrst eigenvector) is any nonzero multiple of x1:The computation for λ2 is done separately:λ2 = 2 :The second eigenvector is any nonzero multiple of x2:You might notice that the columns of A − λ1I give x2, and the columns of A − λ2I aremultiples of x1. This is special (and useful) for 2 by 2 matrices.In the 3 by 3 case, I often set a component of x equal to 1 and solve (A−λI)x = 0 forthe other components. Of course if x is an eigenvector then so is 7x and so is −x. Allvectors in the nullspace of A−λI (which we call the eigenspace) will satisfy Ax = λx.In our example the eigenspaces are the lines through x1 = (1,1) and x2 = (5,2).Before going back to the application (the differential equation), we emphasize thesteps in solving Ax = λx:1. Compute the determinant of A − λI. With λ subtracted along the diagonal, thisdeterminant is a polynomial of degree n. It starts with (−λ)n.2. Find the roots of this polynomial. The n roots are the eigenvalues of A.3. For each eigenvalue solve the equation (A − λI)x = 0. Since the determinant iszero, there are solutions other than x = 0. Those are the eigenvectors.",eigenvec_val
"7.2 Matrix Norm and Condition Numberstanding successes of numerical analysis. It is clearly deﬁned, its importance is obvious,but until recently no one knew how to solve it. Dozens of algorithms have been sug-gested, and everything depends on the size and the properties of A (and on the numberof eigenvalues that are wanted). You can ask LAPACK for an eigenvalue subroutine,without knowing its contents, but it is better to know. We have chosen two or three ideasthat have superseded almost all of their predecessors: the QR algorithm, the family of“power methods,” and the preprocessing of a symmetric matrix to make it tridiagonal.The ﬁrst two methods are iterative, and the last is direct. It does its job in a ﬁnitenumber of steps, but it does not end up with the eigenvalues themselves. This producesa much simpler matrix to use in the iterative steps.3. The Condition Number of a Matrix.Section 7.2 attempts to measure the“sensitivity” of a problem: If A and b are slightly changed, how great is the effect onx = A−1b? Before starting on that question, we need a way to measure A and the change∆A. The length of a vector is already deﬁned, and now we need the norm of a matrix.Then the condition number, and the sensitivity of A will follow from multiplying thenorms of A and A−1. The matrices in this chapter are square.Matrix Norm and Condition NumberAn error and a blunder are very different things. An error is a small mistake, probablyunavoidable even by a perfect mathematician or a perfect computer. A blunder is muchmore serious, and larger by at least an order of magnitude. When the computer roundsoft a number after 16 bits, that is an error, But when a problem is so excruciatinglysensitive that this roundoff error completely changes the solution, then almost certainlysomeone has committed a blunder. Our goal in this section is to analyze the effect oferrors, so that blunders can be avoided.We are actually continuing a discussion that began in Chapter 1 withWe claimed that B is well-conditioned, and not particularly sensitive to roundoff—exceptthat if Gaussian elimination is applied in a stupid way, the matrix becomes completelyvulnerable. It is a blunder to accept .0001 as the ﬁrst pivot, and we must insist on a largerand safer choice by exchanging the rows of B. When “partial pivoting” is built into theelimination algorithm, the computer automatically looks for the largest pivot. Then thenatural resistance to roundoff error is no longer compromised.How do we measure this natural resistance, and decide whether a matrix is well-conditioned or ill-conditioned? If there is a small change in b or in A, how large achange does that produce in the solution x?",computations
"6.2 Tests for Positive DeﬁnitenessEven though it is the hardest to apply to a single matrix, eigenvalues can be the mostuseful test for theoretical purposes. Each test is enough by itself.Positive Deﬁnite Matrices and Least SquaresI hope you will allow one more test for positive deﬁniteness. It is already close. Weconnected positive deﬁnite matrices to pivots (Chapter 1), determinants (Chapter 4), andeigenvalues (Chapter 5). Now we see them in the least-squares problems in Chapter 3,coming from the rectangular matrices of Chapter 2.The rectangular matrix will be R and the least-squares problem will be Rx = b. It hasm equations with m ≥ n (square systems are included). The least-square choice �x is thesolution of RTR�x = RTb. That matrix ARTR is not only symmetric but positive deﬁnite,as we now show—provided that the n columns of R are linearly independent:The symmetric matrix A is positive deﬁnite if and only if(V) There is a matrix R with independent columns such that A = RTR.The key is to recognize xTAx as xTRTRx = (Rx)T(Rx). This squared length ∥Rx∥2 ispositive (unless x = 0), because R has independent columns. (If x is nonzero then Rx isnonzero.) Thus xTRTRx > 0 and RTR is positive deﬁnite.It remains to ﬁnd an R For which A = RTR. We have almost done this twice already:A = LDLT = (LSo take R =This Cholesky decomposition has the pivots split evenly between L and LT.A = QΛQT = (QSo take R =A third possibility is R = QΛQT, the symmetric positive deﬁnite square root of A.There are many other choices, square or rectangular, and we can see why. If you multiplyany R by a matrix Q with orthonormal columns, then (QR)T(QR) = RTQTQR = RTIR =A. Therefore QR is another choice.Applications of positive deﬁnite matrices are developed in my earlier book Intro-duction to Applied Mathematics and also the new Applied Mathematics and ScientiﬁcComputing (see www.wellesleycambridge.com). We mention that Ax = λMxarises constantly in engineering analysis. If A and M are positive deﬁnite, this general-ized problem is parallel to the familiar Ax = λx, and λ > 0. M is a mass matrix for theﬁnite element method in Section 6.4.The tests for semideﬁniteness will relax xTAx > 0, λ > 0, d > 0, and det > 0, to allowzeros to appear. The main point is to see the analogies with the positive deﬁnite case.",pos_def_matrices
"Chapter 2 Vector Spaces27. If A is any 8 by 8 invertible matrix, then its column space is28. True or false (with a counterexample if false)?(a) The vectors b that are not in the column space C(A) form a subspace.(b) If C(A) contains only the zero vector, then A is the zero matrix.(c) The column space of 2A equals the column space of A.(d) The column space of A−I equals the column space of A.29. Construct a 3 by 3 matrix whose column space contains (1,1,0) and (1,0,1) but not(1,1,1). Construct a 3 by 3 matrix whose column space is only a line.30. If the 9 by 12 system Ax = b is solvable for every b, then C(A) =31. Why isn’t R2 a subspace of R3?Solving Ax = 0 and Ax = bChapter 1 concentrated on square invertible matrices. There was one solution to Ax = band it was x = −A−1b. That solution was found by elimination (not by computing A−1).A rectangular matrix brings new possibilities—U may not have a full set of pivots. Thissection goes onward from U to a reduced form R—the simplest matrix that elimina-tion can give. R reveals all solutions immediately.For an invertible matrix, the nullspace contains only x = 0 (multiply Ax = 0 by A−1).The column space is the whole space (Ax = b has a solution for every b). The new ques-tions appear when the nullspace contains more than the zero vector and/or the columnspace contains less than all vectors:1. Any vector xn in the nullspace can be added to a particular solution xp. The solutionsto all linear equations have this form, x = xp +xn:A(xp +xn) = b.2. When the column space doesn’t contain every b in Rm, we need the conditions onb that make Ax = b solvable.A 3 by 4 example will be a good size. We will write down all solutions to Ax = 0. Wewill ﬁnd the conditions for b to lie in the column space (so that Ax = b is solvable). The1 by 1 system 0x = b, one equation and one unknown, shows two possibilities:0x = b has no solution unless b = 0. The column space of the 1 by 1 zeromatrix contains only b = 0.0x = 0 has inﬁnitely many solutions. The nullspace contains all x. A particularsolution is xp = 0, and the complete solution is x = xp +xn = 0+(any x).",vector spaces
"3.5 The Fast Fourier Transform(a) Using those multipliers in A, show that column 1 of A and B = column 2 −2(column 1) and C = column 3− 23(column 2) are orthogonal.(b) Check that ∥column 1∥2 = 2, ∥B∥2 = 32, and ∥C∥2 = 43, using the pivots.31. True or false (give an example in either case):(a) Q−1 is an orthogonal matrix when Q is an orthogonal matrix.(b) If Q (3 by 2) has orthonormal columns then ∥Qx∥ always equals ∥x∥.32. (a) Find a basis for the subspace S in R4 spanned by all solutions ofx1 +x2 +x3 −x4 = 0.(b) Find a basis for the orthogonal complement S⊥.(c) Find b1 in S and b2 in S⊥ so that b1 +b2 = b = (1,1,1,1).The Fast Fourier TransformThe Fourier series is linear algebra in inﬁnite dimensions. The “vectors” are functionsf(x); they are projected onto the sines and cosines; that produces the Fourier coefﬁcientsak and bk. From this inﬁnite sequence of sines and cosines, multiplied by ak and bk, wecan reconstruct f(x). That is the classical case, which Fourier dreamt about, but in actualcalculations it is the discrete Fourier transform that we compute. Fourier still lives, butThis is pure linear algebra, based on orthogonality. The input is a sequence of num-bers y0,...,yn−1, instead of a function f(x). The output c0,...,cn−1 has the same lengthn. The relation between y and c is linear, so it must be given by a matrix. This is theFourier matrix F, and the whole technology of digital signal processing depends on it.The Fourier matrix has remarkable properties.Signals are digitized, whether they come from speech or images or sonar or TV (oreven oil exploration). The signals are transformed by the matrix F, and later they can betransformed back—to reconstruct. What is crucially important is that F and F−1 can beF−1 must be simple. The multiplications by F and F−1 must be fast.Those are both true. F−1 has been known for years, and it looks just like F. In fact,F is symmetric and orthogonal (apart from a factor √n), and it has only one drawback:Its entries are complex numbers. That is a small price to pay, and we pay it below. Thedifﬁculties are minimized by the fact that all entries of F and F−1 tare powers of a singlenumber w. That number has wn = 1.",orthogonality
"4.3 Formulas for the Determinant9. How many multiplications to ﬁnd an n by n determinant from(a) the big formula (6)?(b) the cofactor formula (10), building from the count for n−1?(c) the product of pivots formula (including the elimination steps)?10. In a 5 by 5 matrix, does a + sign or − sign go with a15a24a33a42a51 down the reversediagonal? In other words, is P = (5,4,3,2,1) even or odd? The checkerboard patternof ± signs for cofactors does not give detP.11. If A is m by n and B is n by m, explain whyDo an example with m < n and an example with m > n. Why does your secondexample automatically have detAB = 0?12. Suppose the matrix A is ﬁxed, except that a11 varies from −∞ to +∞. Give examplesin which detA is always zero or never zero. Then show from the cofactor expansion(8) that otherwise detA = 0 for exactly one value of a11.Problems 13–23 use the big formula with n! terms: |A| = ∑±a1αa2β ···anv.13. Compute the determinants of A, B, C from six terms. Independent rows?14. Compute the determinants of A, B, C. Are their columns independent?15. Show that detA = 0, regardless of the ﬁve nonzeros marked by x’s:(What is the rank of A?)16. This problem shows in two ways that detA = 0 (the x’s are any numbers):0 0 0 x x0 0 0 x x0 0 0 x x5 by 5 matrix3 by 3 zero matrix",determinants
"26. Project a1 = (1,0) onto a2 = (1,2). Then project the result back onto a1. Draw theseprojections and multiply the projection matrices P1P2: Is this a projection?Projections and Least SquaresUp to this point, Ax = b either has a solution or not. If b is not in the column space C(A),the system is inconsistent and Gaussian elimination fails. This failure is almost certainwhen there are several equations and only one unknown:This is solvable when b1, b2, b3 are in the ratio 2:3:4. The solution x will exist only if bis on the same line as the column a = (2,3,4).In spite of their unsolvability, inconsistent equations arise all the time in practice.They have to be solved! One possibility is to determine x from part of the system, andignore the rest; this is hard to justify if all m equations come from the same source.Rather than expecting no error in some equations and large errors in the others, it ismuch better to choose the x that minimizes an average error E in the m equations.The most convenient “average” comes from the sum of squares:E2 = (2x−b1)2 +(3x−b2)2 +(4x−b3)2.If there is an exact solution, the minimum error is E = 0. In the more likely case that bis not proportional to a, the graph of E2 will be a parabola. The minimum error is at thelowest point, where the derivative is zero:Solving for x, the least-squares solution of this model system ax = b is denoted by �x:�x = 2b1 +3b2 +4b3You recognize aTb in the numerator and aTa in the denominator.The general case is the same. We “solve” ax = b by minimizingE2 = ∥ax−b∥2 = (a1x−b1)2 +···+(amx−bm)2.The derivative of E2 is zero at the point �x, if(a1�x−b1)a1 +···+(am�x−bm)am = 0.We are minimizing the distance from b to the line through a, and calculus gives the sameanswer, �x = (a1b1 +···+ambm)/(a2m), that geometry did earlier:",orthogonality
"Example 5. Gram-Schmidt Suppose the independent vectors are a, b, c:To ﬁnd q1, make the ﬁrst vector into a unit vector: q1 = a/2. To ﬁnd q2, subtract fromthe second vector its component in the ﬁrst direction:The normalized q2 is B divided by its length, to produce a unit vector:To ﬁnd q3, subtract from c its components along q1 and q2:This is already a unit vector, so it is q3. I went to desperate lengths to cut down the num-ber of square roots (the painful part of Gram-Schmidt). The result is a set of orthonormalvectors q1, q2, q3, which go into the columns of an orthogonal matrix Q:3T The Gram-Schmidt process starts with independent vectors a1,...,an andends with orthonormal vectors q1,...,qn. At step j it subtracts from a j itscomponents in the directions q1,...,q j−1 that are already settled:A j = a j −(qTThen q j is the unit vector A j/∥Aj∥.Remark on the calculations I think it is easier to compute the orthogonal a, B, C,without forcing their lengths to equal one. Then square roots enter only at the end, when",orthogonality
"Chapter 5 Eigenvalues and Eigenvectors26. The solution to y′′ = 0 is a straight line y = C +Dt. Convert to a matrix equation:This matrix A cannot be diagonalized. Find A2 and compute eAt = I +At + 1···. Multiply your eAt times (y(0),y′(0)) to check the straight line y(t) = y(0) +27. Substitute y = eλt into y′′ = 6y′ − 9y to show that λ = 3 is a repeated root. This istrouble; we need a second solution after e3t. The matrix equation isShow that this matrix has λ = 3,3 and only one line of eigenvectors. Trouble heretoo. Show that the second solution is y = te3t.28. Figure out how to write my′′ +by′ +ky = 0 as a vector equation Mu′ = Au.29. (a) Find two familiar functions that solve the equation d2y/dt2 = −y. Which onestarts with y(0) = 1 and y′(0) = 0?(b) This second-order equation y′′ = −y produces a vector equation u′ = Au:Put y(t) from part (a) into u(t) = (y,y′). This solves Problem 6 again.30. A particular solution to du/dt = Au−b is up = A−1b, if A is invertible. The solutionsto du/dt = Au give un. Find the complete solution up +un to31. If c is not an eigenvalue of A, substitute u = ectv and ﬁnd v to solve du/dt = Au −ectb. This u = ectv is a particular solution. How does it break down when c is an32. Find a matrix A to illustrate each of the unstable regions in Figure 5.2:(a) λ1 < 0 and λ2 > 0.(b) λ1 > 0 and λ2 > 0.(c) Complex λ’s with real part a > 0.Problems 33–41 are about the matrix exponential eAt.",eigenvec_val
"of one row from another. Such a transformation preserved the nullspace and row spaceof A; it normally changes the eigenvalues.Eigenvalues are actually calculated by a sequence of simple similarities. The matrixgoes gradually toward a triangular form, and the eigenvalues gradually appear on themain diagonal. (Such a sequence is described in Chapter 7.) This is much better thantrying to compute det(A−λI), whose roots should be the eigenvalues. For a large matrix,it is numerically impossible to concentrate all that information into the polynomial andthen get it out again.Triangular Forms with a Unitary MOur ﬁrst move beyond the eigenvector matrix M = S is a little bit crazy: Instead of amore general M, we go the other way and restrict M to be unitary. M−1AM can achievea triangular form T under this restriction. The columns of M = U are orthonormal (inthe real case, we would write M = Q). Unless the eigenvectors of Λ are orthogonal, adiagonal U−1AU is impossible. But “Schur’s lemma” in 5R is very useful—at least tothe theory. (The rest of this chapter is devoted more to theory than to applications. TheJordan form is independent of this triangular form.)There is a unitary matrix M = U such that U−1AU = T is triangular.The eigenvalues of A appear along the diagonal of this similar matrix T.Proof. Every matrix, say 4 by 4, has at least one eigenvalue λ1. In the worst case, itcould be repeated four times. Therefore A has at least one unit eigenvector x1, which weplace in the ﬁrst column of U. At this stage the other three columns are impossible todetermine, so we complete the matrix in any way that leaves it unitary, and call it U1.(The Gram-Schmidt process guarantees that this can be done.) Ax1 = λ1x1 column 1means that the product U−11 AU1 starts in the right form:Now work with the 3 by 3 submatrix in the lower right-hand corner. It has a uniteigenvector x2, which becomes the ﬁrst column of a unitary matrix M2:",eigenvec_val
"1.4 Matrix Notation and Matrix MultiplicationExample 3. The 1s in the identity matrix I leave every matrix unchanged:Important: The multiplication AB can also be done a row at a time. In Example 1, theﬁrst row of AB uses the numbers 2 and 3 from the ﬁrst row of A. Those numbers give2[row 1] + 3[row 2] = [17 1 0]. Exactly as in elimination, where all this started, eachrow of AB is a combination of the rows of B.We summarize these three different ways to look at matrix multiplication.(i) Each entry of AB is the product of a row and a column:(AB)ij = (row i of A) times (column j of B)(ii) Each column of AB is the product of a matrix and a column:column j of AB = A times (column j of B)(iii) Each row of AB is the product of a row and a matrix:row i of AB = (row i of A) times B.This leads hack to a key property of matrix multiplication. Suppose the shapes ofthree matrices A, B, C (possibly rectangular) permit them to be multiplied. The rows inA and B multiply the columns in B and C. Then the key property is this:Matrix multiplication is associative: (AB)C = A(BC). Just write ABC.AB times C equals A times BC. If C happens to be just a vector (a matrix with only onecolumn) this is the requirement (EA)x = E(Ax) mentioned earlier. It is the whole basisfor the laws of matrix multiplication. And if C has several columns, we have only tothink of them placed side by side, and apply the same rule several times. Parenthesesare not needed when we multiply several matrices.There are two more properties to mention—one property that matrix multiplicationhas, and another which it does not have. The property that it does possess is:Matrix operations are distributive:",gauss elim
"Chapter 1 Matrices and Gaussian Elimination(c) P exchanges rows 1 and 2, then rows 2 and 3.23. In Problem 22, applying E21 and then E32 to the column b = (1,0,0) gives E32E21b =. Applying E32 before E21 gives E21E32b =. When E32 comes ﬁrst, rowfeels no effect from row24. Which three matrices E21, E31, E32 put A into triangular form U?Multiply those E’s to get one matrix M that does elimination: MA = U.25. Suppose a33 = 7 and the third pivot is 5. If you change a33 to 11, the third pivot is. If you change a33 to, there is zero in the pivot position.26. If every column of A is a multiple of (1,1,1), then Ax is always a multiple of (1,1,1).Do a 3 by 3 example. How many pivots are produced by elimination?27. What matrix E31 subtracts 7 times row 1 from row 3? To reverse that step, R31 should. Multiply E31 by R31.28. (a) E21 subtracts row 1 from row 2 and then P23 exchanges rows 2 and 3. Whatmatrix M = P23E21 does both steps at once?(b) P23 exchanges rows 2 and 3 and then E31 subtracts row I from row 3. Whatmatrix M = E31P23 does both steps at once? Explain why the M’s are the samebut the E’s are different.29. (a) What 3 by 3 matrix E13 will add row 3 to row 1?(b) What matrix adds row 1 to row 3 and at the same time adds row 3 to row 1?(c) What matrix adds row 1 to row 3 and then adds row 3 to row 1?30. Multiply these matrices:31. This 4 by 4 matrix needs which elimination matrices E21 and E32 and E43?Problems 32–44 are about creating and multiplying matrices",gauss elim
"Chapter 5 Eigenvalues and Eigenvectors28. Solve u′ = Ju by back-substitution, solving ﬁrst for u2(t):dt = Ju =Notice te5t in the ﬁrst component u1(t).29. Compute A10 and eA if A = MJM−1:30. Show that A and B are similar by ﬁnding M so that B = M−1AM:31. Which of these matrices A1 to A6 are similar? Check their eigenvalues.32. There are sixteen 2 by 2 matrices whose entries are 0s and 1s. Similar matrices gointo the same family. How many families? How many matrices (total 16) in each33. (a) If x is in the nullspace of A, show that M−1x is in the nullspace of M−1AM.(b) The nullspaces of A and M−1AM have the same (vectors)(basis)(dimension).34. If A and B have the exactly the same eigenvalues and eigenvectors, does A = B? Withn independent eigenvectors, we do have A = B. Find A ̸= B when λ = 0,0 (repeated),but there is only one line of eigenvectors (x1,0).Problems 35–39 are about the Jordan form.35. By direct multiplication, ﬁnd J2 and J3 whenGuess the form of Jk. Set k = 0 to ﬁnd J0. Set k = −1 to ﬁnd J−1.",eigenvec_val
"2.3 Linear Independence, Basis, and Dimensiondimensions we need three vectors, along the x-y-z axes or in three other (linearly in-dependent!) directions. The dimension of the space Rn is n. The column space of Uin Example 9 had dimension 2; it was a “two-dimensional subspace of R3.” The zeromatrix is rather exceptional, because its column space contains only the zero vector. Byconvention, the empty set is a basis for that space, and its dimension is zero.Here is our ﬁrst big theorem in linear algebra:2K If v1,...,vm and w1,...,wn are both bases for the same vector space, thenm = n. The number of vectors is the same.Proof. Suppose there are more w’s than v’s (n > m). We will arrive at a contradiction.Since the v’s form a basis, they must span the space. Every w j can be written as acombination of the v’s: If w1 = a11v1 + ··· + am1vm, this is the ﬁrst column of a matrixWe don’t know each ai j, but we know the shape of A (it is m by n). The second vectorw2 is also a combination of the v’s. The coefﬁcients in that combination ﬁll the secondcolumn of A. The key is that A has a row for every v and a column for every w. A is ashort, wide matrix, since n > m. There is a nonzero solution to Ax = 0. Then VAx = 0which is Wx = 0. A combination of the w’s gives zero! The w’s could not be a basis—sowe cannot have n > m.If m > n we exchange the v’s and w’s and repeat the same steps. The only way toavoid a contradiction is to have m = n. This completes the proof that m = n. To repeat:The dimension of a space is the number of vectors in every basis.This proof was used earlier to show that every set of m+1 vectors in Rm must be de-pendent. The v’s and w’s need not be column vectors—the proof was all about the matrixA of coefﬁcients. In fact we can see this general result: In a subspace of dimension k,no set of more than k vectors can be independent, and no set of more than k vectors can.There are other “dual” theorems, of which we mention only one. We can start with aset of vectors that is too small or too big, and end up with a basis:Any linearly independent set in V can be extended to a basis, by addingmore vectors if necessary.Any spanning set in V can be reduced to a basis, by discarding vectors ifThe point is that a basis is a maximal independent set. It cannot be made larger withoutlosing independence. A basis is also a minimal spanning set. It cannot be made smallerand still span the space.",vector spaces
"2.1 Vector Spaces and Subspaces(c) If S and T are subspaces of R5, their intersection S ∩ T (vectors in both sub-spaces) is a subspace of R5. Check the requirements on x+y and cx.19. Suppose P is a plane through (0,0,0) and L is a line through (0,0,0). The smallestvector space containing both P and L is either20. True or false for M = all 3 by 3 matrices (check addition using an example)?(a) The skew-symmetric matrices in M (with AT = −A) form a subspace.(b) The unsymmetric matrices in M (with AT ̸= A) form a subspace.(c) The matrices that have (1,1,1) in their nullspace form a subspace.Problems 21–30 are about column spaces C(A) and the equation Ax = b.21. Describe the column spaces (lines or planes) of these particular matrices:22. For which right-hand sides (ﬁnd a condition on b1, b2, b3) are these systems solvable?23. Adding row 1 of A to row 2 produces B. Adding column 1 to column 2 produces C.A combination of the columns ofis also a combination of the columns of A.Which two matrices have the same column24. For which vectors (b1,b2,b3) do these systems have a solution?25. (Recommended) If we add an extra column b to a matrix A, then the column space. Give an example in which the column space gets larger andan example in which it doesn’t. Why is Ax = b solvable exactly when the columnspace doesn’t get larger by including b?26. The columns of AB are combinations of the columns of A. This means: The columnspace of AB is contained in (possibly equal to) the column space of A. Give anexample where the column spaces of A and AB are not equal.",vector spaces
"Chapter 8 Linear Programming and Game TheorySuppose we have four women and four men. Some of those sixteen couples are compat-ible, others regrettably are not. When is it possible to ﬁnd a complete matching, witheveryone married? If linear algebra can work in 20-dimensional space, it can certainlyhandle the trivial problem of marriage.There are two ways to present the problem—in a matrix or on a graph. The matrixcontains aij = 0 if the ith woman and jth man are not compatible, and aij = 1 if they arewilling to try. Thus row i gives the choices of the ith woman, and column j correspondsto the jth man:1 0 0 01 1 1 00 0 0 10 0 0 1has 6 compatible pairs.The left graph in Figure 8.6 shows two possible marriages. Ignoring the source s andsink t, it has four women on the left and four men on the right. The edges correspondto the 1s in the matrix, and the capacities are 1 marriage. There is no edge between theﬁrst woman and fourth man, because the matrix has a14 = 0.Figure 8.6: Two marriages on the left, three (maximum) on the right. The third is created by adding two newmarriages and one divorce (backward ﬂow).It might seem that node M2 can’t be reached by more ﬂow—but that is not so! Theextra ﬂow on the right goes backward to cancel an existing marriage. This extra ﬂowmakes 3 marriages, which is maximal. The minimal cut is crossed by 3 edges.A complete matching (if it is possible) is a set of four is in the matrix. They wouldcome from four different rows and four different columns, since bigamy is not allowed.It is like ﬁnding a permutation matrix within the nonzero entries of A. On the graph, thismeans four edges with no nodes in common. The maximal ﬂow is less than 4 exactlywhen a complete matching is impossible.In our example the maximal ﬂow is 3, not 4. The marriages 1–1, 2–2, 4–4 are allowed",linear_prog
"4.4 Applications of DeterminantsThese determinants give the volumes—or areas, since we are in two dimensions—drawnin Figure 4.3. The parallelogram has unit base and unit height; its area is also 1.row 1 = (1, 0)row 2 = (0, 1)row 1 = (1, 0)row 2 = (c, 1)Figure 4.3: The areas of a unit square and a unit parallelogram are both 1.4. A Formula for the Pivots.We can ﬁnally discover when elimination is possiblewithout row exchanges. The key observation is that the ﬁrst k pivots are completelydetermined by the submatrix Ak in the upper left corner of A. The remaining rows andcolumns of A have no effect on this corner of the problem:(ad− bc)/a (af −ec)/aCertainly the ﬁrst pivot depended only on the ﬁrst row and column, The second pivot(ad −bc)/a depends only on the 2 by 2 corner submatrix A2. The rest of A does not enteruntil the third pivot. Actually it is not just the pivots, but the entire upper-left corners ofL, D, and U, that are determined by the upper-left corner of A:A = LDU =What we see in the ﬁrst two rows and columns is exactly the factorization of the cornersubmatrix A2. This is a general rule if there are no row exchanges:4D If A is factored into LDU, the upper left corners satisfy Ak = LkDkUk. Forevery k, the submatrix Ak is going through a Gaussian elimination of its own.The proof is to see that this corner can be settled ﬁrst, before even looking at othereliminations. Or use the laws for block multiplication:Comparing the last matrix with A, the corner LkDkUk coincides with Ak. Then:detAk = detLk detDk detUk = detDk = d1d2···dk.",determinants
"Chapter 2 Vector Spacesand only a few hundred unknowns. The equations xh − xv = bi go into a linear systemAx = b, in which A is an incidence matrix. Every game has a row, with +1 in column hand −1 in column v—to indicate which teams are in that game.First difﬁculty: If b is not in the column space there is no solution. The scores mustﬁt perfectly or exact potentials cannot be found. Second difﬁculty: If A has nonzerovectors in its nullspace, the potentials x are not well determined. In the ﬁrst case x doesnot exist; in the second case x is not unique. Probably both difﬁculties are present.The nullspace always contains the vector of 1s, since A looks only at the differencesxh −xv. To determine the potentials we can arbitrarily assign zero potential to Harvard.(I am speaking mathematically, not meanly.) But if the graph is not connected, everyseparate piece of the graph contributes a vector to the nullspace. There is even the vectorwith xMIT = 1 and all other x j = 0. We have to ground not only Harvard but one teamin each piece. (There is nothing unfair in assigning zero potential; if all other potentialsare below zero then the grounded team ranks ﬁrst.) The dimension of the nullspace isthe number of pieces of the graph—and there will be no way to rank one piece againstanother, since they play no games.The column space looks harder to describe. Which scores ﬁt perfectly with a set ofpotentials? Certainly Ax = b is unsolvable if Harvard beats Yale, Yale beats Princeton,and Princeton beats Harvard. More than that, the score differences in that loop of gameshave to add to zero:Kirchhoff’s law for score differencesbHY +bYP +bPH = 0.This is also a law of linear algebra. Ax = b can be solved when b satisﬁes the same lineardependencies as the rows of A. Then elimination leads to 0 = 0.In reality, b is almost certainly not in the column space. Football scores are not thatconsistent. To obtain a ranking we can use least squares: Make Ax as close as possibleto b. That is in Chapter 3, and we mention only one adjustment. The winner gets a bonusof 50 or even 100 points on top of the score difference. Otherwise winning by 1 is tooclose to losing by 1. This brings the computed rankings very close to the polls, and Dr.Leake (Notre Dame) gave a full analysis in Management Science in Sports (1976).After writing that subsection, I found the following in the New York Times:In its ﬁnal rankings for 1985, the computer placed Miami (10-2) in the sev-enth spot above Tennessee (9-1-2). A few days after publication, packagescontaining oranges and angry letters from disgruntled Tennessee fans beganarriving at the Times sports department. The irritation stems from the fact thatTennessee thumped Miami 35-7 in the Sugar Bowl. Final AP and UPI pollsranked Tennessee fourth, with Miami signiﬁcantly lower.Yesterday morning nine cartons of oranges arrived at the loading dock. Theywere sent to Bellevue Hospital with a warning that the quality and contents ofthe oranges were uncertain.",vector spaces
"1.6 Inverses and TransposesStrictly speaking, we have to show that the matrix A−1 with those columns is alsoa left-inverse. Solving AA−1 = I has at the same time solved A−1A = I, but why? A1-sided inverse of a square matrix is automatically a 2-sided inverse. To see why,notice that every Gauss-Jordan step is a multiplication on the left by an elementarymatrix. We are allowing three types of elementary matrices:1. Eij to subtract a multiple ℓ of row j from row i2. Pij to exchange rows i and j3. D (or D−1) to divide all rows by their pivots.The Gauss-Jordan process is really a giant sequence of matrix multiplications:(D−1···E ···P···E)A = I.That matrix in parentheses, to the left of A, is evidently a left-inverse! It exists, it equalsthe right-inverse by Note 2, so every nonsingular matrix is invertible.The converse is also true: If A is invertible, it has n pivots. In an extreme case thatis clear: A cannot have a whole column of zeros. The inverse could never multiply acolumn of zeros to produce a column of I. In a less extreme case, suppose eliminationstarts on an invertible matrix A but breaks down at column 3:No pivot in column 3This matrix cannot have an inverse, no matter what the x’s are. One proof is to usecolumn operations (for the ﬁrst time?) to make the whole third column zero. By sub-tracting multiples of column 2 and then of column 1, we reach a matrix that is certainlynot invertible. Therefore the original A was not invertible. Elimination gives a completetest: An n by n matrix is invertible if and only if it has n pivots.We need one more matrix, and fortunately it is much simpler than the inverse. Thetranspose of A is denoted by AT. Its columns are taken directly from the rows of A—theith row of A becomes the ith column of AT:At the same time the columns of A become the rows of AT, If A is an m by n matrix, thenAT is n by m. The ﬁnal effect is to ﬂip the matrix across its main diagonal, and the entry",gauss elim
"Chapter 2 Vector Spacesthe data. These matrix equations and the corresponding differential equations are in ourtextbook Introduction to Applied Mathematics, and the new Applied Mathematics andScientiﬁc Computing. (See www.wellesleycambridge.com.)We end this chapter at that high point—the formulation of a fundamental problem inapplied mathematics. Often that requires more insight than the solution of the problem.We solved linear equations in Chapter 1, as the ﬁrst step in linear algebra. To set up theequations has required the deeper insight of Chapter 2. The contribution of mathematics,and of people, is not computation but intelligence.1. For the 3-node triangular graph in the ﬁgure following, write the 3 by 3 incidencematrix A. Find a solution to Ax = 0 and describe all other vectors in the nullspace ofA. Find a solution to ATy = 0 and describe all other vectors in the left nullspace of2. For the same 3 by 3 matrix, show directly from the columns that every vector b inthe column space will satisfy b1 +b2 −b3 = 0. Derive the same thing from the threerows—the equations in the system Ax = b. What does that mean about potentialdifferences around a loop?3. Show directly from the rows that every vector f in the row space will satisfy f1 +f2 + f3 = 0. Derive the same thing from the three equations ATy = f. What does thatmean when the f’s are currents into the nodes?4. Compute the 3 by 3 matrix ATA, and show that it is symmetric but singular—whatvectors are in its nullspace? Removing the last column of A (and last row of AT)leaves the 2 by 2 matrix in the upper left corner; show that it is not singular.5. Put the diagonal matrix C with entries c1, c2, c3 in the middle and compute ATCA.Show again that the 2 by 2 matrix in the upper left corner is invertible.6. Write the 6 by 4 incidence matrix A for the second graph in the ﬁgure. The vector(1,1,1,1) is in the nullspace of A, but now there will be m−n+1 = 3 independentvectors that satisfy ATy = 0. Find three vectors y and connect them to the loops in",vector spaces
"1.4 Matrix Notation and Matrix Multiplication15. Suppose A commutes with every 2 by 2 matrix (AB = BA), and in particularcommutes with B1 =Show that a = d and b = c = 0. If AB = BA for all matrices B, then A is a multiple16. Let x be the column vector (1,0,...,0). Show that the rule (AB)x = A(Bx) forces theﬁrst column of AB to equal A times the ﬁrst column of B.17. Which of the following matrices are guaranteed to equal (A+B)2?18. If A and B are n by n matrices with all entries equal to 1, ﬁnd (AB)ij. Summationnotation turns the product AB, and the law (AB)C = A(BC), intoc jl = ∑Compute both sides if C is also n by n, with every c jl = 2.19. A fourth way to multiply matrices is columns of A times rows of B:AB = (column 1)(row 1)+···+(column n)(row n) = sum of simple matrices.Give a 2 by 2 example of this important rule for matrix multiplication.20. The matrix that rotates the x-y plane by an angle θ isVerify that A(θ1)A(θ2) = A(θ1+θ2) from the identities for cos(θ1+θ2) and sin(θ1+θ2). What is A(θ) times A(−θ)?21. Find the powers A2, A3 (A2 times A), and B2, B3, C2, C3. What are Ak, Bk, and Ck?C = AB =Problems 22–31 are about elimination matrices.22. Write down the 3 by 3 matrices that produce these elimination steps:(a) E21 subtracts 5 times row 1 from row 2.(b) E32 subtracts −7 times row 2 from row 3.",gauss elim
"Chapter 7 Computations with Matriceswhich will produce zeros as indicated along the ﬁrst row:A → H1A =∗ ∗ ∗ ∗0 ∗ ∗ ∗0 ∗ ∗ ∗�� → H1AH(1) =∗ ∗ 0 00 ∗ ∗ ∗0 ∗ ∗ ∗Then two ﬁnal Householder transformations quickly achieve the bidiagonal form:∗ ∗ 0 00 ∗ ∗ ∗0 0 ∗ ∗∗ ∗ 0 00 ∗ ∗ 00 0 ∗ ∗The QR Algorithm for Computing EigenvaluesThe algorithm is almost magically simple. It starts with A0, factors it by Gram-Schmidtinto Q0R0, and then reverses the factors: A1 = R0Q0. This new matrix A1 is similar tothe original one because Q−10 A0Q0 = Q−10 (Q0R0)Q0 = A1. So the process continues withno change in the eigenvalues:All Ak are similarThis equation describes the unshifted QR algorithm, and almost always Ak approaches atriangular form, Its diagonal entries approach its eigenvalues, which are also the eigen-values of A0. If there was already some processing to obtain a tridiagonal form, then A0is connected to the absolutely original A by Q−1AQ = A0.As it stands, the QR algorithm is good but not very good. To make it special, it needstwo reﬁnements: We must allow shifts to Ak − αkI, and we must ensure that the QRfactorization at each step is very quick.1. The Shifted Algorithm.If the number αk is close to an eigenvalue, the step inequation (5) should be shifted immediately by αk (which changes Qk and Rk):Ak = αkI = QkRkAk+1 = RkQk +αkI.This matrix Ak+1 is similar to Ak (always the same eigenvalues):k AkQk = Q−1k (QkRk +αkI)Qk = Ak+1.What happens in practice is that the (n,n) entry of Ak—the one in the lower right-handcorner—is the ﬁrst to approach an eigenvalue. That entry is the simplest and most pop-ular choice for the shift αk. Normally this produces quadratic convergence, and in thesymmetric case even cubic convergence, to the smallest eigenvalue. After three or four",computations
"a + ib = reiθa − ib = a + ib = re−iθr = |a + ib|r2 = a2 + b2Figure 5.4: The complex plane, with a+ib = reiθ and its conjugate a−ib = re−iθ.Multiplying a+ib times c+id uses the rule that i2 = −1:(a+ib)(c+id) = ac+ibc+iad +i2bdThe complex conjugate of a + ib is the number a − ib. The sign of the imaginarypart is reversed. It is the mirror image across the real axis; any real number is its ownconjugate, since b = 0. The conjugate is denoted by a bar or a star: (a+ib)∗ = a+ib =a−ib. It has three important properties:1. The conjugate of a product equals the product of the conjugates:(a+ib)(c+id) = (ac−bd)−i(bc+ad) = (a+ib)(c+id).2. The conjugate of a sum equals the sum of the conjugates:(a+c)+i(b+d) = (a+c)−i(b+d) = (a+ib)+(c+id).3. Multiplying any a+ib by its conjugate a−ib produces a real number a2 +b2:(a+ib)(a−ib) = a2 +b2 = r2.This distance r is the absolute value |a+ib| =Finally, trigonometry connects the sides a and b to the hypotenuse r by a = rcosθand b = rsinθ. Combining these two equations moves us into polar coordinates:a+ib = r(cosθ +isinθ) = reiθ.",eigenvec_val
"Chapter 5 Eigenvalues and EigenvectorsProblems 34–44 are new applications of A = SΛS−1.34. Suppose that A = SΛS−1. Take determinants to prove that detA = λ1λ2···λn = prod-uct of λ’s. This quick proof only works when A is35. The trace of S times ΛS−1 equals the trace of ΛS−1 times S. So the trace of a diago-nalizable A equals the trace of Λ, which is36. If A = SΛS−1, diagonalize the block matrix B =. Find its eigenvalue and37. Consider all 4 by 4 matrices A that are diagonalized by the same ﬁxed eigenvectormatrix S. Show that the A’s form a subspace (cA and A1 + A2 have this same S).What is this subspace when S = I? What is its dimension?38. Suppose A2 = A. On the left side A multiplies each column of A. Which of our foursubspaces contains eigenvectors with λ = 1? Which subspace contains eigenvectorswith λ = 0? From the dimensions of those subspaces, A has a full set of independenteigenvectors and can be diagonalized.39. Suppose Ax = λx. If λ = 0, then x is in the nullspace. If λ ̸= 0, then x is in thecolumn space. Those spaces have dimensions (n−r)+r = n. So why doesn’t everysquare matrix have n linearly independent eigenvectors?40. Substitute A = SΛS−1 into the product (A − λ1I)(A − λ2I)···(A − λnI) and explainwhy this produces the zero matrix. We are substituting the matrix A for the numberλ in the polynomial p(λ) = det(A−λI). The Cayley-Hamilton Theorem says thatthis product is always p(A) = zero matrix, even if A is not diagonalizable.41. Test the Cayley-Hamilton Theorem on Fibonacci’s matrix A =predicts that A2 −A−I = 0, since det(A−λI) is λ 2 −λ −1.42. If A =, then det(A−λI) is (λ −a)(λ −d). Check the Cayley-Hamilton state-ment that (A−aI)(A−dI) = zero matrix.43. If A =and AB = BA, show that B =is also diagonal. B has the sameas A, but different eigen. These diagonal matrices B form a two-dimensional subspace of matrix space. AB − BA = 0 gives four equations for theunknowns a, b, c, d—ﬁnd the rank of the 4 by 4 matrix.44. If A is 5 by 5. then AB−BA = zero matrix gives 25 equations for the 25 entries in B.Show that the 25 by 25 matrix is singular by noticing a simple nonzero solution B.45. Find the eigenvalues and eigenvectors for both of these Markov matrices A and A∞.Explain why A100 is close to A∞:",eigenvec_val
"3.4 Orthogonal Bases and Gram-Schmidtvectors qi in the columns of Q have m > n components. Then Q is an m by n matrix andwe cannot expect to solve Qx = b exactly. We solve it by least squares.If there is any justice, orthonormal columns should make the problem simple. Itworked for square matrices, and now it will work for rectangular matrices. The key is tonotice that we still have QTQ = I. So QT is still the left-inverse of Q.For least squares that is all we need. The normal equations came from multiplyingAx = b by the transpose matrix, to give ATA�x = ATb. Now the normal equations areQTQ = QTb. But QTQ is the identity matrix! Therefore �x = QTb, whether Q is squareand �x is an exact solution, or Q is rectangular and we need least squares.If Q has orthonormal columns, the least-squares problem becomes easy:rectangular system with no solution for most b.rectangular system with no solution for most b.normal equation for the best �x—in which QTQ = I.the projection of b is (qTthe projection matrix is P = QQT.The last formulas are like p = A�x and P = A(ATA)−1AT. When the columns are orthonor-mal, the “cross-product matrix” ATA becomes QTQ = I. The hard part of least squaresdisappears when vectors are orthonormal. The projections onto the axes are uncoupled,and p is the sum p = (qTWe emphasize that those projections do not reconstruct b. In the square case m = n,they did. In the rectangular case m > n, they don’t. They give the projection p andnot the original vector b—which is all we can expect when there are more equationsthan unknowns, and the q’s are no longer a basis. The projection matrix is usuallyA(ATA)−1AT, and here it simpliﬁes toNotice that QTQ is the n by n identity matrix, whereas QQT is an m by m projection P.It is the identity matrix on the columns of Q (P leaves them alone), But QQT is the zeromatrix on the orthogonal complement (the nullspace of QT).Example 3. The following case is simple but typical. Suppose we project a pointb = (x,y,z) onto the x-y plane. Its projection is p = (x,y,0), and this is the sum of theseparate projections onto the x- and y-axes:",orthogonality
"2.4 The Four Fundamental SubspacesA rectangular matrix cannot have both existence and uniqueness. If m is different fromn, we cannot have r = m and r = n.A square matrix is the opposite. If m = n, we cannot have one property without theother. A square matrix has a left-inverse if and only if it has a right-inverse. There isonly one inverse, namely B = C = A−1. Existence implies uniqueness and uniquenessimplies existence, when the matrix is square. The condition for invertibility is full rank:r = m = n. Each of these conditions is a necessary and sufﬁcient test:1. The columns span Rn, so Ax = b has at least one solution for every b.2. The columns are independent, so Ax = 0 has only the solution x = 0.This list can be made much longer, especially if we look ahead to later chapters. Everycondition is equivalent to every other, and ensures that A is invertible.3. The rows of A span Rn.4. The rows are linearly independent.5. Elimination can be completed: PA = LDU, with all n pivots.6. The determinant of A is not zero.7. Zero is not an eigenvalue of A.8. ATA is positive deﬁnite.Here is a typical application to polynomials P(t) of degree n − 1. The only suchpolynomial that vanishes at t1,...,tn is P(t) ≡ 0. No other polynomial of degree n−1 canhave n roots. This is uniqueness, and it implies existence: Given any values b1,...,bn,there exists a polynomial of degree n − 1 interpolating these values: P(ti) = bi. Thepoint is that we are dealing with a square matrix; the number n of coefﬁcients in P(t) =x1 +x2t +···+xntn−1 matches the number of equations:That Vandermonde matrix is n by n and full rank. Ax = b always has a solution—apolynomial can be passed through any bi at distinct points ti. Later we shall actually ﬁndthe determinant of A; it is not zero.Matrices of Rank 1Finally comes the easiest case, when the rank is as small as possible (except for the zeromatrix with rank 0), One basic theme of mathematics is, given something complicated,",vector spaces
"Chapter 2 Vector SpacesMost sets of four vectors in R4 are independent. Those e’s might be the safest.To check any set of vectors v1,...,vn for independence, put them in the columns of A.Then solve the system Ac = 0; the vectors are dependent if there is a solution other thanc = 0. With no free variables (rank n), there is no nullspace except c = 0; the vectors areindependent. If the rank is less than n, at least one free variable can be nonzero and theOne case has special importance. Let the n vectors have m components, so that A is anm by n matrix. Suppose now that n > m. There are too many columns to be independentsThere cannot be n pivots, since there are not enough rows to hold them. The rank willbe less than n. Every system Ac = 0 with more unknowns than equations has solutionsA set of n vectors in Rm must be linearly dependent if n > m.The reader will recognize this as a disguised form of 2C: Every m by n system Ax = 0has nonzero solutions if n > m.Example 5. These three columns in R2 cannot be independent:To ﬁnd the combination of the columns producing zero we solve Ac = 0:A → U =If we give the value 1 to the free variable c3, then back-substitution in Uc = 0 givesc2 = −1, c1 = 1. With these three weights, the ﬁrst column minus the second plus thethird equals zero: Dependence.Now we deﬁne what it means for a set of vectors to span a space. The column space ofA is spanned by the columns. Their combinations produce the whole space:If a vector space V consists of all linear combinations of w1,...,wℓ, thenthese vectors span the space. Every vector v in V is some combination of theEvery v comes from w’sv = c1w1 +···+cℓwℓfor some coefﬁcients ci.It is permitted that a different combination of w’s could give the same vector v. Thec’s need not be unique, because the spanning set might be excessively large—it couldinclude the zero vector, or even all vectors.",vector spaces
"8.3 The Dual ProblemFigure 8.4: The cone of nonnegative combinations of the columns: b = Ax with x ≥ 0. When b is outside the cone,it is separated by a hyperplane (perpendicular to y).region. For n columns in Rm, the cone becomes an open-ended pyramid. Figure 8.4 hasfour vectors in R2, and A is 2 by 4. If b lies in this cone, there is a nonnegative solutionto Ax = b; otherwise not.What is the alternative if b lies outside the cone? Figure 8.4 also shows a “separatinghyperplane,” which has the vector b on one side and the whole cone on the other side.The plane consists of all vectors perpendicular to a ﬁxed vector y. The angle betweeny and b is greater than 90°, so yb < 0. The angle between y and every column of A isless than 90°, so yA ≥ 0. This is the alternative we are looking for. This theorem of theseparating hyperplane is fundamental to mathematical economics.Ax = b has a nonnegative solutionthere is a y with yA ≥ 0 andExample 1. The nonnegative combinations of the columns of A = I ﬁll the positivequadrant b ≥ 0. For every other b, the alternative must hold for some y:The x-axis, perpendicular to y = [0 1], separates b from the cone = quadrant.Here is a curious pair of alternatives. It is impossible for a subspace S and its or-thogonal complement S⊥ both to contain positive vectors. Their inner product wouldbe positive, not zero. But S might be the x-axis and S⊥ the y-axis, in which case theycontain the “semipositive” vectors [1 0] and [0 1]. This slightly weaker alternative doeswork: Either S contains a positive vector x > 0, or S⊥ contains a nonzero y ≥ 0. When Sand S⊥ are perpendicular lines in the plane, one or the other must enter the ﬁrst quadrant.I can’t see this clearly in three or four dimensions.",linear_prog
"of the columns of Q = I:That is not the only orthonormal basis! We can rotate the axes without changing theright angles at which they meet. These rotation matrices will be examples of Q.If we have a subspace of Rn, the standard vectors ei might not lie in that subspace.But the subspace always has an orthonormal basis, and it can be constructed in a simpleway out of any basis whatsoever. This construction, which converts a skewed set of axesinto a perpendicular set, is known as Gram-Schmidt orthogonalization.To summarize, the three topics basic to this section are:1. The deﬁnition and properties of orthogonal matrices Q.2. The solution of Qx = b, either n by n or rectangular (least squares).3. The Gram-Schmidt process and its interpretation as a new factorization A = QR.If Q (square or rectangular) has orthonormal columns, then QTQ = I:1 0 · 00 1 · 00 0 · 1An orthogonal matrix is a square matrix with orthonormal columns.2 ThenQT is Q−1. For square orthogonal matrices, the transpose is the inverse.When row i of QT multiplies column j of Q, the result is qTj q j = 0. On the diagonalwhere i = j, we have qTi qi = 1. That is the normalization to unit vectors of length 1.Note that QTQ = I even if Q is rectangular. But then QT is only a left-inverse.QT = Q−1 =2Orthonormal matrix would have been a better name, but it is too late to change. Also, there is no accepted wordfor a rectangular matrix with orthonormal columns. We still write Q, but we won’t call it an “orthogonal matrix”unless it is square.",orthogonality
"6.1 Minima, Maxima, and Saddle Pointssplit between the same entry b above and below. A quadratic f(x,y) comes directly froma symmetric 2 by 2 matrix!This identity (please multiply it out) is the key to the whole chapter. It generalizesimmediately to n dimensions, and it is a perfect shorthand for studying maxima andminima. When the variables are x1,...,xn, they go into a column vector x. For anysymmetric matrix A, the product xTAx is a pure quadratic form f(x1,...,xn):The diagonal entries a11 to ann multiply x2n. The pair aij = a ji combines into2aijxix j. Then f = a11x2There are no higher-order terms or lower-order terms—only second-order. The func-tion is zero at x = (0,...,0), and its ﬁrst derivatives are zero. The tangent is ﬂat; this isa stationary point. We have to decide if x = 0 is a minimum or a maximum or a saddlepoint of the function f = xTAx.Example 3. f = 2x2 +4xy+y2 and A =Example 4. f = 2xy and A =Example 5. A is 3 by 3 for 2x2�� → minimum at (0,0,0).Any function F(x1,...,xn) is approached in the same way. At a stationary pointall ﬁrst derivatives are zero. A is the “second derivative matrix” with entries aij =∂ 2F/∂xi∂x j. This automatically equals a ji = ∂ 2F/∂x j∂xi, so A is symmetric. Then Fhas a minimum when the pure quadratic xTAx is positive deﬁnite. These second-orderterms control F near the stationary point:F(x) = F(0)+xT(grad F)+ 1At a stationary point, grad F = (∂F/∂x1,...,∂F/∂xn) is a vector of zeros. The secondderivatives in xTAx take the graph up or down (or saddle). If the stationary point is at x0",pos_def_matrices
"2.5 Graphs and Networksﬁve currents. They are conditions of “conservation” at each node: Flow in equals ﬂowout at every node:y1 −y3 −y4 = 0y2 +y3 −y5 = 0y4 +y5 = 0Total current to node 1 is zeroThe beauty of network theory is that both A and AT have important roles.Solving ATy = 0 means ﬁnding a set of currents that do not “pile up” at any node. Thetrafﬁc keeps circulating, and the simplest solutions are currents around small loops.Our graph has two loops, and we send 1 amp of current around each loop:1 −1 1 0 00 0 1 −1 1Each loop produces a vector y in the left nullspace. The component +1 or −1 indicateswhether the current goes with or against the arrow. The combinations of y1 and y2 ﬁllthe left nullspace, so y1 and y2 are a basis (the dimension had to be m−r = 5−3 = 2).In fact y1 −y2 = (1,−1,0,1,−1) gives the big loop around the outside of the graph.The column space and left nullspace are closely related. The left nullspace containsy1 = (1,1,1,0,0), and the vectors in the column space satisfy b1 − b2 + b3 = 0. ThenyTb = 0: Vectors in the column space and left nullspace are perpendicular! That is soonto become Part Two of the “Fundamental Theorem of Linear Algebra.”The row space of A contains vectors in R4, but not all vectors. Itsdimension is the rank r = 3. Elimination will ﬁnd three independent rows, and we canalso look to the graph. The ﬁrst three rows are dependent (row 1 + row 3 = row 2, andthose edges form a loop). Rows 1,2,4 are independent because edges 1,2,4 contain noRows 1, 2, 4 are a basis for the row space. In each row the entries add to zero. Everycombination (f1, f2, f3, f4) in the row space will have that same property:f in row spacef1 + f2 + f3 + f4 = 0Again this illustrates the Fundamental Theorem: The row space is perpendicular to thenullspace. If f is in the row space and x is in the nullspace then f Tx = 0.For AT, the basic law of network theory is Kirchhoff’s Current Law. The total ﬂowinto every node is zero. The numbers f1, f2, f3, f4 are current sources into the nodes. Thesource f1 must balance −y1−y2, which is the ﬂow leaving node 1 (along edges 1 and 2).That is the ﬁrst equation in ATy = f. Similarly at the other three nodes—conservationof charge requires ﬂow in = ﬂow out. The beautiful thing is that AT is exactly the rightmatrix for the Current Law.The equations ATy = f at the nodes express Kirchhoff’s Current Law:",vector spaces
"−1 column for every edge:Maximize x61 subject to Ax = 0 and 0 ≤ xij ≤ cij.A ﬂow of 2 can go on the path 1-2-4-6-1. A ﬂow of 3 can go along 1-3-4-6-1. Anadditional ﬂow of 1 can take the lowest path 1-3-5-6-1. The total is 6, and no more ispossible. How do you prove that the maximal ﬂow is 6 and not 7?Trial and error is convincing, but mathematics is conclusive: The key is to ﬁnd a cut inthe network, across which all capacities are ﬁlled. That cut separates nodes 5 and 6 fromthe others. The edges that go forward across the cut have total capacity 2+3+1 = 6—and no more can get across! Weak duality says that every cut gives a bound to the totalﬂow, and full duality says that the cut of smallest capacity (the minimal cut) is ﬁlled byMax ﬂow-min cut theorem. The maximal ﬂow in a network equals thetotal capacity across the minimal cut.A “cut” splits the nodes into two groups S and T (source in S and sink in T). Its capacityis the sum of the capacities of all edges crossing the cut (from S to T). Several cutsmight have the same capacity. Certainly the total ﬂow can never be greater than the totalcapacity across the minimal cut. The problem, here and in all of duality, is to show thatequality is achieved by the right ﬂow and the right cut.Proof that max ﬂow = min cut. Suppose a ﬂow is maximal. Some nodes might still bereached from the source by additional ﬂow, without exceeding any capacities. Thosenodes go with the source into the set S. The sink must lie in the remaining set T, or itcould have received more ﬂow! Every edge across the cut must he ﬁlled, or extra ﬂowcould have gone further forward to a node in T. Thus the maximal ﬂow does ﬁll this cutto capacity. and equality has been achieved.This suggests a way to construct the maximal ﬂow: Check whether any path hasunused capacity. If so, add ﬂow along that “augmenting path.” Then compute the re-maining capacities and decide whether the sink is cut off from the source, or additionalﬂow is possible. If you label each node in S by the previous node that ﬂow could comefrom, you can backtrack to ﬁnd the path for extra ﬂow.",linear_prog
"2.5 Graphs and NetworksSo much for that application of linear algebra.Networks and Discrete Applied MathematicsA graph becomes a network when numbers c1,...,cm are assigned to the edges. Thenumber ci can be the length of edge i, or its capacity, or its stiffness (if it contains aspring), or its conductance (if it contains a resistor). Those numbers go into a diagonalmatrix C, which is m by m. C reﬂects “material properties,” in contrast to the incidencematrix A—which gives information about the connections.Our description will be in electrical terms. On edge i, the conductance is ci and theresistance is 1/ci. Ohm’s Law says that the current yi through the resistor is proportionalto the voltage drop ei:(current) = (conductance)(voltage drop).This is also written E = IR, voltage drop equals current times resistance. As a vectorequation on all edges at once, Ohm’s Law is y = Ce.We need Kirchhoff’s Voltage Law and Current Law to complete the framework:KVL: The voltage drops around each loop add to zero.KCL: The currents yi (and fi) into each node add to zero.The voltage law allows us to assign potentials x1,...,xn to the nodes. Then the dif-ferences around a loop give a sum like (x2 − x1) + (x3 − x2) + (x1 − x3) = 0, in whicheverything cancels. The current law asks us to add the currents into each node by themultiplication ATy. If there are no external sources of current, Kirchhoff’s Current Lawis ATy = 0.The other equation is Ohm’s Law, but we need to ﬁnd the voltage drop e acrossthe resistor. The multiplication Ax gave the potential difference between the nodes.Reversing the signs, −Ax gives the drop in potential. Part of that drop may be due to abattery in the edge of strength bi. The rest of the drop is e = b−Ax across the resistor:The fundamental equations of equilibrium combine Ohm and Kirchhoff into a cen-tral problem of applied mathematics. These equations appear everywhere:C−1y + Ax =That is a linear symmetric system, from which e has disappeared. The unknowns are thecurrents y and the potentials x. You see the symmetric block matrix:",vector spaces
"44. If Ax = (1,0,...,0) show how Cramer’s Rule gives x = ﬁrst column of A−1.45. (VISA to AVIS) This takes an odd number of exchanges (IVSA, AVSI, AVIS). Countthe pairs of letters in VISA and AVIS that are reversed from alphabetical order. Thedifference should be odd.4.1 Find the determinants of1 1 1 11 1 1 21 1 3 11 4 1 14.2 If B = M−1AM, why is detB = detA? Show also that detA−1B = 1.4.3 Starting with A, multiply its ﬁrst row by 3 to produce B, and subtract the ﬁrst rowof B from the second to produce C. How is detC related to detA?4.4 Solve 3u+2v = 7, 4u+3v = 11 by Cramer’s rule.4.5 If the entries of A and A−1 are all integers, how do you know that both determinantsare 1 or −1? Hint: What is detA times detA−1?4.6 Find all the cofactors, and the inverse or the nullspace, of4.7 What is the volume of the parallelepiped with four of its vertices at (0,0,0), (−1,2,2),(2,−1,2), and (2,2,−1)? Where are the other four vertices?4.8 How many terms are in the expansion of a 5 by 5 determinant, and how many aresure to be zero if a21 = 0?4.9 If P1 is an even permutation matrix and P2 is odd, deduce from P1 + P2 = P1(PT2 )P2 that det(P1 +P2) = 0.4.10 If detA > 0, show that A can be connected to I by a continuous chain of matricesA(t) all with positive determinants. (The straight path A(t) = A+t(I −A) does gofrom A(0) = A to A(1) = I, but in between A(t) might be singular. The problem isnot so easy, and solutions are welcomed by the author.)",determinants
"5.4 Differential Equations and eAt33. Write ﬁve terms of the inﬁnite series for eAt. Take the t derivative of each term. Showthat you have four terms of AeAt. Conclusion: eAtu(0) solves u′ = Au.34. The matrix B =has B2 = 0. Find eBt from a (short) inﬁnite series. Check thatthe derivative of eBt is BeBt.35. Starting from u(0), the solution at time T is eATu(0). Go an additional time t to reacheAt(eATu(0)). This solution at time t + T can also be written aseAt times eAT equals36. Write A =in the form SΛS−1. Find eAt from SeΛtS−1.37. If A2 = A, show that the inﬁnite series produces eAt = I +(et −1)A. For A =Problem 36, this gives eAt =38. Generally eAeB is different from eBeA. They are both different from eA+B. Check thisusing Problems 36–37 and 34:39. Write A =as SΛS−1. Multiply SeΛtS−1 to ﬁnd the matrix exponential eAt.Check eAt = I when t = 0.40. Put A =into the inﬁnite series to ﬁnd eAt. First compute A2:41. Give two reasons why the matrix exponential eAt is never singular:(a) Write its inverse.(b) Write its eigenvalues. If Ax = λx then eAtx =42. Find a solution x(t), y(t) of the ﬁrst system that gets large as t → ∞. To avoid thisinstability a scientist thought of exchanging the two equations!= −2x + 2yis stable. It has λ < 0. Comment on this craziness.43. From this general solution to du/dt = Au, ﬁnd the matrix A:",eigenvec_val
"Chapter 2 Vector Spaces34. Following the method of Problem 33, reduce A to echelon form and look at zerorows. The b column tells which combinations you have taken of the rows:From the b column after elimination, read off m−r basis vectors in the left nullspaceof A (combinations of rows that give zero).35. Suppose A is the sum of two matrices of rank one: A = uvT +wzT.(a) Which vectors span the column space of A?(b) Which vectors span the row space of A?(c) The rank is less than 2 if(d) Compute A and its rank if u = z = (1,0,0) and v = w = (0,0,1).36. Without multiplying matrices, ﬁnd bases for the row and column spaces of A:How do you know from these shapes that A is not invertible?37. True or false (with a reason or a counterexample)?(a) A and AT have the same number of pivots.(b) A and AT have the same left nullspace.(c) If the row space equals the column space then AT = A.(d) If AT = −A then the row space of A equals the column space.38. If AB = 0, the columns of B are in the nullspace of A. If those vectors are in Rn,prove that rank(A)+rank(B) ≤ n.39. Can tic-tac-toe be completed (5 ones and 4 zeros in A) so that rank(A) = 2 but neitherside passed up a winning move?40. Construct any 2 by 3 matrix of rank 1. Copy Figure 2.5 and put one vector in eachsubspace (two in the nullspace). Which vectors are orthogonal?41. Redraw Figure 2.5 for a 3 by 2 matrix of rank r = 2. Which subspace is Z (zerovector only)? The nullspace part of any vector x in R2 is xn =",vector spaces
"Chapter 2 Vector Spaces30. By locating the pivots, ﬁnd a basis for the column space of0 5 4 30 0 2 10 0 0 00 0 0 0Express each column that is not in the basis as a combination of the basic columns,Find also a matrix A with this echelon form U, but a different column space.31. Find a counterexample to the following statement: If v1, v2, v3, v4 is a basis for thevector space R4, and if W is a subspace, then some subset of the v’s is a basis for W.32. Find the dimensions of these vector spaces:(a) The space of all vectors in R4 whose components add to zero.(b) The nullspace of the 4 by 4 identity matrix.(c) The space of all 4 by 4 matrices.33. Suppose V is known to have dimension k. Prove that(a) any k independent vectors in V form a basis;(b) any k vectors that span V form a basis.In other words, if the number of vectors is known to be correct, either of the twoproperties of a basis implies the other.34. Prove that if V and W are three-dimensional subspaces of R5, then V and W musthave a nonzero vector in common. Hint: Start with bases for the two subspaces,making six vectors in all.35. True or false?(a) If the columns of A are linearly independent, then Ax = b has exactly one solution(b) A 5 by 7 matrix never has linearly independent columns,36. If A is a 64 by 17 matrix of rank 11, how many independent vectors satisfy Ax = 0?How many independent vectors satisfy ATy = 0?37. Find a basis for each of these subspaces of 3 by 3 matrices:(a) All diagonal matrices.(b) All symmetric matrices (AT = A).(c) All skew-symmetric matrices (AT = −A).Problems 38–42 are about spaces in which the “vectors” are functions.",vector spaces
"5.3 Difference Equations and Powers Aksum; the condition for that is λmax < 1. Add up the inﬁnite series, and conﬁrm thatit equals (IłA)−1, for the consumption matrixwhich has λmax = 0.20. For A =, ﬁnd the powers Ak (including A0) and show explicitly that their sumagrees with (I −A)−1.21. Explain by mathematics or economics why increasing the “consumption matrix” Amust increase tmax = λ1 (and slow down the expansion).22. What are the limits as k → ∞ (the steady states) of the following?Problems 23–29 are about A = SΛS−1 and Ak = SΛkS−123. Diagonalize A and compute SΛkS−1 to prove this formula for Ak:5k +1 5k −15k −1 5k +124. Diagonalize B and compute SΛkS−1 to prove this formula for Bk:25. The eigenvalues of A are 1 and 9, the eigenvalues of B are ł1 and 9:Find a matrix square root of A from R = SΛS−1, Why is there no real matrix square26. If A and B have the same λ’s with the same full set of independent eigenvectors, theirare the same. So A = B.27. Suppose A and B have the same full set of eigenvectors, so that A = SΛ1S−1 andB = SΛ2S−1. Prove that AB = BA.28. (a) When do the eigenvectors for λ = 0 span the nullspace N(A)?(b) When do all the eigenvectors for λ ̸= 0 span the column space C(A)?",eigenvec_val
"2.4 The Four Fundamental SubspacesNote that all vectors are column vectors. Even the rows are transposed, and the rowspace of A is the column space of AT, Our problem will be to connect the four spaces forU (after elimination) to the four spaces for A:1 3 3 20 0 3 30 0 0 0−1 −3 3 4For novelty, we take the four subspaces in a more interesting order.3. The row space of A For an echelon matrix like U, the row space is clear. It containsall combinations of the rows, as every row space does—but here the third row contributesnothing. The ﬁrst two rows are a basis for the row space. A similar rule applies to everyechelon matrix U or R, with r pivots and r nonzero rows: The nonzero rows are a basis,and the row space has dimension r. That makes it easy to deal with the original matrixThe row space of A has the same dimension r as the row space of U,and it has the same bases, because the row spaces of A and U (and R) are theThe reason is that each elementary operation leaves the row space unchanged. The rowsin U are combinations of the original rows in A. Therefore the row space of U containsnothing new. At the same time, because every step can be reversed, nothing is lost; therows of A can be recovered from U. It is true that A and U have different rows, but thecombinations of the rows are identical: same space!Note that we did not start with the m rows of A, which span the row space, and discardm − r of them to end up with a basis. According to 2L, we could have done so. But itmight be hard to decide which rows to keep and which to discard, so it was easier just totake the nonzero rows of U.2. The nullspace of A Elimination simpliﬁes a system of linear equations withoutchanging the solutions. The system Ax = 0 is reduced to Ux = 0, and this process isreversible. The nullspace of A is the same as the nullspace of U and R. Only r ofthe equations Ax = 0 are independent. Choosing the n−r “special solutions” to Ax = 0provides a deﬁnite basis for the nullspace:The nullspace N(A) has dimension n − r. The “special solutions” are abasis—each free variable is given the value 1, while the other free variablesare 0. Then Ax = 0 or Ux = 0 or Rx = 0 gives the pivot variables by back-This is exactly the way we have been solving Ux = 0. The basic example above haspivots in columns 1 and 3. Therefore its free variables are the second and fourth v and y.",vector spaces
"7.2 Matrix Norm and Condition NumberWhat is remarkable is that the same condition number appears in equation (9), when thematrix itself is perturbed: If Ax = b and (A+δA)(x+δx) = b, then by subtractionMultiplying by δA ampliﬁes a vector by no more than ∥δA∥, and multiplying by A−1ampliﬁes by no more than ∥A−1∥. Then ∥δx∥ < ∥A−1∥∥δA∥∥x+δx∥, which is∥x+δx∥ ≤ ∥A−1∥∥δA∥ = c∥δA∥These inequalities mean that roundoff error comes from two sources. One is thenatural sensitivity of the problem, measured by c. The other is the actual error δbor δA. This was the basis of Wilkinson’s error analysis. Since elimination actuallyproduces approximate factors L′ and U′, it solves the equation with the wrong matrixA + δA = L′U′ instead of the right matrix A = LU. He proved that partial pivotingcontrols δA—so the burden of the roundoff error is carried by the condition number c.A Formula for the NormThe norm of A measures the largest amount by which any vector (eigenvector or not)is ampliﬁed by matrix multiplication: ∥A∥ = max(∥Ax∥/∥x∥). The norm of the identitymatrix is 1. To compute the norm, square both sides to reach the symmetric ATA:∥A∥2 = max ∥Ax∥2∥x∥2 = max xTATAx7D ∥A∥ is the square root of the largest eigenvalue of ATA: ∥A∥2 = λmax(ATA).The vector that A ampliﬁes the most is the corresponding eigenvector of ATA:= λmax(ATA) = ∥A∥2.Figure 7.1 shows an unsymmetric matrix with eigenvalues λ1 = λ2 = 1 and norm∥A∥ = 1.618. In this case A−1 has the same norm. The farthest and closest points Ax onthe ellipse come from eigenvectors x of ATA, not of A.Note 1. The norm and condition number are not actually computed in practice, onlyestimated, There is not time to solve an eigenvalue problem for λmax(ATA).Note 2. In the least-squares equation ATAx = ATb, the condition number c(ATA) is thesquare of c(A). Forming ATA can turn a healthy problem into a sick one. It may benecessary to orthogonalize A by Gram-Schmidt, instead of computing with ATA.Note 3. The singular values of A in the SVD are the square roots of the eigenvalues ofATA. By equation (12), another formula for the norm is ∥A∥ = σmax. The orthogonalU and V leave lengths unchanged in ∥Ax∥ = ∥UΣV Tx∥. So the largest ∥Ax∥/∥x∥ comesfrom the largest σ in the diagonal matrix Σ.",computations
"Chapter 2 Vector SpacesThe basis for the nullspace isAny combination c1x1 +c2x2 has c1 as its v component, and c2 as its y component. Theonly way to have c1x1+c2x2 = 0 is to have c1 = c2 = 0, so these vectors are independent.They also span the nullspace; the complete solution is vx1 +yx2. Thus the n−r = 4−2vectors are a basis.The nullspace is also called the kernel of A, and its dimension n−r is the nullity.1. The column space of A The column space is sometimes called the range. Thisis consistent with the usual idea of the range, as the set of all possible values f(x); x isin the domain and f(x) is in the range. In our case the function is f(x) = Ax. Its domainconsists of all x in Rn; its range is all possible vectors Ax, which is the column space.(In an earlier edition of this book we called it R(A).)Our problem is to ﬁnd bases for the column spaces of U and A. Those spaces aredifferent (just look at the matrices!) but their dimensions are the same.The ﬁrst and third columns of U are a basis for its column space. They are thecolumns with pivots. Every other column is a combination of those two. Furthermore,the same is true of the original A—even though its columns are different. The pivotcolumns of A are a basis for its column space. The second column is three timesthe ﬁrst, just as in U. The fourth column equals (column 3) − (column 1). The samenullspace is telling us those dependencies.The reason is this: Ax = 0 exactly when Ux = 0. The two systems are equivalent andhave the same solutions. The fourth column of U was also (column 3) − (column 1).Every linear dependence Ax = 0 among the columns of A is matched by a dependenceUx = 0 among the columns of U, with exactly the same coefﬁcients. If a set of columnsof A is independent, then so are the corresponding columns of U, and vice versa.To ﬁnd a basis for the column space C(A), we use what is already done for U. Ther columns containing pivots are a basis for the column space of U. We will pick thosesame r columns in A:The dimension of the column space C(A) equals the rank r, which alsoequals the dimension of the row space: The number of independent columnsequals the number of independent rows. A basis for C(A) is formed by the rcolumns of A that correspond, in U, to the columns containing pivots.The row space and the column space have the same dimension r! This is one ofthe most important theorems in linear algebra. It is often abbreviated as “row rank =column rank.” It expresses a result that, for a random 10 by 12 matrix, is not at all",vector spaces
"4.4 Applications of Determinants1. Find the determinant and all nine cofactors Cij of this triangular matrix:Form CT and verify that ACT = (detA)I. What is A−1?2. Use the cofactor matrix C to invert these symmetric matrices:3. Find x, y, and z by Cramer’s Rule in equation (4):ax + by = 1+ dy = 0x + 4y −+ 3z = 0.4. (a) Find the determinant when a vector x replaces column j of the identity (considerx j = 0 as a separate case):(b) If Ax = b, show that AM is the matrix B j in equation (4), with b in column j.(c) Derive Cramer’s rule by taking determinants in AM = Bj.5. (a) Draw the triangle with vertices A = (2,2), B = (−1,3), and C = (0,0). Byregarding it as half of a parallelogram, explain why its area equals(b) Move the third vertex to C = (1,−4) and justify the formula",determinants
"Chapter 1 Matrices and Gaussian EliminationOn the right-hand side is the column vector b. On the left-hand side are the unknowns u,v, w. Also on the left-hand side are nine coefﬁcients (one of which happens to be zero).It is natural to represent the three unknowns by a vector:The unknown is x =The solution is x =The nine coefﬁcients fall into three rows and three columns, producing a 3 by 3 matrix:A is a square matrix, because the number of equations equals the number of unknowns.If there are n equations in n unknowns, we have a square n by n matrix. More generally,we might have m equations and n unknowns. Then A is rectangular, with m rows and ncolumns. It will be an “m by n matrix.”Matrices are added to each other, or multiplied by numerical constants, exactly asvectors are—one entry at a time. In fact we may regard vectors as special cases ofmatrices; they are matrices with only one column. As with vectors, two matrices can beadded only if they have the same shape:Multiplication of a Matrix and a VectorWe want to rewrite the three equations with three unknowns u, v, w in the simpliﬁedmatrix form Ax = b. Written out in full, matrix times vector equals vector:Matrix form Ax = bThe right-hand side b is the column vector of “inhomogeneous terms.” The left-handside is A times x. This multiplication will be deﬁned exactly so as to reproduce theoriginal system. The ﬁrst component of Ax comes from “multiplying” the ﬁrst row of Ainto the column vector x:",gauss elim
"25. L is lower triangular and S is symmetric. Assume they are invertible:(a) Which three cofactors of L are zero? Then L−1 is lower triangular.(b) Which three pairs of cofactors of S are equal? Then S−1 is symmetric.26. For n = 5 the matrix C containscofactors and each 4 by 4 cofactor containsterms and each term needsmultiplications. Compare with 53 = 125 forthe Gauss-Jordan computation of A−1.Problems 27–36 are about area and volume by determinants.27. (a) Find the area of the parallelogram with edges v = (3,2) and w = (1,4).(b) Find the area of the triangle with sides v, w, and v+w. Draw it.(c) Find the area of the triangle with sides v, w, and w−v. Draw it.28. A box has edges from (0,0,0) to (3,1,1), (1,3,1), and (1,1,3). Find its volume andalso ﬁnd the area of each parallelogram face.29. (a) The corners of a triangle are (2,1), (3,4), and (0,5). What is the area?(b) A new corner at (−1,0) makes it lopsided (four sides). Find the area.30. The parallelogram with sides (2,1) and (2,3) has the same area as the parallelogramwith sides (2,2) and (1,3). Find those areas from 2 by 2 determinants and say whythey must be equal. (I can’t see why from a picture. Please write to me if you do.)31. The Hadamard matrix H has orthogonal rows. The box is a hypercube!What is detH == volume of a hypercube in R4?32. If the columns of a 4 by 4 matrix have lengths L1, L2, L3, L4, what is the largestpossible value for the determinant (based on volume)? If all entries are 1 or −1,what are those lengths and the maximum determinant?33. Show by a picture how a rectangle with area x1y2 minus a rectangle with area x2y1produces the area x1y2 −x2y1 of a parallelogram.34. When the edge vectors a, b, c are perpendicular, the volume of the box is ∥a∥ times∥b∥ times ∥c∥. The matrix ATA is. Find detATA and detA.",determinants
"Chapter 1 Matrices and Gaussian EliminationTest this pattern for L = eye(5) − diag(1:5)\diag(1:4,−1) and inv(L).Special Matrices and ApplicationsThis section has two goals. The ﬁrst is to explain one way in which large linear systemsAx = b can arise in practice. The truth is that a large and completely realistic problem inengineering or economics would lead us far aﬁeld. But there is one natural and importantapplication that does not require a lot of preparation.The other goal is to illustrate, by this same application, the special properties that co-efﬁcient matrices frequently have. Large matrices almost always have a clear pattern—frequently a pattern of symmetry, and very many zero entries. Since a sparse matrixcontains far fewer than n2 pieces of information, the computations ought to be fast. Welook at band matrices, to see how concentration near the diagonal speeds up elimination.In fact we look at one special tridiagonal matrix.The matrix itself can be seen in equation (6). It comes from changing a differentialequation to a matrix equation. The continuous problem asks for u(x) at every x, and acomputer cannot solve it exactly. It has to be approximated by a discrete problem—themore unknowns we keep, the better will be the accuracy and the greater the expense.As a simple but still very typical continuous problem, our choice falls on the differential0 ≤ x ≤ 1.This is a linear equation for the unknown function u(x). Any combination C + Dxcould be added to any solution, since the second derivative ofC+Dx contributes nothing.The uncertainty left by these two arbitrary constants C and D is removed by a “boundarycondition” at each end of the interval:The result is a two-point boundary-value problem, describing not a transient but a steady-state phenomenon—the temperature distribution in a rod, for example, with ends ﬁxedat 0℃ and with a heat source f(x).Remember that our goal is to produce a discrete problem—in other words, a problemin linear algebra. For that reason we can only accept a ﬁnite amount of information aboutf(x), say its values at n equally spaced points x = h,x = 2h,...,x = nh. We computeapproximate values u1,...,un for the true solution u at these same points. At the endsx = 0 and x = 1 = (n+1)h, the boundary values are u0 = 0 and un+1 = 0.The ﬁrst question is: How do we replace the derivative d2u/dx2? The ﬁrst derivativecan be approximated by stopping ∆u/∆x at a ﬁnite stepsize, and not permitting h (or ∆x)",gauss elim
"2.4 The Four Fundamental Subspaces4. Describe the four subspaces in three-dimensional space associated with5. If the product AB is the zero matrix, AB = 0, show that the column space of B iscontained in the nullspace of A. (Also the row space of A is in the left nullspace ofB, since each row of A multiplies B to give a zero row.)6. Suppose A is an m by n matrix of rank r. Under what conditions on those numbers(a) A have a two-sided inverse: AA−1 = A−1A = I?(b) Ax = b have inﬁnitely many solutions for every b?7. Why is there no matrix whose row space and nullspace both contain (1,1,1)?8. Suppose the only solution to Ax = 0 (m equations in n unknowns) is x = 0. What isthe rank and why? The columns of A are linearly9. Find a 1 by 3 matrix whose nullspace consists of all vectors in R3 such that x1 +2x2 +4x3 = 0. Find a 3 by 3 matrix with that same nullspace.10. If Ax = b always has at least one solution, show that the only solution to ATy = 0 isy = 0. Hint: What is the rank?11. If Ax = 0 has a nonzero solution, show that ATy = f fails to be solvable for someright-hand sides f. Construct an example of A and f.12. Find the rank of A and write the matrix as A = uvT:1 0 0 30 0 0 02 0 0 613. If a, b, c are given with a ̸= 0, choose d so thathas rank 1. What are the pivots?14. Find a left-inverse and/or a right-inverse (when they exist) for",vector spaces
"8.2 The Simplex MethodFortunately, cycling does not occur. It is so rare that commercial codes ignore it.Unfortunately, degeneracy is extremely common in applications—if you print the costafter each simplex step you see it repeat several times before the simplex method ﬁnds agood edge. Then the cost decreases again.Each simplex step involves decisions followed by row operations—the entering andleaving variables have to be chosen, and they have to be made to come and go. Oneway to organize the step is to ﬁt A, b, c into a large matrix, or tableau:Tableau is m+1 by m+n+1At the start, the basic variables may be mixed with the free variables. Renumbering ifnecessary, suppose that x1,...,xm are the basic (nonzero) variables at the current corner.The ﬁrst m columns of A form a square matrix B (the basis matrix for that corner). Thelast n columns give an m by n matrix N. The cost vector c splits into [cB cN], and theunknown x into (xB,xN).At the corner, the free variables are xN = 0. There, Ax = b turns into BxB = b:The basic variables will stand alone when elimination multiplies by B−1:To reach the fully reduced row echelon form R = rref(T), subtract cB times the topblock row from the bottom row:0 cN − cBB−1N −cBB−1bLet me review the meaning of each entry in this tableau, and also call attention to Ex-ample 3 (following, with numbers). Here is the algebra:xB +B−1NxN = B−1bThe cost cBxB +cNxN has been turned intocx = (cN −cBB−1N)xN +cBB−1bCost at this corner = cBB−1b.Every important quantity appears in the fully reduced tableau R. We can decide whetherthe corner is optimal by looking at r = cN −cBB−1N in the middle of the bottom row. If",linear_prog
"Chapter 6 Positive Deﬁnite MatricesThose new unknowns y1,...,yℓ are called Lagrange multipliers. They build theconstraint into a function L(x,y). This was the brilliant insight of Lagrange:L(x,y) = P(x)+yT(Cx−d) = 1That term in L is chosen exactly so that ∂L/∂y = 0 brings back Cx = d. When we setthe derivatives of L to zero, we have n+ℓ equations for n+ℓ unknowns x and y:∂L/∂x = 0 :∂L/∂y = 0 :The ﬁrst equations involve the mysterious unknowns y. You might well ask what theyrepresent. Those “dual unknowns” y tell how much the constrained minimum PC/min(which only allows x when Cx = d) exceeds the unconstrained Pmin (allowing all x):PC/min = Pmin + 1Example 2. Suppose P(x1,x2) = 12. Its smallest value is certainly Pmin = 0.This unconstrained problem has n = 2, A = I, and b = 0. So the minimizing equationAx = b just gives x1 = 0 and x2 = 0.Now add one constraint c1x1 + c2x2 = d. This puts x on a line in the x1-x2 plane.The old minimizer x1 = x2 = 0 is not on the line. The Lagrangian function L(x,y) =2 +y(c1x1 +c2x2 −d) has n+ℓ = 2+1 partial derivatives:x1 +c1y = 0x2 +c2y = 0c1x1 +c2x2 = d.Substituting x1 = −c1y and x2 = −c2y into the third equation gives −c2The constrained minimum of P = 12xTx is reached at that solution point:2yd as predicted in equation (5), since b = 0 and Pmin = 0.Figure 6.5 shows what problem the linear algebra has solved, if the constraint keepsx on a line 2x1 −x2 = 5. We are looking for the closest point to (0,0) on this line. Thesolution is x = (2,−1). We expect this shortest vector x to be perpendicular to the line,and we are right.",pos_def_matrices
"5.2 Diagonalization of a MatrixIf A is invertible this rule also applies to its inverse (the power k = −1). The eigen-values of A−1 are 1/λi. That can be seen even without diagonalizing:λ x = A−1x.Example 3. If K is rotation through 90°, then K2 is rotation through 180° (which means−I) and K−1 is rotation through −90°:The eigenvalues of K are i and −i; their squares are −1 and −1; their reciprocals are1/i = −i and 1/(−i) = i. Then K4 is a complete rotation through 360°:For a product of two matrices, we can ask about the eigenvalues of AB—but we won’tget a good answer. It is very tempting to try the same reasoning, hoping to prove whatis not in general true. If λ is an eigenvalue of A and µ is an eigenvalue of B, here is thefalse proof that AB has the eigenvalue µλ:ABx = Aµx = µAx = µλx.The mistake lies in assuming that A and B share the same eigenvector x. In general, theydo not, We could have two matrices with zero eigenvalues, while AB has λ = 1:The eigenvectors of this A and B are completely different, which is typical. For the samereason, the eigenvalues of A+B generally have nothing to do with λ + µ.This false proof does suggest what is true. If the eigenvector is the same for A andB, then the eigenvalues multiply and AB has the eigenvalue µλ. But there is somethingmore important. There is an easy way to recognize when A and B share a full set ofeigenvectors, and that is a key question in quantum mechanics:Diagonalizable matrices share the same eigenvector matrix S if and onlyif AB = BA.Proof. If the same S diagonalizes both A = SΛ1S−1 and B = SΛ2S−1, we can multiplyAB = SΛ1S−1SΛ2S−1 = SΛ1Λ2S−1BA = SΛ2S−1SΛ1S−1 = SΛ2Λ1S−1.Since Λ1Λ2 = Λ2Λ1 (diagonal matrices always commute) we have AB = BA.",eigenvec_val
"10. For n = 2, write y0 from the ﬁrst line of equation (13) and y1 from the second line.For n = 4, use the ﬁrst line to ﬁnd y0 and y1, and the second to ﬁnd y2 and y3, all interms of y′ and y′′.11. Compute y = F4c by the three steps of the Fast Fourier Transform if c = (1,0,1,0).12. Compute y = F8c by the three steps of the Fast Fourier Transform if c = (1,0,1,0,1,0,1,0).Repeat the computation with c = (0,1,0,1,0,1,0,1).13. For the 4 by 4 matrix, write out the formulas for c0, c1, c2, c3 and verify that if f isodd then c is odd. The vector f is odd if fn−j = −f j; for n = 4 that means f0 = 0,f3 = −f1, f2 = 0 as in sin0, sinπ/2, sinπ, sin3π/2. This is copied by c and it leadsto a fast sine transform.14. Multiply the three matrices in equation (16) and compare with F. in which six entriesdo you need to know that i2 = −1?15. Invert the three factors in equation (14) to ﬁnd a fast factorization of F−1.16. F is symmetric. So transpose equation (14) to ﬁnd a new Fast Fourier Transform!17. All entries in the factorization of F6 involve powers of w = sixth root of 1:Write these factors with 1, w, w2 in D and 1, w2, w4 in F3. Multiply!Problems 18–20 introduce the idea of an eigenvector and eigenvalue, when a matrixtimes a vector is a multiple of that vector. This is the theme of Chapter 5.18. The columns of the Fourier matrix F are the eigenvectors of the cyclic permutationP. Multiply PF to ﬁnd the eigenvalues λ0 to λ3:0 1 0 00 0 1 00 0 0 11 0 0 0This is PF = FΛ or P = FΛF−1.19. Two eigenvectors of this circulant matrix C are (1,1,1,1) and (1,i,i2,i3). What arethe eigenvalues e0 and e1?",orthogonality
"5.4 Differential Equations and eAtThat is correct but not beautiful. By substituting cost ±isint for eit and e−it, real num-bers will reappear: The circling solution is u(t) = (cost,sint).Starting from a different u(0) = (a,b), the solution u(t) ends up asThere we have something important! The last matrix is multiplying u(0), so it must bethe exponential eAt. (Remember that u(t) = eAtu(0).) That matrix of cosines and sinesis our leading example of an orthogonal matrix. The columns have length 1, their innerproduct is zero, and we have a conﬁrmation of a wonderful fact:If A is skew-symmetric (AT = −A) then eAt is an orthogonal matrix.AT = −A gives a conservative system. No energy is lost in damping or diffusion:That last equation expresses an essential property of orthogonal matrices. When theymultiply a vector, the length is not changed. The vector u(0) is just rotated, and thatdescribes the solution to du/dt = Au: It goes around in a circle.In this very unusual case, eAt can also be recognized directly from the inﬁnite series.Note that A =has A2 = −I, and use this in the series for eAt:I +At + (At)2Example 4. The diffusion equation is stable: A =has λ = −1 and λ = −3.Example 5. If we close off the inﬁnite segments, nothing can escape:This is a continuous Markov process. Instead of moving every year, the particles moveevery instant. Their total number v + w is constant. That comes from adding the twoequations on the right-hand side: the derivative of v+w is zero.A discrete Markov matrix has its column sums equal to λmax = 1. A continuousMarkov matrix, for differential equations, has its column sums equal to λmax = 0. A isa discrete Markov matrix if and only if B = A − I is a continuous Markov matrix. The",eigenvec_val
"4.4 Applications of Determinants4.11 Explain why the point (x,y) is on the line through (2,8) and (4,7) if4.12 In analogy with the previous exercise, what is the equation for (x,y,z) to be on theplane through (2,0,0), (0,2,0), and (0,0,4)? It involves a 4 by 4 determinant.4.13 If the points (x,y,z), (2,1,0), and (1,1,1) lie on a plane through the origin, whatdeterminant is zero? Are the vectors (1,0,−1), (2,1,0), (1,1,1) independent?4.14 If every row of A has either a single +1, or a single −1, or one of each (and isotherwise zero), show that detA = 1 or −1 or 0.4.15 If C =and D = [ u vw z], then CD = −DC yields 4 equations Ax = 0:(a) Show that detA = 0 if a+d = 0. Solve for u, v, w, z, the entries of D.(b) Show that detA = 0 if ad = bc (so C is singular).In all other cases, CD = −DC is only possible with D = zero matrix.4.16 The circular shift permutes (1,2,...,n) into (2,3,...,1). What is the correspondingpermutation matrix P, and (depending on n) what is its determinant?4.17 Find the determinant of A = eye(5) + ones(5) and if possible eye(n) + ones(n).",determinants
"1.6 Inverses and Transposes44. If B has the columns of A in reverse order, solve (A−B)x = 0 to show that A−B isnot invertible. An example will lead you to x.45. Find and check the inverses (assuming they exist) of these block matrices:46. Use inv(S) to invert MATLAB’s 4 by 4 symmetric matrix S = pascal(4). CreatePascal’s lower triangular A = abs(pascal(4,1)) and test inv(S) = inv(A’) ∗ inv(A).47. If A = ones(4,4) and b = rand(4,1), how does MATLAB tell you that Ax = b hasno solution? If b = ones(4,1), which solution to Ax = b is found by A\b?48. M−1 shows the change in A−1 (useful to know) when a matrix is subtracted from A.Check part 3 by carefully multiplying MM−1 to get I:M = I −uvTM−1 = I +uvT/(1−vTu).M−1 = A−1 +A−1uvTA−1/(1−vTA−1u).M = I −UVM−1 = In +U(Im −VU)−1V.M = A−UW −1VM−1 = A−1 +A−1U(W −VA−1U)−1VA−1.The four identities come from the 1, 1 block when inverting these matrices:Problems 49–55 are about the rules for transpose matrices.49. Find AT and A−1 and (A−1)T and (AT)−1 for50. Verify that (AB)T equals BTAT but those are different from ATBT:In case AB = BA (not generally true!), how do you prove that BTAT = ATBT?51. (a) The matrix(AB)−1�T comes from (A−1)T and (B−1)T. In what order?(b) If U is upper triangular then (U−1)T is52. Show that A2 = 0 is possible but ATA = 0 is not possible (unless A = zero matrix).",gauss elim
"Hint: Subtracting the last row from each of the others leavesSketch A′ = (1,6), B′ = (−2,7), C′ = (0,0) and their relation to A, B, C.6. Explain in terms of volumes why det3A = 3ndetA for an n by n matrix A.7. Predict in advance, and conﬁrm by elimination, the pivot entries of8. Find all the odd permutations of the numbers {1,2,3,4}. They come from an oddnumber of exchanges and lead to detP = −1.9. Suppose the permutation P takes (1,2,3,4,5) to (5,4,1,2,3).(a) What does P2 do to (1,2,3,4,5)?(b) What does P−1 do to (1,2,3,4,5)?10. If P is an odd permutation, explain why P2 is even but P−1 is odd.11. Prove that if you keep multiplying A by the same permutation matrix P, the ﬁrst roweventually comes back to its original place.12. If A is a 5 by 5 matrix with all |aij| ≤ 1, then detA ≤. Volumes or the bigformula or pivots should give some upper bound on the determinant.Problems 13–17 are about Cramer’s Rule for x = A−1b.13. Solve these linear equations by Cramer’s Rule x j = detB j/detA:14. Use Cramer’s Rule to solve for y (only). Call the 3 by 3 determinant D:cx + dy = 0.ax + by +gx + hy +",determinants
"Chapter 2 Vector Spaces7. On the space P3 of cubic polynomials, what matrix represents d2/dt2? Constructthe 4 by 4 matrix from the standard basis 1, t, t2, t3. Find its nullspace and columnspace. What do they mean in terms of polynomials?8. From the cubics P3 to the fourth-degree polynomials P4, what matrix representsmultiplication by 2 + 3t? The columns of the 5 by 4 matrix A come from applyingthe transformation to 1, t, t2, t3.9. The solutions to the linear differential equation d2u/dt2 = u form a vector space(since combinations of solutions are still solutions). Find two independent solutions,to give a basis for that solution space.10. With initial values u = x and du/dt = y at t = 0, what combination of basis vectorsin Problem 9 solves u′′ = u? This transformation from initial values to solution islinear. What is its 2 by 2 matrix (using x = 1, y = 0 and x = 0, y = 1 as basis for V,and your basis for W)?11. Verify directly from c2 +s2 = 1 that reﬂection matrices satisfy H2 = 1.12. Suppose A is a linear transformation from the x-y plane to itself. Why does A−1(x+y) = A−1x + A−1y? If A is represented by the matrix M, explain why A−1 is repre-13. The product (AB)C of linear transformations starts with a vector x and producesu = Cx. Then rule 2V applies AB to u and reaches (AB)Cx.(a) Is this result the same as separately applying C then B then A?(b) Is the result the same as applying BC followed by A? Parentheses are unnecessaryand the associative law (AB)C = A(BC) holds for linear transformations. This isthe best proof of the same law for matrices.14. Prove that T 2 is a linear transformation if T is linear (from R3 to R3).15. The space of all 2 by 2 matrices has the four basis “vectors”For the linear transformation of transposing, ﬁnd its matrix A with respect to thisbasis. Why is A2 = I?16. Find the 4 by 4 cyclic permutation matrix: (x1,x2,x3,x4) is transformed to Ax =(x2,x3,x4,x1). What is the effect of A2? Show that A3 = A−1.17. Find the 4 by 3 matrix A that represents a right shift: (x1,x2,x3) is transformed to(0,x1,x2,x3). Find also the left shift matrix B from R4 back to R3, transforming(x1,x2,x3,x4) to (x2,x3,x4). What are the products AB and BA?",vector spaces
"Chapter 8 Linear Programming and Game Theory4. Show that the following problem is feasible but unbounded, so it has no optimalsolution: Maximize x+y, subject to x ≥ 0, y ≥ 0, −3x+2y ≤ −1, x−y ≤ 2.5. Add a single inequality constraint to x ≥ 0, y ≥ 0 such that the feasible set contains6. What shape is the feasible set x ≥ 0, y ≥ 0, z ≥ 0, x + y + z = 1, and what is the7. Solve the portfolio problem at the end of the preceding section.8. In the feasible set for the General Motors problem, the nonnegativity x,y,z ≥ 0 leavesan eighth of three-dimensional space (the positive octant). How is this cut by the twoplanes from the constraints, and what shape is the feasible set? How do its cornersshow that, with only these two constraints, there will be only two kinds of cars in the9. (Transportation problem) Suppose Texas, California, and Alaska each produce a mil-lion barrels of oil; 800,000 barrels are needed in Chicago at a distance of 1000, 2000,and 3000 miles from the three producers, respectively; and 2,200,000 barrels areneeded in New England 1500, 3000, and 3700 miles away. If shipments cost oneunit for each barrel-mile, what linear program with ﬁve equality constraints must besolved to minimize the shipping cost?This section is about linear programming with n unknowns x ≥ 0 and m constraintsAx ≥ b. In the previous section we had two variables, and one constraint x+2y ≥ 4. Thefull problem is not hard to explain, and not easy to solve.The best approach is to put the problem into matrix form. We are given A, b, and c:1. an m by n matrix A.2. a column vector b with m components, and3. a row vector c (cost vector) with n components.To be “feasible,” the vector x must satisfy x ≥ 0 and Ax ≥ b. The optimal vector x∗ is thefeasible vector of least cost—and the cost is cx = c1x1 +···+cnxn.Minimize the cost cx, subject to x ≥ 0 and Ax ≥ b.The condition x ≥ 0 restricts x to the positive quadrant in n-dimensional space. InR2 it is a quarter of the plane; it is an eighth of R3. A random vector has one chancein 2n of being nonnegative. Ax ≥ b produces m additional halfspaces, and the feasible",linear_prog
"Minima, Maxima, and Saddle PointsUp to now, we have hardly thought about the signs of the eigenvalues. We couldn’task whether λ was positive before it was known to be real. Chapter 5 established thatevery symmetric matrix has real eigenvalues. Now we will ﬁnd a test that can be applieddirectly to A, without computing its eigenvalues, which will guarantee that all thoseeigenvalues are positive. The test brings together three of the most basic ideas in thebook—pivots, determinants, and eigenvalues.The signs of the eigenvalues are often crucial. For stability in differential equations,we needed negative eigenvalues so that eλt would decay. The new and highly importantproblem is to recognize a minimum point. This arises throughout science and engi-neering and every problem of optimization. The mathematical problem is to move thesecond derivative test F′′ > 0 into n dimensions. Here are two examples:F(x,y) = 7+2(x+y)2 −ysiny−x3f(x,y) = 2x2 +4xy+y2.Does either F(x,y) or f(x,y) have a minimum at the point x = y = 0?Remark 3. The zero-order terms F(0,0) = 7 and f(0,0) = 0 have no effect on the an-swer. They simply raise or lower the graphs of F and f.Remark 4. The linear terms give a necessary condition: To have any chance of a mini-mum, the ﬁrst derivatives must vanish at x = y = 0:∂x = 4(x+y)−3x2 = 0∂y = 4(x+y)−ycosy−siny = 0∂x = 4x+4y = 0∂y = 4x+2y = 0.Thus (x,y) = (0,0) is a stationary point for both functions. The surface z = F(x,y) istangent to the horizontal plane z = 7, and the surface z = f(x,y) is tangent to the planez = 0. The question is whether the graphs go above those planes or not, as we moveaway from the tangency point x = y = 0.",pos_def_matrices
"18. In the vector space P3 of all p(x) = a0 + a1x + a2x2 + a3x3, let S be the subset of0 p(x)dx = 0. Verify that S is a subspace and ﬁnd a basis.19. A nonlinear transformation is invertible if T(x) = b has exactly one solution forevery b. The example T(x) = x2 is not invertible because x2 = b has two solutionsfor positive b and no solution for negative b. Which of the following transformations(from the real numbers R1 to the real numbers R1) are invertible? None are linear,20. What is the axis and the rotation angle for the transformation that takes (x1,x2,x3)21. A linear transformation must leave the zero vector ﬁxed: T(0) = 0. Prove this fromT(v+w) = T(v)+T(w) by choosing w =. Prove it also from the requirementT(cv) = cT(v) by choosing c =22. Which of these transformations is not linear? The input is v = (v1,v2).23. If S and T are linear with S(v) = T(v) = v, then S(T(v)) = v or v2?24. Suppose T(v) = v, except that T(0,v2) = (0,0). Show that this transformation satis-ﬁes T(cv) = cT(v) but not T(v+w) = T(v)+T(w).25. Which of these transformations satisfy T(v + w) = T(v) + T(w), and which satisfyT(v) = v1 +v2 +v3.T(v) = largest component of v.26. For these transformations of V = R2 to W = R2, ﬁnd T(T(v)).(a) T(v) = −v.(b) T(v) = v+(1,1).(c) T(v) = 90° rotation = (−v2,v1).(d) T(v) = projection =27. The “cyclic” transformation T is deﬁned by T(v1,v2,v3) = (v2,v3,v1).T(T(T(v)))? What is T 100(v)?",vector spaces
"7.4 Iterative Methods for Ax = b−1, 2, −1 in x and ygives −1, −1, 4, −1, −1entries of the true L and U are set to zero while factoring A. It is called incomplete LUand it can be terriﬁc.We cannot close without mentioning the conjugate gradient method, which lookeddead hut is suddenly very much alive (Problem 33 gives the steps). It is direct ratherthan iterative, but unlike elimination, it can be stopped part way. And needless to say,a completely new idea may still appear and win. But it seems fair to say that it was thechange from .99 to .75 that revolutionized the solution of Ax = b.1. This matrix has eigenvalues 2−2, 2, and 2+Find the Jacobi matrix D−1(−L −U) and the Gauss-Seidel matrix (D + L)−1(−U)and their eigenvalues, and the numbers ωopt and λmax for SOR.2. For this n by n matrix, describe the Jacobi matrix J = D−1(−L−U):Show that the vector x1 = (sinπh,sin2πh,...,sinnπh) is an eigenvector of J witheigenvalue λ1 = cosπh = cosπ/(n+1).3. In Problem 2, show that xk = (sinkπh,sin2kπh,...,sinnkπh) is an eigenvector of A.Multiply xk by A to ﬁnd the corresponding eigenvalue αk. Verify that in the 3 by 3case these eigenvalues are 2−Note. The eigenvalues of the Jacobi matrix J = 12(−L −U) = I − 12A are λk = 1 −2αk = coskπh. They occur in plus-minus pairs and λmax is cosπh.",computations
"Chapter 1 Matrices and Gaussian Elimination40. There are 12 “even” permutations of (1,2,3,4), with an even number of exchanges.Two of them are (1,2,3,4) with no exchanges and (4,3,2,1) with two exchanges.List the other ten. Instead of writing each 4 by 4 matrix, use the numbers 4, 3, 2, 1to give the position of the 1 in each row.41. How many exchanges will permute (5,4,3,2,1) back to (1,2,3,4,5)? How manyexchanges to change (6,5,4,3,2,1) to (1,2,3,4,5,6)? One is even and the other isodd. For (n,...,1) to (1,...,n), show that n = 100 and 101 are even, n = 102 and42. If P1 and P2 are permutation matrices, so is P1P2. This still has the rows of I in someorder. Give examples with P1P2 ̸= P2P1 and P3P4 = P4P3.43. (Try this question.) Which permutation makes PA upper triangular? Which permu-tations make P1AP2 lower triangular? Multiplying A on the right by P2 exchanges44. Find a 3 by 3 permutation matrix with P3 = I (but not P = I). Find a 4 by 4 permu-tation �P with �P4 ̸= I.45. If you take powers of a permutation, why is some Pk eventually equal to I? Find a 5by 5 permutation P so that the smallest power to equal I is P6. (This is a challengequestion. Combine a 2 by 2 block with a 3 by 3 block.)46. The matrix P that multiplies (x,y,z) to give (z,x,y) is also a rotation matrix. Find Pand P3. The rotation axis a = (1,1,1) doesn’t move, it equals Pa. What is the angleof rotation from v = (2,3,−5) to Pv = (−5,2,3)?47. If P is any permutation matrix, ﬁnd a nonzero vector x so that (I − P)x = 0. (Thiswill mean that I −P has no inverse, and has determinant zero.)48. If P has 1s on the antidiagonal from (1,n) to (n,1), describe PAP.The inverse of an n by n matrix is another n by n matrix. The inverse of A is written A−1(and pronounced “A inverse”). The fundamental property is simple: If you multiply by Aand then multiply by A−1, you are back where you started:",gauss elim
"Chapter 8 Linear Programming and Game Theoryany entry in r is negative, the cost can still be reduced. We can make rxN negative,at the start of equation (2), by increasing a component of xN. That will be our next step.But if r ≥ 0, the best corner has been found. This is the stopping test, or optimalityThe corner is optimal when r = cN − cBB−1N ≥ 0. Its cost is cBB−1b.Negative components of r correspond to edges on which the cost goes down.The entering variable xi corresponds to the most negative component of r.The components of r are the reduced costs—the cost in cN to use a free variableminus what it saves. Computing r is called pricing out the variables. If the direct cost(in cN) is less than the saving (from reducing basic variables), then ri < 0, and it will payto increase that free variable.Suppose the most negative reduced cost is ri. Then the ith component of xN is theentering variable, which increases from zero to a positive value α at the next corner(the end of the edge).As xi is increased, other components of x may decrease (to maintain Ax = b). The xkthat reaches zero ﬁrst becomes the leaving variable—it changes from basic to free. Wereach the next corner when a component of xB drops to zero.That new corner is feasible because we still have x ≥ 0. It is basic because we againhave n zero components. The ith component of xN went from zero to α. The kth com-ponent of xB dropped to zero (the other components of xB remain positive). The leavingxk that drops to zero is the one that gives the minimum ratio in equation (3):Suppose xi is the entering variable and u is column i of N:xi = α = smallest ratio(B−1b)jThis minimum is taken only over positive components of B−1u. The kth col-umn of the old B leaves the basis (xk becomes 0) and the new column u enters.B−1u is the column of B−1N in the reduced tableau R, above the most negative entry inthe bottom row r, If B−1u ≤ 0, the next corner is inﬁnitely far away and the minimalcost is −∞ (this doesn’t happen here). Our example will go from the corner P to Q, andbegin again at Q.Example 3. The original cost function x+y and constraints Ax = b = (6,6) giveAt the corner P in Figure 8.3, x = 0 intersects 2x+y = 6. To be organized, we exchange",linear_prog
"Chapter 1 Matrices and Gaussian Elimination8. For which three numbers k does elimination break down? Which is ﬁxed by a rowexchange? In each case, is the number of solutions 0 or 1 or ∞?kx + 3y =3x + ky = −6.9. What test on b1 and b2 decides whether these two equations allow a solution? Howmany solutions will they have? Draw the column picture.3x − 2y =6x − 4y = b2.Problems 10–19 study elimination on 3 by 3 systems (and possible failure).10. Reduce this system to upper triangular form by two row operations:2x + 3y +4x + 7y + 5z = 20− 2y + 2z =Circle the pivots. Solve by back-substitution for z, y, x.11. Apply elimination (circle the pivots) and back-substitution to solve4x − 5y +− 3z = 5.List the three row operations: Subtract12. Which number d forces a row exchange, and what is the triangular system (not sin-gular) for that d? Which d makes this system singular (no third pivot)?2x + 5y + z =4x + dy + z =− z = 3.13. Which number b leads later to a row exchange? Which b leads to a missing pivot?In that singular case ﬁnd a nonzero solution x, y, z.x − 2y − z =+ z = 0.14. (a) Construct a 3 by 3 system that needs two row exchanges to reach a triangularform and a solution.(b) Construct a 3 by 3 system that needs a row exchange to keep going, but breaks",gauss elim
"Chapter 8 Linear Programming and Game Theory2x + y = 6x + 2y = 6Figure 8.3: The corners P, Q, R, and the edges of the feasible set.I either to ﬁnd one genuine corner or to establish that the feasible set is empty. Wecontinue on the assumption that a corner has been found.Suppose one of the n intersecting planes is removed. The points that satisfy theremaining n − 1 equations form an edge that comes out of the corner. This edgeis the intersection of the n − 1 planes. To stay in the feasible set, only one direction isallowed along each edge. But we do have a choice of n different edges, and Phase IImust make that choice.To describe this phase, rewrite Ax ≥ b in a form completely parallel to the n simpleconstraints x j ≥ 0. This is the role of the slack variables w = Ax − b. The constraintsAx ≥ b are translated into w1 ≥ 0,...,wm ≥ 0, with one slack variable for every row ofA. The equation w = Ax−b, or Ax−w = b, goes into matrix form:Slack variables give m equationsThe feasible set is governed by these m equations and the n+m simple inequalities x ≥ 0,w ≥ 0. We now have equality constraints and nonnegativity.The simplex method notices no difference between x and w, so we simplify:The equality constraints are now Ax = b. The n + m inequalities become just x ≥ 0.The only trace left of the slack variable w is in the fact that the new matrix A is m byn+m, and the new x has n+m components. We keep this much of the original notationleaving m and n unchanged as a reminder of what happened. The problem has become:Minimize cx, subject to x ≥ 0 and Ax = b.",linear_prog
"Chapter 1 Matrices and Gaussian Elimination53. (a) The row vector xT times A times the column y produces what number?(b) This is the row xTA =times the column y = (0,1,0).(c) This is the row xT = [0 1] times the column Ay =54. When you transpose a block matrix M = [ A BC D] the result is MT =Under what conditions on A, B, C, D is the block matrix symmetric?55. Explain why the inner product of x and y equals the inner product of Px and Py.Then (Px)T(Py) = xTy says that PTP = I for any permutation. With x = (1,2,3) andy = (1,4,2), choose P to show that (Px)Ty is not always equal to xT(PTy).Problems 56–60 are about symmetric matrices and their factorizations.56. If A = AT and B = BT, which of these matrices are certainly symmetric?57. If A = AT needs a row exchange, then it also needs a column exchange to stay sym-metric. In matrix language, PA loses the symmetry of A but58. (a) How many entries of A can be chosen independently, if A = AT is 5 by 5?(b) How do L and D (5 by 5) give the same number of choices in LDLT?59. Suppose R is rectangular (m by n) and A is symmetric (m by m).(a) Transpose RTAR to show its symmetry. What shape is this matrix?(b) Show why RTR has no negative numbers on its diagonal.60. Factor these symmetric matrices into A = LDLT. The matrix D is diagonal:The next three problems are about applications of (Ax)Ty = xT(ATy).61. Wires go between Boston, Chicago, and Seattle. Those cities are at voltages xB, xC,xS. With unit resistances between cities, the three currents are in y:",gauss elim
"Chapter 1 Matrices and Gaussian EliminationThe remedy is equally clear. Exchange the two equations, moving the entry 3 upinto the pivot. In this example the matrix would become upper triangular:To express this in matrix terms, we need the permutation matrix P that produces therow exchange. It comes from exchanging the rows of I:P has the same effect on b, exchanging b1 and b2. The new system is PAx = Pb. Theunknowns u and v are not reversed in a row exchange.A permutation matrix P has the same rows as the identity (in some order). There isa single “1” in every row and column. The most common permutation matrix is P = I (itexchanges nothing). The product of two permutation matrices is another permutation—the rows of I get reordered twice.After P = I, the simplest permutations exchange two rows. Other permutations ex-change more rows. There are n! = (n)(n−1)···(1) permutations of size n. Row 1 hasn choices, then row 2 has n−1 choices, and ﬁnally the last row has only one choice. Wecan display all 3 by 3 permutations (there are 3! = (3)(2)(1) = 6 matrices):There will be 24 permutation matrices of order n = 4. There are only two permutationmatrices of order 2, namelyWhen we know about inverses and transposes (the next section deﬁnes A−1 and AT),we discover an important fact: P−1 is always the same as PT.A zero in the pivot location raises two possibilities: The trouble may be easy to ﬁx,or it may be serious. This is decided by looking below the zero. If there is a nonzeroentry lower down in the same column, then a row exchange is carried out. The nonzeroentry becomes the needed pivot, and elimination can get going again:d = 0 =⇒ no ﬁrst pivota = 0 =⇒ no second pivot=⇒ no third pivot.",gauss elim
"Chapter 6 Positive Deﬁnite MatricesRemark 5. The second derivatives at (0,0) are decisive:∂x2 = 4−6x = 4∂x∂y = ∂ 2F∂y2 = 4+ysiny−2cosy = 2∂x∂y = ∂ 2 fThese second derivatives 4, 4, 2 contain the answer. Since they are the same for F andf, they must contain the same answer. The two functions behave in exactly the sameway near the origin. F has a minimum if and only if f has a minimum. I am going toshow that those functions don’t!Remark 6. The higher-degree terms in F have no effect on the question of a local min-imum, but they can prevent it from being a global minimum. In our example the term−x3 must sooner or later pull F toward −∞. For f(x,y), with no higher terms, all theaction is at (0,0).Every quadratic form f = ax2+2bxy+cy2 has a stationary point at the origin, where∂ f/∂x = ∂ f/∂y = 0. A local minimum would also be a global minimum, The surfacez = f(x,y) will then be shaped like a bowl, resting on the origin (Figure 6.1). If thestationary point of F is at x = α, y = β, the only change would be to use the secondderivatives at α, β:∂x2 (α,β)+xy ∂ 2FThis f(x,y) behaves near (0,0) in the same way that F(x,y) behaves near (α,β).Figure 6.1: A bowl and a saddle: Deﬁnite A =and indeﬁnite A =The third derivatives are drawn into the problem when the second derivatives fail togive a deﬁnite decision. That happens when the quadratic part is singular. For a trueminimum, f is allowed to vanish only at x = y = 0. When f(x,y) is strictly positive atall other points (the bowl goes up), it is called positive deﬁnite.",pos_def_matrices
"Chapter 7 Computations with Matricesof λ = ω − 1. Since our goal is to make λmax as small as possible, that extremal pairspeciﬁes the best choice ωopt:λmax = ωopt −1.The splittings of the −1, 2, −1 matrix of order n yield these eigenvaluesJacobi (S = 0, 2, 0 matrix):S−1T has |λ|max = cosGauss-Seidel (S = −1, 2, 0 matrix):S−1T has |λ|max =SOR (with the best ω):This can only be appreciated by an example. Suppose A is of order 21, which is verymoderate. Then h = 122, cosπh = .99, and the Jacobi method is slow; cos2πh = .98means that even Gauss-Seidel will require a great many iterations. But since sinπh =.02 = .14, the optimal overrelaxation method will have the convergence factorωopt = 1+λmax = 1.75.The error is reduced by 25% at every step, and a single SOR step is the equivalent of30 Jacobi steps: (.99)30 = .75.That is a striking result from such a simple idea. Its real applications are not in one-dimensional problems like −uxx = f. A tridiagonal system Ax = b is already easy. It isfor partial differential equations that overrelaxation (and other ideas) will be important.Changing to −uxx −uyy = f leads to the “ﬁve-point scheme.” The entries −1, 2, −1 inthe x direction combine with −1, 2, −1 in the y direction to give a main diagonal of+4 and four off-diagonal entries of −1. The matrix A does not have a small bandwidth!There is no way to number the N2 mesh points in a square so that each point staysclose to all four of its neighbors. That is the true curse of dimensionality, and parallelcomputers will partly relieve it.If the ordering goes a row at a time, every point must wait a whole row for the neigh-bor above it to turn up. The “ﬁve-point matrix” has bandwidth N: This matrix has hadmore attention, and been attacked in more different ways, than any other linear equa-tion Ax = b. The trend now is back to direct methods, based on an idea of Golub andHockney; certain special matrices will fall apart when they are dropped the right way.(It is comparable to the Fast Fourier Transform.) Before that came the iterative methodsof alternating direction, in which the splitting separated the tridiagonal matrix in the xdirection from the one in the y direction, A recent choice is S = L0U0, in which small",computations
"(ii) For reﬂections, that same basis gives H =. The second basis vector is re-ﬂected onto its negative, to produce this second column. The matrix H is still 2P−Iwhen the same basis is used for H and P.(iii) For rotations, the matrix is not changed. Those lines are still rotated through θ, andQ = [c −ss c ] as before.The whole question of choosing the best basis is absolutely central, and we come backto it in Chapter 5. The goal is to make the matrix diagonal, as achieved for P and H. Tomake Q diagonal requires complex vectors, since all real vectors are rotated.We mention here the effect on the matrix of a change of basis, while the linear trans-formation stays the same. The matrix A (or Q or P or H) is altered to S−1AS. Thus asingle transformation is represented by different matrices (via different bases, accountedfor by S). The theory of eigenvectors will lead to this formula S−1AS, and to the best1. What matrix has the effect of rotating every vector through 90° and then projectingthe result onto the x-axis? What matrix represents projection onto the x-axis followedby projection onto the y-axis?2. Does the product of 5 reﬂections and 8 rotations of the x-y plane produce a rotation3. The matrix A =produces a stretching in the x-direction. Draw the circle x2 +y2 = 1 and sketch around it the points (2x,y) that result from multiplication by A.What shape is that curve?4. Every straight line remains straight after a linear transformation. If z is halfwaybetween x and y, show that Az is halfway between Ax and Ay.5. The matrix A =yields a shearing transformation, which leaves the y-axis un-changed. Sketch its effect on the x-axis, by indicating what happens to (1,0) and(2,0) and (−1,0)—and how the whole axis is transformed.6. What 3 by 3 matrices represent the transformations that(a) project every vector onto the x-y plane?(b) reﬂect every vector through the x-y plane?(c) rotate the x-y plane through 90°, leaving the z-axis alone?(d) rotate the x-y plane, then x-z, then y-z, through 90°?(e) carry out the same three rotations, but each one through 180°?",vector spaces
"Chapter 2 Vector Spacessatisﬁes this constraint, so it is forced on b! Geometrically, we shall see that the vector(5,−2,1) is perpendicular to each column.If b belongs to the column space, the solutions of Ax = b are easy to ﬁnd. The lastequation in Ux = c is 0 = 0. To the free variables v and y, we may assign any values,as before. The pivot variables u and w are still determined by back-substitution. For aspeciﬁc example with b3 −2b2 +5b1 = 0, choose b = (1,5,5):−1 −3 3 4Forward elimination produces U on the left and c on the right:1 3 3 20 0 3 30 0 0 0The last equation is 0 = 0, as expected. Back-substitution givesAgain there is a double inﬁnity of solutions: v and y are free, u and w are not:x = xp +xnThis has all solutions to Ax = 0, plus the new xp = (−2,0,1,0). That xp is a particularsolution to Ax = b. The last two terms with v and y yield more solutions (because theysatisfy Ax = 0). Every solution to Ax = b is the sum of one particular solution and asolution to Ax = 0:xcomplete = xparticular +xnullspaceThe particular solution in equation (4) comes from solving the equation with all freevariables set to zero. That is the only new part, since the nullspace is already computed.When you multiply the highlighted equation by A, you get Axcomplete = b+0.Geometrically, the solutions again ﬁll a two-dimensional surface—but it is not a sub-space. It does not contain x = 0. It is parallel to the nullspace we had before, shiftedby the particular solution xp as in Figure 2.2. Equation (4) is a good way to write the1. Reduce Ax = b to Ux = c.",vector spaces
"6.2 Tests for Positive Deﬁnitenessfor exponential solutions eiωtx:Mu′′ +Au = 0Canceling eiωt, and writing λ for ω2, this is an eigenvalue problem:Generalized problem Ax = λMxThere is a solution when A−λM is singular. The special choice M = I brings back theusual det(A−λI) = 0. We work out det(A−λM) with m1 = 1 and m2 = 2:= 2λ 2 −6λ +3 = 0For the eigenvector x1(3−1,1), the two masses oscillate together—but the ﬁrst massonly moves as far as3 − 1 ≈ .73. In the fastest mode, the components of x2 = (1 +3,−1) have opposite signs and the masses move in opposite directions. This time thesmaller mass goes much further.The underlying theory is easier to explain if M is split into RTR. (M is assumed to bepositive deﬁnite.) Then the substitution y = Rx changesAx = λMx = λRTRxWriting C for R−1, and multiplying through by (RT)−1 = CT, this becomes a standardeigenvalue problem for the single symmetric matrix CTAC:The eigenvalues λj are the same as for the original Ax = λMx. and the eigenvectors arerelated by y j = Rx j. The properties of CTAC lead directly to thc properties of Ax = λMx,when A = AT and M is positive deﬁnite:1. The eigenvalues for Ax = λMx are real, because CTAC is symmetric.2. The λ’s have the same signs as the eigenvalues of A, by the law of inertia.3. CTAC has orthogonal eigenvectors y j. So the eigenvectors of Ax = λMx havei Mx j = xTi RTRx j = yTi y j = 0.A and M are being simultaneously diagonalized. If S has the x j in its columns, thenSTAS = Λ and STMS = I. This is a congruence transformation, with ST on the left,and not a similarity transformation with S−1. The main point is easy to summarize: Aslong as M is positive deﬁnite, the generalized eigenvalue problem Ax = −λMx behavesexactly like Ax = λx.",pos_def_matrices
"3.1 Orthogonal Vectors and SubspacesFigure 3.2: A right triangle with 5+20 = 25. Dotted angle 100°, dashed angle 30°.We have a right triangle when that sum of cross-product terms xiyi is zero:xTy = x1y1 +···+xnyn = 0.This sum is xTy = ∑xiyi = yTx, the row vector xT times the column vector y:�� = x1y1 +···+xnyn.This number is sometimes called the scalar product or dot product, and denoted by (x,y)or x·y. We will use the name inner product and keep the notation xTy.3A The inner product xTy is zero if and only if x and y are orthogonal vectors.If xTy > 0, their angle is less than 90°. If xTy < 0, their angle is greater thanThe length squared is the inner product of x with itself: xTx = x2n = ∥x∥2. Theonly vector with length zero—the only vector orthogonal to itself—is the zero vector.This vector x = 0 is orthogonal to every vector in Rn.Example 1. (2,2,−1) is orthogonal to (−1,2,2). Both have length √4+4+1 = 3.Useful fact: If nonzero vectors v1,...,vk are mutually orthogonal (every vector isperpendicular to every other), then those vectors are linearly independent.Proof. Suppose c1v1 + ··· + ckvk = 0. To show that c1 must be zero, take the innerproduct of both sides with v1. Orthogonality of the v’s leaves only one term:1(c1v1 +···+ckvk) = c1vTThe vectors are nonzero, so vT1v1 ̸= 0 and therefore c1 = 0. The same is true of every ci.The only combination of the v’s producing zero has all ci = 0: independence!The coordinate vectors e1,...,en in Rn are the most important orthogonal vectors.Those are the columns of the identity matrix. They form the simplest basis for Rn, and",orthogonality
"4.3 Formulas for the DeterminantC11 comes from erasing row 1 and column 1, which leaves the −1, 2, −1 pattern:C11 = detA3 = detFor a12 = −1 it is column 2 that gets removed, and we need its cofactor C12:This left us with the 2 by 2 determinant. Altogether row 1 has produced 2C11 −C12:detA4 = 2(detA3)−detA2 = 2(4)−3 = 5The same idea applies to A5 and A6, and every An:This gives the determinant of increasingly bigger matrices. At every step the determinantof An is n+1, from the previous determinants n and n−1:−1, 2, −1 matrixdetAn = 2(n)−(n−1) = n+1.The answer n+1 agrees with the product of pivots at the start of this section.1. For these matrices, ﬁnd the only nonzero term in the big formula (6):0 1 0 01 0 1 00 1 0 10 0 1 00 0 1 20 3 4 56 7 8 90 0 0 1There is only one way of choosing four nonzero entries from different rows anddifferent columns. By deciding even or odd, compute detA and detB.2. Expand those determinants in cofactors of the ﬁrst row. Find the cofactors (theyinclude the signs (−1)i+j) and the determinants of A and B.3. True or false?(a) The determinant of S−1AS equals the determinant of A.(b) If detA = 0 then at least one of the cofactors must be zero.",determinants
"1.7 Special Matrices and ApplicationsA small pivot forces a practical change in elimination. Normally wecompare each pivot with all possible pivots in the same column. Exchangingrows to obtain the largest possible pivot is called partial pivoting.For B, the pivot .0001 would be compared with the possible pivot I below it. A rowexchange would take place immediately. In matrix terms, this is multiplication by apermutation matrix P = [0 11 0]. The new matrix C = PB has good factors:The pivots for C are 1 and .9999, much better than .0001 and −9999 for B.The strategy of complete pivoting looks also in all later columns for the largest pos-Not only a row but also a column exchange may be needed.postmultiplication by a permutation matrix.) The difﬁculty with being so conservativeis the expense, and partial pivoting is quite adequate.We have ﬁnally arrived at the fundamental algorithm of numerical linear algebra:elimination with partial pivoting. Some further reﬁnements, such as watching to seewhether a whole row or column needs to be resealed, are still possible. But essentiallythe reader now knows what a computer does with a system of linear equations. Com-pared with the “theoretical” description—ﬁnd A−1, and multiply A−1b—our descriptionhas consumed a lot of the reader’s time (and patience). I wish there were an easier wayto explain how x is actually found, but I do not think there is.1. Write out the LDU = LDLT factors of A in equation (6) when n = 4. Find the deter-minant as the product of the pivots in D.2. Modify a11 in equation (6) from a11 = 2 to a11 = 1, and ﬁnd the LDU factors of this3. Find the 5 by 5 matrix A0 (h = 1replacing these boundary conditions by u0 = u1 and u6 = u5. Check that your A0times the constant vector (C,C,C,C,C), yields zero; A0 is singular. Analogously, ifu(x) is a solution of the continuous problem, then so is u(x)+C.4. Write down the 3 by 3 ﬁnite-difference matrix equation (h = 1dx2 +u = x,u(0) = u(1) = 0.",gauss elim
"Chapter 5 Eigenvalues and Eigenvectors9. (a) How is the determinant of AH related to the determinant of A?(b) Prove that the determinant of any Hermitian matrix is real.10. (a) How many degrees of freedom are there in a real symmetric matrix, a real diag-onal matrix, and a real orthogonal matrix? (The ﬁrst answer is the sum of theother two, because A = QΛQT.)(b) Show that 3 by 3 Hermitian matrices A and also unitary U have 9 real degrees offreedom (columns of U can be multiplied by any eiθ).11. Write P, Q and R in the form λ1x1xH2 of the spectral theorem:12. Give a reason if true or a counterexample if false:(a) If A is Hermitian, then A+iI is invertible.(b) If Q is orthogonal. then Q+ 1(c) If A is real, then A+iI is invertible.13. Suppose A is a symmetric 3 by 3 matrix with eigenvalues 0, 1, 2.(a) What properties can be guaranteed for the corresponding unit eigenvectors u, v,(b) In terms of u, v, w, describe the nullspace, left nullspace, row space and column(c) Find a vector x that satisﬁes Ax = v+w. Is x unique?(d) Under what conditions on b does Ax = b have a solution?(e) If u, v, w are the columns of S, what are S−1 and S−1AS?14. In the list below, which classes of matrices contain A and which contain B?0 1 0 00 0 1 00 0 0 11 0 0 01 1 1 11 1 1 11 1 1 11 1 1 1Orthogonal, invertible, projection, permutation, Hermitian, rank-1, diagonalizable,Markov. Find the eigenvalues of A and B.15. What is the dimension of the space S of all n by n real symmetric matrices? Thespectral theorem says that every symmetric matrix is a combination of n projectionmatrices. Since the dimension exceeds n, how is this difference explained?16. Write one signiﬁcant fact about the eigenvalues of each of the following.",eigenvec_val
"The column space consists of the line through a = (1,1,1).The nullspace consists of the plane perpendicular to a.The rank is r = 1.Every column is a multiple of a, and so is Pb = �xa. The vectors that project to p = 0are especially important. They satisfy aTb = 0—they are perpendicular to a and theircomponent along the line is zero. They lie in the nullspace = perpendicular plane.Actually that example is too perfect. It has the nullspace orthogonal to the columnspace, which is haywire. The nullspace should be orthogonal to the row space. Butbecause P is symmetric, its row and column spaces are the same.Remark on scaling The projection matrix aaT/aTa is the same if a is doubled:The line through a is the same, and that’s all the projection matrix cares about. If a hasunit length, the denominator is aTa = 1 and the matrix is just P = aaT.Example 3. Project onto the “θ-direction” in the x-y plane. The line goes througha = (cosθ,sinθ) and the matrix is symmetric with P2 = P:Here c is cosθ, s is sinθ, and c2 + s2 = 1 in the denominator. This matrix P was dis-covered in Section 2.6 on linear transformations. Now we know P in any number ofdimensions. We emphasize that it produces the projection p:To project b onto a, multiply by the projection matrix P: p = Pb.Transposes from Inner ProductsFinally we connect inner products to AT. Up to now, AT is simply the reﬂection of Aacross its main diagonal; the rows of A become the columns of AT, and vice versa. Theentry in row i, column j of AT is the (j,i) entry of A:There is a deeper signiﬁcance to AT, Its close connection to inner products gives a newand much more “abstract” deﬁnition of the transpose:",orthogonality
"x + 2y = 34x + 5y = 6One solution (x, y) = (−1, 2)x + 2y = 34x + 8y = 6x + 2y = 34x + 8y = 12Whole line of solutionsFigure 1.1: The example has one solution. Singular cases have none or too many.First we have to introduce matrices and vectors and the rules for multiplication.Every matrix has a transpose AT. This matrix has an inverse A−1.3. In most cases elimination goes forward without difﬁculties. The matrix has aninverse and the system Ax = b has one solution. In exceptional cases the methodwill break down—either the equations were written in the wrong order, which iseasily ﬁxed by exchanging them, or the equations don’t have a unique solution.That singular case will appear if 8 replaces 5 in our example:1x + 2y =4x + 8y = 6.Elimination still innocently subtracts 4 times the ﬁrst equation from the second. Butlook at the result!This singular case has no solution. Other singular cases have inﬁnitely many solu-tions. (Change 6 to 12 in the example, and elimination will lead to 0 = 0. Now ycan have any value,) When elimination breaks down, we want to ﬁnd every possible4. We need a rough count of the number of elimination steps required to solve a sys-tem of size n. The computing cost often determines the accuracy in the model. Ahundred equations require a third of a million steps (multiplications and subtrac-tions). The computer can do those quickly, but not many trillions. And alreadyafter a million steps, roundoff error could be signiﬁcant. (Some problems are sen-sitive; others are not.) Without trying for full detail, we want to see large systemsthat arise in practice, and how they are actually solved.The ﬁnal result of this chapter will be an elimination algorithm that is about as efﬁ-cient as possible. It is essentially the algorithm that is in constant use in a tremendousvariety of applications. And at the same time, understanding it in terms of matrices—thecoefﬁcient matrix A, the matrices E for elimination and P for row exchanges, and the",gauss elim
"2.4 The Four Fundamental Subspaces38. (a) Find all functions that satisfy dy(b) Choose a particular function that satisﬁes dy(c) Find all functions that satisfy dy39. The cosine space F3 contains all combinations y(x) = Acosx + Bcos2x +Ccos3x.Find a basis for the subspace that has y(0) = 0.40. Find a basis for the space of functions that satisfydx −2y = 0.41. Suppose y1(x), y2(x), y3(x) are three different functions of x. The vector space theyspan could have dimension 1, 2, or 3. Give an example of y1, y2, y3 to show each42. Find a basis for the space of polynomials p(x) of degree ≤ 3. Find a basis for thesubspace with p(1) = 0.43. Write the 3 by 3 identity matrix as a combination of the other ﬁve permutation matri-ces! Then show that those ﬁve matrices are linearly independent. (Assume a combination gives zero, and check entries to prove each term is zero.) The ﬁve permuta-tions are a basis for the subspace of 3 by 3 matrices with row and column sums all44. Review: Which of the following are bases for R3?(a) (1,2,0) and (0,1,−1).(b) (1,1,−1), (2,3,4), (4,1,−1), (0,1,−1).(c) (1,2,2), (−1,2,1), (0,8,0).(d) (1,2,2), (−1,2,1), (0,8,6).45. Review: Suppose A is 5 by 4 with rank 4. Show that Ax = b has no solution when the5 by 5 matrix [A b] is invertible. Show that Ax = b is solvable when [A b] is singular.The Four Fundamental SubspacesThe previous section dealt with deﬁnitions rather than constructions. We know what abasis is, but not how to ﬁnd one. Now, starting from an explicit description of a subspace,we would like to compute an explicit basis.Subspaces can be described in two ways. First, we may be given a set of vectors thatspan the space. (Example: The columns span the column space.) Second, we may be",vector spaces
"The 4 by 4 discrete Fourier transform uses w = i (and notice i4 = 1). The success ofthe whole DFT depends on F times its complex conjugate F:Immediately FF = 4I tells us that F−1 = F/4. The columns of F are orthogonal (to givethe zero entries in 4I). The n by n matrices will have FF = nI. Then the inverse of F isjust F/n. In a moment we will look at the complex number w = e2πi/n (which equals ifor n = 4).It is remarkable that F is so easy to invert. If that were all (and up to 1965 it was all),the discrete transform would have an important place. Now there is more. The multipli-cations by F and F−1 can be done in an extremely fast and ingenious way. Instead ofn2 separate multiplications, coming from the n2 entries in the matrix, the matrix-vectorproducts Fc and F−1y require only 12nlogn steps. This rearrangement of the multiplica-tion is called the Fast Fourier Transform.The section begins with w and its properties, moves on to F−1, and ends with theFFT—the fast transform. The great application in signal processing is ﬁltering, and thekey to its success is the convolution rule. In matrix language, all “circulant matrices”are diagonalized by F. So they reduce to two FFTs and a diagonal matrix.Complex Roots of UnityReal equations can have complex solutions. The equation x2 +1 = 0 led to the inventionof i (and also to −i!). That was declared to be a solution, and the case was closed. Ifsomeone asked about x2 − i = 0, there was an answer: The square roots of a complexnumber are again complex numbers. You must allow combinations x + iy, with a realpart x and an imaginary part y, but no further inventions are necessary. Every real orcomplex polynomial of degree n has a full set of n roots (possibly complex and possiblyrepeated). That is the fundamental theorem of algebra.We are interested in equations like x4 = 1. That has four solutions—the fourth rootsof unity. The two square roots of unity are 1 and −1. The fourth roots are the squareroots of the square roots, 1 and −1, i and −i. The number i will satisfy i4 = 1 becauseit satisﬁes i2 = −1. For the eighth roots of unity we need the square roots of i, and thatbrings us to w = (1+i)/2. Squaring w produces (1+2i+i2)/2, which is i—because1+i2 is zero. Then w8 = i4 = 1. There has to be a system here.The complex numbers cosθ +isinθ in the Fourier matrix are extremely special. Thereal part is plotted on the x-axis and the imaginary part on the y-axis (Figure 3.11). Thenthe number w lies on the unit circle; its distance from the origin is cos2 θ +sin2θ = 1.",orthogonality
"2.3 Linear Independence, Basis, and Dimension62. Construct a matrix whose column space contains (1,1,5) and (0,3.1) and whose63. Construct a matrix whose column space contains (1,1,0) and (0,1,1) and whosenullspace contains (1,0,1) and (0,0,1).64. Construct a matrix whose column space contains (1,1,1) and whose nullspace is theline of multiples of (1,1,1,1).65. Construct a 2 by 2 matrix whose nullspace equals its column space.66. Why does no 3 by 3 matrix have a nullspace that equals its column space?67. The reduced form R of a 3 by 3 matrix with randomly chosen entries is almost sure. What R is virtually certain if the random A is 4 by 3?68. Show by example that these three statements are generally false:(a) A and AT have the same nullspace.(b) A and AT have the same free variables.(c) If R is the reduced form rref(A) then RT is rref(AT).69. If the special solutions to Rx = 0 are in the columns of these N, go backward to ﬁndthe nonzero rows of the reduced matrices R:(empty 3 by 1).70. Explain why A and −A always have the same reduced echelon form R.Linear Independence, Basis, and DimensionBy themselves, the numbers m and n give an incomplete picture of the true size of alinear system. The matrix in our example had three rows and four columns, but the thirdrow was only a combination of the ﬁrst two. After elimination it became a zero row, Ithad no effect on the homogeneous problem Ax = 0. The four columns also failed to beindependent, and the column space degenerated into a two-dimensional plane.The important number that is beginning to emerge (the true size) is the rank r. Therank was introduced as the number of pivots in the elimination process. Equivalently,the ﬁnal matrix U has r nonzero rows. This deﬁnition could be given to a computer. Butit would be wrong to leave it there because the rank has a simple and intuitive meaning:The rank counts the number of genuinely independent rows in the matrix A. We wantdeﬁnitions that are mathematical rather than computational.The goal of this section is to explain and use four ideas:",vector spaces
"Chapter 2 Vector SpacesFor block elimination the pivot is C−1, the multiplier is ATC, and subtraction knocks outAT below the pivot. The result isThe equation for x alone is in the bottom row, with the symmetric matrix ATCA:Then back-substitution in the ﬁrst equation produces y. Nothing mysterious—substitutey = C(b−Ax) into ATy = f to reach (7).Important Remark One potential must be ﬁxed in advance: xn = 0. The nth nodeis grounded, and the nth column of the original incidence matrix is removed. The re-sulting matrix is what we now mean by A: its n−1 columns are independent. The squarematrix ATCA, which is the key to solving equation (7) for x, is an invertible matrix ofExample 1. Suppose a battery b3 and a current source f2 (and ﬁve resistors) connectfour nodes. Node 4 is grounded and the potential x4 = 0 is ﬁxed. The ﬁrst thing is thecurrent law ATy = f at nodes 1, 2, 3:No equation is written for node 4, where the current law is y4+y5+ f2 = 0. This followsfrom adding the other three equations.The other equation is C−1y + Ax = b. The potentials x are connected to the currentsy by Ohm’s Law. The diagonal matrix C contains the ﬁve conductances ci = 1/Ri. The",vector spaces
"4.3 Formulas for the DeterminantIts determinant is the product of its pivots. The numbers 2,...,n all cancel:MATLAB computes the determinant from the pivots. But concentrating all informationinto the pivots makes it impossible to ﬁgure out how a change in one entry would affectthe determinant. We want to ﬁnd an explicit expression for the determinant in terms ofFor n = 2, we will be proving that ad − bc is correct. For n = 3, the determinantformula is again pretty well known (it has six terms):= +a11a22a33 +a12a23a31 +a13a21a32Our goal is to derive these formulas directly from the deﬁning properties 1–3 of detA. Ifwe can handle n = 2 and n = 3 in an organized way, you will see the pattern.To start, each row can be broken down into vectors in the coordinate directions:Then we apply the property of linearity, ﬁrst in row 1 and then in row 2:nn = 22 easyEvery row splits into n coordinate directions, so this expansion has nn terms. Most ofthose terms (all but n! = n factorial) will be automatically zero. When two rows are inthe same coordinate direction, one will be a multiple of the other, andWe pay attention only when the rows point in different directions. The nonzero termshave to come in different columns. Suppose the ﬁrst row has a nonzero term in columnα, the second row is nonzero in column β, and ﬁnally the nth row in column v. Thecolumn numbers α,β,...,v are all different. They are a reordering, or permutation, of",determinants
"3.2 Cosines and Projections onto Lines45. Suppose an n by n matrix is invertible: AA−1 = I. Then the ﬁrst column of A−1 isorthogonal to the space spanned by which rows of A?46. Find ATA if the columns of A are unit vectors, all mutually perpendicular.47. Construct a 3 by 3 matrix A with no zero entries whose columns are mutually per-pendicular. Compute ATA. Why is it a diagonal matrix?48. The lines 3x+y = b1 and 6x+2y = b2 are. They are the same line ifthat case (b1,b2) is perpendicular to the vector. The nullspace of the matrix isthe line 3x+y =. One particular vector in that nullspace is49. Why is each of these statements false?(a) (1,1,1) is perpendicular to (1,1,−2), so the planes x+y+z = 0 and x+y−2z =0 are orthogonal subspaces.(b) The subspace spanned by (1,1,0,0,0) and (0,0,0,1,1) is the orthogonal com-plement of the subspace spanned by (1,−1,0,0,0) and (2,−2,3,4,−4).(c) Two subspaces that meet only in the zero vector are orthogonal.50. Find a matrix with v = (1,2,3) in the row space and column space. Find anothermatrix with v in the nullspace and column space. Which pairs of subspaces can v not51. Suppose A is 3 by 4, B is 4 by 5, and AB = 0. Prove rank(A)+rank(B) ≤ 4.52. The command N = null(A) will produce a basis for the nullspace of A. Then thecommand B = null(N’) will produce a basis for theCosines and Projections onto LinesVectors with xTy = 0 are orthogonal. Now we allow inner products that are not zero,and angles that are not right angles. We want to connect inner products to angles, andalso to transposes. In Chapter 1 the transpose was constructed by ﬂipping over a matrixas if it were some kind of pancake. We have to do better than that.One fact is unavoidable: The orthogonal case is the most important. Suppose wewant to ﬁnd the distance from a point b to the line in the direction of the vector a. Weare looking along that line for the point p closest to b. The key is in the geometry: Theline connecting b to p (the dotted line in Figure 3.5) is perpendicular to a. This fact willallow us to ﬁnd the projection p. Even though a and b are not orthogonal, the distanceproblem automatically brings in orthogonality.The situation is the same when we are given a plane (or any subspace S) instead of aline. Again the problem is to ﬁnd the point p on that subspace that is closest to b. This",orthogonality
"4.3 Formulas for the Determinant26. The matrix Bn is the −1, 2, −1 matrix An except that b11 = 1 instead of a11 = 2.Using cofactors of the last row of B4, show that |B4| = 2|B3|−|B2| = 1:The recursion |Bn| = 2|Bn−1|−|Bn−2| is the same as for the A’s. The difference is inthe starting values 1, 1, 1 for n = 1,2,3. What are the pivots?27. Bn is still the same as An except for b11 = 1. So use linearity in the ﬁrst row, where[1 −1 0] equals [2 −1 0] minus [1 0 0]:Linearity in row 1 gives |Bn| = |An|−|An−1| =28. The n by n determinant Cn has 1s above and below the main diagonal:0 1 0 01 0 1 00 1 0 10 0 1 0(a) What are the determinants of C1, C2, C3, C4?(b) By cofactors ﬁnd the relation between Cn and Cn−1 and Cn−2. Find C10.29. Problem 28 has 1s just above and below the main diagonal. Going down the matrix,which order of columns (if any) gives all 1s? Explain why that permutation is evenfor n = 4,8,12,... and odd for n = 2,6,10,...Cn = 0 (odd n)Cn = 1 (n = 4,8,...)Cn = −1 (n = 2,6,...).30. Explain why this Vandermonde determinant contains x3 but not x4 or x5:The determinant is zero at x =. The cofactor of x3 is V3 =(b−a)(c−a)(c−b). Then V4 = (x−a)(x−b)(x−c)V3.",determinants
"Chapter 8 Linear Programming and Game TheoryIn calculus, everybody knows the condition for a maximum or a minimum: The ﬁrstderivatives are zero. But this is completely changed by constraints. The simplest exam-ple is the line y = x. Its derivative is never zero, calculus looks useless, and the largesty is certain to occur at the end of the interval. That is exactly the situation in linear pro-gramming! There are more variables, and an interval is replaced by a feasible set, butstill the maximum is always found at a corner of the feasible set (with only m nonzeroThe problem in linear programming is to locate that cornet For this, calculus is notcompletely helpless. Far from it, because “Lagrange multipliers” will bring back zeroderivatives at the maximum and minimum. The dual variables y are exactly the La-grange multipliers. And they answer the key question: How does the minimum costcx∗ = y∗b change, if we change b or c?This is a question in sensitivity analysis. It allows us to squeeze extra information outof the dual problem. For an economist or an executive, these questions about marginalcost are the most important.If we allow large changes in b or c, the solution behaves in a very jumpy way. Asthe price of eggs increases, there will be a point at which they disappear from the diet.The variable xegg will jump from basic to free. To follow it properly, we would haveto introduce “parametric” programming. But if the changes are small, the corner thatwas optimal remains optimal. The choice of basic variables does not change; B and Nstay the same. Geometrically, we shifted the feasible set a little (by changing b), and wetilted the planes that come up to meet it (by changing c). When these changes are small,contact occurs at the same (slightly moved) corner.At the end of the simplex method, when the right basic variables are known, thecorresponding m columns of A make up the basis matrix B. At that corner, a shift of size∆b changes the minimum cost by y∗∆b. The dual solution y∗ gives the rate of changeof minimum cost (its derivative) with respect to changes in b. The components of y∗are the shadow prices. If the requirement for a vitamin goes up by ∆, and the druggist’s1, then the diet cost (from druggist or grocer) will go up by y∗1∆. In the case1 is zero, that vitamin is a free good and the small change has no effect. The dietalready contained more than b1.We now ask a different question. Suppose we insist that the diet contain some smalledible amount of egg. The condition xegg ≥ 0 is changed to xegg ≥ δ. How does thisIf eggs were in the diet x∗, there is no change. But if x∗egg = 0, it will cost extra to addin the amount δ. The increase will not be the full price ceggδ, since we can cut down onother foods. The reduced cost of eggs is their own price, minus the price we are payingfor the equivalent in cheaper foods. To compute it we return to equation (2) of Section",linear_prog
"1.3 An Example of Gaussian Elimination15. If rows 1 and 2 are the same, how far can you get with elimination (allowing rowexchange)? If columns 1 and 2 are the same, which pivot is missing?16. Construct a 3 by 3 example that has 9 different coefﬁcients on the left-hand side, butrows 2 and 3 become zero in elimination. How many solutions to your system withb = (1,10,100) and how many with b = (0,0,0)?17. Which number q makes this system singular and which right-hand side t gives itinﬁnitely many solutions? Find the solution that has z = 1.x + 4y − 2z =x + 7y − 6z =3y + qz = t.18. (Recommended) It is impossible for a system of linear equations to have exactly two(a) If (x,y,z) and (X,Y,Z) are two solutions, what is another one?(b) If 25 planes meet at two points, where else do they meet?19. Three planes can fail to have an intersection point, when no two planes are parallel.The system is singular if row 3 of A is aof the ﬁrst two rows. Find a thirdequation that can’t be solved if x+y+z = 0 and x−2y−z = 1.Problems 20–22 move up to 4 by 4 and n by n.20. Find the pivots and the solution for these four equations:21. If you extend Problem 20 following the 1, 2, 1 pattern or the −1, 2, −1 pattern, whatis the ﬁfth pivot? What is the nth pivot?22. Apply elimination and back-substitution to solve4u + 5v +− 3w = 5.What are the pivots? List the three operations in which a multiple of one row is",gauss elim
"Chapter 2 Vector Spaces14. Choose x = (x1,x2,x3,x4) in R4. It has 24 rearrangements like (x2,x1,x3,x4) and(x4,x3,x1,x2). Those 24 vectors, including x itself, span a subspace S. Find speciﬁcvectors x so that the dimension of S is: (a) 0, (b) 1, (c) 3, (d) 4.15. v+w and v−w are combinations of v and w. Write v and w as combinations of v+wand v−w. The two pairs of vectorsthe same space. When are they a basis for16. Decide whether or not the following vectors are linearly independent, by solvingc1v1 +c2v2 +c3v3 +c4v4 = 0:Decide also if they span R4, by trying to solve c1v1 +···+c4v4 = (0,0,0,1).17. Suppose the vectors to be tested for independence are placed into the rows insteadof the columns of A, How does the elimination process from A to U decide for or18. To decide whether b is in the sub space spanned by w1,...,wn, let the vectors w bethe columns of A and try to solve Ax = b. What is the result for(a) w1 = (1,1,0), w2 = (2,2,1), w3 = (0,0,2), b = (3,4,5)?(b) w1 = (1,2,0), w2 = (2,5,0), w3 = (0,0,2), w4 = (0,0,0), and any b?Problems 19–37 are about the requirements for a basis.19. If v1,...,vn are linearly independent, the space they span has dimensionfor that space. If the vectors are the columns of an m by n matrix,20. Find a basis for each of these subspaces of R4:(a) All vectors whose components are equal.(b) All vectors whose components add to zero.(c) All vectors that are perpendicular to (1,1,0,0) and (1,0,1,1).(d) The column space (in R2) and nullspace (in R5) of U =�1 0 1 0 10 1 0 1 021. Find three different bases for the column space of U above. Then ﬁnd two differentbases for the row space of U.22. Suppose v1,v2,...,v6 are six vectors in R4.(a) Those vectors (do)(do not)(might not) span R4.",vector spaces
"Chapter 5 Eigenvalues and EigenvectorsCan you ﬁnd a time T at which the solution u(T) is guaranteed to return to the5.11 If P is the matrix that projects Rn onto a subspace S, explain why every vector inS is an eigenvector, and so is every vector in S⊥. What are the eigenvai (Note theconnection to P2 = P, which means that λ 2 = λ.)5.12 Show that every matrix of order > 1 is the sum of two singular matrices.5.13 (a) Show that the matrix differential equation dX/dt = AX + XB has the solution(b) Prove that the solutions of dX/dt = AX −XA keep the same eigenvalues for all5.14 If the eigenvalues of A are 1 and 3 with eigenvectors (5,2) and (2,1), ﬁnd thesolutions to du/dt = Au and uk+1 = Auk, starting from u = (9,4).5.15 Find the eigenvalues and eigenvectors ofWhat property do you expect for the eigenvectors, and is it true?5.16 By trying to solveshow that A has no square root. Change the diagonal entries of A to 4 and ﬁnd a5.17 (a) Find the eigenvalues and eigenvectors of A =(b) Solve du/dt = Au starting from u(0) = (100,100).(c) If v(t) = income to stockbrokers and w(t) = income to client, and they helpeach other by dv/dt = 4w and dw/dt = 14v, what does the ratio v/w approachas t → ∞?5.18 True or false, with reason if true and counterexample if false:(a) For every matrix A, there is a solution to du/dt = Au starting from u(0) =(b) Every invertible matrix can be diagonalized.(c) Every diagonalizable matrix can be inverted.(d) Exchanging the rows of a 2 by 2 matrix reverses the signs of its eigenvalues.",eigenvec_val
"Chapter 1 Matrices and Gaussian EliminationOur true goal is to look beyond two or three dimensions into n dimensions. With nequations in n unknowns, there are n planes in the row picture. There are n vectors inthe column picture, plus a vector b on the right side. The equations ask for a linear com-bination of the n columns that equals b. For certain equations that will be impossible.Paradoxically, the way to understand the good case is to study the bad one. Thereforewe look at the geometry exactly when it breaks down, in the singular case.Row picture: Intersection of planesColumn picture: Combination of columnsSuppose we are again in three dimensions, and the three planes in the row picture do notintersect. What can go wrong? One possibility is that two planes may be parallel. Theequations 2u + v + w = 5 and 4u + 2v + 2w = 11 are inconsistent—and parallel planesgive no solution (Figure 1.5a shows an end view). In two dimensions, parallel linesare the only possibility for breakdown. But three planes in three dimensions can be introuble without being parallel.Figure 1.5: Singular cases: no solution for (a), (b), or (d), an inﬁnity of solutions for (c).The most common difﬁculty is shown in Figure 1.5b. From the end view the planesform a triangle. Every pair of planes intersects in a line, and those lines are parallel. Thethird plane is not parallel to the other planes, but it is parallel to their line of intersection.This corresponds to a singular system with b = (2,5,6):No solution, as in Figure 1.5b3u + v + 4w = 6.The ﬁrst two left sides add up to the third. On the right side that fails: 2+5 ̸= 6. Equation1 plus equation 2 minus equation 3 is the impossible statement 0 = 1. Thus the equationsare inconsistent, as Gaussian elimination will systematically discover.",gauss elim
"Chapter 1 Matrices and Gaussian EliminationDO 10 I = 1, NDO 10 J = 1, NDO 10 J = 1, NDO 10 I = 1, NB(I) = B(I) + A(I,J) * X(J)B(I) = B(I) + A(I,J) * X(J)The outputs Bx = Ax are the same. The second code is slightly more efﬁcient inFORTRAN and much more efﬁcient on a vector machine (the ﬁrst changes singleentries B(I), the second can update whole vectors).9. If the entries of A are aij, use subscript notation to write(a) the ﬁrst pivot.(b) the multiplier ℓi1 of row 1 to be subtracted from row i.(c) the new entry that replaces aij after that subtraction.(d) the second pivot.10. True or false? Give a speciﬁc counterexample when false.(a) If columns 1 and 3 of B are the same, so are columns 1 and 3 of AB.(b) If rows 1 and 3 of B are the same, so are rows 1 and 3 of AB.(c) If rows 1 and 3 of A are the same, so are rows 1 and 3 of AB.(d) (AB)2 = A2B2.11. The ﬁrst row of AB is a linear combination of all the rows of B. What are the coefﬁ-cients in this combination, and what is the ﬁrst row of AB, if12. The product of two lower triangular matrices is again lower triangular (all its entriesabove the main diagonal are zero). Conﬁrm this with a 3 by 3 example, and thenexplain how it follows from the laws of matrix multiplication.13. By trial and error ﬁnd examples of 2 by 2 matrices such that(a) A2 = −I, A having only real entries.(b) B2 = 0, although B ̸= 0.(c) CD = −DC, not allowing the case CD = 0.(d) EF = 0, although no entries of E or F are zero.14. Describe the rows of EA and the columns of AE if",gauss elim
"3.4 Orthogonal Bases and Gram-Schmidt39. From m independent measurements b1,...,bm of your pulse rate, weighted by w1,...,wm,what is the weighted average that replaces equation (9)? It is the best estimate whenthe statistical variances are σ240. If W =, ﬁnd the W-inner product of x = (2,3) and y = (1,1), and the W-lengthof x. What line of vectors is W-perpendicular to y?41. Find the weighted least-squares solution �xW to Ax = b:Check that the projection A�xW is still perpendicular (in the W-inner product!) to the42. (a) Suppose you guess your professor’s age, making errors e = −2,−1,5 with prob-4. Check that the expected error E(e) is zero and ﬁnd the variance(b) If the professor guesses too (or tries to remember), making errors −1, 0, 1 with8, what weights w1 and w2 give the reliability of your guessand the professor’s guess?Orthogonal Bases and Gram-SchmidtIn an orthogonal basis, every vector is perpendicular to every other vector. The coor-dinate axes are mutually orthogonal. That is just about optimal, and the one possibleimprovement is easy: Divide each vector by its length, to make it a unit vector. Thatchanges an orthogonal basis into an orthonormal basis of q’s:The vectors q1,...,qn are orthonormal ifi q j =whenever i ̸= j,whenever i = j,A matrix with orthonormal columns will be called Q.The most important example is the standard basis. For the x-y plane, the best-knownaxes e1 = (1,0) and e2 = (0,1) are not only perpendicular but horizontal and vertical. Qis the 2 by 2 identity matrix. In n dimensions the standard basis e1,...,en again consists",orthogonality
"Chapter 1 Matrices and Gaussian Elimination58. In MATLAB notation, write the commands that deﬁne the matrix A and the columnvectors x and b. What command would test whether or not Ax = b?59. The MATLAB commands A = eye(3) and v = [3:5]’ produce the 3 by 3 identitymatrix and the column vector (3,4,5). What are the outputs from A ∗ v and v’ ∗ v?(Computer not needed!) If you ask for v ∗ A, what happens?60. If you multiply the 4 by 4 all-ones matrix A = ones(4,4) and the column v =ones(4,1), what is A ∗ v? (Computer not needed.) If you multiply B = eye(4)+ ones(4,4) times w = zeros(4,1) + 2 ∗ ones(4,1), what is B ∗ w?61. Invent a 3 by 3 magic matrix M with entries 1,2,...,9. All rows and columns anddiagonals add to 15. The ﬁrst row could be 8, 3, 4. What is M times (1,1,1)? Whatis the row vectorTriangular Factors and Row ExchangesWe want to look again at elimination, to see what it means in terms of matrices. Thestarting point was the model system Ax = b:Then there were three elimination steps, with multipliers 2, −1, −1:Step 1. Subtract 2 times the ﬁrst equation from the second;Step 2. Subtract −1 times the ﬁrst equation from the third;Step 3. Subtract −1 times the second equation from the third.The result was an equivalent system Ux = c, with a new coefﬁcient matrix U:This matrix U is upper triangular—all entries below the diagonal are zero.The new right side c was derived from the original vector b by the same steps thattook A into U. Forward elimination amounted to three row operations:",gauss elim
